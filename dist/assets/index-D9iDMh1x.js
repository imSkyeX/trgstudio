(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function BT(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Q_={exports:{}},$d={},K_={exports:{}},hn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _w;function Rb(){if(_w)return hn;_w=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),_=Symbol.iterator;function y(Q){return Q===null||typeof Q!="object"?null:(Q=_&&Q[_]||Q["@@iterator"],typeof Q=="function"?Q:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,E={};function M(Q,$,he){this.props=Q,this.context=$,this.refs=E,this.updater=he||w}M.prototype.isReactComponent={},M.prototype.setState=function(Q,$){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,$,"setState")},M.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function P(){}P.prototype=M.prototype;function C(Q,$,he){this.props=Q,this.context=$,this.refs=E,this.updater=he||w}var b=C.prototype=new P;b.constructor=C,T(b,M.prototype),b.isPureReactComponent=!0;var R=Array.isArray,z=Object.prototype.hasOwnProperty,B={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function I(Q,$,he){var Ae,se={},Ne=null,Oe=null;if($!=null)for(Ae in $.ref!==void 0&&(Oe=$.ref),$.key!==void 0&&(Ne=""+$.key),$)z.call($,Ae)&&!k.hasOwnProperty(Ae)&&(se[Ae]=$[Ae]);var He=arguments.length-2;if(He===1)se.children=he;else if(1<He){for(var Xe=Array(He),Je=0;Je<He;Je++)Xe[Je]=arguments[Je+2];se.children=Xe}if(Q&&Q.defaultProps)for(Ae in He=Q.defaultProps,He)se[Ae]===void 0&&(se[Ae]=He[Ae]);return{$$typeof:r,type:Q,key:Ne,ref:Oe,props:se,_owner:B.current}}function N(Q,$){return{$$typeof:r,type:Q.type,key:$,ref:Q.ref,props:Q.props,_owner:Q._owner}}function V(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===r}function W(Q){var $={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(he){return $[he]})}var q=/\/+/g;function H(Q,$){return typeof Q=="object"&&Q!==null&&Q.key!=null?W(""+Q.key):$.toString(36)}function re(Q,$,he,Ae,se){var Ne=typeof Q;(Ne==="undefined"||Ne==="boolean")&&(Q=null);var Oe=!1;if(Q===null)Oe=!0;else switch(Ne){case"string":case"number":Oe=!0;break;case"object":switch(Q.$$typeof){case r:case e:Oe=!0}}if(Oe)return Oe=Q,se=se(Oe),Q=Ae===""?"."+H(Oe,0):Ae,R(se)?(he="",Q!=null&&(he=Q.replace(q,"$&/")+"/"),re(se,$,he,"",function(Je){return Je})):se!=null&&(V(se)&&(se=N(se,he+(!se.key||Oe&&Oe.key===se.key?"":(""+se.key).replace(q,"$&/")+"/")+Q)),$.push(se)),1;if(Oe=0,Ae=Ae===""?".":Ae+":",R(Q))for(var He=0;He<Q.length;He++){Ne=Q[He];var Xe=Ae+H(Ne,He);Oe+=re(Ne,$,he,Xe,se)}else if(Xe=y(Q),typeof Xe=="function")for(Q=Xe.call(Q),He=0;!(Ne=Q.next()).done;)Ne=Ne.value,Xe=Ae+H(Ne,He++),Oe+=re(Ne,$,he,Xe,se);else if(Ne==="object")throw $=String(Q),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Oe}function de(Q,$,he){if(Q==null)return Q;var Ae=[],se=0;return re(Q,Ae,"","",function(Ne){return $.call(he,Ne,se++)}),Ae}function ye(Q){if(Q._status===-1){var $=Q._result;$=$(),$.then(function(he){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=he)},function(he){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=he)}),Q._status===-1&&(Q._status=0,Q._result=$)}if(Q._status===1)return Q._result.default;throw Q._result}var Ce={current:null},K={transition:null},oe={ReactCurrentDispatcher:Ce,ReactCurrentBatchConfig:K,ReactCurrentOwner:B};function ne(){throw Error("act(...) is not supported in production builds of React.")}return hn.Children={map:de,forEach:function(Q,$,he){de(Q,function(){$.apply(this,arguments)},he)},count:function(Q){var $=0;return de(Q,function(){$++}),$},toArray:function(Q){return de(Q,function($){return $})||[]},only:function(Q){if(!V(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},hn.Component=M,hn.Fragment=t,hn.Profiler=i,hn.PureComponent=C,hn.StrictMode=n,hn.Suspense=f,hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oe,hn.act=ne,hn.cloneElement=function(Q,$,he){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var Ae=T({},Q.props),se=Q.key,Ne=Q.ref,Oe=Q._owner;if($!=null){if($.ref!==void 0&&(Ne=$.ref,Oe=B.current),$.key!==void 0&&(se=""+$.key),Q.type&&Q.type.defaultProps)var He=Q.type.defaultProps;for(Xe in $)z.call($,Xe)&&!k.hasOwnProperty(Xe)&&(Ae[Xe]=$[Xe]===void 0&&He!==void 0?He[Xe]:$[Xe])}var Xe=arguments.length-2;if(Xe===1)Ae.children=he;else if(1<Xe){He=Array(Xe);for(var Je=0;Je<Xe;Je++)He[Je]=arguments[Je+2];Ae.children=He}return{$$typeof:r,type:Q.type,key:se,ref:Ne,props:Ae,_owner:Oe}},hn.createContext=function(Q){return Q={$$typeof:a,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:s,_context:Q},Q.Consumer=Q},hn.createElement=I,hn.createFactory=function(Q){var $=I.bind(null,Q);return $.type=Q,$},hn.createRef=function(){return{current:null}},hn.forwardRef=function(Q){return{$$typeof:u,render:Q}},hn.isValidElement=V,hn.lazy=function(Q){return{$$typeof:m,_payload:{_status:-1,_result:Q},_init:ye}},hn.memo=function(Q,$){return{$$typeof:d,type:Q,compare:$===void 0?null:$}},hn.startTransition=function(Q){var $=K.transition;K.transition={};try{Q()}finally{K.transition=$}},hn.unstable_act=ne,hn.useCallback=function(Q,$){return Ce.current.useCallback(Q,$)},hn.useContext=function(Q){return Ce.current.useContext(Q)},hn.useDebugValue=function(){},hn.useDeferredValue=function(Q){return Ce.current.useDeferredValue(Q)},hn.useEffect=function(Q,$){return Ce.current.useEffect(Q,$)},hn.useId=function(){return Ce.current.useId()},hn.useImperativeHandle=function(Q,$,he){return Ce.current.useImperativeHandle(Q,$,he)},hn.useInsertionEffect=function(Q,$){return Ce.current.useInsertionEffect(Q,$)},hn.useLayoutEffect=function(Q,$){return Ce.current.useLayoutEffect(Q,$)},hn.useMemo=function(Q,$){return Ce.current.useMemo(Q,$)},hn.useReducer=function(Q,$,he){return Ce.current.useReducer(Q,$,he)},hn.useRef=function(Q){return Ce.current.useRef(Q)},hn.useState=function(Q){return Ce.current.useState(Q)},hn.useSyncExternalStore=function(Q,$,he){return Ce.current.useSyncExternalStore(Q,$,he)},hn.useTransition=function(){return Ce.current.useTransition()},hn.version="18.3.1",hn}var vw;function W0(){return vw||(vw=1,K_.exports=Rb()),K_.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yw;function Db(){if(yw)return $d;yw=1;var r=W0(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(u,f,d){var m,_={},y=null,w=null;d!==void 0&&(y=""+d),f.key!==void 0&&(y=""+f.key),f.ref!==void 0&&(w=f.ref);for(m in f)n.call(f,m)&&!s.hasOwnProperty(m)&&(_[m]=f[m]);if(u&&u.defaultProps)for(m in f=u.defaultProps,f)_[m]===void 0&&(_[m]=f[m]);return{$$typeof:e,type:u,key:y,ref:w,props:_,_owner:i.current}}return $d.Fragment=t,$d.jsx=a,$d.jsxs=a,$d}var xw;function Lb(){return xw||(xw=1,Q_.exports=Db()),Q_.exports}var rt=Lb(),at=W0();const Mu=BT(at);var cg={},Z_={exports:{}},Rs={},J_={exports:{}},ev={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ww;function Ob(){return ww||(ww=1,function(r){function e(K,oe){var ne=K.length;K.push(oe);e:for(;0<ne;){var Q=ne-1>>>1,$=K[Q];if(0<i($,oe))K[Q]=oe,K[ne]=$,ne=Q;else break e}}function t(K){return K.length===0?null:K[0]}function n(K){if(K.length===0)return null;var oe=K[0],ne=K.pop();if(ne!==oe){K[0]=ne;e:for(var Q=0,$=K.length,he=$>>>1;Q<he;){var Ae=2*(Q+1)-1,se=K[Ae],Ne=Ae+1,Oe=K[Ne];if(0>i(se,ne))Ne<$&&0>i(Oe,se)?(K[Q]=Oe,K[Ne]=ne,Q=Ne):(K[Q]=se,K[Ae]=ne,Q=Ae);else if(Ne<$&&0>i(Oe,ne))K[Q]=Oe,K[Ne]=ne,Q=Ne;else break e}}return oe}function i(K,oe){var ne=K.sortIndex-oe.sortIndex;return ne!==0?ne:K.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var a=Date,u=a.now();r.unstable_now=function(){return a.now()-u}}var f=[],d=[],m=1,_=null,y=3,w=!1,T=!1,E=!1,M=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(K){for(var oe=t(d);oe!==null;){if(oe.callback===null)n(d);else if(oe.startTime<=K)n(d),oe.sortIndex=oe.expirationTime,e(f,oe);else break;oe=t(d)}}function R(K){if(E=!1,b(K),!T)if(t(f)!==null)T=!0,ye(z);else{var oe=t(d);oe!==null&&Ce(R,oe.startTime-K)}}function z(K,oe){T=!1,E&&(E=!1,P(I),I=-1),w=!0;var ne=y;try{for(b(oe),_=t(f);_!==null&&(!(_.expirationTime>oe)||K&&!W());){var Q=_.callback;if(typeof Q=="function"){_.callback=null,y=_.priorityLevel;var $=Q(_.expirationTime<=oe);oe=r.unstable_now(),typeof $=="function"?_.callback=$:_===t(f)&&n(f),b(oe)}else n(f);_=t(f)}if(_!==null)var he=!0;else{var Ae=t(d);Ae!==null&&Ce(R,Ae.startTime-oe),he=!1}return he}finally{_=null,y=ne,w=!1}}var B=!1,k=null,I=-1,N=5,V=-1;function W(){return!(r.unstable_now()-V<N)}function q(){if(k!==null){var K=r.unstable_now();V=K;var oe=!0;try{oe=k(!0,K)}finally{oe?H():(B=!1,k=null)}}else B=!1}var H;if(typeof C=="function")H=function(){C(q)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,de=re.port2;re.port1.onmessage=q,H=function(){de.postMessage(null)}}else H=function(){M(q,0)};function ye(K){k=K,B||(B=!0,H())}function Ce(K,oe){I=M(function(){K(r.unstable_now())},oe)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(K){K.callback=null},r.unstable_continueExecution=function(){T||w||(T=!0,ye(z))},r.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<K?Math.floor(1e3/K):5},r.unstable_getCurrentPriorityLevel=function(){return y},r.unstable_getFirstCallbackNode=function(){return t(f)},r.unstable_next=function(K){switch(y){case 1:case 2:case 3:var oe=3;break;default:oe=y}var ne=y;y=oe;try{return K()}finally{y=ne}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(K,oe){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ne=y;y=K;try{return oe()}finally{y=ne}},r.unstable_scheduleCallback=function(K,oe,ne){var Q=r.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?Q+ne:Q):ne=Q,K){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,K={id:m++,callback:oe,priorityLevel:K,startTime:ne,expirationTime:$,sortIndex:-1},ne>Q?(K.sortIndex=ne,e(d,K),t(f)===null&&K===t(d)&&(E?(P(I),I=-1):E=!0,Ce(R,ne-Q))):(K.sortIndex=$,e(f,K),T||w||(T=!0,ye(z))),K},r.unstable_shouldYield=W,r.unstable_wrapCallback=function(K){var oe=y;return function(){var ne=y;y=oe;try{return K.apply(this,arguments)}finally{y=ne}}}}(ev)),ev}var Sw;function Nb(){return Sw||(Sw=1,J_.exports=Ob()),J_.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ew;function kb(){if(Ew)return Rs;Ew=1;var r=W0(),e=Nb();function t(o){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+o,p=1;p<arguments.length;p++)l+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function s(o,l){a(o,l),a(o+"Capture",l)}function a(o,l){for(i[o]=l,o=0;o<l.length;o++)n.add(l[o])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},_={};function y(o){return f.call(_,o)?!0:f.call(m,o)?!1:d.test(o)?_[o]=!0:(m[o]=!0,!1)}function w(o,l,p,x){if(p!==null&&p.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return x?!1:p!==null?!p.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function T(o,l,p,x){if(l===null||typeof l>"u"||w(o,l,p,x))return!0;if(x)return!1;if(p!==null)switch(p.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function E(o,l,p,x,A,O,G){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=x,this.attributeNamespace=A,this.mustUseProperty=p,this.propertyName=o,this.type=l,this.sanitizeURL=O,this.removeEmptyString=G}var M={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){M[o]=new E(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var l=o[0];M[l]=new E(l,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){M[o]=new E(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){M[o]=new E(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){M[o]=new E(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){M[o]=new E(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){M[o]=new E(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){M[o]=new E(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){M[o]=new E(o,5,!1,o.toLowerCase(),null,!1,!1)});var P=/[\-:]([a-z])/g;function C(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var l=o.replace(P,C);M[l]=new E(l,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var l=o.replace(P,C);M[l]=new E(l,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var l=o.replace(P,C);M[l]=new E(l,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){M[o]=new E(o,1,!1,o.toLowerCase(),null,!1,!1)}),M.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){M[o]=new E(o,1,!1,o.toLowerCase(),null,!0,!0)});function b(o,l,p,x){var A=M.hasOwnProperty(l)?M[l]:null;(A!==null?A.type!==0:x||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(T(l,p,A,x)&&(p=null),x||A===null?y(l)&&(p===null?o.removeAttribute(l):o.setAttribute(l,""+p)):A.mustUseProperty?o[A.propertyName]=p===null?A.type===3?!1:"":p:(l=A.attributeName,x=A.attributeNamespace,p===null?o.removeAttribute(l):(A=A.type,p=A===3||A===4&&p===!0?"":""+p,x?o.setAttributeNS(x,l,p):o.setAttribute(l,p))))}var R=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,z=Symbol.for("react.element"),B=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),W=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),de=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),Ce=Symbol.for("react.offscreen"),K=Symbol.iterator;function oe(o){return o===null||typeof o!="object"?null:(o=K&&o[K]||o["@@iterator"],typeof o=="function"?o:null)}var ne=Object.assign,Q;function $(o){if(Q===void 0)try{throw Error()}catch(p){var l=p.stack.trim().match(/\n( *(at )?)/);Q=l&&l[1]||""}return`
`+Q+o}var he=!1;function Ae(o,l){if(!o||he)return"";he=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(we){var x=we}Reflect.construct(o,[],l)}else{try{l.call()}catch(we){x=we}o.call(l.prototype)}else{try{throw Error()}catch(we){x=we}o()}}catch(we){if(we&&x&&typeof we.stack=="string"){for(var A=we.stack.split(`
`),O=x.stack.split(`
`),G=A.length-1,te=O.length-1;1<=G&&0<=te&&A[G]!==O[te];)te--;for(;1<=G&&0<=te;G--,te--)if(A[G]!==O[te]){if(G!==1||te!==1)do if(G--,te--,0>te||A[G]!==O[te]){var ie=`
`+A[G].replace(" at new "," at ");return o.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",o.displayName)),ie}while(1<=G&&0<=te);break}}}finally{he=!1,Error.prepareStackTrace=p}return(o=o?o.displayName||o.name:"")?$(o):""}function se(o){switch(o.tag){case 5:return $(o.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return o=Ae(o.type,!1),o;case 11:return o=Ae(o.type.render,!1),o;case 1:return o=Ae(o.type,!0),o;default:return""}}function Ne(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case k:return"Fragment";case B:return"Portal";case N:return"Profiler";case I:return"StrictMode";case H:return"Suspense";case re:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case W:return(o.displayName||"Context")+".Consumer";case V:return(o._context.displayName||"Context")+".Provider";case q:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case de:return l=o.displayName||null,l!==null?l:Ne(o.type)||"Memo";case ye:l=o._payload,o=o._init;try{return Ne(o(l))}catch{}}return null}function Oe(o){var l=o.type;switch(o.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=l.render,o=o.displayName||o.name||"",l.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ne(l);case 8:return l===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function He(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Xe(o){var l=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Je(o){var l=Xe(o)?"checked":"value",p=Object.getOwnPropertyDescriptor(o.constructor.prototype,l),x=""+o[l];if(!o.hasOwnProperty(l)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var A=p.get,O=p.set;return Object.defineProperty(o,l,{configurable:!0,get:function(){return A.call(this)},set:function(G){x=""+G,O.call(this,G)}}),Object.defineProperty(o,l,{enumerable:p.enumerable}),{getValue:function(){return x},setValue:function(G){x=""+G},stopTracking:function(){o._valueTracker=null,delete o[l]}}}}function ut(o){o._valueTracker||(o._valueTracker=Je(o))}function De(o){if(!o)return!1;var l=o._valueTracker;if(!l)return!0;var p=l.getValue(),x="";return o&&(x=Xe(o)?o.checked?"true":"false":o.value),o=x,o!==p?(l.setValue(o),!0):!1}function Le(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Qe(o,l){var p=l.checked;return ne({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??o._wrapperState.initialChecked})}function gt(o,l){var p=l.defaultValue==null?"":l.defaultValue,x=l.checked!=null?l.checked:l.defaultChecked;p=He(l.value!=null?l.value:p),o._wrapperState={initialChecked:x,initialValue:p,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function et(o,l){l=l.checked,l!=null&&b(o,"checked",l,!1)}function It(o,l){et(o,l);var p=He(l.value),x=l.type;if(p!=null)x==="number"?(p===0&&o.value===""||o.value!=p)&&(o.value=""+p):o.value!==""+p&&(o.value=""+p);else if(x==="submit"||x==="reset"){o.removeAttribute("value");return}l.hasOwnProperty("value")?Pt(o,l.type,p):l.hasOwnProperty("defaultValue")&&Pt(o,l.type,He(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(o.defaultChecked=!!l.defaultChecked)}function At(o,l,p){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var x=l.type;if(!(x!=="submit"&&x!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+o._wrapperState.initialValue,p||l===o.value||(o.value=l),o.defaultValue=l}p=o.name,p!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,p!==""&&(o.name=p)}function Pt(o,l,p){(l!=="number"||Le(o.ownerDocument)!==o)&&(p==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+p&&(o.defaultValue=""+p))}var Yt=Array.isArray;function tn(o,l,p,x){if(o=o.options,l){l={};for(var A=0;A<p.length;A++)l["$"+p[A]]=!0;for(p=0;p<o.length;p++)A=l.hasOwnProperty("$"+o[p].value),o[p].selected!==A&&(o[p].selected=A),A&&x&&(o[p].defaultSelected=!0)}else{for(p=""+He(p),l=null,A=0;A<o.length;A++){if(o[A].value===p){o[A].selected=!0,x&&(o[A].defaultSelected=!0);return}l!==null||o[A].disabled||(l=o[A])}l!==null&&(l.selected=!0)}}function ee(o,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},l,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function X(o,l){var p=l.value;if(p==null){if(p=l.children,l=l.defaultValue,p!=null){if(l!=null)throw Error(t(92));if(Yt(p)){if(1<p.length)throw Error(t(93));p=p[0]}l=p}l==null&&(l=""),p=l}o._wrapperState={initialValue:He(p)}}function Se(o,l){var p=He(l.value),x=He(l.defaultValue);p!=null&&(p=""+p,p!==o.value&&(o.value=p),l.defaultValue==null&&o.defaultValue!==p&&(o.defaultValue=p)),x!=null&&(o.defaultValue=""+x)}function $e(o){var l=o.textContent;l===o._wrapperState.initialValue&&l!==""&&l!==null&&(o.value=l)}function Ue(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function je(o,l){return o==null||o==="http://www.w3.org/1999/xhtml"?Ue(l):o==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var _t,st=function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,p,x,A){MSApp.execUnsafeLocalFunction(function(){return o(l,p,x,A)})}:o}(function(o,l){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=l;else{for(_t=_t||document.createElement("div"),_t.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=_t.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;l.firstChild;)o.appendChild(l.firstChild)}});function Re(o,l){if(l){var p=o.firstChild;if(p&&p===o.lastChild&&p.nodeType===3){p.nodeValue=l;return}}o.textContent=l}var Et={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ht=["Webkit","ms","Moz","O"];Object.keys(Et).forEach(function(o){ht.forEach(function(l){l=l+o.charAt(0).toUpperCase()+o.substring(1),Et[l]=Et[o]})});function Rt(o,l,p){return l==null||typeof l=="boolean"||l===""?"":p||typeof l!="number"||l===0||Et.hasOwnProperty(o)&&Et[o]?(""+l).trim():l+"px"}function bt(o,l){o=o.style;for(var p in l)if(l.hasOwnProperty(p)){var x=p.indexOf("--")===0,A=Rt(p,l[p],x);p==="float"&&(p="cssFloat"),x?o.setProperty(p,A):o[p]=A}}var Tt=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function rn(o,l){if(l){if(Tt[o]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function Cn(o,l){if(o.indexOf("-")===-1)return typeof l.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bn=null;function le(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var be=null,Fe=null,tt=null;function ct(o){if(o=zo(o)){if(typeof be!="function")throw Error(t(280));var l=o.stateNode;l&&(l=Bh(l),be(o.stateNode,o.type,l))}}function an(o){Fe?tt?tt.push(o):tt=[o]:Fe=o}function Wn(){if(Fe){var o=Fe,l=tt;if(tt=Fe=null,ct(o),l)for(o=0;o<l.length;o++)ct(l[o])}}function ri(o,l){return o(l)}function Yi(){}var _n=!1;function Ci(o,l,p){if(_n)return o(l,p);_n=!0;try{return ri(o,l,p)}finally{_n=!1,(Fe!==null||tt!==null)&&(Yi(),Wn())}}function vn(o,l){var p=o.stateNode;if(p===null)return null;var x=Bh(p);if(x===null)return null;p=x[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(o=o.type,x=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!x;break e;default:o=!1}if(o)return null;if(p&&typeof p!="function")throw Error(t(231,l,typeof p));return p}var ca=!1;if(u)try{var Jr={};Object.defineProperty(Jr,"passive",{get:function(){ca=!0}}),window.addEventListener("test",Jr,Jr),window.removeEventListener("test",Jr,Jr)}catch{ca=!1}function oo(o,l,p,x,A,O,G,te,ie){var we=Array.prototype.slice.call(arguments,3);try{l.apply(p,we)}catch(Ve){this.onError(Ve)}}var Y=!1,ge=null,Ee=!1,pe=null,Ie={onError:function(o){Y=!0,ge=o}};function Mt(o,l,p,x,A,O,G,te,ie){Y=!1,ge=null,oo.apply(Ie,arguments)}function kt(o,l,p,x,A,O,G,te,ie){if(Mt.apply(this,arguments),Y){if(Y){var we=ge;Y=!1,ge=null}else throw Error(t(198));Ee||(Ee=!0,pe=we)}}function Lt(o){var l=o,p=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,(l.flags&4098)!==0&&(p=l.return),o=l.return;while(o)}return l.tag===3?p:null}function Ft(o){if(o.tag===13){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function Ht(o){if(Lt(o)!==o)throw Error(t(188))}function Qt(o){var l=o.alternate;if(!l){if(l=Lt(o),l===null)throw Error(t(188));return l!==o?null:o}for(var p=o,x=l;;){var A=p.return;if(A===null)break;var O=A.alternate;if(O===null){if(x=A.return,x!==null){p=x;continue}break}if(A.child===O.child){for(O=A.child;O;){if(O===p)return Ht(A),o;if(O===x)return Ht(A),l;O=O.sibling}throw Error(t(188))}if(p.return!==x.return)p=A,x=O;else{for(var G=!1,te=A.child;te;){if(te===p){G=!0,p=A,x=O;break}if(te===x){G=!0,x=A,p=O;break}te=te.sibling}if(!G){for(te=O.child;te;){if(te===p){G=!0,p=O,x=A;break}if(te===x){G=!0,x=O,p=A;break}te=te.sibling}if(!G)throw Error(t(189))}}if(p.alternate!==x)throw Error(t(190))}if(p.tag!==3)throw Error(t(188));return p.stateNode.current===p?o:l}function Kt(o){return o=Qt(o),o!==null?Nn(o):null}function Nn(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var l=Nn(o);if(l!==null)return l;o=o.sibling}return null}var _i=e.unstable_scheduleCallback,Sr=e.unstable_cancelCallback,ys=e.unstable_shouldYield,Yn=e.unstable_requestPaint,vt=e.unstable_now,xs=e.unstable_getCurrentPriorityLevel,Rn=e.unstable_ImmediatePriority,zi=e.unstable_UserBlockingPriority,Er=e.unstable_NormalPriority,es=e.unstable_LowPriority,ts=e.unstable_IdlePriority,An=null,Ut=null;function mn(o){if(Ut&&typeof Ut.onCommitFiberRoot=="function")try{Ut.onCommitFiberRoot(An,o,void 0,(o.current.flags&128)===128)}catch{}}var ln=Math.clz32?Math.clz32:ns,Qn=Math.log,Ai=Math.LN2;function ns(o){return o>>>=0,o===0?32:31-(Qn(o)/Ai|0)|0}var Fs=64,bi=4194304;function Us(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function ha(o,l){var p=o.pendingLanes;if(p===0)return 0;var x=0,A=o.suspendedLanes,O=o.pingedLanes,G=p&268435455;if(G!==0){var te=G&~A;te!==0?x=Us(te):(O&=G,O!==0&&(x=Us(O)))}else G=p&~A,G!==0?x=Us(G):O!==0&&(x=Us(O));if(x===0)return 0;if(l!==0&&l!==x&&(l&A)===0&&(A=x&-x,O=l&-l,A>=O||A===16&&(O&4194240)!==0))return l;if((x&4)!==0&&(x|=p&16),l=o.entangledLanes,l!==0)for(o=o.entanglements,l&=x;0<l;)p=31-ln(l),A=1<<p,x|=o[p],l&=~A;return x}function wh(o,l){switch(o){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ws(o,l){for(var p=o.suspendedLanes,x=o.pingedLanes,A=o.expirationTimes,O=o.pendingLanes;0<O;){var G=31-ln(O),te=1<<G,ie=A[G];ie===-1?((te&p)===0||(te&x)!==0)&&(A[G]=wh(te,l)):ie<=l&&(o.expiredLanes|=te),O&=~te}}function Ur(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function Qi(){var o=Fs;return Fs<<=1,(Fs&4194240)===0&&(Fs=64),o}function fa(o){for(var l=[],p=0;31>p;p++)l.push(o);return l}function da(o,l,p){o.pendingLanes|=l,l!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,l=31-ln(l),o[l]=p}function kn(o,l){var p=o.pendingLanes&~l;o.pendingLanes=l,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=l,o.mutableReadLanes&=l,o.entangledLanes&=l,l=o.entanglements;var x=o.eventTimes;for(o=o.expirationTimes;0<p;){var A=31-ln(p),O=1<<A;l[A]=0,x[A]=-1,o[A]=-1,p&=~O}}function Bs(o,l){var p=o.entangledLanes|=l;for(o=o.entanglements;p;){var x=31-ln(p),A=1<<x;A&l|o[x]&l&&(o[x]|=l),p&=~A}}var sn=0;function Ss(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var Ua,Nl,Sh,kl,zl,bo=!1,ao=[],Pi=null,jt=null,Es=null,lo=new Map,is=new Map,uo=[],ad="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fi(o,l){switch(o){case"focusin":case"focusout":Pi=null;break;case"dragenter":case"dragleave":jt=null;break;case"mouseover":case"mouseout":Es=null;break;case"pointerover":case"pointerout":lo.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":is.delete(l.pointerId)}}function ar(o,l,p,x,A,O){return o===null||o.nativeEvent!==O?(o={blockedOn:l,domEventName:p,eventSystemFlags:x,nativeEvent:O,targetContainers:[A]},l!==null&&(l=zo(l),l!==null&&Nl(l)),o):(o.eventSystemFlags|=x,l=o.targetContainers,A!==null&&l.indexOf(A)===-1&&l.push(A),o)}function ld(o,l,p,x,A){switch(l){case"focusin":return Pi=ar(Pi,o,l,p,x,A),!0;case"dragenter":return jt=ar(jt,o,l,p,x,A),!0;case"mouseover":return Es=ar(Es,o,l,p,x,A),!0;case"pointerover":var O=A.pointerId;return lo.set(O,ar(lo.get(O)||null,o,l,p,x,A)),!0;case"gotpointercapture":return O=A.pointerId,is.set(O,ar(is.get(O)||null,o,l,p,x,A)),!0}return!1}function Fl(o){var l=wa(o.target);if(l!==null){var p=Lt(l);if(p!==null){if(l=p.tag,l===13){if(l=Ft(p),l!==null){o.blockedOn=l,zl(o.priority,function(){Sh(p)});return}}else if(l===3&&p.stateNode.current.memoizedState.isDehydrated){o.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Po(o){if(o.blockedOn!==null)return!1;for(var l=o.targetContainers;0<l.length;){var p=Tr(o.domEventName,o.eventSystemFlags,l[0],o.nativeEvent);if(p===null){p=o.nativeEvent;var x=new p.constructor(p.type,p);Bn=x,p.target.dispatchEvent(x),Bn=null}else return l=zo(p),l!==null&&Nl(l),o.blockedOn=p,!1;l.shift()}return!0}function co(o,l,p){Po(o)&&p.delete(l)}function rs(){bo=!1,Pi!==null&&Po(Pi)&&(Pi=null),jt!==null&&Po(jt)&&(jt=null),Es!==null&&Po(Es)&&(Es=null),lo.forEach(co),is.forEach(co)}function Vs(o,l){o.blockedOn===l&&(o.blockedOn=null,bo||(bo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,rs)))}function Hs(o){function l(A){return Vs(A,o)}if(0<ao.length){Vs(ao[0],o);for(var p=1;p<ao.length;p++){var x=ao[p];x.blockedOn===o&&(x.blockedOn=null)}}for(Pi!==null&&Vs(Pi,o),jt!==null&&Vs(jt,o),Es!==null&&Vs(Es,o),lo.forEach(l),is.forEach(l),p=0;p<uo.length;p++)x=uo[p],x.blockedOn===o&&(x.blockedOn=null);for(;0<uo.length&&(p=uo[0],p.blockedOn===null);)Fl(p),p.blockedOn===null&&uo.shift()}var Fi=R.ReactCurrentBatchConfig,lr=!0;function zn(o,l,p,x){var A=sn,O=Fi.transition;Fi.transition=null;try{sn=1,Ul(o,l,p,x)}finally{sn=A,Fi.transition=O}}function qu(o,l,p,x){var A=sn,O=Fi.transition;Fi.transition=null;try{sn=4,Ul(o,l,p,x)}finally{sn=A,Fi.transition=O}}function Ul(o,l,p,x){if(lr){var A=Tr(o,l,p,x);if(A===null)Oh(o,l,x,Ba,p),fi(o,x);else if(ld(A,o,l,p,x))x.stopPropagation();else if(fi(o,x),l&4&&-1<ad.indexOf(o)){for(;A!==null;){var O=zo(A);if(O!==null&&Ua(O),O=Tr(o,l,p,x),O===null&&Oh(o,l,x,Ba,p),O===A)break;A=O}A!==null&&x.stopPropagation()}else Oh(o,l,x,null,p)}}var Ba=null;function Tr(o,l,p,x){if(Ba=null,o=le(x),o=wa(o),o!==null)if(l=Lt(o),l===null)o=null;else if(p=l.tag,p===13){if(o=Ft(l),o!==null)return o;o=null}else if(p===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;o=null}else l!==o&&(o=null);return Ba=o,null}function Xu(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xs()){case Rn:return 1;case zi:return 4;case Er:case es:return 16;case ts:return 536870912;default:return 16}default:return 16}}var ur=null,Bl=null,Kn=null;function pa(){if(Kn)return Kn;var o,l=Bl,p=l.length,x,A="value"in ur?ur.value:ur.textContent,O=A.length;for(o=0;o<p&&l[o]===A[o];o++);var G=p-o;for(x=1;x<=G&&l[p-x]===A[O-x];x++);return Kn=A.slice(o,1<x?1-x:void 0)}function Io(o){var l=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&l===13&&(o=13)):o=l,o===10&&(o=13),32<=o||o===13?o:0}function Mr(){return!0}function Va(){return!1}function Ii(o){function l(p,x,A,O,G){this._reactName=p,this._targetInst=A,this.type=x,this.nativeEvent=O,this.target=G,this.currentTarget=null;for(var te in o)o.hasOwnProperty(te)&&(p=o[te],this[te]=p?p(O):O[te]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?Mr:Va,this.isPropagationStopped=Va,this}return ne(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Mr)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Mr)},persist:function(){},isPersistent:Mr}),l}var Ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ma=Ii(Ts),Ms=ne({},Ts,{view:0,detail:0}),ga=Ii(Ms),Ki,Ui,Cr,Ro=ne({},Ms,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ar,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Cr&&(Cr&&o.type==="mousemove"?(Ki=o.screenX-Cr.screenX,Ui=o.screenY-Cr.screenY):Ui=Ki=0,Cr=o),Ki)},movementY:function(o){return"movementY"in o?o.movementY:Ui}}),Ha=Ii(Ro),ss=ne({},Ro,{dataTransfer:0}),Gs=Ii(ss),Do=ne({},Ms,{relatedTarget:0}),Ga=Ii(Do),Wa=ne({},Ts,{animationName:0,elapsedTime:0,pseudoElement:0}),ho=Ii(Wa),$u=ne({},Ts,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Vl=Ii($u),ja=ne({},Ts,{data:0}),Hl=Ii(ja),qa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lo(o){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(o):(o=Gl[o])?!!l[o]:!1}function Ar(){return Lo}var g=ne({},Ms,{key:function(o){if(o.key){var l=qa[o.key]||o.key;if(l!=="Unidentified")return l}return o.type==="keypress"?(o=Io(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?cr[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ar,charCode:function(o){return o.type==="keypress"?Io(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Io(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),L=Ii(g),U=ne({},Ro,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),j=Ii(U),fe=ne({},Ms,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ar}),xe=Ii(fe),We=ne({},Ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),fn=Ii(We),vi=ne({},Ro,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),un=Ii(vi),yi=[9,13,27,32],yn=u&&"CompositionEvent"in window,Zn=null;u&&"documentMode"in document&&(Zn=document.documentMode);var cn=u&&"TextEvent"in window&&!Zn,Ws=u&&(!yn||Zn&&8<Zn&&11>=Zn),hr=" ",ud=!1;function cd(o,l){switch(o){case"keyup":return yi.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Eh(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var _a=!1;function Mm(o,l){switch(o){case"compositionend":return Eh(l);case"keypress":return l.which!==32?null:(ud=!0,hr);case"textInput":return o=l.data,o===hr&&ud?null:o;default:return null}}function Yu(o,l){if(_a)return o==="compositionend"||!yn&&cd(o,l)?(o=pa(),Kn=Bl=ur=null,_a=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ws&&l.locale!=="ko"?null:l.data;default:return null}}var Wl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Th(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l==="input"?!!Wl[o.type]:l==="textarea"}function jl(o,l,p,x){an(x),l=Nh(l,"onChange"),0<l.length&&(p=new ma("onChange","change",null,p,x),o.push({event:p,listeners:l}))}var va=null,ql=null;function Cm(o){Ql(o,0)}function Oo(o){var l=di(o);if(De(l))return o}function Am(o,l){if(o==="change")return l}var Xl=!1;if(u){var Br;if(u){var Xa="oninput"in document;if(!Xa){var $a=document.createElement("div");$a.setAttribute("oninput","return;"),Xa=typeof $a.oninput=="function"}Br=Xa}else Br=!1;Xl=Br&&(!document.documentMode||9<document.documentMode)}function js(){va&&(va.detachEvent("onpropertychange",Mh),ql=va=null)}function Mh(o){if(o.propertyName==="value"&&Oo(ql)){var l=[];jl(l,ql,o,le(o)),Ci(Cm,l)}}function $l(o,l,p){o==="focusin"?(js(),va=l,ql=p,va.attachEvent("onpropertychange",Mh)):o==="focusout"&&js()}function bm(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Oo(ql)}function hd(o,l){if(o==="click")return Oo(l)}function si(o,l){if(o==="input"||o==="change")return Oo(l)}function Ch(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var os=typeof Object.is=="function"?Object.is:Ch;function Ya(o,l){if(os(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var p=Object.keys(o),x=Object.keys(l);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var A=p[x];if(!f.call(l,A)||!os(o[A],l[A]))return!1}return!0}function Qu(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function as(o,l){var p=Qu(o);o=0;for(var x;p;){if(p.nodeType===3){if(x=o+p.textContent.length,o<=l&&x>=l)return{node:p,offset:l-o};o=x}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Qu(p)}}function Qa(o,l){return o&&l?o===l?!0:o&&o.nodeType===3?!1:l&&l.nodeType===3?Qa(o,l.parentNode):"contains"in o?o.contains(l):o.compareDocumentPosition?!!(o.compareDocumentPosition(l)&16):!1:!1}function oi(){for(var o=window,l=Le();l instanceof o.HTMLIFrameElement;){try{var p=typeof l.contentWindow.location.href=="string"}catch{p=!1}if(p)o=l.contentWindow;else break;l=Le(o.document)}return l}function Bi(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l&&(l==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||l==="textarea"||o.contentEditable==="true")}function Vi(o){var l=oi(),p=o.focusedElem,x=o.selectionRange;if(l!==p&&p&&p.ownerDocument&&Qa(p.ownerDocument.documentElement,p)){if(x!==null&&Bi(p)){if(l=x.start,o=x.end,o===void 0&&(o=l),"selectionStart"in p)p.selectionStart=l,p.selectionEnd=Math.min(o,p.value.length);else if(o=(l=p.ownerDocument||document)&&l.defaultView||window,o.getSelection){o=o.getSelection();var A=p.textContent.length,O=Math.min(x.start,A);x=x.end===void 0?O:Math.min(x.end,A),!o.extend&&O>x&&(A=x,x=O,O=A),A=as(p,O);var G=as(p,x);A&&G&&(o.rangeCount!==1||o.anchorNode!==A.node||o.anchorOffset!==A.offset||o.focusNode!==G.node||o.focusOffset!==G.offset)&&(l=l.createRange(),l.setStart(A.node,A.offset),o.removeAllRanges(),O>x?(o.addRange(l),o.extend(G.node,G.offset)):(l.setEnd(G.node,G.offset),o.addRange(l)))}}for(l=[],o=p;o=o.parentNode;)o.nodeType===1&&l.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<l.length;p++)o=l[p],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var Ah=u&&"documentMode"in document&&11>=document.documentMode,fo=null,Ka=null,Ku=null,Hi=!1;function bh(o,l,p){var x=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Hi||fo==null||fo!==Le(x)||(x=fo,"selectionStart"in x&&Bi(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Ku&&Ya(Ku,x)||(Ku=x,x=Nh(Ka,"onSelect"),0<x.length&&(l=new ma("onSelect","select",null,l,p),o.push({event:l,listeners:x}),l.target=fo)))}function Yl(o,l){var p={};return p[o.toLowerCase()]=l.toLowerCase(),p["Webkit"+o]="webkit"+l,p["Moz"+o]="moz"+l,p}var ya={animationend:Yl("Animation","AnimationEnd"),animationiteration:Yl("Animation","AnimationIteration"),animationstart:Yl("Animation","AnimationStart"),transitionend:Yl("Transition","TransitionEnd")},qs={},Xs={};u&&(Xs=document.createElement("div").style,"AnimationEvent"in window||(delete ya.animationend.animation,delete ya.animationiteration.animation,delete ya.animationstart.animation),"TransitionEvent"in window||delete ya.transitionend.transition);function po(o){if(qs[o])return qs[o];if(!ya[o])return o;var l=ya[o],p;for(p in l)if(l.hasOwnProperty(p)&&p in Xs)return qs[o]=l[p];return o}var Zu=po("animationend"),Ju=po("animationiteration"),fd=po("animationstart"),dd=po("transitionend"),pd=new Map,md="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function No(o,l){pd.set(o,l),s(l,[o])}for(var Ph=0;Ph<md.length;Ph++){var ec=md[Ph],tc=ec.toLowerCase(),Pm=ec[0].toUpperCase()+ec.slice(1);No(tc,"on"+Pm)}No(Zu,"onAnimationEnd"),No(Ju,"onAnimationIteration"),No(fd,"onAnimationStart"),No("dblclick","onDoubleClick"),No("focusin","onFocus"),No("focusout","onBlur"),No(dd,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ih=new Set("cancel close invalid load scroll toggle".split(" ").concat(xa));function Rh(o,l,p){var x=o.type||"unknown-event";o.currentTarget=p,kt(x,l,void 0,o),o.currentTarget=null}function Ql(o,l){l=(l&4)!==0;for(var p=0;p<o.length;p++){var x=o[p],A=x.event;x=x.listeners;e:{var O=void 0;if(l)for(var G=x.length-1;0<=G;G--){var te=x[G],ie=te.instance,we=te.currentTarget;if(te=te.listener,ie!==O&&A.isPropagationStopped())break e;Rh(A,te,we),O=ie}else for(G=0;G<x.length;G++){if(te=x[G],ie=te.instance,we=te.currentTarget,te=te.listener,ie!==O&&A.isPropagationStopped())break e;Rh(A,te,we),O=ie}}}if(Ee)throw o=pe,Ee=!1,pe=null,o}function Vn(o,l){var p=l[el];p===void 0&&(p=l[el]=new Set);var x=o+"__bubble";p.has(x)||(Lh(l,o,2,!1),p.add(x))}function Dh(o,l,p){var x=0;l&&(x|=4),Lh(p,o,x,l)}var nc="_reactListening"+Math.random().toString(36).slice(2);function Kl(o){if(!o[nc]){o[nc]=!0,n.forEach(function(p){p!=="selectionchange"&&(Ih.has(p)||Dh(p,!1,o),Dh(p,!0,o))});var l=o.nodeType===9?o:o.ownerDocument;l===null||l[nc]||(l[nc]=!0,Dh("selectionchange",!1,l))}}function Lh(o,l,p,x){switch(Xu(l)){case 1:var A=zn;break;case 4:A=qu;break;default:A=Ul}p=A.bind(null,l,p,o),A=void 0,!ca||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(A=!0),x?A!==void 0?o.addEventListener(l,p,{capture:!0,passive:A}):o.addEventListener(l,p,!0):A!==void 0?o.addEventListener(l,p,{passive:A}):o.addEventListener(l,p,!1)}function Oh(o,l,p,x,A){var O=x;if((l&1)===0&&(l&2)===0&&x!==null)e:for(;;){if(x===null)return;var G=x.tag;if(G===3||G===4){var te=x.stateNode.containerInfo;if(te===A||te.nodeType===8&&te.parentNode===A)break;if(G===4)for(G=x.return;G!==null;){var ie=G.tag;if((ie===3||ie===4)&&(ie=G.stateNode.containerInfo,ie===A||ie.nodeType===8&&ie.parentNode===A))return;G=G.return}for(;te!==null;){if(G=wa(te),G===null)return;if(ie=G.tag,ie===5||ie===6){x=O=G;continue e}te=te.parentNode}}x=x.return}Ci(function(){var we=O,Ve=le(p),Ge=[];e:{var Be=pd.get(o);if(Be!==void 0){var lt=ma,yt=o;switch(o){case"keypress":if(Io(p)===0)break e;case"keydown":case"keyup":lt=L;break;case"focusin":yt="focus",lt=Ga;break;case"focusout":yt="blur",lt=Ga;break;case"beforeblur":case"afterblur":lt=Ga;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":lt=Ha;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":lt=Gs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":lt=xe;break;case Zu:case Ju:case fd:lt=ho;break;case dd:lt=fn;break;case"scroll":lt=ga;break;case"wheel":lt=un;break;case"copy":case"cut":case"paste":lt=Vl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":lt=j}var xt=(l&4)!==0,Di=!xt&&o==="scroll",me=xt?Be!==null?Be+"Capture":null:Be;xt=[];for(var ae=we,_e;ae!==null;){_e=ae;var Ke=_e.stateNode;if(_e.tag===5&&Ke!==null&&(_e=Ke,me!==null&&(Ke=vn(ae,me),Ke!=null&&xt.push(Zl(ae,Ke,_e)))),Di)break;ae=ae.return}0<xt.length&&(Be=new lt(Be,yt,null,p,Ve),Ge.push({event:Be,listeners:xt}))}}if((l&7)===0){e:{if(Be=o==="mouseover"||o==="pointerover",lt=o==="mouseout"||o==="pointerout",Be&&p!==Bn&&(yt=p.relatedTarget||p.fromElement)&&(wa(yt)||yt[ls]))break e;if((lt||Be)&&(Be=Ve.window===Ve?Ve:(Be=Ve.ownerDocument)?Be.defaultView||Be.parentWindow:window,lt?(yt=p.relatedTarget||p.toElement,lt=we,yt=yt?wa(yt):null,yt!==null&&(Di=Lt(yt),yt!==Di||yt.tag!==5&&yt.tag!==6)&&(yt=null)):(lt=null,yt=we),lt!==yt)){if(xt=Ha,Ke="onMouseLeave",me="onMouseEnter",ae="mouse",(o==="pointerout"||o==="pointerover")&&(xt=j,Ke="onPointerLeave",me="onPointerEnter",ae="pointer"),Di=lt==null?Be:di(lt),_e=yt==null?Be:di(yt),Be=new xt(Ke,ae+"leave",lt,p,Ve),Be.target=Di,Be.relatedTarget=_e,Ke=null,wa(Ve)===we&&(xt=new xt(me,ae+"enter",yt,p,Ve),xt.target=_e,xt.relatedTarget=Di,Ke=xt),Di=Ke,lt&&yt)t:{for(xt=lt,me=yt,ae=0,_e=xt;_e;_e=Za(_e))ae++;for(_e=0,Ke=me;Ke;Ke=Za(Ke))_e++;for(;0<ae-_e;)xt=Za(xt),ae--;for(;0<_e-ae;)me=Za(me),_e--;for(;ae--;){if(xt===me||me!==null&&xt===me.alternate)break t;xt=Za(xt),me=Za(me)}xt=null}else xt=null;lt!==null&&Im(Ge,Be,lt,xt,!1),yt!==null&&Di!==null&&Im(Ge,Di,yt,xt,!0)}}e:{if(Be=we?di(we):window,lt=Be.nodeName&&Be.nodeName.toLowerCase(),lt==="select"||lt==="input"&&Be.type==="file")var Ct=Am;else if(Th(Be))if(Xl)Ct=si;else{Ct=bm;var Ot=$l}else(lt=Be.nodeName)&&lt.toLowerCase()==="input"&&(Be.type==="checkbox"||Be.type==="radio")&&(Ct=hd);if(Ct&&(Ct=Ct(o,we))){jl(Ge,Ct,p,Ve);break e}Ot&&Ot(o,Be,we),o==="focusout"&&(Ot=Be._wrapperState)&&Ot.controlled&&Be.type==="number"&&Pt(Be,"number",Be.value)}switch(Ot=we?di(we):window,o){case"focusin":(Th(Ot)||Ot.contentEditable==="true")&&(fo=Ot,Ka=we,Ku=null);break;case"focusout":Ku=Ka=fo=null;break;case"mousedown":Hi=!0;break;case"contextmenu":case"mouseup":case"dragend":Hi=!1,bh(Ge,p,Ve);break;case"selectionchange":if(Ah)break;case"keydown":case"keyup":bh(Ge,p,Ve)}var Nt;if(yn)e:{switch(o){case"compositionstart":var Bt="onCompositionStart";break e;case"compositionend":Bt="onCompositionEnd";break e;case"compositionupdate":Bt="onCompositionUpdate";break e}Bt=void 0}else _a?cd(o,p)&&(Bt="onCompositionEnd"):o==="keydown"&&p.keyCode===229&&(Bt="onCompositionStart");Bt&&(Ws&&p.locale!=="ko"&&(_a||Bt!=="onCompositionStart"?Bt==="onCompositionEnd"&&_a&&(Nt=pa()):(ur=Ve,Bl="value"in ur?ur.value:ur.textContent,_a=!0)),Ot=Nh(we,Bt),0<Ot.length&&(Bt=new Hl(Bt,o,null,p,Ve),Ge.push({event:Bt,listeners:Ot}),Nt?Bt.data=Nt:(Nt=Eh(p),Nt!==null&&(Bt.data=Nt)))),(Nt=cn?Mm(o,p):Yu(o,p))&&(we=Nh(we,"onBeforeInput"),0<we.length&&(Ve=new Hl("onBeforeInput","beforeinput",null,p,Ve),Ge.push({event:Ve,listeners:we}),Ve.data=Nt))}Ql(Ge,l)})}function Zl(o,l,p){return{instance:o,listener:l,currentTarget:p}}function Nh(o,l){for(var p=l+"Capture",x=[];o!==null;){var A=o,O=A.stateNode;A.tag===5&&O!==null&&(A=O,O=vn(o,p),O!=null&&x.unshift(Zl(o,O,A)),O=vn(o,l),O!=null&&x.push(Zl(o,O,A))),o=o.return}return x}function Za(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function Im(o,l,p,x,A){for(var O=l._reactName,G=[];p!==null&&p!==x;){var te=p,ie=te.alternate,we=te.stateNode;if(ie!==null&&ie===x)break;te.tag===5&&we!==null&&(te=we,A?(ie=vn(p,O),ie!=null&&G.unshift(Zl(p,ie,te))):A||(ie=vn(p,O),ie!=null&&G.push(Zl(p,ie,te)))),p=p.return}G.length!==0&&o.push({event:l,listeners:G})}var E_=/\r\n?/g,Rm=/\u0000|\uFFFD/g;function gd(o){return(typeof o=="string"?o:""+o).replace(E_,`
`).replace(Rm,"")}function ic(o,l,p){if(l=gd(l),gd(o)!==l&&p)throw Error(t(425))}function rc(){}var Jl=null,_d=null;function vd(o,l){return o==="textarea"||o==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var yd=typeof setTimeout=="function"?setTimeout:void 0,xd=typeof clearTimeout=="function"?clearTimeout:void 0,kh=typeof Promise=="function"?Promise:void 0,T_=typeof queueMicrotask=="function"?queueMicrotask:typeof kh<"u"?function(o){return kh.resolve(null).then(o).catch(Dm)}:yd;function Dm(o){setTimeout(function(){throw o})}function zh(o,l){var p=l,x=0;do{var A=p.nextSibling;if(o.removeChild(p),A&&A.nodeType===8)if(p=A.data,p==="/$"){if(x===0){o.removeChild(A),Hs(l);return}x--}else p!=="$"&&p!=="$?"&&p!=="$!"||x++;p=A}while(p);Hs(l)}function ko(o){for(;o!=null;o=o.nextSibling){var l=o.nodeType;if(l===1||l===3)break;if(l===8){if(l=o.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return o}function wd(o){o=o.previousSibling;for(var l=0;o;){if(o.nodeType===8){var p=o.data;if(p==="$"||p==="$!"||p==="$?"){if(l===0)return o;l--}else p==="/$"&&l++}o=o.previousSibling}return null}var Ja=Math.random().toString(36).slice(2),Ri="__reactFiber$"+Ja,eu="__reactProps$"+Ja,ls="__reactContainer$"+Ja,el="__reactEvents$"+Ja,Fh="__reactListeners$"+Ja,Uh="__reactHandles$"+Ja;function wa(o){var l=o[Ri];if(l)return l;for(var p=o.parentNode;p;){if(l=p[ls]||p[Ri]){if(p=l.alternate,l.child!==null||p!==null&&p.child!==null)for(o=wd(o);o!==null;){if(p=o[Ri])return p;o=wd(o)}return l}o=p,p=o.parentNode}return null}function zo(o){return o=o[Ri]||o[ls],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function di(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function Bh(o){return o[eu]||null}var Sd=[],Gi=-1;function li(o){return{current:o}}function Hn(o){0>Gi||(o.current=Sd[Gi],Sd[Gi]=null,Gi--)}function Fn(o,l){Gi++,Sd[Gi]=o.current,o.current=l}var Fo={},Zi=li(Fo),br=li(!1),Uo=Fo;function tl(o,l){var p=o.type.contextTypes;if(!p)return Fo;var x=o.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===l)return x.__reactInternalMemoizedMaskedChildContext;var A={},O;for(O in p)A[O]=l[O];return x&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=l,o.__reactInternalMemoizedMaskedChildContext=A),A}function fr(o){return o=o.childContextTypes,o!=null}function sc(){Hn(br),Hn(Zi)}function Ed(o,l,p){if(Zi.current!==Fo)throw Error(t(168));Fn(Zi,l),Fn(br,p)}function oc(o,l,p){var x=o.stateNode;if(l=l.childContextTypes,typeof x.getChildContext!="function")return p;x=x.getChildContext();for(var A in x)if(!(A in l))throw Error(t(108,Oe(o)||"Unknown",A));return ne({},p,x)}function nl(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||Fo,Uo=Zi.current,Fn(Zi,o),Fn(br,br.current),!0}function Td(o,l,p){var x=o.stateNode;if(!x)throw Error(t(169));p?(o=oc(o,l,Uo),x.__reactInternalMemoizedMergedChildContext=o,Hn(br),Hn(Zi),Fn(Zi,o)):Hn(br),Fn(br,p)}var $s=null,ac=!1,Vh=!1;function lc(o){$s===null?$s=[o]:$s.push(o)}function Lm(o){ac=!0,lc(o)}function mo(){if(!Vh&&$s!==null){Vh=!0;var o=0,l=sn;try{var p=$s;for(sn=1;o<p.length;o++){var x=p[o];do x=x(!0);while(x!==null)}$s=null,ac=!1}catch(A){throw $s!==null&&($s=$s.slice(o+1)),_i(Rn,mo),A}finally{sn=l,Vh=!1}}return null}var il=[],Vr=0,Hh=null,Gh=0,Pr=[],Wi=0,rl=null,Ze=1,Cs="";function Bo(o,l){il[Vr++]=Gh,il[Vr++]=Hh,Hh=o,Gh=l}function Md(o,l,p){Pr[Wi++]=Ze,Pr[Wi++]=Cs,Pr[Wi++]=rl,rl=o;var x=Ze;o=Cs;var A=32-ln(x)-1;x&=~(1<<A),p+=1;var O=32-ln(l)+A;if(30<O){var G=A-A%5;O=(x&(1<<G)-1).toString(32),x>>=G,A-=G,Ze=1<<32-ln(l)+A|p<<A|x,Cs=O+o}else Ze=1<<O|p<<A|x,Cs=o}function Cd(o){o.return!==null&&(Bo(o,1),Md(o,1,0))}function Vo(o){for(;o===Hh;)Hh=il[--Vr],il[Vr]=null,Gh=il[--Vr],il[Vr]=null;for(;o===rl;)rl=Pr[--Wi],Pr[Wi]=null,Cs=Pr[--Wi],Pr[Wi]=null,Ze=Pr[--Wi],Pr[Wi]=null}var Ji=null,Ir=null,jn=!1,As=null;function Ad(o,l){var p=xo(5,null,null,0);p.elementType="DELETED",p.stateNode=l,p.return=o,l=o.deletions,l===null?(o.deletions=[p],o.flags|=16):l.push(p)}function bd(o,l){switch(o.tag){case 5:var p=o.type;return l=l.nodeType!==1||p.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(o.stateNode=l,Ji=o,Ir=ko(l.firstChild),!0):!1;case 6:return l=o.pendingProps===""||l.nodeType!==3?null:l,l!==null?(o.stateNode=l,Ji=o,Ir=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(p=rl!==null?{id:Ze,overflow:Cs}:null,o.memoizedState={dehydrated:l,treeContext:p,retryLane:1073741824},p=xo(18,null,null,0),p.stateNode=l,p.return=o,o.child=p,Ji=o,Ir=null,!0):!1;default:return!1}}function Wh(o){return(o.mode&1)!==0&&(o.flags&128)===0}function jh(o){if(jn){var l=Ir;if(l){var p=l;if(!bd(o,l)){if(Wh(o))throw Error(t(418));l=ko(p.nextSibling);var x=Ji;l&&bd(o,l)?Ad(x,p):(o.flags=o.flags&-4097|2,jn=!1,Ji=o)}}else{if(Wh(o))throw Error(t(418));o.flags=o.flags&-4097|2,jn=!1,Ji=o}}}function qh(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Ji=o}function tu(o){if(o!==Ji)return!1;if(!jn)return qh(o),jn=!0,!1;var l;if((l=o.tag!==3)&&!(l=o.tag!==5)&&(l=o.type,l=l!=="head"&&l!=="body"&&!vd(o.type,o.memoizedProps)),l&&(l=Ir)){if(Wh(o))throw Pd(),Error(t(418));for(;l;)Ad(o,l),l=ko(l.nextSibling)}if(qh(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,l=0;o;){if(o.nodeType===8){var p=o.data;if(p==="/$"){if(l===0){Ir=ko(o.nextSibling);break e}l--}else p!=="$"&&p!=="$!"&&p!=="$?"||l++}o=o.nextSibling}Ir=null}}else Ir=Ji?ko(o.stateNode.nextSibling):null;return!0}function Pd(){for(var o=Ir;o;)o=ko(o.nextSibling)}function Sa(){Ir=Ji=null,jn=!1}function nu(o){As===null?As=[o]:As.push(o)}var M_=R.ReactCurrentBatchConfig;function uc(o,l,p){if(o=p.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(t(309));var x=p.stateNode}if(!x)throw Error(t(147,o));var A=x,O=""+o;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===O?l.ref:(l=function(G){var te=A.refs;G===null?delete te[O]:te[O]=G},l._stringRef=O,l)}if(typeof o!="string")throw Error(t(284));if(!p._owner)throw Error(t(290,o))}return o}function cc(o,l){throw o=Object.prototype.toString.call(l),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o))}function Id(o){var l=o._init;return l(o._payload)}function Rd(o){function l(me,ae){if(o){var _e=me.deletions;_e===null?(me.deletions=[ae],me.flags|=16):_e.push(ae)}}function p(me,ae){if(!o)return null;for(;ae!==null;)l(me,ae),ae=ae.sibling;return null}function x(me,ae){for(me=new Map;ae!==null;)ae.key!==null?me.set(ae.key,ae):me.set(ae.index,ae),ae=ae.sibling;return me}function A(me,ae){return me=du(me,ae),me.index=0,me.sibling=null,me}function O(me,ae,_e){return me.index=_e,o?(_e=me.alternate,_e!==null?(_e=_e.index,_e<ae?(me.flags|=2,ae):_e):(me.flags|=2,ae)):(me.flags|=1048576,ae)}function G(me){return o&&me.alternate===null&&(me.flags|=2),me}function te(me,ae,_e,Ke){return ae===null||ae.tag!==6?(ae=W_(_e,me.mode,Ke),ae.return=me,ae):(ae=A(ae,_e),ae.return=me,ae)}function ie(me,ae,_e,Ke){var Ct=_e.type;return Ct===k?Ve(me,ae,_e.props.children,Ke,_e.key):ae!==null&&(ae.elementType===Ct||typeof Ct=="object"&&Ct!==null&&Ct.$$typeof===ye&&Id(Ct)===ae.type)?(Ke=A(ae,_e.props),Ke.ref=uc(me,ae,_e),Ke.return=me,Ke):(Ke=ng(_e.type,_e.key,_e.props,null,me.mode,Ke),Ke.ref=uc(me,ae,_e),Ke.return=me,Ke)}function we(me,ae,_e,Ke){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==_e.containerInfo||ae.stateNode.implementation!==_e.implementation?(ae=j_(_e,me.mode,Ke),ae.return=me,ae):(ae=A(ae,_e.children||[]),ae.return=me,ae)}function Ve(me,ae,_e,Ke,Ct){return ae===null||ae.tag!==7?(ae=Ac(_e,me.mode,Ke,Ct),ae.return=me,ae):(ae=A(ae,_e),ae.return=me,ae)}function Ge(me,ae,_e){if(typeof ae=="string"&&ae!==""||typeof ae=="number")return ae=W_(""+ae,me.mode,_e),ae.return=me,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case z:return _e=ng(ae.type,ae.key,ae.props,null,me.mode,_e),_e.ref=uc(me,null,ae),_e.return=me,_e;case B:return ae=j_(ae,me.mode,_e),ae.return=me,ae;case ye:var Ke=ae._init;return Ge(me,Ke(ae._payload),_e)}if(Yt(ae)||oe(ae))return ae=Ac(ae,me.mode,_e,null),ae.return=me,ae;cc(me,ae)}return null}function Be(me,ae,_e,Ke){var Ct=ae!==null?ae.key:null;if(typeof _e=="string"&&_e!==""||typeof _e=="number")return Ct!==null?null:te(me,ae,""+_e,Ke);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case z:return _e.key===Ct?ie(me,ae,_e,Ke):null;case B:return _e.key===Ct?we(me,ae,_e,Ke):null;case ye:return Ct=_e._init,Be(me,ae,Ct(_e._payload),Ke)}if(Yt(_e)||oe(_e))return Ct!==null?null:Ve(me,ae,_e,Ke,null);cc(me,_e)}return null}function lt(me,ae,_e,Ke,Ct){if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number")return me=me.get(_e)||null,te(ae,me,""+Ke,Ct);if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case z:return me=me.get(Ke.key===null?_e:Ke.key)||null,ie(ae,me,Ke,Ct);case B:return me=me.get(Ke.key===null?_e:Ke.key)||null,we(ae,me,Ke,Ct);case ye:var Ot=Ke._init;return lt(me,ae,_e,Ot(Ke._payload),Ct)}if(Yt(Ke)||oe(Ke))return me=me.get(_e)||null,Ve(ae,me,Ke,Ct,null);cc(ae,Ke)}return null}function yt(me,ae,_e,Ke){for(var Ct=null,Ot=null,Nt=ae,Bt=ae=0,gr=null;Nt!==null&&Bt<_e.length;Bt++){Nt.index>Bt?(gr=Nt,Nt=null):gr=Nt.sibling;var bn=Be(me,Nt,_e[Bt],Ke);if(bn===null){Nt===null&&(Nt=gr);break}o&&Nt&&bn.alternate===null&&l(me,Nt),ae=O(bn,ae,Bt),Ot===null?Ct=bn:Ot.sibling=bn,Ot=bn,Nt=gr}if(Bt===_e.length)return p(me,Nt),jn&&Bo(me,Bt),Ct;if(Nt===null){for(;Bt<_e.length;Bt++)Nt=Ge(me,_e[Bt],Ke),Nt!==null&&(ae=O(Nt,ae,Bt),Ot===null?Ct=Nt:Ot.sibling=Nt,Ot=Nt);return jn&&Bo(me,Bt),Ct}for(Nt=x(me,Nt);Bt<_e.length;Bt++)gr=lt(Nt,me,Bt,_e[Bt],Ke),gr!==null&&(o&&gr.alternate!==null&&Nt.delete(gr.key===null?Bt:gr.key),ae=O(gr,ae,Bt),Ot===null?Ct=gr:Ot.sibling=gr,Ot=gr);return o&&Nt.forEach(function(pu){return l(me,pu)}),jn&&Bo(me,Bt),Ct}function xt(me,ae,_e,Ke){var Ct=oe(_e);if(typeof Ct!="function")throw Error(t(150));if(_e=Ct.call(_e),_e==null)throw Error(t(151));for(var Ot=Ct=null,Nt=ae,Bt=ae=0,gr=null,bn=_e.next();Nt!==null&&!bn.done;Bt++,bn=_e.next()){Nt.index>Bt?(gr=Nt,Nt=null):gr=Nt.sibling;var pu=Be(me,Nt,bn.value,Ke);if(pu===null){Nt===null&&(Nt=gr);break}o&&Nt&&pu.alternate===null&&l(me,Nt),ae=O(pu,ae,Bt),Ot===null?Ct=pu:Ot.sibling=pu,Ot=pu,Nt=gr}if(bn.done)return p(me,Nt),jn&&Bo(me,Bt),Ct;if(Nt===null){for(;!bn.done;Bt++,bn=_e.next())bn=Ge(me,bn.value,Ke),bn!==null&&(ae=O(bn,ae,Bt),Ot===null?Ct=bn:Ot.sibling=bn,Ot=bn);return jn&&Bo(me,Bt),Ct}for(Nt=x(me,Nt);!bn.done;Bt++,bn=_e.next())bn=lt(Nt,me,Bt,bn.value,Ke),bn!==null&&(o&&bn.alternate!==null&&Nt.delete(bn.key===null?Bt:bn.key),ae=O(bn,ae,Bt),Ot===null?Ct=bn:Ot.sibling=bn,Ot=bn);return o&&Nt.forEach(function(Ib){return l(me,Ib)}),jn&&Bo(me,Bt),Ct}function Di(me,ae,_e,Ke){if(typeof _e=="object"&&_e!==null&&_e.type===k&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case z:e:{for(var Ct=_e.key,Ot=ae;Ot!==null;){if(Ot.key===Ct){if(Ct=_e.type,Ct===k){if(Ot.tag===7){p(me,Ot.sibling),ae=A(Ot,_e.props.children),ae.return=me,me=ae;break e}}else if(Ot.elementType===Ct||typeof Ct=="object"&&Ct!==null&&Ct.$$typeof===ye&&Id(Ct)===Ot.type){p(me,Ot.sibling),ae=A(Ot,_e.props),ae.ref=uc(me,Ot,_e),ae.return=me,me=ae;break e}p(me,Ot);break}else l(me,Ot);Ot=Ot.sibling}_e.type===k?(ae=Ac(_e.props.children,me.mode,Ke,_e.key),ae.return=me,me=ae):(Ke=ng(_e.type,_e.key,_e.props,null,me.mode,Ke),Ke.ref=uc(me,ae,_e),Ke.return=me,me=Ke)}return G(me);case B:e:{for(Ot=_e.key;ae!==null;){if(ae.key===Ot)if(ae.tag===4&&ae.stateNode.containerInfo===_e.containerInfo&&ae.stateNode.implementation===_e.implementation){p(me,ae.sibling),ae=A(ae,_e.children||[]),ae.return=me,me=ae;break e}else{p(me,ae);break}else l(me,ae);ae=ae.sibling}ae=j_(_e,me.mode,Ke),ae.return=me,me=ae}return G(me);case ye:return Ot=_e._init,Di(me,ae,Ot(_e._payload),Ke)}if(Yt(_e))return yt(me,ae,_e,Ke);if(oe(_e))return xt(me,ae,_e,Ke);cc(me,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"?(_e=""+_e,ae!==null&&ae.tag===6?(p(me,ae.sibling),ae=A(ae,_e),ae.return=me,me=ae):(p(me,ae),ae=W_(_e,me.mode,Ke),ae.return=me,me=ae),G(me)):p(me,ae)}return Di}var sl=Rd(!0),hc=Rd(!1),ol=li(null),al=null,Ho=null,iu=null;function ll(){iu=Ho=al=null}function fc(o){var l=ol.current;Hn(ol),o._currentValue=l}function dc(o,l,p){for(;o!==null;){var x=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,x!==null&&(x.childLanes|=l)):x!==null&&(x.childLanes&l)!==l&&(x.childLanes|=l),o===p)break;o=o.return}}function Ea(o,l){al=o,iu=Ho=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&l)!==0&&(Zt=!0),o.firstContext=null)}function us(o){var l=o._currentValue;if(iu!==o)if(o={context:o,memoizedValue:l,next:null},Ho===null){if(al===null)throw Error(t(308));Ho=o,al.dependencies={lanes:0,firstContext:o}}else Ho=Ho.next=o;return l}var Go=null;function Dd(o){Go===null?Go=[o]:Go.push(o)}function pc(o,l,p,x){var A=l.interleaved;return A===null?(p.next=p,Dd(l)):(p.next=A.next,A.next=p),l.interleaved=p,Ys(o,x)}function Ys(o,l){o.lanes|=l;var p=o.alternate;for(p!==null&&(p.lanes|=l),p=o,o=o.return;o!==null;)o.childLanes|=l,p=o.alternate,p!==null&&(p.childLanes|=l),p=o,o=o.return;return p.tag===3?p.stateNode:null}var Dn=!1;function $t(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pi(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Ln(o,l){return{eventTime:o,lane:l,tag:0,payload:null,callback:null,next:null}}function Jn(o,l,p){var x=o.updateQueue;if(x===null)return null;if(x=x.shared,(En&2)!==0){var A=x.pending;return A===null?l.next=l:(l.next=A.next,A.next=l),x.pending=l,Ys(o,p)}return A=x.interleaved,A===null?(l.next=l,Dd(x)):(l.next=A.next,A.next=l),x.interleaved=l,Ys(o,p)}function dr(o,l,p){if(l=l.updateQueue,l!==null&&(l=l.shared,(p&4194240)!==0)){var x=l.lanes;x&=o.pendingLanes,p|=x,l.lanes=p,Bs(o,p)}}function ul(o,l){var p=o.updateQueue,x=o.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var A=null,O=null;if(p=p.firstBaseUpdate,p!==null){do{var G={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};O===null?A=O=G:O=O.next=G,p=p.next}while(p!==null);O===null?A=O=l:O=O.next=l}else A=O=l;p={baseState:x.baseState,firstBaseUpdate:A,lastBaseUpdate:O,shared:x.shared,effects:x.effects},o.updateQueue=p;return}o=p.lastBaseUpdate,o===null?p.firstBaseUpdate=l:o.next=l,p.lastBaseUpdate=l}function ui(o,l,p,x){var A=o.updateQueue;Dn=!1;var O=A.firstBaseUpdate,G=A.lastBaseUpdate,te=A.shared.pending;if(te!==null){A.shared.pending=null;var ie=te,we=ie.next;ie.next=null,G===null?O=we:G.next=we,G=ie;var Ve=o.alternate;Ve!==null&&(Ve=Ve.updateQueue,te=Ve.lastBaseUpdate,te!==G&&(te===null?Ve.firstBaseUpdate=we:te.next=we,Ve.lastBaseUpdate=ie))}if(O!==null){var Ge=A.baseState;G=0,Ve=we=ie=null,te=O;do{var Be=te.lane,lt=te.eventTime;if((x&Be)===Be){Ve!==null&&(Ve=Ve.next={eventTime:lt,lane:0,tag:te.tag,payload:te.payload,callback:te.callback,next:null});e:{var yt=o,xt=te;switch(Be=l,lt=p,xt.tag){case 1:if(yt=xt.payload,typeof yt=="function"){Ge=yt.call(lt,Ge,Be);break e}Ge=yt;break e;case 3:yt.flags=yt.flags&-65537|128;case 0:if(yt=xt.payload,Be=typeof yt=="function"?yt.call(lt,Ge,Be):yt,Be==null)break e;Ge=ne({},Ge,Be);break e;case 2:Dn=!0}}te.callback!==null&&te.lane!==0&&(o.flags|=64,Be=A.effects,Be===null?A.effects=[te]:Be.push(te))}else lt={eventTime:lt,lane:Be,tag:te.tag,payload:te.payload,callback:te.callback,next:null},Ve===null?(we=Ve=lt,ie=Ge):Ve=Ve.next=lt,G|=Be;if(te=te.next,te===null){if(te=A.shared.pending,te===null)break;Be=te,te=Be.next,Be.next=null,A.lastBaseUpdate=Be,A.shared.pending=null}}while(!0);if(Ve===null&&(ie=Ge),A.baseState=ie,A.firstBaseUpdate=we,A.lastBaseUpdate=Ve,l=A.shared.interleaved,l!==null){A=l;do G|=A.lane,A=A.next;while(A!==l)}else O===null&&(A.shared.lanes=0);Ec|=G,o.lanes=G,o.memoizedState=Ge}}function ru(o,l,p){if(o=l.effects,l.effects=null,o!==null)for(l=0;l<o.length;l++){var x=o[l],A=x.callback;if(A!==null){if(x.callback=null,x=p,typeof A!="function")throw Error(t(191,A));A.call(x)}}}var go={},cs=li(go),cl=li(go),Wo=li(go);function xi(o){if(o===go)throw Error(t(174));return o}function mc(o,l){switch(Fn(Wo,l),Fn(cl,o),Fn(cs,go),o=l.nodeType,o){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:je(null,"");break;default:o=o===8?l.parentNode:l,l=o.namespaceURI||null,o=o.tagName,l=je(l,o)}Hn(cs),Fn(cs,l)}function Ta(){Hn(cs),Hn(cl),Hn(Wo)}function hl(o){xi(Wo.current);var l=xi(cs.current),p=je(l,o.type);l!==p&&(Fn(cl,o),Fn(cs,p))}function su(o){cl.current===o&&(Hn(cs),Hn(cl))}var qn=li(0);function Qs(o){for(var l=o;l!==null;){if(l.tag===13){var p=l.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ou=[];function _o(){for(var o=0;o<ou.length;o++)ou[o]._workInProgressVersionPrimary=null;ou.length=0}var fl=R.ReactCurrentDispatcher,dl=R.ReactCurrentBatchConfig,jo=0,Gn=null,ci=null,xn=null,Ks=!1,pr=!1,Ma=0,Hr=0;function er(){throw Error(t(321))}function gc(o,l){if(l===null)return!1;for(var p=0;p<l.length&&p<o.length;p++)if(!os(o[p],l[p]))return!1;return!0}function _c(o,l,p,x,A,O){if(jo=O,Gn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,fl.current=o===null||o.memoizedState===null?Bm:Vm,o=p(x,A),pr){O=0;do{if(pr=!1,Ma=0,25<=O)throw Error(t(301));O+=1,xn=ci=null,l.updateQueue=null,fl.current=Hm,o=p(x,A)}while(pr)}if(fl.current=Jh,l=ci!==null&&ci.next!==null,jo=0,xn=ci=Gn=null,Ks=!1,l)throw Error(t(300));return o}function Ld(){var o=Ma!==0;return Ma=0,o}function tr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?Gn.memoizedState=xn=o:xn=xn.next=o,xn}function hs(){if(ci===null){var o=Gn.alternate;o=o!==null?o.memoizedState:null}else o=ci.next;var l=xn===null?Gn.memoizedState:xn.next;if(l!==null)xn=l,ci=o;else{if(o===null)throw Error(t(310));ci=o,o={memoizedState:ci.memoizedState,baseState:ci.baseState,baseQueue:ci.baseQueue,queue:ci.queue,next:null},xn===null?Gn.memoizedState=xn=o:xn=xn.next=o}return xn}function au(o,l){return typeof l=="function"?l(o):l}function vc(o){var l=hs(),p=l.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=o;var x=ci,A=x.baseQueue,O=p.pending;if(O!==null){if(A!==null){var G=A.next;A.next=O.next,O.next=G}x.baseQueue=A=O,p.pending=null}if(A!==null){O=A.next,x=x.baseState;var te=G=null,ie=null,we=O;do{var Ve=we.lane;if((jo&Ve)===Ve)ie!==null&&(ie=ie.next={lane:0,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null}),x=we.hasEagerState?we.eagerState:o(x,we.action);else{var Ge={lane:Ve,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null};ie===null?(te=ie=Ge,G=x):ie=ie.next=Ge,Gn.lanes|=Ve,Ec|=Ve}we=we.next}while(we!==null&&we!==O);ie===null?G=x:ie.next=te,os(x,l.memoizedState)||(Zt=!0),l.memoizedState=x,l.baseState=G,l.baseQueue=ie,p.lastRenderedState=x}if(o=p.interleaved,o!==null){A=o;do O=A.lane,Gn.lanes|=O,Ec|=O,A=A.next;while(A!==o)}else A===null&&(p.lanes=0);return[l.memoizedState,p.dispatch]}function qo(o){var l=hs(),p=l.queue;if(p===null)throw Error(t(311));p.lastRenderedReducer=o;var x=p.dispatch,A=p.pending,O=l.memoizedState;if(A!==null){p.pending=null;var G=A=A.next;do O=o(O,G.action),G=G.next;while(G!==A);os(O,l.memoizedState)||(Zt=!0),l.memoizedState=O,l.baseQueue===null&&(l.baseState=O),p.lastRenderedState=O}return[O,x]}function Od(){}function Nd(o,l){var p=Gn,x=hs(),A=l(),O=!os(x.memoizedState,A);if(O&&(x.memoizedState=A,Zt=!0),x=x.queue,Fd(Om.bind(null,p,x,o),[o]),x.getSnapshot!==l||O||xn!==null&&xn.memoizedState.tag&1){if(p.flags|=2048,Zs(9,yc.bind(null,p,x,A,l),void 0,null),mr===null)throw Error(t(349));(jo&30)!==0||Xh(p,l,A)}return A}function Xh(o,l,p){o.flags|=16384,o={getSnapshot:l,value:p},l=Gn.updateQueue,l===null?(l={lastEffect:null,stores:null},Gn.updateQueue=l,l.stores=[o]):(p=l.stores,p===null?l.stores=[o]:p.push(o))}function yc(o,l,p,x){l.value=p,l.getSnapshot=x,Nm(l)&&kd(o)}function Om(o,l,p){return p(function(){Nm(l)&&kd(o)})}function Nm(o){var l=o.getSnapshot;o=o.value;try{var p=l();return!os(o,p)}catch{return!0}}function kd(o){var l=Ys(o,1);l!==null&&Ko(l,o,1,-1)}function zd(o){var l=tr();return typeof o=="function"&&(o=o()),l.memoizedState=l.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:au,lastRenderedState:o},l.queue=o,o=o.dispatch=pl.bind(null,Gn,o),[l.memoizedState,o]}function Zs(o,l,p,x){return o={tag:o,create:l,destroy:p,deps:x,next:null},l=Gn.updateQueue,l===null?(l={lastEffect:null,stores:null},Gn.updateQueue=l,l.lastEffect=o.next=o):(p=l.lastEffect,p===null?l.lastEffect=o.next=o:(x=p.next,p.next=o,o.next=x,l.lastEffect=o)),o}function km(){return hs().memoizedState}function vo(o,l,p,x){var A=tr();Gn.flags|=o,A.memoizedState=Zs(1|l,p,void 0,x===void 0?null:x)}function xc(o,l,p,x){var A=hs();x=x===void 0?null:x;var O=void 0;if(ci!==null){var G=ci.memoizedState;if(O=G.destroy,x!==null&&gc(x,G.deps)){A.memoizedState=Zs(l,p,O,x);return}}Gn.flags|=o,A.memoizedState=Zs(1|l,p,O,x)}function Rr(o,l){return vo(8390656,8,o,l)}function Fd(o,l){return xc(2048,8,o,l)}function Ud(o,l){return xc(4,2,o,l)}function zm(o,l){return xc(4,4,o,l)}function Fm(o,l){if(typeof l=="function")return o=o(),l(o),function(){l(null)};if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function Bd(o,l,p){return p=p!=null?p.concat([o]):null,xc(4,4,Fm.bind(null,l,o),p)}function $h(){}function Um(o,l){var p=hs();l=l===void 0?null:l;var x=p.memoizedState;return x!==null&&l!==null&&gc(l,x[1])?x[0]:(p.memoizedState=[o,l],o)}function fs(o,l){var p=hs();l=l===void 0?null:l;var x=p.memoizedState;return x!==null&&l!==null&&gc(l,x[1])?x[0]:(o=o(),p.memoizedState=[o,l],o)}function Yh(o,l,p){return(jo&21)===0?(o.baseState&&(o.baseState=!1,Zt=!0),o.memoizedState=p):(os(p,l)||(p=Qi(),Gn.lanes|=p,Ec|=p,o.baseState=!0),l)}function C_(o,l){var p=sn;sn=p!==0&&4>p?p:4,o(!0);var x=dl.transition;dl.transition={};try{o(!1),l()}finally{sn=p,dl.transition=x}}function Xo(){return hs().memoizedState}function Qh(o,l,p){var x=hu(o);if(p={lane:x,action:p,hasEagerState:!1,eagerState:null,next:null},wc(o))Kh(l,p);else if(p=pc(o,l,p,x),p!==null){var A=ps();Ko(p,o,x,A),Zh(p,l,x)}}function pl(o,l,p){var x=hu(o),A={lane:x,action:p,hasEagerState:!1,eagerState:null,next:null};if(wc(o))Kh(l,A);else{var O=o.alternate;if(o.lanes===0&&(O===null||O.lanes===0)&&(O=l.lastRenderedReducer,O!==null))try{var G=l.lastRenderedState,te=O(G,p);if(A.hasEagerState=!0,A.eagerState=te,os(te,G)){var ie=l.interleaved;ie===null?(A.next=A,Dd(l)):(A.next=ie.next,ie.next=A),l.interleaved=A;return}}catch{}finally{}p=pc(o,l,A,x),p!==null&&(A=ps(),Ko(p,o,x,A),Zh(p,l,x))}}function wc(o){var l=o.alternate;return o===Gn||l!==null&&l===Gn}function Kh(o,l){pr=Ks=!0;var p=o.pending;p===null?l.next=l:(l.next=p.next,p.next=l),o.pending=l}function Zh(o,l,p){if((p&4194240)!==0){var x=l.lanes;x&=o.pendingLanes,p|=x,l.lanes=p,Bs(o,p)}}var Jh={readContext:us,useCallback:er,useContext:er,useEffect:er,useImperativeHandle:er,useInsertionEffect:er,useLayoutEffect:er,useMemo:er,useReducer:er,useRef:er,useState:er,useDebugValue:er,useDeferredValue:er,useTransition:er,useMutableSource:er,useSyncExternalStore:er,useId:er,unstable_isNewReconciler:!1},Bm={readContext:us,useCallback:function(o,l){return tr().memoizedState=[o,l===void 0?null:l],o},useContext:us,useEffect:Rr,useImperativeHandle:function(o,l,p){return p=p!=null?p.concat([o]):null,vo(4194308,4,Fm.bind(null,l,o),p)},useLayoutEffect:function(o,l){return vo(4194308,4,o,l)},useInsertionEffect:function(o,l){return vo(4,2,o,l)},useMemo:function(o,l){var p=tr();return l=l===void 0?null:l,o=o(),p.memoizedState=[o,l],o},useReducer:function(o,l,p){var x=tr();return l=p!==void 0?p(l):l,x.memoizedState=x.baseState=l,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:l},x.queue=o,o=o.dispatch=Qh.bind(null,Gn,o),[x.memoizedState,o]},useRef:function(o){var l=tr();return o={current:o},l.memoizedState=o},useState:zd,useDebugValue:$h,useDeferredValue:function(o){return tr().memoizedState=o},useTransition:function(){var o=zd(!1),l=o[0];return o=C_.bind(null,o[1]),tr().memoizedState=o,[l,o]},useMutableSource:function(){},useSyncExternalStore:function(o,l,p){var x=Gn,A=tr();if(jn){if(p===void 0)throw Error(t(407));p=p()}else{if(p=l(),mr===null)throw Error(t(349));(jo&30)!==0||Xh(x,l,p)}A.memoizedState=p;var O={value:p,getSnapshot:l};return A.queue=O,Rr(Om.bind(null,x,O,o),[o]),x.flags|=2048,Zs(9,yc.bind(null,x,O,p,l),void 0,null),p},useId:function(){var o=tr(),l=mr.identifierPrefix;if(jn){var p=Cs,x=Ze;p=(x&~(1<<32-ln(x)-1)).toString(32)+p,l=":"+l+"R"+p,p=Ma++,0<p&&(l+="H"+p.toString(32)),l+=":"}else p=Hr++,l=":"+l+"r"+p.toString(32)+":";return o.memoizedState=l},unstable_isNewReconciler:!1},Vm={readContext:us,useCallback:Um,useContext:us,useEffect:Fd,useImperativeHandle:Bd,useInsertionEffect:Ud,useLayoutEffect:zm,useMemo:fs,useReducer:vc,useRef:km,useState:function(){return vc(au)},useDebugValue:$h,useDeferredValue:function(o){var l=hs();return Yh(l,ci.memoizedState,o)},useTransition:function(){var o=vc(au)[0],l=hs().memoizedState;return[o,l]},useMutableSource:Od,useSyncExternalStore:Nd,useId:Xo,unstable_isNewReconciler:!1},Hm={readContext:us,useCallback:Um,useContext:us,useEffect:Fd,useImperativeHandle:Bd,useInsertionEffect:Ud,useLayoutEffect:zm,useMemo:fs,useReducer:qo,useRef:km,useState:function(){return qo(au)},useDebugValue:$h,useDeferredValue:function(o){var l=hs();return ci===null?l.memoizedState=o:Yh(l,ci.memoizedState,o)},useTransition:function(){var o=qo(au)[0],l=hs().memoizedState;return[o,l]},useMutableSource:Od,useSyncExternalStore:Nd,useId:Xo,unstable_isNewReconciler:!1};function bs(o,l){if(o&&o.defaultProps){l=ne({},l),o=o.defaultProps;for(var p in o)l[p]===void 0&&(l[p]=o[p]);return l}return l}function Sc(o,l,p,x){l=o.memoizedState,p=p(x,l),p=p==null?l:ne({},l,p),o.memoizedState=p,o.lanes===0&&(o.updateQueue.baseState=p)}var ef={isMounted:function(o){return(o=o._reactInternals)?Lt(o)===o:!1},enqueueSetState:function(o,l,p){o=o._reactInternals;var x=ps(),A=hu(o),O=Ln(x,A);O.payload=l,p!=null&&(O.callback=p),l=Jn(o,O,A),l!==null&&(Ko(l,o,A,x),dr(l,o,A))},enqueueReplaceState:function(o,l,p){o=o._reactInternals;var x=ps(),A=hu(o),O=Ln(x,A);O.tag=1,O.payload=l,p!=null&&(O.callback=p),l=Jn(o,O,A),l!==null&&(Ko(l,o,A,x),dr(l,o,A))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var p=ps(),x=hu(o),A=Ln(p,x);A.tag=2,l!=null&&(A.callback=l),l=Jn(o,A,x),l!==null&&(Ko(l,o,x,p),dr(l,o,x))}};function Gm(o,l,p,x,A,O,G){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(x,O,G):l.prototype&&l.prototype.isPureReactComponent?!Ya(p,x)||!Ya(A,O):!0}function c(o,l,p){var x=!1,A=Fo,O=l.contextType;return typeof O=="object"&&O!==null?O=us(O):(A=fr(l)?Uo:Zi.current,x=l.contextTypes,O=(x=x!=null)?tl(o,A):Fo),l=new l(p,O),o.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=ef,o.stateNode=l,l._reactInternals=o,x&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=A,o.__reactInternalMemoizedMaskedChildContext=O),l}function h(o,l,p,x){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(p,x),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(p,x),l.state!==o&&ef.enqueueReplaceState(l,l.state,null)}function v(o,l,p,x){var A=o.stateNode;A.props=p,A.state=o.memoizedState,A.refs={},$t(o);var O=l.contextType;typeof O=="object"&&O!==null?A.context=us(O):(O=fr(l)?Uo:Zi.current,A.context=tl(o,O)),A.state=o.memoizedState,O=l.getDerivedStateFromProps,typeof O=="function"&&(Sc(o,l,O,p),A.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(l=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),l!==A.state&&ef.enqueueReplaceState(A,A.state,null),ui(o,p,A,x),A.state=o.memoizedState),typeof A.componentDidMount=="function"&&(o.flags|=4194308)}function S(o,l){try{var p="",x=l;do p+=se(x),x=x.return;while(x);var A=p}catch(O){A=`
Error generating stack: `+O.message+`
`+O.stack}return{value:o,source:l,stack:A,digest:null}}function D(o,l,p){return{value:o,source:null,stack:p??null,digest:l??null}}function F(o,l){try{console.error(l.value)}catch(p){setTimeout(function(){throw p})}}var J=typeof WeakMap=="function"?WeakMap:Map;function ue(o,l,p){p=Ln(-1,p),p.tag=3,p.payload={element:null};var x=l.value;return p.callback=function(){Qm||(Qm=!0,k_=x),F(o,l)},p}function Me(o,l,p){p=Ln(-1,p),p.tag=3;var x=o.type.getDerivedStateFromError;if(typeof x=="function"){var A=l.value;p.payload=function(){return x(A)},p.callback=function(){F(o,l)}}var O=o.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(p.callback=function(){F(o,l),typeof x!="function"&&(uu===null?uu=new Set([this]):uu.add(this));var G=l.stack;this.componentDidCatch(l.value,{componentStack:G!==null?G:""})}),p}function Ye(o,l,p){var x=o.pingCache;if(x===null){x=o.pingCache=new J;var A=new Set;x.set(l,A)}else A=x.get(l),A===void 0&&(A=new Set,x.set(l,A));A.has(p)||(A.add(p),o=yb.bind(null,o,l,p),l.then(o,o))}function ft(o){do{var l;if((l=o.tag===13)&&(l=o.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return o;o=o.return}while(o!==null);return null}function Gt(o,l,p,x,A){return(o.mode&1)===0?(o===l?o.flags|=65536:(o.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(l=Ln(-1,1),l.tag=2,Jn(p,l,1))),p.lanes|=1),o):(o.flags|=65536,o.lanes=A,o)}var Dt=R.ReactCurrentOwner,Zt=!1;function ot(o,l,p,x){l.child=o===null?hc(l,null,p,x):sl(l,o.child,p,x)}function nr(o,l,p,x,A){p=p.render;var O=l.ref;return Ea(l,A),x=_c(o,l,p,x,O,A),p=Ld(),o!==null&&!Zt?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~A,ml(o,l,A)):(jn&&p&&Cd(l),l.flags|=1,ot(o,l,x,A),l.child)}function ds(o,l,p,x,A){if(o===null){var O=p.type;return typeof O=="function"&&!G_(O)&&O.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(l.tag=15,l.type=O,ve(o,l,O,x,A)):(o=ng(p.type,null,x,l,l.mode,A),o.ref=l.ref,o.return=l,l.child=o)}if(O=o.child,(o.lanes&A)===0){var G=O.memoizedProps;if(p=p.compare,p=p!==null?p:Ya,p(G,x)&&o.ref===l.ref)return ml(o,l,A)}return l.flags|=1,o=du(O,x),o.ref=l.ref,o.return=l,l.child=o}function ve(o,l,p,x,A){if(o!==null){var O=o.memoizedProps;if(Ya(O,x)&&o.ref===l.ref)if(Zt=!1,l.pendingProps=x=O,(o.lanes&A)!==0)(o.flags&131072)!==0&&(Zt=!0);else return l.lanes=o.lanes,ml(o,l,A)}return it(o,l,p,x,A)}function ce(o,l,p){var x=l.pendingProps,A=x.children,O=o!==null?o.memoizedState:null;if(x.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fn(nf,Js),Js|=p;else{if((p&1073741824)===0)return o=O!==null?O.baseLanes|p:p,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:o,cachePool:null,transitions:null},l.updateQueue=null,Fn(nf,Js),Js|=o,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=O!==null?O.baseLanes:p,Fn(nf,Js),Js|=x}else O!==null?(x=O.baseLanes|p,l.memoizedState=null):x=p,Fn(nf,Js),Js|=x;return ot(o,l,A,p),l.child}function Te(o,l){var p=l.ref;(o===null&&p!==null||o!==null&&o.ref!==p)&&(l.flags|=512,l.flags|=2097152)}function it(o,l,p,x,A){var O=fr(p)?Uo:Zi.current;return O=tl(l,O),Ea(l,A),p=_c(o,l,p,x,O,A),x=Ld(),o!==null&&!Zt?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~A,ml(o,l,A)):(jn&&x&&Cd(l),l.flags|=1,ot(o,l,p,A),l.child)}function wt(o,l,p,x,A){if(fr(p)){var O=!0;nl(l)}else O=!1;if(Ea(l,A),l.stateNode===null)jm(o,l),c(l,p,x),v(l,p,x,A),x=!0;else if(o===null){var G=l.stateNode,te=l.memoizedProps;G.props=te;var ie=G.context,we=p.contextType;typeof we=="object"&&we!==null?we=us(we):(we=fr(p)?Uo:Zi.current,we=tl(l,we));var Ve=p.getDerivedStateFromProps,Ge=typeof Ve=="function"||typeof G.getSnapshotBeforeUpdate=="function";Ge||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(te!==x||ie!==we)&&h(l,G,x,we),Dn=!1;var Be=l.memoizedState;G.state=Be,ui(l,x,G,A),ie=l.memoizedState,te!==x||Be!==ie||br.current||Dn?(typeof Ve=="function"&&(Sc(l,p,Ve,x),ie=l.memoizedState),(te=Dn||Gm(l,p,te,x,Be,ie,we))?(Ge||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(l.flags|=4194308)):(typeof G.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=x,l.memoizedState=ie),G.props=x,G.state=ie,G.context=we,x=te):(typeof G.componentDidMount=="function"&&(l.flags|=4194308),x=!1)}else{G=l.stateNode,pi(o,l),te=l.memoizedProps,we=l.type===l.elementType?te:bs(l.type,te),G.props=we,Ge=l.pendingProps,Be=G.context,ie=p.contextType,typeof ie=="object"&&ie!==null?ie=us(ie):(ie=fr(p)?Uo:Zi.current,ie=tl(l,ie));var lt=p.getDerivedStateFromProps;(Ve=typeof lt=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(te!==Ge||Be!==ie)&&h(l,G,x,ie),Dn=!1,Be=l.memoizedState,G.state=Be,ui(l,x,G,A);var yt=l.memoizedState;te!==Ge||Be!==yt||br.current||Dn?(typeof lt=="function"&&(Sc(l,p,lt,x),yt=l.memoizedState),(we=Dn||Gm(l,p,we,x,Be,yt,ie)||!1)?(Ve||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(x,yt,ie),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(x,yt,ie)),typeof G.componentDidUpdate=="function"&&(l.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof G.componentDidUpdate!="function"||te===o.memoizedProps&&Be===o.memoizedState||(l.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||te===o.memoizedProps&&Be===o.memoizedState||(l.flags|=1024),l.memoizedProps=x,l.memoizedState=yt),G.props=x,G.state=yt,G.context=ie,x=we):(typeof G.componentDidUpdate!="function"||te===o.memoizedProps&&Be===o.memoizedState||(l.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||te===o.memoizedProps&&Be===o.memoizedState||(l.flags|=1024),x=!1)}return qt(o,l,p,x,O,A)}function qt(o,l,p,x,A,O){Te(o,l);var G=(l.flags&128)!==0;if(!x&&!G)return A&&Td(l,p,!1),ml(o,l,O);x=l.stateNode,Dt.current=l;var te=G&&typeof p.getDerivedStateFromError!="function"?null:x.render();return l.flags|=1,o!==null&&G?(l.child=sl(l,o.child,null,O),l.child=sl(l,null,te,O)):ot(o,l,te,O),l.memoizedState=x.state,A&&Td(l,p,!0),l.child}function Wt(o){var l=o.stateNode;l.pendingContext?Ed(o,l.pendingContext,l.pendingContext!==l.context):l.context&&Ed(o,l.context,!1),mc(o,l.containerInfo)}function gn(o,l,p,x,A){return Sa(),nu(A),l.flags|=256,ot(o,l,p,x),l.child}var wi={dehydrated:null,treeContext:null,retryLane:0};function pn(o){return{baseLanes:o,cachePool:null,transitions:null}}function $o(o,l,p){var x=l.pendingProps,A=qn.current,O=!1,G=(l.flags&128)!==0,te;if((te=G)||(te=o!==null&&o.memoizedState===null?!1:(A&2)!==0),te?(O=!0,l.flags&=-129):(o===null||o.memoizedState!==null)&&(A|=1),Fn(qn,A&1),o===null)return jh(l),o=l.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((l.mode&1)===0?l.lanes=1:o.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(G=x.children,o=x.fallback,O?(x=l.mode,O=l.child,G={mode:"hidden",children:G},(x&1)===0&&O!==null?(O.childLanes=0,O.pendingProps=G):O=ig(G,x,0,null),o=Ac(o,x,p,null),O.return=l,o.return=l,O.sibling=o,l.child=O,l.child.memoizedState=pn(p),l.memoizedState=wi,o):Vd(l,G));if(A=o.memoizedState,A!==null&&(te=A.dehydrated,te!==null))return ab(o,l,G,x,te,A,p);if(O){O=x.fallback,G=l.mode,A=o.child,te=A.sibling;var ie={mode:"hidden",children:x.children};return(G&1)===0&&l.child!==A?(x=l.child,x.childLanes=0,x.pendingProps=ie,l.deletions=null):(x=du(A,ie),x.subtreeFlags=A.subtreeFlags&14680064),te!==null?O=du(te,O):(O=Ac(O,G,p,null),O.flags|=2),O.return=l,x.return=l,x.sibling=O,l.child=x,x=O,O=l.child,G=o.child.memoizedState,G=G===null?pn(p):{baseLanes:G.baseLanes|p,cachePool:null,transitions:G.transitions},O.memoizedState=G,O.childLanes=o.childLanes&~p,l.memoizedState=wi,x}return O=o.child,o=O.sibling,x=du(O,{mode:"visible",children:x.children}),(l.mode&1)===0&&(x.lanes=p),x.return=l,x.sibling=null,o!==null&&(p=l.deletions,p===null?(l.deletions=[o],l.flags|=16):p.push(o)),l.child=x,l.memoizedState=null,x}function Vd(o,l){return l=ig({mode:"visible",children:l},o.mode,0,null),l.return=o,o.child=l}function Wm(o,l,p,x){return x!==null&&nu(x),sl(l,o.child,null,p),o=Vd(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function ab(o,l,p,x,A,O,G){if(p)return l.flags&256?(l.flags&=-257,x=D(Error(t(422))),Wm(o,l,G,x)):l.memoizedState!==null?(l.child=o.child,l.flags|=128,null):(O=x.fallback,A=l.mode,x=ig({mode:"visible",children:x.children},A,0,null),O=Ac(O,A,G,null),O.flags|=2,x.return=l,O.return=l,x.sibling=O,l.child=x,(l.mode&1)!==0&&sl(l,o.child,null,G),l.child.memoizedState=pn(G),l.memoizedState=wi,O);if((l.mode&1)===0)return Wm(o,l,G,null);if(A.data==="$!"){if(x=A.nextSibling&&A.nextSibling.dataset,x)var te=x.dgst;return x=te,O=Error(t(419)),x=D(O,x,void 0),Wm(o,l,G,x)}if(te=(G&o.childLanes)!==0,Zt||te){if(x=mr,x!==null){switch(G&-G){case 4:A=2;break;case 16:A=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:A=32;break;case 536870912:A=268435456;break;default:A=0}A=(A&(x.suspendedLanes|G))!==0?0:A,A!==0&&A!==O.retryLane&&(O.retryLane=A,Ys(o,A),Ko(x,o,A,-1))}return H_(),x=D(Error(t(421))),Wm(o,l,G,x)}return A.data==="$?"?(l.flags|=128,l.child=o.child,l=xb.bind(null,o),A._reactRetry=l,null):(o=O.treeContext,Ir=ko(A.nextSibling),Ji=l,jn=!0,As=null,o!==null&&(Pr[Wi++]=Ze,Pr[Wi++]=Cs,Pr[Wi++]=rl,Ze=o.id,Cs=o.overflow,rl=l),l=Vd(l,x.children),l.flags|=4096,l)}function B1(o,l,p){o.lanes|=l;var x=o.alternate;x!==null&&(x.lanes|=l),dc(o.return,l,p)}function A_(o,l,p,x,A){var O=o.memoizedState;O===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:A}:(O.isBackwards=l,O.rendering=null,O.renderingStartTime=0,O.last=x,O.tail=p,O.tailMode=A)}function V1(o,l,p){var x=l.pendingProps,A=x.revealOrder,O=x.tail;if(ot(o,l,x.children,p),x=qn.current,(x&2)!==0)x=x&1|2,l.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&B1(o,p,l);else if(o.tag===19)B1(o,p,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break e;for(;o.sibling===null;){if(o.return===null||o.return===l)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}x&=1}if(Fn(qn,x),(l.mode&1)===0)l.memoizedState=null;else switch(A){case"forwards":for(p=l.child,A=null;p!==null;)o=p.alternate,o!==null&&Qs(o)===null&&(A=p),p=p.sibling;p=A,p===null?(A=l.child,l.child=null):(A=p.sibling,p.sibling=null),A_(l,!1,A,p,O);break;case"backwards":for(p=null,A=l.child,l.child=null;A!==null;){if(o=A.alternate,o!==null&&Qs(o)===null){l.child=A;break}o=A.sibling,A.sibling=p,p=A,A=o}A_(l,!0,p,null,O);break;case"together":A_(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function jm(o,l){(l.mode&1)===0&&o!==null&&(o.alternate=null,l.alternate=null,l.flags|=2)}function ml(o,l,p){if(o!==null&&(l.dependencies=o.dependencies),Ec|=l.lanes,(p&l.childLanes)===0)return null;if(o!==null&&l.child!==o.child)throw Error(t(153));if(l.child!==null){for(o=l.child,p=du(o,o.pendingProps),l.child=p,p.return=l;o.sibling!==null;)o=o.sibling,p=p.sibling=du(o,o.pendingProps),p.return=l;p.sibling=null}return l.child}function lb(o,l,p){switch(l.tag){case 3:Wt(l),Sa();break;case 5:hl(l);break;case 1:fr(l.type)&&nl(l);break;case 4:mc(l,l.stateNode.containerInfo);break;case 10:var x=l.type._context,A=l.memoizedProps.value;Fn(ol,x._currentValue),x._currentValue=A;break;case 13:if(x=l.memoizedState,x!==null)return x.dehydrated!==null?(Fn(qn,qn.current&1),l.flags|=128,null):(p&l.child.childLanes)!==0?$o(o,l,p):(Fn(qn,qn.current&1),o=ml(o,l,p),o!==null?o.sibling:null);Fn(qn,qn.current&1);break;case 19:if(x=(p&l.childLanes)!==0,(o.flags&128)!==0){if(x)return V1(o,l,p);l.flags|=128}if(A=l.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),Fn(qn,qn.current),x)break;return null;case 22:case 23:return l.lanes=0,ce(o,l,p)}return ml(o,l,p)}var H1,b_,G1,W1;H1=function(o,l){for(var p=l.child;p!==null;){if(p.tag===5||p.tag===6)o.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===l)break;for(;p.sibling===null;){if(p.return===null||p.return===l)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},b_=function(){},G1=function(o,l,p,x){var A=o.memoizedProps;if(A!==x){o=l.stateNode,xi(cs.current);var O=null;switch(p){case"input":A=Qe(o,A),x=Qe(o,x),O=[];break;case"select":A=ne({},A,{value:void 0}),x=ne({},x,{value:void 0}),O=[];break;case"textarea":A=ee(o,A),x=ee(o,x),O=[];break;default:typeof A.onClick!="function"&&typeof x.onClick=="function"&&(o.onclick=rc)}rn(p,x);var G;p=null;for(we in A)if(!x.hasOwnProperty(we)&&A.hasOwnProperty(we)&&A[we]!=null)if(we==="style"){var te=A[we];for(G in te)te.hasOwnProperty(G)&&(p||(p={}),p[G]="")}else we!=="dangerouslySetInnerHTML"&&we!=="children"&&we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&we!=="autoFocus"&&(i.hasOwnProperty(we)?O||(O=[]):(O=O||[]).push(we,null));for(we in x){var ie=x[we];if(te=A!=null?A[we]:void 0,x.hasOwnProperty(we)&&ie!==te&&(ie!=null||te!=null))if(we==="style")if(te){for(G in te)!te.hasOwnProperty(G)||ie&&ie.hasOwnProperty(G)||(p||(p={}),p[G]="");for(G in ie)ie.hasOwnProperty(G)&&te[G]!==ie[G]&&(p||(p={}),p[G]=ie[G])}else p||(O||(O=[]),O.push(we,p)),p=ie;else we==="dangerouslySetInnerHTML"?(ie=ie?ie.__html:void 0,te=te?te.__html:void 0,ie!=null&&te!==ie&&(O=O||[]).push(we,ie)):we==="children"?typeof ie!="string"&&typeof ie!="number"||(O=O||[]).push(we,""+ie):we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&(i.hasOwnProperty(we)?(ie!=null&&we==="onScroll"&&Vn("scroll",o),O||te===ie||(O=[])):(O=O||[]).push(we,ie))}p&&(O=O||[]).push("style",p);var we=O;(l.updateQueue=we)&&(l.flags|=4)}},W1=function(o,l,p,x){p!==x&&(l.flags|=4)};function Hd(o,l){if(!jn)switch(o.tailMode){case"hidden":l=o.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?o.tail=null:p.sibling=null;break;case"collapsed":p=o.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:x.sibling=null}}function Gr(o){var l=o.alternate!==null&&o.alternate.child===o.child,p=0,x=0;if(l)for(var A=o.child;A!==null;)p|=A.lanes|A.childLanes,x|=A.subtreeFlags&14680064,x|=A.flags&14680064,A.return=o,A=A.sibling;else for(A=o.child;A!==null;)p|=A.lanes|A.childLanes,x|=A.subtreeFlags,x|=A.flags,A.return=o,A=A.sibling;return o.subtreeFlags|=x,o.childLanes=p,l}function ub(o,l,p){var x=l.pendingProps;switch(Vo(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gr(l),null;case 1:return fr(l.type)&&sc(),Gr(l),null;case 3:return x=l.stateNode,Ta(),Hn(br),Hn(Zi),_o(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(o===null||o.child===null)&&(tu(l)?l.flags|=4:o===null||o.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,As!==null&&(U_(As),As=null))),b_(o,l),Gr(l),null;case 5:su(l);var A=xi(Wo.current);if(p=l.type,o!==null&&l.stateNode!=null)G1(o,l,p,x,A),o.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!x){if(l.stateNode===null)throw Error(t(166));return Gr(l),null}if(o=xi(cs.current),tu(l)){x=l.stateNode,p=l.type;var O=l.memoizedProps;switch(x[Ri]=l,x[eu]=O,o=(l.mode&1)!==0,p){case"dialog":Vn("cancel",x),Vn("close",x);break;case"iframe":case"object":case"embed":Vn("load",x);break;case"video":case"audio":for(A=0;A<xa.length;A++)Vn(xa[A],x);break;case"source":Vn("error",x);break;case"img":case"image":case"link":Vn("error",x),Vn("load",x);break;case"details":Vn("toggle",x);break;case"input":gt(x,O),Vn("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!O.multiple},Vn("invalid",x);break;case"textarea":X(x,O),Vn("invalid",x)}rn(p,O),A=null;for(var G in O)if(O.hasOwnProperty(G)){var te=O[G];G==="children"?typeof te=="string"?x.textContent!==te&&(O.suppressHydrationWarning!==!0&&ic(x.textContent,te,o),A=["children",te]):typeof te=="number"&&x.textContent!==""+te&&(O.suppressHydrationWarning!==!0&&ic(x.textContent,te,o),A=["children",""+te]):i.hasOwnProperty(G)&&te!=null&&G==="onScroll"&&Vn("scroll",x)}switch(p){case"input":ut(x),At(x,O,!0);break;case"textarea":ut(x),$e(x);break;case"select":case"option":break;default:typeof O.onClick=="function"&&(x.onclick=rc)}x=A,l.updateQueue=x,x!==null&&(l.flags|=4)}else{G=A.nodeType===9?A:A.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=Ue(p)),o==="http://www.w3.org/1999/xhtml"?p==="script"?(o=G.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof x.is=="string"?o=G.createElement(p,{is:x.is}):(o=G.createElement(p),p==="select"&&(G=o,x.multiple?G.multiple=!0:x.size&&(G.size=x.size))):o=G.createElementNS(o,p),o[Ri]=l,o[eu]=x,H1(o,l,!1,!1),l.stateNode=o;e:{switch(G=Cn(p,x),p){case"dialog":Vn("cancel",o),Vn("close",o),A=x;break;case"iframe":case"object":case"embed":Vn("load",o),A=x;break;case"video":case"audio":for(A=0;A<xa.length;A++)Vn(xa[A],o);A=x;break;case"source":Vn("error",o),A=x;break;case"img":case"image":case"link":Vn("error",o),Vn("load",o),A=x;break;case"details":Vn("toggle",o),A=x;break;case"input":gt(o,x),A=Qe(o,x),Vn("invalid",o);break;case"option":A=x;break;case"select":o._wrapperState={wasMultiple:!!x.multiple},A=ne({},x,{value:void 0}),Vn("invalid",o);break;case"textarea":X(o,x),A=ee(o,x),Vn("invalid",o);break;default:A=x}rn(p,A),te=A;for(O in te)if(te.hasOwnProperty(O)){var ie=te[O];O==="style"?bt(o,ie):O==="dangerouslySetInnerHTML"?(ie=ie?ie.__html:void 0,ie!=null&&st(o,ie)):O==="children"?typeof ie=="string"?(p!=="textarea"||ie!=="")&&Re(o,ie):typeof ie=="number"&&Re(o,""+ie):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(i.hasOwnProperty(O)?ie!=null&&O==="onScroll"&&Vn("scroll",o):ie!=null&&b(o,O,ie,G))}switch(p){case"input":ut(o),At(o,x,!1);break;case"textarea":ut(o),$e(o);break;case"option":x.value!=null&&o.setAttribute("value",""+He(x.value));break;case"select":o.multiple=!!x.multiple,O=x.value,O!=null?tn(o,!!x.multiple,O,!1):x.defaultValue!=null&&tn(o,!!x.multiple,x.defaultValue,!0);break;default:typeof A.onClick=="function"&&(o.onclick=rc)}switch(p){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Gr(l),null;case 6:if(o&&l.stateNode!=null)W1(o,l,o.memoizedProps,x);else{if(typeof x!="string"&&l.stateNode===null)throw Error(t(166));if(p=xi(Wo.current),xi(cs.current),tu(l)){if(x=l.stateNode,p=l.memoizedProps,x[Ri]=l,(O=x.nodeValue!==p)&&(o=Ji,o!==null))switch(o.tag){case 3:ic(x.nodeValue,p,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&ic(x.nodeValue,p,(o.mode&1)!==0)}O&&(l.flags|=4)}else x=(p.nodeType===9?p:p.ownerDocument).createTextNode(x),x[Ri]=l,l.stateNode=x}return Gr(l),null;case 13:if(Hn(qn),x=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(jn&&Ir!==null&&(l.mode&1)!==0&&(l.flags&128)===0)Pd(),Sa(),l.flags|=98560,O=!1;else if(O=tu(l),x!==null&&x.dehydrated!==null){if(o===null){if(!O)throw Error(t(318));if(O=l.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(t(317));O[Ri]=l}else Sa(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Gr(l),O=!1}else As!==null&&(U_(As),As=null),O=!0;if(!O)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=p,l):(x=x!==null,x!==(o!==null&&o.memoizedState!==null)&&x&&(l.child.flags|=8192,(l.mode&1)!==0&&(o===null||(qn.current&1)!==0?ir===0&&(ir=3):H_())),l.updateQueue!==null&&(l.flags|=4),Gr(l),null);case 4:return Ta(),b_(o,l),o===null&&Kl(l.stateNode.containerInfo),Gr(l),null;case 10:return fc(l.type._context),Gr(l),null;case 17:return fr(l.type)&&sc(),Gr(l),null;case 19:if(Hn(qn),O=l.memoizedState,O===null)return Gr(l),null;if(x=(l.flags&128)!==0,G=O.rendering,G===null)if(x)Hd(O,!1);else{if(ir!==0||o!==null&&(o.flags&128)!==0)for(o=l.child;o!==null;){if(G=Qs(o),G!==null){for(l.flags|=128,Hd(O,!1),x=G.updateQueue,x!==null&&(l.updateQueue=x,l.flags|=4),l.subtreeFlags=0,x=p,p=l.child;p!==null;)O=p,o=x,O.flags&=14680066,G=O.alternate,G===null?(O.childLanes=0,O.lanes=o,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=G.childLanes,O.lanes=G.lanes,O.child=G.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=G.memoizedProps,O.memoizedState=G.memoizedState,O.updateQueue=G.updateQueue,O.type=G.type,o=G.dependencies,O.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),p=p.sibling;return Fn(qn,qn.current&1|2),l.child}o=o.sibling}O.tail!==null&&vt()>rf&&(l.flags|=128,x=!0,Hd(O,!1),l.lanes=4194304)}else{if(!x)if(o=Qs(G),o!==null){if(l.flags|=128,x=!0,p=o.updateQueue,p!==null&&(l.updateQueue=p,l.flags|=4),Hd(O,!0),O.tail===null&&O.tailMode==="hidden"&&!G.alternate&&!jn)return Gr(l),null}else 2*vt()-O.renderingStartTime>rf&&p!==1073741824&&(l.flags|=128,x=!0,Hd(O,!1),l.lanes=4194304);O.isBackwards?(G.sibling=l.child,l.child=G):(p=O.last,p!==null?p.sibling=G:l.child=G,O.last=G)}return O.tail!==null?(l=O.tail,O.rendering=l,O.tail=l.sibling,O.renderingStartTime=vt(),l.sibling=null,p=qn.current,Fn(qn,x?p&1|2:p&1),l):(Gr(l),null);case 22:case 23:return V_(),x=l.memoizedState!==null,o!==null&&o.memoizedState!==null!==x&&(l.flags|=8192),x&&(l.mode&1)!==0?(Js&1073741824)!==0&&(Gr(l),l.subtreeFlags&6&&(l.flags|=8192)):Gr(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function cb(o,l){switch(Vo(l),l.tag){case 1:return fr(l.type)&&sc(),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return Ta(),Hn(br),Hn(Zi),_o(),o=l.flags,(o&65536)!==0&&(o&128)===0?(l.flags=o&-65537|128,l):null;case 5:return su(l),null;case 13:if(Hn(qn),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(t(340));Sa()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return Hn(qn),null;case 4:return Ta(),null;case 10:return fc(l.type._context),null;case 22:case 23:return V_(),null;case 24:return null;default:return null}}var qm=!1,Wr=!1,hb=typeof WeakSet=="function"?WeakSet:Set,mt=null;function tf(o,l){var p=o.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(x){Si(o,l,x)}else p.current=null}function P_(o,l,p){try{p()}catch(x){Si(o,l,x)}}var j1=!1;function fb(o,l){if(Jl=lr,o=oi(),Bi(o)){if("selectionStart"in o)var p={start:o.selectionStart,end:o.selectionEnd};else e:{p=(p=o.ownerDocument)&&p.defaultView||window;var x=p.getSelection&&p.getSelection();if(x&&x.rangeCount!==0){p=x.anchorNode;var A=x.anchorOffset,O=x.focusNode;x=x.focusOffset;try{p.nodeType,O.nodeType}catch{p=null;break e}var G=0,te=-1,ie=-1,we=0,Ve=0,Ge=o,Be=null;t:for(;;){for(var lt;Ge!==p||A!==0&&Ge.nodeType!==3||(te=G+A),Ge!==O||x!==0&&Ge.nodeType!==3||(ie=G+x),Ge.nodeType===3&&(G+=Ge.nodeValue.length),(lt=Ge.firstChild)!==null;)Be=Ge,Ge=lt;for(;;){if(Ge===o)break t;if(Be===p&&++we===A&&(te=G),Be===O&&++Ve===x&&(ie=G),(lt=Ge.nextSibling)!==null)break;Ge=Be,Be=Ge.parentNode}Ge=lt}p=te===-1||ie===-1?null:{start:te,end:ie}}else p=null}p=p||{start:0,end:0}}else p=null;for(_d={focusedElem:o,selectionRange:p},lr=!1,mt=l;mt!==null;)if(l=mt,o=l.child,(l.subtreeFlags&1028)!==0&&o!==null)o.return=l,mt=o;else for(;mt!==null;){l=mt;try{var yt=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(yt!==null){var xt=yt.memoizedProps,Di=yt.memoizedState,me=l.stateNode,ae=me.getSnapshotBeforeUpdate(l.elementType===l.type?xt:bs(l.type,xt),Di);me.__reactInternalSnapshotBeforeUpdate=ae}break;case 3:var _e=l.stateNode.containerInfo;_e.nodeType===1?_e.textContent="":_e.nodeType===9&&_e.documentElement&&_e.removeChild(_e.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ke){Si(l,l.return,Ke)}if(o=l.sibling,o!==null){o.return=l.return,mt=o;break}mt=l.return}return yt=j1,j1=!1,yt}function Gd(o,l,p){var x=l.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var A=x=x.next;do{if((A.tag&o)===o){var O=A.destroy;A.destroy=void 0,O!==void 0&&P_(l,p,O)}A=A.next}while(A!==x)}}function Xm(o,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var p=l=l.next;do{if((p.tag&o)===o){var x=p.create;p.destroy=x()}p=p.next}while(p!==l)}}function I_(o){var l=o.ref;if(l!==null){var p=o.stateNode;switch(o.tag){case 5:o=p;break;default:o=p}typeof l=="function"?l(o):l.current=o}}function q1(o){var l=o.alternate;l!==null&&(o.alternate=null,q1(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&(delete l[Ri],delete l[eu],delete l[el],delete l[Fh],delete l[Uh])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function X1(o){return o.tag===5||o.tag===3||o.tag===4}function $1(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||X1(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function R_(o,l,p){var x=o.tag;if(x===5||x===6)o=o.stateNode,l?p.nodeType===8?p.parentNode.insertBefore(o,l):p.insertBefore(o,l):(p.nodeType===8?(l=p.parentNode,l.insertBefore(o,p)):(l=p,l.appendChild(o)),p=p._reactRootContainer,p!=null||l.onclick!==null||(l.onclick=rc));else if(x!==4&&(o=o.child,o!==null))for(R_(o,l,p),o=o.sibling;o!==null;)R_(o,l,p),o=o.sibling}function D_(o,l,p){var x=o.tag;if(x===5||x===6)o=o.stateNode,l?p.insertBefore(o,l):p.appendChild(o);else if(x!==4&&(o=o.child,o!==null))for(D_(o,l,p),o=o.sibling;o!==null;)D_(o,l,p),o=o.sibling}var Dr=null,Yo=!1;function lu(o,l,p){for(p=p.child;p!==null;)Y1(o,l,p),p=p.sibling}function Y1(o,l,p){if(Ut&&typeof Ut.onCommitFiberUnmount=="function")try{Ut.onCommitFiberUnmount(An,p)}catch{}switch(p.tag){case 5:Wr||tf(p,l);case 6:var x=Dr,A=Yo;Dr=null,lu(o,l,p),Dr=x,Yo=A,Dr!==null&&(Yo?(o=Dr,p=p.stateNode,o.nodeType===8?o.parentNode.removeChild(p):o.removeChild(p)):Dr.removeChild(p.stateNode));break;case 18:Dr!==null&&(Yo?(o=Dr,p=p.stateNode,o.nodeType===8?zh(o.parentNode,p):o.nodeType===1&&zh(o,p),Hs(o)):zh(Dr,p.stateNode));break;case 4:x=Dr,A=Yo,Dr=p.stateNode.containerInfo,Yo=!0,lu(o,l,p),Dr=x,Yo=A;break;case 0:case 11:case 14:case 15:if(!Wr&&(x=p.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){A=x=x.next;do{var O=A,G=O.destroy;O=O.tag,G!==void 0&&((O&2)!==0||(O&4)!==0)&&P_(p,l,G),A=A.next}while(A!==x)}lu(o,l,p);break;case 1:if(!Wr&&(tf(p,l),x=p.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=p.memoizedProps,x.state=p.memoizedState,x.componentWillUnmount()}catch(te){Si(p,l,te)}lu(o,l,p);break;case 21:lu(o,l,p);break;case 22:p.mode&1?(Wr=(x=Wr)||p.memoizedState!==null,lu(o,l,p),Wr=x):lu(o,l,p);break;default:lu(o,l,p)}}function Q1(o){var l=o.updateQueue;if(l!==null){o.updateQueue=null;var p=o.stateNode;p===null&&(p=o.stateNode=new hb),l.forEach(function(x){var A=wb.bind(null,o,x);p.has(x)||(p.add(x),x.then(A,A))})}}function Qo(o,l){var p=l.deletions;if(p!==null)for(var x=0;x<p.length;x++){var A=p[x];try{var O=o,G=l,te=G;e:for(;te!==null;){switch(te.tag){case 5:Dr=te.stateNode,Yo=!1;break e;case 3:Dr=te.stateNode.containerInfo,Yo=!0;break e;case 4:Dr=te.stateNode.containerInfo,Yo=!0;break e}te=te.return}if(Dr===null)throw Error(t(160));Y1(O,G,A),Dr=null,Yo=!1;var ie=A.alternate;ie!==null&&(ie.return=null),A.return=null}catch(we){Si(A,l,we)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)K1(l,o),l=l.sibling}function K1(o,l){var p=o.alternate,x=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(Qo(l,o),Ca(o),x&4){try{Gd(3,o,o.return),Xm(3,o)}catch(xt){Si(o,o.return,xt)}try{Gd(5,o,o.return)}catch(xt){Si(o,o.return,xt)}}break;case 1:Qo(l,o),Ca(o),x&512&&p!==null&&tf(p,p.return);break;case 5:if(Qo(l,o),Ca(o),x&512&&p!==null&&tf(p,p.return),o.flags&32){var A=o.stateNode;try{Re(A,"")}catch(xt){Si(o,o.return,xt)}}if(x&4&&(A=o.stateNode,A!=null)){var O=o.memoizedProps,G=p!==null?p.memoizedProps:O,te=o.type,ie=o.updateQueue;if(o.updateQueue=null,ie!==null)try{te==="input"&&O.type==="radio"&&O.name!=null&&et(A,O),Cn(te,G);var we=Cn(te,O);for(G=0;G<ie.length;G+=2){var Ve=ie[G],Ge=ie[G+1];Ve==="style"?bt(A,Ge):Ve==="dangerouslySetInnerHTML"?st(A,Ge):Ve==="children"?Re(A,Ge):b(A,Ve,Ge,we)}switch(te){case"input":It(A,O);break;case"textarea":Se(A,O);break;case"select":var Be=A._wrapperState.wasMultiple;A._wrapperState.wasMultiple=!!O.multiple;var lt=O.value;lt!=null?tn(A,!!O.multiple,lt,!1):Be!==!!O.multiple&&(O.defaultValue!=null?tn(A,!!O.multiple,O.defaultValue,!0):tn(A,!!O.multiple,O.multiple?[]:"",!1))}A[eu]=O}catch(xt){Si(o,o.return,xt)}}break;case 6:if(Qo(l,o),Ca(o),x&4){if(o.stateNode===null)throw Error(t(162));A=o.stateNode,O=o.memoizedProps;try{A.nodeValue=O}catch(xt){Si(o,o.return,xt)}}break;case 3:if(Qo(l,o),Ca(o),x&4&&p!==null&&p.memoizedState.isDehydrated)try{Hs(l.containerInfo)}catch(xt){Si(o,o.return,xt)}break;case 4:Qo(l,o),Ca(o);break;case 13:Qo(l,o),Ca(o),A=o.child,A.flags&8192&&(O=A.memoizedState!==null,A.stateNode.isHidden=O,!O||A.alternate!==null&&A.alternate.memoizedState!==null||(N_=vt())),x&4&&Q1(o);break;case 22:if(Ve=p!==null&&p.memoizedState!==null,o.mode&1?(Wr=(we=Wr)||Ve,Qo(l,o),Wr=we):Qo(l,o),Ca(o),x&8192){if(we=o.memoizedState!==null,(o.stateNode.isHidden=we)&&!Ve&&(o.mode&1)!==0)for(mt=o,Ve=o.child;Ve!==null;){for(Ge=mt=Ve;mt!==null;){switch(Be=mt,lt=Be.child,Be.tag){case 0:case 11:case 14:case 15:Gd(4,Be,Be.return);break;case 1:tf(Be,Be.return);var yt=Be.stateNode;if(typeof yt.componentWillUnmount=="function"){x=Be,p=Be.return;try{l=x,yt.props=l.memoizedProps,yt.state=l.memoizedState,yt.componentWillUnmount()}catch(xt){Si(x,p,xt)}}break;case 5:tf(Be,Be.return);break;case 22:if(Be.memoizedState!==null){ew(Ge);continue}}lt!==null?(lt.return=Be,mt=lt):ew(Ge)}Ve=Ve.sibling}e:for(Ve=null,Ge=o;;){if(Ge.tag===5){if(Ve===null){Ve=Ge;try{A=Ge.stateNode,we?(O=A.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none"):(te=Ge.stateNode,ie=Ge.memoizedProps.style,G=ie!=null&&ie.hasOwnProperty("display")?ie.display:null,te.style.display=Rt("display",G))}catch(xt){Si(o,o.return,xt)}}}else if(Ge.tag===6){if(Ve===null)try{Ge.stateNode.nodeValue=we?"":Ge.memoizedProps}catch(xt){Si(o,o.return,xt)}}else if((Ge.tag!==22&&Ge.tag!==23||Ge.memoizedState===null||Ge===o)&&Ge.child!==null){Ge.child.return=Ge,Ge=Ge.child;continue}if(Ge===o)break e;for(;Ge.sibling===null;){if(Ge.return===null||Ge.return===o)break e;Ve===Ge&&(Ve=null),Ge=Ge.return}Ve===Ge&&(Ve=null),Ge.sibling.return=Ge.return,Ge=Ge.sibling}}break;case 19:Qo(l,o),Ca(o),x&4&&Q1(o);break;case 21:break;default:Qo(l,o),Ca(o)}}function Ca(o){var l=o.flags;if(l&2){try{e:{for(var p=o.return;p!==null;){if(X1(p)){var x=p;break e}p=p.return}throw Error(t(160))}switch(x.tag){case 5:var A=x.stateNode;x.flags&32&&(Re(A,""),x.flags&=-33);var O=$1(o);D_(o,O,A);break;case 3:case 4:var G=x.stateNode.containerInfo,te=$1(o);R_(o,te,G);break;default:throw Error(t(161))}}catch(ie){Si(o,o.return,ie)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function db(o,l,p){mt=o,Z1(o)}function Z1(o,l,p){for(var x=(o.mode&1)!==0;mt!==null;){var A=mt,O=A.child;if(A.tag===22&&x){var G=A.memoizedState!==null||qm;if(!G){var te=A.alternate,ie=te!==null&&te.memoizedState!==null||Wr;te=qm;var we=Wr;if(qm=G,(Wr=ie)&&!we)for(mt=A;mt!==null;)G=mt,ie=G.child,G.tag===22&&G.memoizedState!==null?tw(A):ie!==null?(ie.return=G,mt=ie):tw(A);for(;O!==null;)mt=O,Z1(O),O=O.sibling;mt=A,qm=te,Wr=we}J1(o)}else(A.subtreeFlags&8772)!==0&&O!==null?(O.return=A,mt=O):J1(o)}}function J1(o){for(;mt!==null;){var l=mt;if((l.flags&8772)!==0){var p=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Wr||Xm(5,l);break;case 1:var x=l.stateNode;if(l.flags&4&&!Wr)if(p===null)x.componentDidMount();else{var A=l.elementType===l.type?p.memoizedProps:bs(l.type,p.memoizedProps);x.componentDidUpdate(A,p.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var O=l.updateQueue;O!==null&&ru(l,O,x);break;case 3:var G=l.updateQueue;if(G!==null){if(p=null,l.child!==null)switch(l.child.tag){case 5:p=l.child.stateNode;break;case 1:p=l.child.stateNode}ru(l,G,p)}break;case 5:var te=l.stateNode;if(p===null&&l.flags&4){p=te;var ie=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":ie.autoFocus&&p.focus();break;case"img":ie.src&&(p.src=ie.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var we=l.alternate;if(we!==null){var Ve=we.memoizedState;if(Ve!==null){var Ge=Ve.dehydrated;Ge!==null&&Hs(Ge)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Wr||l.flags&512&&I_(l)}catch(Be){Si(l,l.return,Be)}}if(l===o){mt=null;break}if(p=l.sibling,p!==null){p.return=l.return,mt=p;break}mt=l.return}}function ew(o){for(;mt!==null;){var l=mt;if(l===o){mt=null;break}var p=l.sibling;if(p!==null){p.return=l.return,mt=p;break}mt=l.return}}function tw(o){for(;mt!==null;){var l=mt;try{switch(l.tag){case 0:case 11:case 15:var p=l.return;try{Xm(4,l)}catch(ie){Si(l,p,ie)}break;case 1:var x=l.stateNode;if(typeof x.componentDidMount=="function"){var A=l.return;try{x.componentDidMount()}catch(ie){Si(l,A,ie)}}var O=l.return;try{I_(l)}catch(ie){Si(l,O,ie)}break;case 5:var G=l.return;try{I_(l)}catch(ie){Si(l,G,ie)}}}catch(ie){Si(l,l.return,ie)}if(l===o){mt=null;break}var te=l.sibling;if(te!==null){te.return=l.return,mt=te;break}mt=l.return}}var pb=Math.ceil,$m=R.ReactCurrentDispatcher,L_=R.ReactCurrentOwner,yo=R.ReactCurrentBatchConfig,En=0,mr=null,ji=null,Lr=0,Js=0,nf=li(0),ir=0,Wd=null,Ec=0,Ym=0,O_=0,jd=null,Ps=null,N_=0,rf=1/0,gl=null,Qm=!1,k_=null,uu=null,Km=!1,cu=null,Zm=0,qd=0,z_=null,Jm=-1,eg=0;function ps(){return(En&6)!==0?vt():Jm!==-1?Jm:Jm=vt()}function hu(o){return(o.mode&1)===0?1:(En&2)!==0&&Lr!==0?Lr&-Lr:M_.transition!==null?(eg===0&&(eg=Qi()),eg):(o=sn,o!==0||(o=window.event,o=o===void 0?16:Xu(o.type)),o)}function Ko(o,l,p,x){if(50<qd)throw qd=0,z_=null,Error(t(185));da(o,p,x),((En&2)===0||o!==mr)&&(o===mr&&((En&2)===0&&(Ym|=p),ir===4&&fu(o,Lr)),Is(o,x),p===1&&En===0&&(l.mode&1)===0&&(rf=vt()+500,ac&&mo()))}function Is(o,l){var p=o.callbackNode;ws(o,l);var x=ha(o,o===mr?Lr:0);if(x===0)p!==null&&Sr(p),o.callbackNode=null,o.callbackPriority=0;else if(l=x&-x,o.callbackPriority!==l){if(p!=null&&Sr(p),l===1)o.tag===0?Lm(iw.bind(null,o)):lc(iw.bind(null,o)),T_(function(){(En&6)===0&&mo()}),p=null;else{switch(Ss(x)){case 1:p=Rn;break;case 4:p=zi;break;case 16:p=Er;break;case 536870912:p=ts;break;default:p=Er}p=hw(p,nw.bind(null,o))}o.callbackPriority=l,o.callbackNode=p}}function nw(o,l){if(Jm=-1,eg=0,(En&6)!==0)throw Error(t(327));var p=o.callbackNode;if(sf()&&o.callbackNode!==p)return null;var x=ha(o,o===mr?Lr:0);if(x===0)return null;if((x&30)!==0||(x&o.expiredLanes)!==0||l)l=tg(o,x);else{l=x;var A=En;En|=2;var O=sw();(mr!==o||Lr!==l)&&(gl=null,rf=vt()+500,Mc(o,l));do try{_b();break}catch(te){rw(o,te)}while(!0);ll(),$m.current=O,En=A,ji!==null?l=0:(mr=null,Lr=0,l=ir)}if(l!==0){if(l===2&&(A=Ur(o),A!==0&&(x=A,l=F_(o,A))),l===1)throw p=Wd,Mc(o,0),fu(o,x),Is(o,vt()),p;if(l===6)fu(o,x);else{if(A=o.current.alternate,(x&30)===0&&!mb(A)&&(l=tg(o,x),l===2&&(O=Ur(o),O!==0&&(x=O,l=F_(o,O))),l===1))throw p=Wd,Mc(o,0),fu(o,x),Is(o,vt()),p;switch(o.finishedWork=A,o.finishedLanes=x,l){case 0:case 1:throw Error(t(345));case 2:Cc(o,Ps,gl);break;case 3:if(fu(o,x),(x&130023424)===x&&(l=N_+500-vt(),10<l)){if(ha(o,0)!==0)break;if(A=o.suspendedLanes,(A&x)!==x){ps(),o.pingedLanes|=o.suspendedLanes&A;break}o.timeoutHandle=yd(Cc.bind(null,o,Ps,gl),l);break}Cc(o,Ps,gl);break;case 4:if(fu(o,x),(x&4194240)===x)break;for(l=o.eventTimes,A=-1;0<x;){var G=31-ln(x);O=1<<G,G=l[G],G>A&&(A=G),x&=~O}if(x=A,x=vt()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*pb(x/1960))-x,10<x){o.timeoutHandle=yd(Cc.bind(null,o,Ps,gl),x);break}Cc(o,Ps,gl);break;case 5:Cc(o,Ps,gl);break;default:throw Error(t(329))}}}return Is(o,vt()),o.callbackNode===p?nw.bind(null,o):null}function F_(o,l){var p=jd;return o.current.memoizedState.isDehydrated&&(Mc(o,l).flags|=256),o=tg(o,l),o!==2&&(l=Ps,Ps=p,l!==null&&U_(l)),o}function U_(o){Ps===null?Ps=o:Ps.push.apply(Ps,o)}function mb(o){for(var l=o;;){if(l.flags&16384){var p=l.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var x=0;x<p.length;x++){var A=p[x],O=A.getSnapshot;A=A.value;try{if(!os(O(),A))return!1}catch{return!1}}}if(p=l.child,l.subtreeFlags&16384&&p!==null)p.return=l,l=p;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function fu(o,l){for(l&=~O_,l&=~Ym,o.suspendedLanes|=l,o.pingedLanes&=~l,o=o.expirationTimes;0<l;){var p=31-ln(l),x=1<<p;o[p]=-1,l&=~x}}function iw(o){if((En&6)!==0)throw Error(t(327));sf();var l=ha(o,0);if((l&1)===0)return Is(o,vt()),null;var p=tg(o,l);if(o.tag!==0&&p===2){var x=Ur(o);x!==0&&(l=x,p=F_(o,x))}if(p===1)throw p=Wd,Mc(o,0),fu(o,l),Is(o,vt()),p;if(p===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=l,Cc(o,Ps,gl),Is(o,vt()),null}function B_(o,l){var p=En;En|=1;try{return o(l)}finally{En=p,En===0&&(rf=vt()+500,ac&&mo())}}function Tc(o){cu!==null&&cu.tag===0&&(En&6)===0&&sf();var l=En;En|=1;var p=yo.transition,x=sn;try{if(yo.transition=null,sn=1,o)return o()}finally{sn=x,yo.transition=p,En=l,(En&6)===0&&mo()}}function V_(){Js=nf.current,Hn(nf)}function Mc(o,l){o.finishedWork=null,o.finishedLanes=0;var p=o.timeoutHandle;if(p!==-1&&(o.timeoutHandle=-1,xd(p)),ji!==null)for(p=ji.return;p!==null;){var x=p;switch(Vo(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&sc();break;case 3:Ta(),Hn(br),Hn(Zi),_o();break;case 5:su(x);break;case 4:Ta();break;case 13:Hn(qn);break;case 19:Hn(qn);break;case 10:fc(x.type._context);break;case 22:case 23:V_()}p=p.return}if(mr=o,ji=o=du(o.current,null),Lr=Js=l,ir=0,Wd=null,O_=Ym=Ec=0,Ps=jd=null,Go!==null){for(l=0;l<Go.length;l++)if(p=Go[l],x=p.interleaved,x!==null){p.interleaved=null;var A=x.next,O=p.pending;if(O!==null){var G=O.next;O.next=A,x.next=G}p.pending=x}Go=null}return o}function rw(o,l){do{var p=ji;try{if(ll(),fl.current=Jh,Ks){for(var x=Gn.memoizedState;x!==null;){var A=x.queue;A!==null&&(A.pending=null),x=x.next}Ks=!1}if(jo=0,xn=ci=Gn=null,pr=!1,Ma=0,L_.current=null,p===null||p.return===null){ir=1,Wd=l,ji=null;break}e:{var O=o,G=p.return,te=p,ie=l;if(l=Lr,te.flags|=32768,ie!==null&&typeof ie=="object"&&typeof ie.then=="function"){var we=ie,Ve=te,Ge=Ve.tag;if((Ve.mode&1)===0&&(Ge===0||Ge===11||Ge===15)){var Be=Ve.alternate;Be?(Ve.updateQueue=Be.updateQueue,Ve.memoizedState=Be.memoizedState,Ve.lanes=Be.lanes):(Ve.updateQueue=null,Ve.memoizedState=null)}var lt=ft(G);if(lt!==null){lt.flags&=-257,Gt(lt,G,te,O,l),lt.mode&1&&Ye(O,we,l),l=lt,ie=we;var yt=l.updateQueue;if(yt===null){var xt=new Set;xt.add(ie),l.updateQueue=xt}else yt.add(ie);break e}else{if((l&1)===0){Ye(O,we,l),H_();break e}ie=Error(t(426))}}else if(jn&&te.mode&1){var Di=ft(G);if(Di!==null){(Di.flags&65536)===0&&(Di.flags|=256),Gt(Di,G,te,O,l),nu(S(ie,te));break e}}O=ie=S(ie,te),ir!==4&&(ir=2),jd===null?jd=[O]:jd.push(O),O=G;do{switch(O.tag){case 3:O.flags|=65536,l&=-l,O.lanes|=l;var me=ue(O,ie,l);ul(O,me);break e;case 1:te=ie;var ae=O.type,_e=O.stateNode;if((O.flags&128)===0&&(typeof ae.getDerivedStateFromError=="function"||_e!==null&&typeof _e.componentDidCatch=="function"&&(uu===null||!uu.has(_e)))){O.flags|=65536,l&=-l,O.lanes|=l;var Ke=Me(O,te,l);ul(O,Ke);break e}}O=O.return}while(O!==null)}aw(p)}catch(Ct){l=Ct,ji===p&&p!==null&&(ji=p=p.return);continue}break}while(!0)}function sw(){var o=$m.current;return $m.current=Jh,o===null?Jh:o}function H_(){(ir===0||ir===3||ir===2)&&(ir=4),mr===null||(Ec&268435455)===0&&(Ym&268435455)===0||fu(mr,Lr)}function tg(o,l){var p=En;En|=2;var x=sw();(mr!==o||Lr!==l)&&(gl=null,Mc(o,l));do try{gb();break}catch(A){rw(o,A)}while(!0);if(ll(),En=p,$m.current=x,ji!==null)throw Error(t(261));return mr=null,Lr=0,ir}function gb(){for(;ji!==null;)ow(ji)}function _b(){for(;ji!==null&&!ys();)ow(ji)}function ow(o){var l=cw(o.alternate,o,Js);o.memoizedProps=o.pendingProps,l===null?aw(o):ji=l,L_.current=null}function aw(o){var l=o;do{var p=l.alternate;if(o=l.return,(l.flags&32768)===0){if(p=ub(p,l,Js),p!==null){ji=p;return}}else{if(p=cb(p,l),p!==null){p.flags&=32767,ji=p;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{ir=6,ji=null;return}}if(l=l.sibling,l!==null){ji=l;return}ji=l=o}while(l!==null);ir===0&&(ir=5)}function Cc(o,l,p){var x=sn,A=yo.transition;try{yo.transition=null,sn=1,vb(o,l,p,x)}finally{yo.transition=A,sn=x}return null}function vb(o,l,p,x){do sf();while(cu!==null);if((En&6)!==0)throw Error(t(327));p=o.finishedWork;var A=o.finishedLanes;if(p===null)return null;if(o.finishedWork=null,o.finishedLanes=0,p===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var O=p.lanes|p.childLanes;if(kn(o,O),o===mr&&(ji=mr=null,Lr=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Km||(Km=!0,hw(Er,function(){return sf(),null})),O=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||O){O=yo.transition,yo.transition=null;var G=sn;sn=1;var te=En;En|=4,L_.current=null,fb(o,p),K1(p,o),Vi(_d),lr=!!Jl,_d=Jl=null,o.current=p,db(p),Yn(),En=te,sn=G,yo.transition=O}else o.current=p;if(Km&&(Km=!1,cu=o,Zm=A),O=o.pendingLanes,O===0&&(uu=null),mn(p.stateNode),Is(o,vt()),l!==null)for(x=o.onRecoverableError,p=0;p<l.length;p++)A=l[p],x(A.value,{componentStack:A.stack,digest:A.digest});if(Qm)throw Qm=!1,o=k_,k_=null,o;return(Zm&1)!==0&&o.tag!==0&&sf(),O=o.pendingLanes,(O&1)!==0?o===z_?qd++:(qd=0,z_=o):qd=0,mo(),null}function sf(){if(cu!==null){var o=Ss(Zm),l=yo.transition,p=sn;try{if(yo.transition=null,sn=16>o?16:o,cu===null)var x=!1;else{if(o=cu,cu=null,Zm=0,(En&6)!==0)throw Error(t(331));var A=En;for(En|=4,mt=o.current;mt!==null;){var O=mt,G=O.child;if((mt.flags&16)!==0){var te=O.deletions;if(te!==null){for(var ie=0;ie<te.length;ie++){var we=te[ie];for(mt=we;mt!==null;){var Ve=mt;switch(Ve.tag){case 0:case 11:case 15:Gd(8,Ve,O)}var Ge=Ve.child;if(Ge!==null)Ge.return=Ve,mt=Ge;else for(;mt!==null;){Ve=mt;var Be=Ve.sibling,lt=Ve.return;if(q1(Ve),Ve===we){mt=null;break}if(Be!==null){Be.return=lt,mt=Be;break}mt=lt}}}var yt=O.alternate;if(yt!==null){var xt=yt.child;if(xt!==null){yt.child=null;do{var Di=xt.sibling;xt.sibling=null,xt=Di}while(xt!==null)}}mt=O}}if((O.subtreeFlags&2064)!==0&&G!==null)G.return=O,mt=G;else e:for(;mt!==null;){if(O=mt,(O.flags&2048)!==0)switch(O.tag){case 0:case 11:case 15:Gd(9,O,O.return)}var me=O.sibling;if(me!==null){me.return=O.return,mt=me;break e}mt=O.return}}var ae=o.current;for(mt=ae;mt!==null;){G=mt;var _e=G.child;if((G.subtreeFlags&2064)!==0&&_e!==null)_e.return=G,mt=_e;else e:for(G=ae;mt!==null;){if(te=mt,(te.flags&2048)!==0)try{switch(te.tag){case 0:case 11:case 15:Xm(9,te)}}catch(Ct){Si(te,te.return,Ct)}if(te===G){mt=null;break e}var Ke=te.sibling;if(Ke!==null){Ke.return=te.return,mt=Ke;break e}mt=te.return}}if(En=A,mo(),Ut&&typeof Ut.onPostCommitFiberRoot=="function")try{Ut.onPostCommitFiberRoot(An,o)}catch{}x=!0}return x}finally{sn=p,yo.transition=l}}return!1}function lw(o,l,p){l=S(p,l),l=ue(o,l,1),o=Jn(o,l,1),l=ps(),o!==null&&(da(o,1,l),Is(o,l))}function Si(o,l,p){if(o.tag===3)lw(o,o,p);else for(;l!==null;){if(l.tag===3){lw(l,o,p);break}else if(l.tag===1){var x=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(uu===null||!uu.has(x))){o=S(p,o),o=Me(l,o,1),l=Jn(l,o,1),o=ps(),l!==null&&(da(l,1,o),Is(l,o));break}}l=l.return}}function yb(o,l,p){var x=o.pingCache;x!==null&&x.delete(l),l=ps(),o.pingedLanes|=o.suspendedLanes&p,mr===o&&(Lr&p)===p&&(ir===4||ir===3&&(Lr&130023424)===Lr&&500>vt()-N_?Mc(o,0):O_|=p),Is(o,l)}function uw(o,l){l===0&&((o.mode&1)===0?l=1:(l=bi,bi<<=1,(bi&130023424)===0&&(bi=4194304)));var p=ps();o=Ys(o,l),o!==null&&(da(o,l,p),Is(o,p))}function xb(o){var l=o.memoizedState,p=0;l!==null&&(p=l.retryLane),uw(o,p)}function wb(o,l){var p=0;switch(o.tag){case 13:var x=o.stateNode,A=o.memoizedState;A!==null&&(p=A.retryLane);break;case 19:x=o.stateNode;break;default:throw Error(t(314))}x!==null&&x.delete(l),uw(o,p)}var cw;cw=function(o,l,p){if(o!==null)if(o.memoizedProps!==l.pendingProps||br.current)Zt=!0;else{if((o.lanes&p)===0&&(l.flags&128)===0)return Zt=!1,lb(o,l,p);Zt=(o.flags&131072)!==0}else Zt=!1,jn&&(l.flags&1048576)!==0&&Md(l,Gh,l.index);switch(l.lanes=0,l.tag){case 2:var x=l.type;jm(o,l),o=l.pendingProps;var A=tl(l,Zi.current);Ea(l,p),A=_c(null,l,x,o,A,p);var O=Ld();return l.flags|=1,typeof A=="object"&&A!==null&&typeof A.render=="function"&&A.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,fr(x)?(O=!0,nl(l)):O=!1,l.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,$t(l),A.updater=ef,l.stateNode=A,A._reactInternals=l,v(l,x,o,p),l=qt(null,l,x,!0,O,p)):(l.tag=0,jn&&O&&Cd(l),ot(null,l,A,p),l=l.child),l;case 16:x=l.elementType;e:{switch(jm(o,l),o=l.pendingProps,A=x._init,x=A(x._payload),l.type=x,A=l.tag=Eb(x),o=bs(x,o),A){case 0:l=it(null,l,x,o,p);break e;case 1:l=wt(null,l,x,o,p);break e;case 11:l=nr(null,l,x,o,p);break e;case 14:l=ds(null,l,x,bs(x.type,o),p);break e}throw Error(t(306,x,""))}return l;case 0:return x=l.type,A=l.pendingProps,A=l.elementType===x?A:bs(x,A),it(o,l,x,A,p);case 1:return x=l.type,A=l.pendingProps,A=l.elementType===x?A:bs(x,A),wt(o,l,x,A,p);case 3:e:{if(Wt(l),o===null)throw Error(t(387));x=l.pendingProps,O=l.memoizedState,A=O.element,pi(o,l),ui(l,x,null,p);var G=l.memoizedState;if(x=G.element,O.isDehydrated)if(O={element:x,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},l.updateQueue.baseState=O,l.memoizedState=O,l.flags&256){A=S(Error(t(423)),l),l=gn(o,l,x,p,A);break e}else if(x!==A){A=S(Error(t(424)),l),l=gn(o,l,x,p,A);break e}else for(Ir=ko(l.stateNode.containerInfo.firstChild),Ji=l,jn=!0,As=null,p=hc(l,null,x,p),l.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Sa(),x===A){l=ml(o,l,p);break e}ot(o,l,x,p)}l=l.child}return l;case 5:return hl(l),o===null&&jh(l),x=l.type,A=l.pendingProps,O=o!==null?o.memoizedProps:null,G=A.children,vd(x,A)?G=null:O!==null&&vd(x,O)&&(l.flags|=32),Te(o,l),ot(o,l,G,p),l.child;case 6:return o===null&&jh(l),null;case 13:return $o(o,l,p);case 4:return mc(l,l.stateNode.containerInfo),x=l.pendingProps,o===null?l.child=sl(l,null,x,p):ot(o,l,x,p),l.child;case 11:return x=l.type,A=l.pendingProps,A=l.elementType===x?A:bs(x,A),nr(o,l,x,A,p);case 7:return ot(o,l,l.pendingProps,p),l.child;case 8:return ot(o,l,l.pendingProps.children,p),l.child;case 12:return ot(o,l,l.pendingProps.children,p),l.child;case 10:e:{if(x=l.type._context,A=l.pendingProps,O=l.memoizedProps,G=A.value,Fn(ol,x._currentValue),x._currentValue=G,O!==null)if(os(O.value,G)){if(O.children===A.children&&!br.current){l=ml(o,l,p);break e}}else for(O=l.child,O!==null&&(O.return=l);O!==null;){var te=O.dependencies;if(te!==null){G=O.child;for(var ie=te.firstContext;ie!==null;){if(ie.context===x){if(O.tag===1){ie=Ln(-1,p&-p),ie.tag=2;var we=O.updateQueue;if(we!==null){we=we.shared;var Ve=we.pending;Ve===null?ie.next=ie:(ie.next=Ve.next,Ve.next=ie),we.pending=ie}}O.lanes|=p,ie=O.alternate,ie!==null&&(ie.lanes|=p),dc(O.return,p,l),te.lanes|=p;break}ie=ie.next}}else if(O.tag===10)G=O.type===l.type?null:O.child;else if(O.tag===18){if(G=O.return,G===null)throw Error(t(341));G.lanes|=p,te=G.alternate,te!==null&&(te.lanes|=p),dc(G,p,l),G=O.sibling}else G=O.child;if(G!==null)G.return=O;else for(G=O;G!==null;){if(G===l){G=null;break}if(O=G.sibling,O!==null){O.return=G.return,G=O;break}G=G.return}O=G}ot(o,l,A.children,p),l=l.child}return l;case 9:return A=l.type,x=l.pendingProps.children,Ea(l,p),A=us(A),x=x(A),l.flags|=1,ot(o,l,x,p),l.child;case 14:return x=l.type,A=bs(x,l.pendingProps),A=bs(x.type,A),ds(o,l,x,A,p);case 15:return ve(o,l,l.type,l.pendingProps,p);case 17:return x=l.type,A=l.pendingProps,A=l.elementType===x?A:bs(x,A),jm(o,l),l.tag=1,fr(x)?(o=!0,nl(l)):o=!1,Ea(l,p),c(l,x,A),v(l,x,A,p),qt(null,l,x,!0,o,p);case 19:return V1(o,l,p);case 22:return ce(o,l,p)}throw Error(t(156,l.tag))};function hw(o,l){return _i(o,l)}function Sb(o,l,p,x){this.tag=o,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xo(o,l,p,x){return new Sb(o,l,p,x)}function G_(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Eb(o){if(typeof o=="function")return G_(o)?1:0;if(o!=null){if(o=o.$$typeof,o===q)return 11;if(o===de)return 14}return 2}function du(o,l){var p=o.alternate;return p===null?(p=xo(o.tag,l,o.key,o.mode),p.elementType=o.elementType,p.type=o.type,p.stateNode=o.stateNode,p.alternate=o,o.alternate=p):(p.pendingProps=l,p.type=o.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=o.flags&14680064,p.childLanes=o.childLanes,p.lanes=o.lanes,p.child=o.child,p.memoizedProps=o.memoizedProps,p.memoizedState=o.memoizedState,p.updateQueue=o.updateQueue,l=o.dependencies,p.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},p.sibling=o.sibling,p.index=o.index,p.ref=o.ref,p}function ng(o,l,p,x,A,O){var G=2;if(x=o,typeof o=="function")G_(o)&&(G=1);else if(typeof o=="string")G=5;else e:switch(o){case k:return Ac(p.children,A,O,l);case I:G=8,A|=8;break;case N:return o=xo(12,p,l,A|2),o.elementType=N,o.lanes=O,o;case H:return o=xo(13,p,l,A),o.elementType=H,o.lanes=O,o;case re:return o=xo(19,p,l,A),o.elementType=re,o.lanes=O,o;case Ce:return ig(p,A,O,l);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case V:G=10;break e;case W:G=9;break e;case q:G=11;break e;case de:G=14;break e;case ye:G=16,x=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return l=xo(G,p,l,A),l.elementType=o,l.type=x,l.lanes=O,l}function Ac(o,l,p,x){return o=xo(7,o,x,l),o.lanes=p,o}function ig(o,l,p,x){return o=xo(22,o,x,l),o.elementType=Ce,o.lanes=p,o.stateNode={isHidden:!1},o}function W_(o,l,p){return o=xo(6,o,null,l),o.lanes=p,o}function j_(o,l,p){return l=xo(4,o.children!==null?o.children:[],o.key,l),l.lanes=p,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}function Tb(o,l,p,x,A){this.tag=l,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fa(0),this.expirationTimes=fa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fa(0),this.identifierPrefix=x,this.onRecoverableError=A,this.mutableSourceEagerHydrationData=null}function q_(o,l,p,x,A,O,G,te,ie){return o=new Tb(o,l,p,te,ie),l===1?(l=1,O===!0&&(l|=8)):l=0,O=xo(3,null,null,l),o.current=O,O.stateNode=o,O.memoizedState={element:x,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},$t(O),o}function Mb(o,l,p){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:x==null?null:""+x,children:o,containerInfo:l,implementation:p}}function fw(o){if(!o)return Fo;o=o._reactInternals;e:{if(Lt(o)!==o||o.tag!==1)throw Error(t(170));var l=o;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(fr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(o.tag===1){var p=o.type;if(fr(p))return oc(o,p,l)}return l}function dw(o,l,p,x,A,O,G,te,ie){return o=q_(p,x,!0,o,A,O,G,te,ie),o.context=fw(null),p=o.current,x=ps(),A=hu(p),O=Ln(x,A),O.callback=l??null,Jn(p,O,A),o.current.lanes=A,da(o,A,x),Is(o,x),o}function rg(o,l,p,x){var A=l.current,O=ps(),G=hu(A);return p=fw(p),l.context===null?l.context=p:l.pendingContext=p,l=Ln(O,G),l.payload={element:o},x=x===void 0?null:x,x!==null&&(l.callback=x),o=Jn(A,l,G),o!==null&&(Ko(o,A,G,O),dr(o,A,G)),G}function sg(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function pw(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var p=o.retryLane;o.retryLane=p!==0&&p<l?p:l}}function X_(o,l){pw(o,l),(o=o.alternate)&&pw(o,l)}function Cb(){return null}var mw=typeof reportError=="function"?reportError:function(o){console.error(o)};function $_(o){this._internalRoot=o}og.prototype.render=$_.prototype.render=function(o){var l=this._internalRoot;if(l===null)throw Error(t(409));rg(o,l,null,null)},og.prototype.unmount=$_.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var l=o.containerInfo;Tc(function(){rg(null,o,null,null)}),l[ls]=null}};function og(o){this._internalRoot=o}og.prototype.unstable_scheduleHydration=function(o){if(o){var l=kl();o={blockedOn:null,target:o,priority:l};for(var p=0;p<uo.length&&l!==0&&l<uo[p].priority;p++);uo.splice(p,0,o),p===0&&Fl(o)}};function Y_(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function ag(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function gw(){}function Ab(o,l,p,x,A){if(A){if(typeof x=="function"){var O=x;x=function(){var we=sg(G);O.call(we)}}var G=dw(l,x,o,0,null,!1,!1,"",gw);return o._reactRootContainer=G,o[ls]=G.current,Kl(o.nodeType===8?o.parentNode:o),Tc(),G}for(;A=o.lastChild;)o.removeChild(A);if(typeof x=="function"){var te=x;x=function(){var we=sg(ie);te.call(we)}}var ie=q_(o,0,!1,null,null,!1,!1,"",gw);return o._reactRootContainer=ie,o[ls]=ie.current,Kl(o.nodeType===8?o.parentNode:o),Tc(function(){rg(l,ie,p,x)}),ie}function lg(o,l,p,x,A){var O=p._reactRootContainer;if(O){var G=O;if(typeof A=="function"){var te=A;A=function(){var ie=sg(G);te.call(ie)}}rg(l,G,o,A)}else G=Ab(p,l,o,A,x);return sg(G)}Ua=function(o){switch(o.tag){case 3:var l=o.stateNode;if(l.current.memoizedState.isDehydrated){var p=Us(l.pendingLanes);p!==0&&(Bs(l,p|1),Is(l,vt()),(En&6)===0&&(rf=vt()+500,mo()))}break;case 13:Tc(function(){var x=Ys(o,1);if(x!==null){var A=ps();Ko(x,o,1,A)}}),X_(o,1)}},Nl=function(o){if(o.tag===13){var l=Ys(o,134217728);if(l!==null){var p=ps();Ko(l,o,134217728,p)}X_(o,134217728)}},Sh=function(o){if(o.tag===13){var l=hu(o),p=Ys(o,l);if(p!==null){var x=ps();Ko(p,o,l,x)}X_(o,l)}},kl=function(){return sn},zl=function(o,l){var p=sn;try{return sn=o,l()}finally{sn=p}},be=function(o,l,p){switch(l){case"input":if(It(o,p),l=p.name,p.type==="radio"&&l!=null){for(p=o;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<p.length;l++){var x=p[l];if(x!==o&&x.form===o.form){var A=Bh(x);if(!A)throw Error(t(90));De(x),It(x,A)}}}break;case"textarea":Se(o,p);break;case"select":l=p.value,l!=null&&tn(o,!!p.multiple,l,!1)}},ri=B_,Yi=Tc;var bb={usingClientEntryPoint:!1,Events:[zo,di,Bh,an,Wn,B_]},Xd={findFiberByHostInstance:wa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Pb={bundleType:Xd.bundleType,version:Xd.version,rendererPackageName:Xd.rendererPackageName,rendererConfig:Xd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=Kt(o),o===null?null:o.stateNode},findFiberByHostInstance:Xd.findFiberByHostInstance||Cb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ug=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ug.isDisabled&&ug.supportsFiber)try{An=ug.inject(Pb),Ut=ug}catch{}}return Rs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bb,Rs.createPortal=function(o,l){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Y_(l))throw Error(t(200));return Mb(o,l,null,p)},Rs.createRoot=function(o,l){if(!Y_(o))throw Error(t(299));var p=!1,x="",A=mw;return l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(x=l.identifierPrefix),l.onRecoverableError!==void 0&&(A=l.onRecoverableError)),l=q_(o,1,!1,null,null,p,!1,x,A),o[ls]=l.current,Kl(o.nodeType===8?o.parentNode:o),new $_(l)},Rs.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=Kt(l),o=o===null?null:o.stateNode,o},Rs.flushSync=function(o){return Tc(o)},Rs.hydrate=function(o,l,p){if(!ag(l))throw Error(t(200));return lg(null,o,l,!0,p)},Rs.hydrateRoot=function(o,l,p){if(!Y_(o))throw Error(t(405));var x=p!=null&&p.hydratedSources||null,A=!1,O="",G=mw;if(p!=null&&(p.unstable_strictMode===!0&&(A=!0),p.identifierPrefix!==void 0&&(O=p.identifierPrefix),p.onRecoverableError!==void 0&&(G=p.onRecoverableError)),l=dw(l,null,o,1,p??null,A,!1,O,G),o[ls]=l.current,Kl(o),x)for(o=0;o<x.length;o++)p=x[o],A=p._getVersion,A=A(p._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[p,A]:l.mutableSourceEagerHydrationData.push(p,A);return new og(l)},Rs.render=function(o,l,p){if(!ag(l))throw Error(t(200));return lg(null,o,l,!1,p)},Rs.unmountComponentAtNode=function(o){if(!ag(o))throw Error(t(40));return o._reactRootContainer?(Tc(function(){lg(null,null,o,!1,function(){o._reactRootContainer=null,o[ls]=null})}),!0):!1},Rs.unstable_batchedUpdates=B_,Rs.unstable_renderSubtreeIntoContainer=function(o,l,p,x){if(!ag(p))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return lg(o,l,p,!1,x)},Rs.version="18.3.1-next-f1338f8080-20240426",Rs}var Tw;function zb(){if(Tw)return Z_.exports;Tw=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Z_.exports=kb(),Z_.exports}var Mw;function Fb(){if(Mw)return cg;Mw=1;var r=zb();return cg.createRoot=r.createRoot,cg.hydrateRoot=r.hydrateRoot,cg}var Ub=Fb();/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const j0="150",Bb={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Vb={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},VT=0,fy=1,HT=2,Hb=3,GT=0,q0=1,vp=2,Hc=3,Pl=0,Os=1,Ra=2,Gb=2,Cl=0,Qc=1,dy=2,py=3,my=4,WT=5,Bc=100,jT=101,qT=102,gy=103,_y=104,XT=200,$T=201,YT=202,QT=203,xx=204,wx=205,KT=206,ZT=207,JT=208,eM=209,tM=210,nM=0,iM=1,rM=2,x0=3,sM=4,oM=5,aM=6,lM=7,Zp=0,uM=1,cM=2,aa=0,hM=1,fM=2,dM=3,Sx=4,pM=5,X0=300,Iu=301,Ru=302,Hf=303,bp=304,Zf=306,Pp=1e3,Kr=1001,Ip=1002,Oi=1003,w0=1004,Wb=1004,yp=1005,jb=1005,ai=1006,Ex=1007,qb=1007,Du=1008,Xb=1008,Il=1009,mM=1010,gM=1011,Tx=1012,_M=1013,Eu=1014,Co=1015,Da=1016,vM=1017,yM=1018,Kc=1020,xM=1021,_s=1023,wM=1024,SM=1025,Cu=1026,ih=1027,EM=1028,TM=1029,MM=1030,CM=1031,AM=1033,a0=33776,l0=33777,u0=33778,c0=33779,vy=35840,yy=35841,xy=35842,wy=35843,bM=36196,Sy=37492,Ey=37496,Ty=37808,My=37809,Cy=37810,Ay=37811,by=37812,Py=37813,Iy=37814,Ry=37815,Dy=37816,Ly=37817,Oy=37818,Ny=37819,ky=37820,zy=37821,h0=36492,PM=36283,Fy=36284,Uy=36285,By=36286,IM=2200,RM=2201,DM=2202,Rp=2300,Dp=2301,f0=2302,Gc=2400,Wc=2401,Lp=2402,$0=2500,Mx=2501,$b=0,Yb=1,Qb=2,Lu=3e3,ti=3001,LM=3200,OM=3201,Bu=0,NM=1,Kb="",na="srgb",Gf="srgb-linear",Cx="display-p3",Zb=0,d0=7680,Jb=7681,e3=7682,t3=7683,n3=34055,i3=34056,r3=5386,s3=512,o3=513,a3=514,l3=515,u3=516,c3=517,h3=518,kM=519,Op=35044,f3=35048,d3=35040,p3=35045,m3=35049,g3=35041,_3=35046,v3=35050,y3=35042,x3="100",Vy="300 es",S0=1035;class za{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}const jr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Cw=1234567;const Zc=Math.PI/180,Np=180/Math.PI;function no(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(jr[r&255]+jr[r>>8&255]+jr[r>>16&255]+jr[r>>24&255]+"-"+jr[e&255]+jr[e>>8&255]+"-"+jr[e>>16&15|64]+jr[e>>24&255]+"-"+jr[t&63|128]+jr[t>>8&255]+"-"+jr[t>>16&255]+jr[t>>24&255]+jr[n&255]+jr[n>>8&255]+jr[n>>16&255]+jr[n>>24&255]).toLowerCase()}function Ni(r,e,t){return Math.max(e,Math.min(t,r))}function Ax(r,e){return(r%e+e)%e}function w3(r,e,t,n,i){return n+(r-e)*(i-n)/(t-e)}function S3(r,e,t){return r!==e?(t-r)/(e-r):0}function xp(r,e,t){return(1-t)*r+t*e}function E3(r,e,t,n){return xp(r,e,1-Math.exp(-t*n))}function T3(r,e=1){return e-Math.abs(Ax(r,e*2)-e)}function M3(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*(3-2*r))}function C3(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*r*(r*(r*6-15)+10))}function A3(r,e){return r+Math.floor(Math.random()*(e-r+1))}function b3(r,e){return r+Math.random()*(e-r)}function P3(r){return r*(.5-Math.random())}function I3(r){r!==void 0&&(Cw=r);let e=Cw+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function R3(r){return r*Zc}function D3(r){return r*Np}function Hy(r){return(r&r-1)===0&&r!==0}function zM(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function FM(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function L3(r,e,t,n,i){const s=Math.cos,a=Math.sin,u=s(t/2),f=a(t/2),d=s((e+n)/2),m=a((e+n)/2),_=s((e-n)/2),y=a((e-n)/2),w=s((n-e)/2),T=a((n-e)/2);switch(i){case"XYX":r.set(u*m,f*_,f*y,u*d);break;case"YZY":r.set(f*y,u*m,f*_,u*d);break;case"ZXZ":r.set(f*_,f*y,u*m,u*d);break;case"XZX":r.set(u*m,f*T,f*w,u*d);break;case"YXY":r.set(f*w,u*m,f*T,u*d);break;case"ZYZ":r.set(f*T,f*w,u*m,u*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Ml(r,e){switch(e.constructor){case Float32Array:return r;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function Xn(r,e){switch(e.constructor){case Float32Array:return r;case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const O3={DEG2RAD:Zc,RAD2DEG:Np,generateUUID:no,clamp:Ni,euclideanModulo:Ax,mapLinear:w3,inverseLerp:S3,lerp:xp,damp:E3,pingpong:T3,smoothstep:M3,smootherstep:C3,randInt:A3,randFloat:b3,randFloatSpread:P3,seededRandom:I3,degToRad:R3,radToDeg:D3,isPowerOfTwo:Hy,ceilPowerOfTwo:zM,floorPowerOfTwo:FM,setQuaternionFromProperEuler:L3,normalize:Xn,denormalize:Ml};class ze{constructor(e=0,t=0){ze.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*n-a*i+e.x,this.y=s*i+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class zr{constructor(){zr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,i,s,a,u,f,d){const m=this.elements;return m[0]=e,m[1]=i,m[2]=u,m[3]=t,m[4]=s,m[5]=f,m[6]=n,m[7]=a,m[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,a=n[0],u=n[3],f=n[6],d=n[1],m=n[4],_=n[7],y=n[2],w=n[5],T=n[8],E=i[0],M=i[3],P=i[6],C=i[1],b=i[4],R=i[7],z=i[2],B=i[5],k=i[8];return s[0]=a*E+u*C+f*z,s[3]=a*M+u*b+f*B,s[6]=a*P+u*R+f*k,s[1]=d*E+m*C+_*z,s[4]=d*M+m*b+_*B,s[7]=d*P+m*R+_*k,s[2]=y*E+w*C+T*z,s[5]=y*M+w*b+T*B,s[8]=y*P+w*R+T*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],u=e[5],f=e[6],d=e[7],m=e[8];return t*a*m-t*u*d-n*s*m+n*u*f+i*s*d-i*a*f}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],u=e[5],f=e[6],d=e[7],m=e[8],_=m*a-u*d,y=u*f-m*s,w=d*s-a*f,T=t*_+n*y+i*w;if(T===0)return this.set(0,0,0,0,0,0,0,0,0);const E=1/T;return e[0]=_*E,e[1]=(i*d-m*n)*E,e[2]=(u*n-i*a)*E,e[3]=y*E,e[4]=(m*t-i*f)*E,e[5]=(i*s-u*t)*E,e[6]=w*E,e[7]=(n*f-d*t)*E,e[8]=(a*t-n*s)*E,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,s,a,u){const f=Math.cos(s),d=Math.sin(s);return this.set(n*f,n*d,-n*(f*a+d*u)+a+e,-i*d,i*f,-i*(-d*a+f*u)+u+t,0,0,1),this}scale(e,t){return this.premultiply(tv.makeScale(e,t)),this}rotate(e){return this.premultiply(tv.makeRotation(-e)),this}translate(e,t){return this.premultiply(tv.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const tv=new zr;function UM(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}const N3={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Of(r,e){return new N3[r](e)}function kp(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}class Ns{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,s,a,u){let f=n[i+0],d=n[i+1],m=n[i+2],_=n[i+3];const y=s[a+0],w=s[a+1],T=s[a+2],E=s[a+3];if(u===0){e[t+0]=f,e[t+1]=d,e[t+2]=m,e[t+3]=_;return}if(u===1){e[t+0]=y,e[t+1]=w,e[t+2]=T,e[t+3]=E;return}if(_!==E||f!==y||d!==w||m!==T){let M=1-u;const P=f*y+d*w+m*T+_*E,C=P>=0?1:-1,b=1-P*P;if(b>Number.EPSILON){const z=Math.sqrt(b),B=Math.atan2(z,P*C);M=Math.sin(M*B)/z,u=Math.sin(u*B)/z}const R=u*C;if(f=f*M+y*R,d=d*M+w*R,m=m*M+T*R,_=_*M+E*R,M===1-u){const z=1/Math.sqrt(f*f+d*d+m*m+_*_);f*=z,d*=z,m*=z,_*=z}}e[t]=f,e[t+1]=d,e[t+2]=m,e[t+3]=_}static multiplyQuaternionsFlat(e,t,n,i,s,a){const u=n[i],f=n[i+1],d=n[i+2],m=n[i+3],_=s[a],y=s[a+1],w=s[a+2],T=s[a+3];return e[t]=u*T+m*_+f*w-d*y,e[t+1]=f*T+m*y+d*_-u*w,e[t+2]=d*T+m*w+u*y-f*_,e[t+3]=m*T-u*_-f*y-d*w,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const n=e._x,i=e._y,s=e._z,a=e._order,u=Math.cos,f=Math.sin,d=u(n/2),m=u(i/2),_=u(s/2),y=f(n/2),w=f(i/2),T=f(s/2);switch(a){case"XYZ":this._x=y*m*_+d*w*T,this._y=d*w*_-y*m*T,this._z=d*m*T+y*w*_,this._w=d*m*_-y*w*T;break;case"YXZ":this._x=y*m*_+d*w*T,this._y=d*w*_-y*m*T,this._z=d*m*T-y*w*_,this._w=d*m*_+y*w*T;break;case"ZXY":this._x=y*m*_-d*w*T,this._y=d*w*_+y*m*T,this._z=d*m*T+y*w*_,this._w=d*m*_-y*w*T;break;case"ZYX":this._x=y*m*_-d*w*T,this._y=d*w*_+y*m*T,this._z=d*m*T-y*w*_,this._w=d*m*_+y*w*T;break;case"YZX":this._x=y*m*_+d*w*T,this._y=d*w*_+y*m*T,this._z=d*m*T-y*w*_,this._w=d*m*_-y*w*T;break;case"XZY":this._x=y*m*_-d*w*T,this._y=d*w*_-y*m*T,this._z=d*m*T+y*w*_,this._w=d*m*_+y*w*T;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],s=t[8],a=t[1],u=t[5],f=t[9],d=t[2],m=t[6],_=t[10],y=n+u+_;if(y>0){const w=.5/Math.sqrt(y+1);this._w=.25/w,this._x=(m-f)*w,this._y=(s-d)*w,this._z=(a-i)*w}else if(n>u&&n>_){const w=2*Math.sqrt(1+n-u-_);this._w=(m-f)/w,this._x=.25*w,this._y=(i+a)/w,this._z=(s+d)/w}else if(u>_){const w=2*Math.sqrt(1+u-n-_);this._w=(s-d)/w,this._x=(i+a)/w,this._y=.25*w,this._z=(f+m)/w}else{const w=2*Math.sqrt(1+_-n-u);this._w=(a-i)/w,this._x=(s+d)/w,this._y=(f+m)/w,this._z=.25*w}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ni(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,s=e._z,a=e._w,u=t._x,f=t._y,d=t._z,m=t._w;return this._x=n*m+a*u+i*d-s*f,this._y=i*m+a*f+s*u-n*d,this._z=s*m+a*d+n*f-i*u,this._w=a*m-n*u-i*f-s*d,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,s=this._z,a=this._w;let u=a*e._w+n*e._x+i*e._y+s*e._z;if(u<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,u=-u):this.copy(e),u>=1)return this._w=a,this._x=n,this._y=i,this._z=s,this;const f=1-u*u;if(f<=Number.EPSILON){const w=1-t;return this._w=w*a+t*this._w,this._x=w*n+t*this._x,this._y=w*i+t*this._y,this._z=w*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const d=Math.sqrt(f),m=Math.atan2(d,u),_=Math.sin((1-t)*m)/d,y=Math.sin(t*m)/d;return this._w=a*_+this._w*y,this._x=n*_+this._x*y,this._y=i*_+this._y*y,this._z=s*_+this._z*y,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),n*Math.sin(s),n*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Z{constructor(e=0,t=0,n=0){Z.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Aw.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Aw.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*i,this.y=s[1]*t+s[4]*n+s[7]*i,this.z=s[2]*t+s[5]*n+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*n+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*n+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*n+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,s=e.x,a=e.y,u=e.z,f=e.w,d=f*t+a*i-u*n,m=f*n+u*t-s*i,_=f*i+s*n-a*t,y=-s*t-a*n-u*i;return this.x=d*f+y*-s+m*-u-_*-a,this.y=m*f+y*-a+_*-s-d*-u,this.z=_*f+y*-u+d*-a-m*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i,this.y=s[1]*t+s[5]*n+s[9]*i,this.z=s[2]*t+s[6]*n+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,s=e.z,a=t.x,u=t.y,f=t.z;return this.x=i*f-s*u,this.y=s*a-n*f,this.z=n*u-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return nv.copy(this).projectOnVector(e),this.sub(nv)}reflect(e){return this.sub(nv.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ni(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const nv=new Z,Aw=new Ns;function Uf(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function iv(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}const k3=new zr().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),z3=new zr().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),Tu=new Z;function F3(r){return r.convertSRGBToLinear(),Tu.set(r.r,r.g,r.b).applyMatrix3(z3),r.setRGB(Tu.x,Tu.y,Tu.z)}function U3(r){return Tu.set(r.r,r.g,r.b).applyMatrix3(k3),r.setRGB(Tu.x,Tu.y,Tu.z).convertLinearToSRGB()}const B3={[Gf]:r=>r,[na]:r=>r.convertSRGBToLinear(),[Cx]:F3},V3={[Gf]:r=>r,[na]:r=>r.convertLinearToSRGB(),[Cx]:U3},$r={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(r){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!r},get workingColorSpace(){return Gf},set workingColorSpace(r){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(r,e,t){if(this.enabled===!1||e===t||!e||!t)return r;const n=B3[e],i=V3[t];if(n===void 0||i===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return i(n(r))},fromWorkingColorSpace:function(r,e){return this.convert(r,this.workingColorSpace,e)},toWorkingColorSpace:function(r,e){return this.convert(r,e,this.workingColorSpace)}};let of;class bx{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{of===void 0&&(of=kp("canvas")),of.width=e.width,of.height=e.height;const n=of.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=of}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=kp("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=Uf(s[a]/255)*255;return n.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Uf(t[n]/255)*255):t[n]=Uf(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class jc{constructor(e=null){this.isSource=!0,this.uuid=no(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,u=i.length;a<u;a++)i[a].isDataTexture?s.push(rv(i[a].image)):s.push(rv(i[a]))}else s=rv(i);n.url=s}return t||(e.images[this.uuid]=n),n}}function rv(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?bx.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let H3=0;class ki extends za{constructor(e=ki.DEFAULT_IMAGE,t=ki.DEFAULT_MAPPING,n=Kr,i=Kr,s=ai,a=Du,u=_s,f=Il,d=ki.DEFAULT_ANISOTROPY,m=Lu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:H3++}),this.uuid=no(),this.name="",this.source=new jc(e),this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=d,this.format=u,this.internalFormat=null,this.type=f,this.offset=new ze(0,0),this.repeat=new ze(1,1),this.center=new ze(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new zr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=m,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==X0)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Pp:e.x=e.x-Math.floor(e.x);break;case Kr:e.x=e.x<0?0:1;break;case Ip:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Pp:e.y=e.y-Math.floor(e.y);break;case Kr:e.y=e.y<0?0:1;break;case Ip:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}ki.DEFAULT_IMAGE=null;ki.DEFAULT_MAPPING=X0;ki.DEFAULT_ANISOTROPY=1;class Un{constructor(e=0,t=0,n=0,i=1){Un.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*n+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*n+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*n+a[11]*i+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,s;const f=e.elements,d=f[0],m=f[4],_=f[8],y=f[1],w=f[5],T=f[9],E=f[2],M=f[6],P=f[10];if(Math.abs(m-y)<.01&&Math.abs(_-E)<.01&&Math.abs(T-M)<.01){if(Math.abs(m+y)<.1&&Math.abs(_+E)<.1&&Math.abs(T+M)<.1&&Math.abs(d+w+P-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const b=(d+1)/2,R=(w+1)/2,z=(P+1)/2,B=(m+y)/4,k=(_+E)/4,I=(T+M)/4;return b>R&&b>z?b<.01?(n=0,i=.707106781,s=.707106781):(n=Math.sqrt(b),i=B/n,s=k/n):R>z?R<.01?(n=.707106781,i=0,s=.707106781):(i=Math.sqrt(R),n=B/i,s=I/i):z<.01?(n=.707106781,i=.707106781,s=0):(s=Math.sqrt(z),n=k/s,i=I/s),this.set(n,i,s,t),this}let C=Math.sqrt((M-T)*(M-T)+(_-E)*(_-E)+(y-m)*(y-m));return Math.abs(C)<.001&&(C=1),this.x=(M-T)/C,this.y=(_-E)/C,this.z=(y-m)/C,this.w=Math.acos((d+w+P-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ao extends za{constructor(e=1,t=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Un(0,0,e,t),this.scissorTest=!1,this.viewport=new Un(0,0,e,t);const i={width:e,height:t,depth:1};this.texture=new ki(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:ai,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new jc(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Y0 extends ki{constructor(e=null,t=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Oi,this.minFilter=Oi,this.wrapR=Kr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class G3 extends Ao{constructor(e=1,t=1,n=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Y0(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Px extends ki{constructor(e=null,t=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Oi,this.minFilter=Oi,this.wrapR=Kr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class W3 extends Ao{constructor(e=1,t=1,n=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Px(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class j3 extends Ao{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let a=0;a<n;a++)this.texture[a]=s.clone(),this.texture[a].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class ph{constructor(e=new Z(1/0,1/0,1/0),t=new Z(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,s=-1/0,a=-1/0,u=-1/0;for(let f=0,d=e.length;f<d;f+=3){const m=e[f],_=e[f+1],y=e[f+2];m<t&&(t=m),_<n&&(n=_),y<i&&(i=y),m>s&&(s=m),_>a&&(a=_),y>u&&(u=y)}return this.min.set(t,n,i),this.max.set(s,a,u),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,s=-1/0,a=-1/0,u=-1/0;for(let f=0,d=e.count;f<d;f++){const m=e.getX(f),_=e.getY(f),y=e.getZ(f);m<t&&(t=m),_<n&&(n=_),y<i&&(i=y),m>s&&(s=m),_>a&&(a=_),y>u&&(u=y)}return this.min.set(t,n,i),this.max.set(s,a,u),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=bc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0)if(t&&n.attributes!=null&&n.attributes.position!==void 0){const s=n.attributes.position;for(let a=0,u=s.count;a<u;a++)bc.fromBufferAttribute(s,a).applyMatrix4(e.matrixWorld),this.expandByPoint(bc)}else n.boundingBox===null&&n.computeBoundingBox(),sv.copy(n.boundingBox),sv.applyMatrix4(e.matrixWorld),this.union(sv);const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,bc),bc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Yd),hg.subVectors(this.max,Yd),af.subVectors(e.a,Yd),lf.subVectors(e.b,Yd),uf.subVectors(e.c,Yd),mu.subVectors(lf,af),gu.subVectors(uf,lf),Pc.subVectors(af,uf);let t=[0,-mu.z,mu.y,0,-gu.z,gu.y,0,-Pc.z,Pc.y,mu.z,0,-mu.x,gu.z,0,-gu.x,Pc.z,0,-Pc.x,-mu.y,mu.x,0,-gu.y,gu.x,0,-Pc.y,Pc.x,0];return!ov(t,af,lf,uf,hg)||(t=[1,0,0,0,1,0,0,0,1],!ov(t,af,lf,uf,hg))?!1:(fg.crossVectors(mu,gu),t=[fg.x,fg.y,fg.z],ov(t,af,lf,uf,hg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,bc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(bc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(_l[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),_l[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),_l[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),_l[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),_l[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),_l[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),_l[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),_l[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(_l),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const _l=[new Z,new Z,new Z,new Z,new Z,new Z,new Z,new Z],bc=new Z,sv=new ph,af=new Z,lf=new Z,uf=new Z,mu=new Z,gu=new Z,Pc=new Z,Yd=new Z,hg=new Z,fg=new Z,Ic=new Z;function ov(r,e,t,n,i){for(let s=0,a=r.length-3;s<=a;s+=3){Ic.fromArray(r,s);const u=i.x*Math.abs(Ic.x)+i.y*Math.abs(Ic.y)+i.z*Math.abs(Ic.z),f=e.dot(Ic),d=t.dot(Ic),m=n.dot(Ic);if(Math.max(-Math.max(f,d,m),Math.min(f,d,m))>u)return!1}return!0}const q3=new ph,Qd=new Z,av=new Z;class mh{constructor(e=new Z,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):q3.setFromPoints(e).getCenter(n);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Qd.subVectors(e,this.center);const t=Qd.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=(n-this.radius)*.5;this.center.addScaledVector(Qd,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(av.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Qd.copy(e.center).add(av)),this.expandByPoint(Qd.copy(e.center).sub(av))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const vl=new Z,lv=new Z,dg=new Z,_u=new Z,uv=new Z,pg=new Z,cv=new Z;class Jp{constructor(e=new Z,t=new Z(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,vl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=vl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(vl.copy(this.origin).addScaledVector(this.direction,t),vl.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){lv.copy(e).add(t).multiplyScalar(.5),dg.copy(t).sub(e).normalize(),_u.copy(this.origin).sub(lv);const s=e.distanceTo(t)*.5,a=-this.direction.dot(dg),u=_u.dot(this.direction),f=-_u.dot(dg),d=_u.lengthSq(),m=Math.abs(1-a*a);let _,y,w,T;if(m>0)if(_=a*f-u,y=a*u-f,T=s*m,_>=0)if(y>=-T)if(y<=T){const E=1/m;_*=E,y*=E,w=_*(_+a*y+2*u)+y*(a*_+y+2*f)+d}else y=s,_=Math.max(0,-(a*y+u)),w=-_*_+y*(y+2*f)+d;else y=-s,_=Math.max(0,-(a*y+u)),w=-_*_+y*(y+2*f)+d;else y<=-T?(_=Math.max(0,-(-a*s+u)),y=_>0?-s:Math.min(Math.max(-s,-f),s),w=-_*_+y*(y+2*f)+d):y<=T?(_=0,y=Math.min(Math.max(-s,-f),s),w=y*(y+2*f)+d):(_=Math.max(0,-(a*s+u)),y=_>0?s:Math.min(Math.max(-s,-f),s),w=-_*_+y*(y+2*f)+d);else y=a>0?-s:s,_=Math.max(0,-(a*y+u)),w=-_*_+y*(y+2*f)+d;return n&&n.copy(this.origin).addScaledVector(this.direction,_),i&&i.copy(lv).addScaledVector(dg,y),w}intersectSphere(e,t){vl.subVectors(e.center,this.origin);const n=vl.dot(this.direction),i=vl.dot(vl)-n*n,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),u=n-a,f=n+a;return f<0?null:u<0?this.at(f,t):this.at(u,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,s,a,u,f;const d=1/this.direction.x,m=1/this.direction.y,_=1/this.direction.z,y=this.origin;return d>=0?(n=(e.min.x-y.x)*d,i=(e.max.x-y.x)*d):(n=(e.max.x-y.x)*d,i=(e.min.x-y.x)*d),m>=0?(s=(e.min.y-y.y)*m,a=(e.max.y-y.y)*m):(s=(e.max.y-y.y)*m,a=(e.min.y-y.y)*m),n>a||s>i||((s>n||isNaN(n))&&(n=s),(a<i||isNaN(i))&&(i=a),_>=0?(u=(e.min.z-y.z)*_,f=(e.max.z-y.z)*_):(u=(e.max.z-y.z)*_,f=(e.min.z-y.z)*_),n>f||u>i)||((u>n||n!==n)&&(n=u),(f<i||i!==i)&&(i=f),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,vl)!==null}intersectTriangle(e,t,n,i,s){uv.subVectors(t,e),pg.subVectors(n,e),cv.crossVectors(uv,pg);let a=this.direction.dot(cv),u;if(a>0){if(i)return null;u=1}else if(a<0)u=-1,a=-a;else return null;_u.subVectors(this.origin,e);const f=u*this.direction.dot(pg.crossVectors(_u,pg));if(f<0)return null;const d=u*this.direction.dot(uv.cross(_u));if(d<0||f+d>a)return null;const m=-u*_u.dot(cv);return m<0?null:this.at(m/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Jt{constructor(){Jt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,i,s,a,u,f,d,m,_,y,w,T,E,M){const P=this.elements;return P[0]=e,P[4]=t,P[8]=n,P[12]=i,P[1]=s,P[5]=a,P[9]=u,P[13]=f,P[2]=d,P[6]=m,P[10]=_,P[14]=y,P[3]=w,P[7]=T,P[11]=E,P[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Jt().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/cf.setFromMatrixColumn(e,0).length(),s=1/cf.setFromMatrixColumn(e,1).length(),a=1/cf.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,s=e.z,a=Math.cos(n),u=Math.sin(n),f=Math.cos(i),d=Math.sin(i),m=Math.cos(s),_=Math.sin(s);if(e.order==="XYZ"){const y=a*m,w=a*_,T=u*m,E=u*_;t[0]=f*m,t[4]=-f*_,t[8]=d,t[1]=w+T*d,t[5]=y-E*d,t[9]=-u*f,t[2]=E-y*d,t[6]=T+w*d,t[10]=a*f}else if(e.order==="YXZ"){const y=f*m,w=f*_,T=d*m,E=d*_;t[0]=y+E*u,t[4]=T*u-w,t[8]=a*d,t[1]=a*_,t[5]=a*m,t[9]=-u,t[2]=w*u-T,t[6]=E+y*u,t[10]=a*f}else if(e.order==="ZXY"){const y=f*m,w=f*_,T=d*m,E=d*_;t[0]=y-E*u,t[4]=-a*_,t[8]=T+w*u,t[1]=w+T*u,t[5]=a*m,t[9]=E-y*u,t[2]=-a*d,t[6]=u,t[10]=a*f}else if(e.order==="ZYX"){const y=a*m,w=a*_,T=u*m,E=u*_;t[0]=f*m,t[4]=T*d-w,t[8]=y*d+E,t[1]=f*_,t[5]=E*d+y,t[9]=w*d-T,t[2]=-d,t[6]=u*f,t[10]=a*f}else if(e.order==="YZX"){const y=a*f,w=a*d,T=u*f,E=u*d;t[0]=f*m,t[4]=E-y*_,t[8]=T*_+w,t[1]=_,t[5]=a*m,t[9]=-u*m,t[2]=-d*m,t[6]=w*_+T,t[10]=y-E*_}else if(e.order==="XZY"){const y=a*f,w=a*d,T=u*f,E=u*d;t[0]=f*m,t[4]=-_,t[8]=d*m,t[1]=y*_+E,t[5]=a*m,t[9]=w*_-T,t[2]=T*_-w,t[6]=u*m,t[10]=E*_+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(X3,e,$3)}lookAt(e,t,n){const i=this.elements;return eo.subVectors(e,t),eo.lengthSq()===0&&(eo.z=1),eo.normalize(),vu.crossVectors(n,eo),vu.lengthSq()===0&&(Math.abs(n.z)===1?eo.x+=1e-4:eo.z+=1e-4,eo.normalize(),vu.crossVectors(n,eo)),vu.normalize(),mg.crossVectors(eo,vu),i[0]=vu.x,i[4]=mg.x,i[8]=eo.x,i[1]=vu.y,i[5]=mg.y,i[9]=eo.y,i[2]=vu.z,i[6]=mg.z,i[10]=eo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,a=n[0],u=n[4],f=n[8],d=n[12],m=n[1],_=n[5],y=n[9],w=n[13],T=n[2],E=n[6],M=n[10],P=n[14],C=n[3],b=n[7],R=n[11],z=n[15],B=i[0],k=i[4],I=i[8],N=i[12],V=i[1],W=i[5],q=i[9],H=i[13],re=i[2],de=i[6],ye=i[10],Ce=i[14],K=i[3],oe=i[7],ne=i[11],Q=i[15];return s[0]=a*B+u*V+f*re+d*K,s[4]=a*k+u*W+f*de+d*oe,s[8]=a*I+u*q+f*ye+d*ne,s[12]=a*N+u*H+f*Ce+d*Q,s[1]=m*B+_*V+y*re+w*K,s[5]=m*k+_*W+y*de+w*oe,s[9]=m*I+_*q+y*ye+w*ne,s[13]=m*N+_*H+y*Ce+w*Q,s[2]=T*B+E*V+M*re+P*K,s[6]=T*k+E*W+M*de+P*oe,s[10]=T*I+E*q+M*ye+P*ne,s[14]=T*N+E*H+M*Ce+P*Q,s[3]=C*B+b*V+R*re+z*K,s[7]=C*k+b*W+R*de+z*oe,s[11]=C*I+b*q+R*ye+z*ne,s[15]=C*N+b*H+R*Ce+z*Q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],s=e[12],a=e[1],u=e[5],f=e[9],d=e[13],m=e[2],_=e[6],y=e[10],w=e[14],T=e[3],E=e[7],M=e[11],P=e[15];return T*(+s*f*_-i*d*_-s*u*y+n*d*y+i*u*w-n*f*w)+E*(+t*f*w-t*d*y+s*a*y-i*a*w+i*d*m-s*f*m)+M*(+t*d*_-t*u*w-s*a*_+n*a*w+s*u*m-n*d*m)+P*(-i*u*m-t*f*_+t*u*y+i*a*_-n*a*y+n*f*m)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],u=e[5],f=e[6],d=e[7],m=e[8],_=e[9],y=e[10],w=e[11],T=e[12],E=e[13],M=e[14],P=e[15],C=_*M*d-E*y*d+E*f*w-u*M*w-_*f*P+u*y*P,b=T*y*d-m*M*d-T*f*w+a*M*w+m*f*P-a*y*P,R=m*E*d-T*_*d+T*u*w-a*E*w-m*u*P+a*_*P,z=T*_*f-m*E*f-T*u*y+a*E*y+m*u*M-a*_*M,B=t*C+n*b+i*R+s*z;if(B===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const k=1/B;return e[0]=C*k,e[1]=(E*y*s-_*M*s-E*i*w+n*M*w+_*i*P-n*y*P)*k,e[2]=(u*M*s-E*f*s+E*i*d-n*M*d-u*i*P+n*f*P)*k,e[3]=(_*f*s-u*y*s-_*i*d+n*y*d+u*i*w-n*f*w)*k,e[4]=b*k,e[5]=(m*M*s-T*y*s+T*i*w-t*M*w-m*i*P+t*y*P)*k,e[6]=(T*f*s-a*M*s-T*i*d+t*M*d+a*i*P-t*f*P)*k,e[7]=(a*y*s-m*f*s+m*i*d-t*y*d-a*i*w+t*f*w)*k,e[8]=R*k,e[9]=(T*_*s-m*E*s-T*n*w+t*E*w+m*n*P-t*_*P)*k,e[10]=(a*E*s-T*u*s+T*n*d-t*E*d-a*n*P+t*u*P)*k,e[11]=(m*u*s-a*_*s-m*n*d+t*_*d+a*n*w-t*u*w)*k,e[12]=z*k,e[13]=(m*E*i-T*_*i+T*n*y-t*E*y-m*n*M+t*_*M)*k,e[14]=(T*u*i-a*E*i-T*n*f+t*E*f+a*n*M-t*u*M)*k,e[15]=(a*_*i-m*u*i+m*n*f-t*_*f-a*n*y+t*u*y)*k,this}scale(e){const t=this.elements,n=e.x,i=e.y,s=e.z;return t[0]*=n,t[4]*=i,t[8]*=s,t[1]*=n,t[5]*=i,t[9]*=s,t[2]*=n,t[6]*=i,t[10]*=s,t[3]*=n,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),s=1-n,a=e.x,u=e.y,f=e.z,d=s*a,m=s*u;return this.set(d*a+n,d*u-i*f,d*f+i*u,0,d*u+i*f,m*u+n,m*f-i*a,0,d*f-i*u,m*f+i*a,s*f*f+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,s,a){return this.set(1,n,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,s=t._x,a=t._y,u=t._z,f=t._w,d=s+s,m=a+a,_=u+u,y=s*d,w=s*m,T=s*_,E=a*m,M=a*_,P=u*_,C=f*d,b=f*m,R=f*_,z=n.x,B=n.y,k=n.z;return i[0]=(1-(E+P))*z,i[1]=(w+R)*z,i[2]=(T-b)*z,i[3]=0,i[4]=(w-R)*B,i[5]=(1-(y+P))*B,i[6]=(M+C)*B,i[7]=0,i[8]=(T+b)*k,i[9]=(M-C)*k,i[10]=(1-(y+E))*k,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let s=cf.set(i[0],i[1],i[2]).length();const a=cf.set(i[4],i[5],i[6]).length(),u=cf.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],Zo.copy(this);const d=1/s,m=1/a,_=1/u;return Zo.elements[0]*=d,Zo.elements[1]*=d,Zo.elements[2]*=d,Zo.elements[4]*=m,Zo.elements[5]*=m,Zo.elements[6]*=m,Zo.elements[8]*=_,Zo.elements[9]*=_,Zo.elements[10]*=_,t.setFromRotationMatrix(Zo),n.x=s,n.y=a,n.z=u,this}makePerspective(e,t,n,i,s,a){const u=this.elements,f=2*s/(t-e),d=2*s/(n-i),m=(t+e)/(t-e),_=(n+i)/(n-i),y=-(a+s)/(a-s),w=-2*a*s/(a-s);return u[0]=f,u[4]=0,u[8]=m,u[12]=0,u[1]=0,u[5]=d,u[9]=_,u[13]=0,u[2]=0,u[6]=0,u[10]=y,u[14]=w,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,t,n,i,s,a){const u=this.elements,f=1/(t-e),d=1/(n-i),m=1/(a-s),_=(t+e)*f,y=(n+i)*d,w=(a+s)*m;return u[0]=2*f,u[4]=0,u[8]=0,u[12]=-_,u[1]=0,u[5]=2*d,u[9]=0,u[13]=-y,u[2]=0,u[6]=0,u[10]=-2*m,u[14]=-w,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const cf=new Z,Zo=new Jt,X3=new Z(0,0,0),$3=new Z(1,1,1),vu=new Z,mg=new Z,eo=new Z,bw=new Jt,Pw=new Ns;class em{constructor(e=0,t=0,n=0,i=em.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,s=i[0],a=i[4],u=i[8],f=i[1],d=i[5],m=i[9],_=i[2],y=i[6],w=i[10];switch(t){case"XYZ":this._y=Math.asin(Ni(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-m,w),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(y,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Ni(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(u,w),this._z=Math.atan2(f,d)):(this._y=Math.atan2(-_,s),this._z=0);break;case"ZXY":this._x=Math.asin(Ni(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-_,w),this._z=Math.atan2(-a,d)):(this._y=0,this._z=Math.atan2(f,s));break;case"ZYX":this._y=Math.asin(-Ni(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(y,w),this._z=Math.atan2(f,s)):(this._x=0,this._z=Math.atan2(-a,d));break;case"YZX":this._z=Math.asin(Ni(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-m,d),this._y=Math.atan2(-_,s)):(this._x=0,this._y=Math.atan2(u,w));break;case"XZY":this._z=Math.asin(-Ni(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(y,d),this._y=Math.atan2(u,s)):(this._x=Math.atan2(-m,w),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return bw.makeRotationFromQuaternion(e),this.setFromRotationMatrix(bw,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Pw.setFromEuler(this),this.setFromQuaternion(Pw,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}em.DEFAULT_ORDER="XYZ";class Jc{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Y3=0;const Iw=new Z,hf=new Ns,yl=new Jt,gg=new Z,Kd=new Z,Q3=new Z,K3=new Ns,Rw=new Z(1,0,0),Dw=new Z(0,1,0),Lw=new Z(0,0,1),Z3={type:"added"},Ow={type:"removed"};class In extends za{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Y3++}),this.uuid=no(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=In.DEFAULT_UP.clone();const e=new Z,t=new em,n=new Ns,i=new Z(1,1,1);function s(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Jt},normalMatrix:{value:new zr}}),this.matrix=new Jt,this.matrixWorld=new Jt,this.matrixAutoUpdate=In.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=In.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Jc,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return hf.setFromAxisAngle(e,t),this.quaternion.multiply(hf),this}rotateOnWorldAxis(e,t){return hf.setFromAxisAngle(e,t),this.quaternion.premultiply(hf),this}rotateX(e){return this.rotateOnAxis(Rw,e)}rotateY(e){return this.rotateOnAxis(Dw,e)}rotateZ(e){return this.rotateOnAxis(Lw,e)}translateOnAxis(e,t){return Iw.copy(e).applyQuaternion(this.quaternion),this.position.add(Iw.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Rw,e)}translateY(e){return this.translateOnAxis(Dw,e)}translateZ(e){return this.translateOnAxis(Lw,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(yl.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?gg.copy(e):gg.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Kd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?yl.lookAt(Kd,gg,this.up):yl.lookAt(gg,Kd,this.up),this.quaternion.setFromRotationMatrix(yl),i&&(yl.extractRotation(i.matrixWorld),hf.setFromRotationMatrix(yl),this.quaternion.premultiply(hf.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Z3)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ow)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Ow)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),yl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),yl.multiply(e.parent.matrixWorld)),e.applyMatrix4(yl),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t){let n=[];this[e]===t&&n.push(this);for(let i=0,s=this.children.length;i<s;i++){const a=this.children[i].getObjectsByProperty(e,t);a.length>0&&(n=n.concat(a))}return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kd,e,Q3),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kd,K3,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){const s=t[n];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++){const u=i[s];u.matrixWorldAutoUpdate===!0&&u.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function s(u,f){return u[f.uuid]===void 0&&(u[f.uuid]=f.toJSON(e)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const f=u.shapes;if(Array.isArray(f))for(let d=0,m=f.length;d<m;d++){const _=f[d];s(e.shapes,_)}else s(e.shapes,f)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let f=0,d=this.material.length;f<d;f++)u.push(s(e.materials,this.material[f]));i.material=u}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let u=0;u<this.children.length;u++)i.children.push(this.children[u].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let u=0;u<this.animations.length;u++){const f=this.animations[u];i.animations.push(s(e.animations,f))}}if(t){const u=a(e.geometries),f=a(e.materials),d=a(e.textures),m=a(e.images),_=a(e.shapes),y=a(e.skeletons),w=a(e.animations),T=a(e.nodes);u.length>0&&(n.geometries=u),f.length>0&&(n.materials=f),d.length>0&&(n.textures=d),m.length>0&&(n.images=m),_.length>0&&(n.shapes=_),y.length>0&&(n.skeletons=y),w.length>0&&(n.animations=w),T.length>0&&(n.nodes=T)}return n.object=i,n;function a(u){const f=[];for(const d in u){const m=u[d];delete m.metadata,f.push(m)}return f}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}In.DEFAULT_UP=new Z(0,1,0);In.DEFAULT_MATRIX_AUTO_UPDATE=!0;In.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Jo=new Z,xl=new Z,hv=new Z,wl=new Z,ff=new Z,df=new Z,Nw=new Z,fv=new Z,dv=new Z,pv=new Z;class To{constructor(e=new Z,t=new Z,n=new Z){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Jo.subVectors(e,t),i.cross(Jo);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,n,i,s){Jo.subVectors(i,t),xl.subVectors(n,t),hv.subVectors(e,t);const a=Jo.dot(Jo),u=Jo.dot(xl),f=Jo.dot(hv),d=xl.dot(xl),m=xl.dot(hv),_=a*d-u*u;if(_===0)return s.set(-2,-1,-1);const y=1/_,w=(d*f-u*m)*y,T=(a*m-u*f)*y;return s.set(1-w-T,T,w)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,wl),wl.x>=0&&wl.y>=0&&wl.x+wl.y<=1}static getUV(e,t,n,i,s,a,u,f){return this.getBarycoord(e,t,n,i,wl),f.set(0,0),f.addScaledVector(s,wl.x),f.addScaledVector(a,wl.y),f.addScaledVector(u,wl.z),f}static isFrontFacing(e,t,n,i){return Jo.subVectors(n,t),xl.subVectors(e,t),Jo.cross(xl).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Jo.subVectors(this.c,this.b),xl.subVectors(this.a,this.b),Jo.cross(xl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return To.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return To.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,s){return To.getUV(e,this.a,this.b,this.c,t,n,i,s)}containsPoint(e){return To.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return To.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,s=this.c;let a,u;ff.subVectors(i,n),df.subVectors(s,n),fv.subVectors(e,n);const f=ff.dot(fv),d=df.dot(fv);if(f<=0&&d<=0)return t.copy(n);dv.subVectors(e,i);const m=ff.dot(dv),_=df.dot(dv);if(m>=0&&_<=m)return t.copy(i);const y=f*_-m*d;if(y<=0&&f>=0&&m<=0)return a=f/(f-m),t.copy(n).addScaledVector(ff,a);pv.subVectors(e,s);const w=ff.dot(pv),T=df.dot(pv);if(T>=0&&w<=T)return t.copy(s);const E=w*d-f*T;if(E<=0&&d>=0&&T<=0)return u=d/(d-T),t.copy(n).addScaledVector(df,u);const M=m*T-w*_;if(M<=0&&_-m>=0&&w-T>=0)return Nw.subVectors(s,i),u=(_-m)/(_-m+(w-T)),t.copy(i).addScaledVector(Nw,u);const P=1/(M+E+y);return a=E*P,u=y*P,t.copy(n).addScaledVector(ff,a).addScaledVector(df,u)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let J3=0;class Zr extends za{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:J3++}),this.uuid=no(),this.name="",this.type="Material",this.blending=Qc,this.side=Pl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=xx,this.blendDst=wx,this.blendEquation=Bc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=x0,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=kM,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=d0,this.stencilZFail=d0,this.stencilZPass=d0,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Qc&&(n.blending=this.blending),this.side!==Pl&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(s){const a=[];for(const u in s){const f=s[u];delete f.metadata,a.push(f)}return a}if(t){const s=i(e.textures),a=i(e.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let s=0;s!==i;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const BM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ea={h:0,s:0,l:0},_g={h:0,s:0,l:0};function mv(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*6*(2/3-t):r}class dt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=na){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,$r.toWorkingColorSpace(this,t),this}setRGB(e,t,n,i=$r.workingColorSpace){return this.r=e,this.g=t,this.b=n,$r.toWorkingColorSpace(this,i),this}setHSL(e,t,n,i=$r.workingColorSpace){if(e=Ax(e,1),t=Ni(t,0,1),n=Ni(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,a=2*n-s;this.r=mv(a,s,e+1/3),this.g=mv(a,s,e),this.b=mv(a,s,e-1/3)}return $r.toWorkingColorSpace(this,i),this}setStyle(e,t=na){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],u=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,$r.toWorkingColorSpace(this,t),n(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,$r.toWorkingColorSpace(this,t),n(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u)){const f=parseFloat(s[1])/360,d=parseFloat(s[2])/100,m=parseFloat(s[3])/100;return n(s[4]),this.setHSL(f,d,m,t)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,$r.toWorkingColorSpace(this,t),this;if(a===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,$r.toWorkingColorSpace(this,t),this;console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=na){const n=BM[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Uf(e.r),this.g=Uf(e.g),this.b=Uf(e.b),this}copyLinearToSRGB(e){return this.r=iv(e.r),this.g=iv(e.g),this.b=iv(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=na){return $r.fromWorkingColorSpace(qr.copy(this),e),Ni(qr.r*255,0,255)<<16^Ni(qr.g*255,0,255)<<8^Ni(qr.b*255,0,255)<<0}getHexString(e=na){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=$r.workingColorSpace){$r.fromWorkingColorSpace(qr.copy(this),t);const n=qr.r,i=qr.g,s=qr.b,a=Math.max(n,i,s),u=Math.min(n,i,s);let f,d;const m=(u+a)/2;if(u===a)f=0,d=0;else{const _=a-u;switch(d=m<=.5?_/(a+u):_/(2-a-u),a){case n:f=(i-s)/_+(i<s?6:0);break;case i:f=(s-n)/_+2;break;case s:f=(n-i)/_+4;break}f/=6}return e.h=f,e.s=d,e.l=m,e}getRGB(e,t=$r.workingColorSpace){return $r.fromWorkingColorSpace(qr.copy(this),t),e.r=qr.r,e.g=qr.g,e.b=qr.b,e}getStyle(e=na){$r.fromWorkingColorSpace(qr.copy(this),e);const t=qr.r,n=qr.g,i=qr.b;return e!==na?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${t*255|0},${n*255|0},${i*255|0})`}offsetHSL(e,t,n){return this.getHSL(ea),ea.h+=e,ea.s+=t,ea.l+=n,this.setHSL(ea.h,ea.s,ea.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(ea),e.getHSL(_g);const n=xp(ea.h,_g.h,t),i=xp(ea.s,_g.s,t),s=xp(ea.l,_g.l,t);return this.setHSL(n,i,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const qr=new dt;dt.NAMES=BM;class Vu extends Zr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new dt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const qi=new Z,vg=new ze;class $n{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Op,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)vg.fromBufferAttribute(this,t),vg.applyMatrix3(e),this.setXY(t,vg.x,vg.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)qi.fromBufferAttribute(this,t),qi.applyMatrix3(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)qi.fromBufferAttribute(this,t),qi.applyMatrix4(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)qi.fromBufferAttribute(this,t),qi.applyNormalMatrix(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)qi.fromBufferAttribute(this,t),qi.transformDirection(e),this.setXYZ(t,qi.x,qi.y,qi.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ml(t,this.array)),t}setX(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ml(t,this.array)),t}setY(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ml(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ml(t,this.array)),t}setW(e,t){return this.normalized&&(t=Xn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),i=Xn(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e*=this.itemSize,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),i=Xn(i,this.array),s=Xn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Op&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class eP extends $n{constructor(e,t,n){super(new Int8Array(e),t,n)}}class tP extends $n{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class nP extends $n{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class iP extends $n{constructor(e,t,n){super(new Int16Array(e),t,n)}}class Ix extends $n{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class rP extends $n{constructor(e,t,n){super(new Int32Array(e),t,n)}}class Rx extends $n{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class sP extends $n{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}}class pt extends $n{constructor(e,t,n){super(new Float32Array(e),t,n)}}class oP extends $n{constructor(e,t,n){super(new Float64Array(e),t,n)}}let aP=0;const wo=new Jt,gv=new In,pf=new Z,to=new ph,Zd=new ph,_r=new Z;class en extends za{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:aP++}),this.uuid=no(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(UM(e)?Rx:Ix)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new zr().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return wo.makeRotationFromQuaternion(e),this.applyMatrix4(wo),this}rotateX(e){return wo.makeRotationX(e),this.applyMatrix4(wo),this}rotateY(e){return wo.makeRotationY(e),this.applyMatrix4(wo),this}rotateZ(e){return wo.makeRotationZ(e),this.applyMatrix4(wo),this}translate(e,t,n){return wo.makeTranslation(e,t,n),this.applyMatrix4(wo),this}scale(e,t,n){return wo.makeScale(e,t,n),this.applyMatrix4(wo),this}lookAt(e){return gv.lookAt(e),gv.updateMatrix(),this.applyMatrix4(gv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(pf).negate(),this.translate(pf.x,pf.y,pf.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new pt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ph);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Z(-1/0,-1/0,-1/0),new Z(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const s=t[n];to.setFromBufferAttribute(s),this.morphTargetsRelative?(_r.addVectors(this.boundingBox.min,to.min),this.boundingBox.expandByPoint(_r),_r.addVectors(this.boundingBox.max,to.max),this.boundingBox.expandByPoint(_r)):(this.boundingBox.expandByPoint(to.min),this.boundingBox.expandByPoint(to.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new mh);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Z,1/0);return}if(e){const n=this.boundingSphere.center;if(to.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const u=t[s];Zd.setFromBufferAttribute(u),this.morphTargetsRelative?(_r.addVectors(to.min,Zd.min),to.expandByPoint(_r),_r.addVectors(to.max,Zd.max),to.expandByPoint(_r)):(to.expandByPoint(Zd.min),to.expandByPoint(Zd.max))}to.getCenter(n);let i=0;for(let s=0,a=e.count;s<a;s++)_r.fromBufferAttribute(e,s),i=Math.max(i,n.distanceToSquared(_r));if(t)for(let s=0,a=t.length;s<a;s++){const u=t[s],f=this.morphTargetsRelative;for(let d=0,m=u.count;d<m;d++)_r.fromBufferAttribute(u,d),f&&(pf.fromBufferAttribute(e,d),_r.add(pf)),i=Math.max(i,n.distanceToSquared(_r))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=e.array,i=t.position.array,s=t.normal.array,a=t.uv.array,u=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new $n(new Float32Array(4*u),4));const f=this.getAttribute("tangent").array,d=[],m=[];for(let V=0;V<u;V++)d[V]=new Z,m[V]=new Z;const _=new Z,y=new Z,w=new Z,T=new ze,E=new ze,M=new ze,P=new Z,C=new Z;function b(V,W,q){_.fromArray(i,V*3),y.fromArray(i,W*3),w.fromArray(i,q*3),T.fromArray(a,V*2),E.fromArray(a,W*2),M.fromArray(a,q*2),y.sub(_),w.sub(_),E.sub(T),M.sub(T);const H=1/(E.x*M.y-M.x*E.y);isFinite(H)&&(P.copy(y).multiplyScalar(M.y).addScaledVector(w,-E.y).multiplyScalar(H),C.copy(w).multiplyScalar(E.x).addScaledVector(y,-M.x).multiplyScalar(H),d[V].add(P),d[W].add(P),d[q].add(P),m[V].add(C),m[W].add(C),m[q].add(C))}let R=this.groups;R.length===0&&(R=[{start:0,count:n.length}]);for(let V=0,W=R.length;V<W;++V){const q=R[V],H=q.start,re=q.count;for(let de=H,ye=H+re;de<ye;de+=3)b(n[de+0],n[de+1],n[de+2])}const z=new Z,B=new Z,k=new Z,I=new Z;function N(V){k.fromArray(s,V*3),I.copy(k);const W=d[V];z.copy(W),z.sub(k.multiplyScalar(k.dot(W))).normalize(),B.crossVectors(I,W);const H=B.dot(m[V])<0?-1:1;f[V*4]=z.x,f[V*4+1]=z.y,f[V*4+2]=z.z,f[V*4+3]=H}for(let V=0,W=R.length;V<W;++V){const q=R[V],H=q.start,re=q.count;for(let de=H,ye=H+re;de<ye;de+=3)N(n[de+0]),N(n[de+1]),N(n[de+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new $n(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let y=0,w=n.count;y<w;y++)n.setXYZ(y,0,0,0);const i=new Z,s=new Z,a=new Z,u=new Z,f=new Z,d=new Z,m=new Z,_=new Z;if(e)for(let y=0,w=e.count;y<w;y+=3){const T=e.getX(y+0),E=e.getX(y+1),M=e.getX(y+2);i.fromBufferAttribute(t,T),s.fromBufferAttribute(t,E),a.fromBufferAttribute(t,M),m.subVectors(a,s),_.subVectors(i,s),m.cross(_),u.fromBufferAttribute(n,T),f.fromBufferAttribute(n,E),d.fromBufferAttribute(n,M),u.add(m),f.add(m),d.add(m),n.setXYZ(T,u.x,u.y,u.z),n.setXYZ(E,f.x,f.y,f.z),n.setXYZ(M,d.x,d.y,d.z)}else for(let y=0,w=t.count;y<w;y+=3)i.fromBufferAttribute(t,y+0),s.fromBufferAttribute(t,y+1),a.fromBufferAttribute(t,y+2),m.subVectors(a,s),_.subVectors(i,s),m.cross(_),n.setXYZ(y+0,m.x,m.y,m.z),n.setXYZ(y+1,m.x,m.y,m.z),n.setXYZ(y+2,m.x,m.y,m.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)_r.fromBufferAttribute(e,t),_r.normalize(),e.setXYZ(t,_r.x,_r.y,_r.z)}toNonIndexed(){function e(u,f){const d=u.array,m=u.itemSize,_=u.normalized,y=new d.constructor(f.length*m);let w=0,T=0;for(let E=0,M=f.length;E<M;E++){u.isInterleavedBufferAttribute?w=f[E]*u.data.stride+u.offset:w=f[E]*m;for(let P=0;P<m;P++)y[T++]=d[w++]}return new $n(y,m,_)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new en,n=this.index.array,i=this.attributes;for(const u in i){const f=i[u],d=e(f,n);t.setAttribute(u,d)}const s=this.morphAttributes;for(const u in s){const f=[],d=s[u];for(let m=0,_=d.length;m<_;m++){const y=d[m],w=e(y,n);f.push(w)}t.morphAttributes[u]=f}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let u=0,f=a.length;u<f;u++){const d=a[u];t.addGroup(d.start,d.count,d.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const d in f)f[d]!==void 0&&(e[d]=f[d]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const f in n){const d=n[f];e.data.attributes[f]=d.toJSON(e.data)}const i={};let s=!1;for(const f in this.morphAttributes){const d=this.morphAttributes[f],m=[];for(let _=0,y=d.length;_<y;_++){const w=d[_];m.push(w.toJSON(e.data))}m.length>0&&(i[f]=m,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const u=this.boundingSphere;return u!==null&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const i=e.attributes;for(const d in i){const m=i[d];this.setAttribute(d,m.clone(t))}const s=e.morphAttributes;for(const d in s){const m=[],_=s[d];for(let y=0,w=_.length;y<w;y++)m.push(_[y].clone(t));this.morphAttributes[d]=m}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let d=0,m=a.length;d<m;d++){const _=a[d];this.addGroup(_.start,_.count,_.materialIndex)}const u=e.boundingBox;u!==null&&(this.boundingBox=u.clone());const f=e.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const kw=new Jt,Aa=new Jp,yg=new mh,zw=new Z,Jd=new Z,ep=new Z,tp=new Z,_v=new Z,xg=new Z,wg=new ze,Sg=new ze,Eg=new ze,vv=new Z,Tg=new Z;class rr extends In{constructor(e=new en,t=new Vu){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const u=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,s=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const u=this.morphTargetInfluences;if(s&&u){xg.set(0,0,0);for(let f=0,d=s.length;f<d;f++){const m=u[f],_=s[f];m!==0&&(_v.fromBufferAttribute(_,e),a?xg.addScaledVector(_v,m):xg.addScaledVector(_v.sub(t),m))}t.add(xg)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const n=this.geometry,i=this.material,s=this.matrixWorld;if(i===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),yg.copy(n.boundingSphere),yg.applyMatrix4(s),Aa.copy(e.ray).recast(e.near),yg.containsPoint(Aa.origin)===!1&&(Aa.intersectSphere(yg,zw)===null||Aa.origin.distanceToSquared(zw)>(e.far-e.near)**2))||(kw.copy(s).invert(),Aa.copy(e.ray).applyMatrix4(kw),n.boundingBox!==null&&Aa.intersectsBox(n.boundingBox)===!1))return;let a;const u=n.index,f=n.attributes.position,d=n.attributes.uv,m=n.attributes.uv2,_=n.groups,y=n.drawRange;if(u!==null)if(Array.isArray(i))for(let w=0,T=_.length;w<T;w++){const E=_[w],M=i[E.materialIndex],P=Math.max(E.start,y.start),C=Math.min(u.count,Math.min(E.start+E.count,y.start+y.count));for(let b=P,R=C;b<R;b+=3){const z=u.getX(b),B=u.getX(b+1),k=u.getX(b+2);a=Mg(this,M,e,Aa,d,m,z,B,k),a&&(a.faceIndex=Math.floor(b/3),a.face.materialIndex=E.materialIndex,t.push(a))}}else{const w=Math.max(0,y.start),T=Math.min(u.count,y.start+y.count);for(let E=w,M=T;E<M;E+=3){const P=u.getX(E),C=u.getX(E+1),b=u.getX(E+2);a=Mg(this,i,e,Aa,d,m,P,C,b),a&&(a.faceIndex=Math.floor(E/3),t.push(a))}}else if(f!==void 0)if(Array.isArray(i))for(let w=0,T=_.length;w<T;w++){const E=_[w],M=i[E.materialIndex],P=Math.max(E.start,y.start),C=Math.min(f.count,Math.min(E.start+E.count,y.start+y.count));for(let b=P,R=C;b<R;b+=3){const z=b,B=b+1,k=b+2;a=Mg(this,M,e,Aa,d,m,z,B,k),a&&(a.faceIndex=Math.floor(b/3),a.face.materialIndex=E.materialIndex,t.push(a))}}else{const w=Math.max(0,y.start),T=Math.min(f.count,y.start+y.count);for(let E=w,M=T;E<M;E+=3){const P=E,C=E+1,b=E+2;a=Mg(this,i,e,Aa,d,m,P,C,b),a&&(a.faceIndex=Math.floor(E/3),t.push(a))}}}}function lP(r,e,t,n,i,s,a,u){let f;if(e.side===Os?f=n.intersectTriangle(a,s,i,!0,u):f=n.intersectTriangle(i,s,a,e.side===Pl,u),f===null)return null;Tg.copy(u),Tg.applyMatrix4(r.matrixWorld);const d=t.ray.origin.distanceTo(Tg);return d<t.near||d>t.far?null:{distance:d,point:Tg.clone(),object:r}}function Mg(r,e,t,n,i,s,a,u,f){r.getVertexPosition(a,Jd),r.getVertexPosition(u,ep),r.getVertexPosition(f,tp);const d=lP(r,e,t,n,Jd,ep,tp,vv);if(d){i&&(wg.fromBufferAttribute(i,a),Sg.fromBufferAttribute(i,u),Eg.fromBufferAttribute(i,f),d.uv=To.getUV(vv,Jd,ep,tp,wg,Sg,Eg,new ze)),s&&(wg.fromBufferAttribute(s,a),Sg.fromBufferAttribute(s,u),Eg.fromBufferAttribute(s,f),d.uv2=To.getUV(vv,Jd,ep,tp,wg,Sg,Eg,new ze));const m={a,b:u,c:f,normal:new Z,materialIndex:0};To.getNormal(Jd,ep,tp,m.normal),d.face=m}return d}class Hu extends en{constructor(e=1,t=1,n=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:s,depthSegments:a};const u=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const f=[],d=[],m=[],_=[];let y=0,w=0;T("z","y","x",-1,-1,n,t,e,a,s,0),T("z","y","x",1,-1,n,t,-e,a,s,1),T("x","z","y",1,1,e,n,t,i,a,2),T("x","z","y",1,-1,e,n,-t,i,a,3),T("x","y","z",1,-1,e,t,n,i,s,4),T("x","y","z",-1,-1,e,t,-n,i,s,5),this.setIndex(f),this.setAttribute("position",new pt(d,3)),this.setAttribute("normal",new pt(m,3)),this.setAttribute("uv",new pt(_,2));function T(E,M,P,C,b,R,z,B,k,I,N){const V=R/k,W=z/I,q=R/2,H=z/2,re=B/2,de=k+1,ye=I+1;let Ce=0,K=0;const oe=new Z;for(let ne=0;ne<ye;ne++){const Q=ne*W-H;for(let $=0;$<de;$++){const he=$*V-q;oe[E]=he*C,oe[M]=Q*b,oe[P]=re,d.push(oe.x,oe.y,oe.z),oe[E]=0,oe[M]=0,oe[P]=B>0?1:-1,m.push(oe.x,oe.y,oe.z),_.push($/k),_.push(1-ne/I),Ce+=1}}for(let ne=0;ne<I;ne++)for(let Q=0;Q<k;Q++){const $=y+Q+de*ne,he=y+Q+de*(ne+1),Ae=y+(Q+1)+de*(ne+1),se=y+(Q+1)+de*ne;f.push($,he,se),f.push(he,Ae,se),K+=6}u.addGroup(w,K,N),w+=K,y+=Ce}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hu(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Wf(r){const e={};for(const t in r){e[t]={};for(const n in r[t]){const i=r[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function gs(r){const e={};for(let t=0;t<r.length;t++){const n=Wf(r[t]);for(const i in n)e[i]=n[i]}return e}function uP(r){const e=[];for(let t=0;t<r.length;t++)e.push(r[t].clone());return e}function VM(r){return r.getRenderTarget()===null&&r.outputEncoding===ti?na:Gf}const tm={clone:Wf,merge:gs};var cP=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,hP=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ro extends Zr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=cP,this.fragmentShader=hP,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Wf(e.uniforms),this.uniformsGroups=uP(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?t.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[i]={type:"m4",value:a.toArray()}:t.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class nm extends In{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Jt,this.projectionMatrix=new Jt,this.projectionMatrixInverse=new Jt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class yr extends nm{constructor(e=50,t=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Np*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Zc*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Np*2*Math.atan(Math.tan(Zc*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Zc*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const f=a.fullWidth,d=a.fullHeight;s+=a.offsetX*i/f,t-=a.offsetY*n/d,i*=a.width/f,n*=a.height/d}const u=this.filmOffset;u!==0&&(s+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const mf=-90,gf=1;class HM extends In{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;const i=new yr(mf,gf,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);const s=new yr(mf,gf,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const a=new yr(mf,gf,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(0,1,0),this.add(a);const u=new yr(mf,gf,e,t);u.layers=this.layers,u.up.set(0,0,1),u.lookAt(0,-1,0),this.add(u);const f=new yr(mf,gf,e,t);f.layers=this.layers,f.up.set(0,1,0),f.lookAt(0,0,1),this.add(f);const d=new yr(mf,gf,e,t);d.layers=this.layers,d.up.set(0,1,0),d.lookAt(0,0,-1),this.add(d)}update(e,t){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget,[i,s,a,u,f,d]=this.children,m=e.getRenderTarget(),_=e.toneMapping,y=e.xr.enabled;e.toneMapping=aa,e.xr.enabled=!1;const w=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,u),e.setRenderTarget(n,4),e.render(t,f),n.texture.generateMipmaps=w,e.setRenderTarget(n,5),e.render(t,d),e.setRenderTarget(m),e.toneMapping=_,e.xr.enabled=y,n.texture.needsPMREMUpdate=!0}}class im extends ki{constructor(e,t,n,i,s,a,u,f,d,m){e=e!==void 0?e:[],t=t!==void 0?t:Iu,super(e,t,n,i,s,a,u,f,d,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class GM extends Ao{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new im(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:ai}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Hu(5,5,5),s=new ro({name:"CubemapFromEquirect",uniforms:Wf(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Os,blending:Cl});s.uniforms.tEquirect.value=t;const a=new rr(i,s),u=t.minFilter;return t.minFilter===Du&&(t.minFilter=ai),new HM(1,10,this).update(e,a),t.minFilter=u,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,i){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,i);e.setRenderTarget(s)}}const yv=new Z,fP=new Z,dP=new zr;class Su{constructor(e=new Z(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=yv.subVectors(n,t).cross(fP.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(yv),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||dP.getNormalMatrix(e),i=this.coplanarPoint(yv).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _f=new mh,Cg=new Z;class Q0{constructor(e=new Su,t=new Su,n=new Su,i=new Su,s=new Su,a=new Su){this.planes=[e,t,n,i,s,a]}set(e,t,n,i,s,a){const u=this.planes;return u[0].copy(e),u[1].copy(t),u[2].copy(n),u[3].copy(i),u[4].copy(s),u[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,i=n[0],s=n[1],a=n[2],u=n[3],f=n[4],d=n[5],m=n[6],_=n[7],y=n[8],w=n[9],T=n[10],E=n[11],M=n[12],P=n[13],C=n[14],b=n[15];return t[0].setComponents(u-i,_-f,E-y,b-M).normalize(),t[1].setComponents(u+i,_+f,E+y,b+M).normalize(),t[2].setComponents(u+s,_+d,E+w,b+P).normalize(),t[3].setComponents(u-s,_-d,E-w,b-P).normalize(),t[4].setComponents(u-a,_-m,E-T,b-C).normalize(),t[5].setComponents(u+a,_+m,E+T,b+C).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),_f.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(_f)}intersectsSprite(e){return _f.center.set(0,0,0),_f.radius=.7071067811865476,_f.applyMatrix4(e.matrixWorld),this.intersectsSphere(_f)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(Cg.x=i.normal.x>0?e.max.x:e.min.x,Cg.y=i.normal.y>0?e.max.y:e.min.y,Cg.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Cg)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WM(){let r=null,e=!1,t=null,n=null;function i(s,a){t(s,a),n=r.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=r.requestAnimationFrame(i),e=!0)},stop:function(){r.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){r=s}}}function pP(r,e){const t=e.isWebGL2,n=new WeakMap;function i(d,m){const _=d.array,y=d.usage,w=r.createBuffer();r.bindBuffer(m,w),r.bufferData(m,_,y),d.onUploadCallback();let T;if(_ instanceof Float32Array)T=5126;else if(_ instanceof Uint16Array)if(d.isFloat16BufferAttribute)if(t)T=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else T=5123;else if(_ instanceof Int16Array)T=5122;else if(_ instanceof Uint32Array)T=5125;else if(_ instanceof Int32Array)T=5124;else if(_ instanceof Int8Array)T=5120;else if(_ instanceof Uint8Array)T=5121;else if(_ instanceof Uint8ClampedArray)T=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+_);return{buffer:w,type:T,bytesPerElement:_.BYTES_PER_ELEMENT,version:d.version}}function s(d,m,_){const y=m.array,w=m.updateRange;r.bindBuffer(_,d),w.count===-1?r.bufferSubData(_,0,y):(t?r.bufferSubData(_,w.offset*y.BYTES_PER_ELEMENT,y,w.offset,w.count):r.bufferSubData(_,w.offset*y.BYTES_PER_ELEMENT,y.subarray(w.offset,w.offset+w.count)),w.count=-1),m.onUploadCallback()}function a(d){return d.isInterleavedBufferAttribute&&(d=d.data),n.get(d)}function u(d){d.isInterleavedBufferAttribute&&(d=d.data);const m=n.get(d);m&&(r.deleteBuffer(m.buffer),n.delete(d))}function f(d,m){if(d.isGLBufferAttribute){const y=n.get(d);(!y||y.version<d.version)&&n.set(d,{buffer:d.buffer,type:d.type,bytesPerElement:d.elementSize,version:d.version});return}d.isInterleavedBufferAttribute&&(d=d.data);const _=n.get(d);_===void 0?n.set(d,i(d,m)):_.version<d.version&&(s(_.buffer,d,m),_.version=d.version)}return{get:a,remove:u,update:f}}class Jf extends en{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const s=e/2,a=t/2,u=Math.floor(n),f=Math.floor(i),d=u+1,m=f+1,_=e/u,y=t/f,w=[],T=[],E=[],M=[];for(let P=0;P<m;P++){const C=P*y-a;for(let b=0;b<d;b++){const R=b*_-s;T.push(R,-C,0),E.push(0,0,1),M.push(b/u),M.push(1-P/f)}}for(let P=0;P<f;P++)for(let C=0;C<u;C++){const b=C+d*P,R=C+d*(P+1),z=C+1+d*(P+1),B=C+1+d*P;w.push(b,R,B),w.push(R,z,B)}this.setIndex(w),this.setAttribute("position",new pt(T,3)),this.setAttribute("normal",new pt(E,3)),this.setAttribute("uv",new pt(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jf(e.width,e.height,e.widthSegments,e.heightSegments)}}var mP=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,gP=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,_P=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,vP=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,yP=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,xP=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,wP="vec3 transformed = vec3( position );",SP=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,EP=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,TP=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,MP=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,CP=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,AP=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,bP=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,PP=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,IP=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,RP=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,DP=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,LP=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,OP=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,NP=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,kP=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,zP=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,FP=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,UP=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,BP=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,VP="gl_FragColor = linearToOutputTexel( gl_FragColor );",HP=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,GP=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,WP=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,jP=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,qP=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,XP=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,$P=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,YP=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,QP=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,KP=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,ZP=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,JP=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,eI=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,tI=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,nI=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,iI=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,rI=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,sI=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,oI=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,aI=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lI=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,uI=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,cI=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,hI=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,fI=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,dI=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,pI=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,mI=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,gI=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,_I=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,vI=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,yI=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,xI=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,wI=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,SI=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,EI=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,TI=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,MI=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,CI=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,AI=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,bI=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,PI=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,II=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,RI=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,DI=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,LI=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,OI=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,NI=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,kI=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,zI=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,FI=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,UI=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,BI=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,VI=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,HI=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,GI=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,WI=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,jI=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,qI=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,XI=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,$I=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,YI=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,QI=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,KI=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,ZI=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,JI=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,eR=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,tR=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,nR=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,iR=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,rR=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,sR=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		
		vec2 lodFudge = pow( 1.95, lod ) / fullSize;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec2 fullSize = vec2( textureSize( sampler, 0 ) );
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,oR=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,aR=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,lR=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uR=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,cR=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,hR=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,fR=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const dR=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,pR=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,mR=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,gR=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,_R=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,vR=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,yR=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,xR=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,wR=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,SR=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,ER=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,TR=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,MR=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,CR=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,AR=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,bR=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,PR=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,IR=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,RR=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,DR=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,LR=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,OR=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,NR=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kR=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zR=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,FR=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,UR=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,BR=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,VR=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,HR=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,GR=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,WR=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,jR=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,qR=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Xt={alphamap_fragment:mP,alphamap_pars_fragment:gP,alphatest_fragment:_P,alphatest_pars_fragment:vP,aomap_fragment:yP,aomap_pars_fragment:xP,begin_vertex:wP,beginnormal_vertex:SP,bsdfs:EP,iridescence_fragment:TP,bumpmap_pars_fragment:MP,clipping_planes_fragment:CP,clipping_planes_pars_fragment:AP,clipping_planes_pars_vertex:bP,clipping_planes_vertex:PP,color_fragment:IP,color_pars_fragment:RP,color_pars_vertex:DP,color_vertex:LP,common:OP,cube_uv_reflection_fragment:NP,defaultnormal_vertex:kP,displacementmap_pars_vertex:zP,displacementmap_vertex:FP,emissivemap_fragment:UP,emissivemap_pars_fragment:BP,encodings_fragment:VP,encodings_pars_fragment:HP,envmap_fragment:GP,envmap_common_pars_fragment:WP,envmap_pars_fragment:jP,envmap_pars_vertex:qP,envmap_physical_pars_fragment:rI,envmap_vertex:XP,fog_vertex:$P,fog_pars_vertex:YP,fog_fragment:QP,fog_pars_fragment:KP,gradientmap_pars_fragment:ZP,lightmap_fragment:JP,lightmap_pars_fragment:eI,lights_lambert_fragment:tI,lights_lambert_pars_fragment:nI,lights_pars_begin:iI,lights_toon_fragment:sI,lights_toon_pars_fragment:oI,lights_phong_fragment:aI,lights_phong_pars_fragment:lI,lights_physical_fragment:uI,lights_physical_pars_fragment:cI,lights_fragment_begin:hI,lights_fragment_maps:fI,lights_fragment_end:dI,logdepthbuf_fragment:pI,logdepthbuf_pars_fragment:mI,logdepthbuf_pars_vertex:gI,logdepthbuf_vertex:_I,map_fragment:vI,map_pars_fragment:yI,map_particle_fragment:xI,map_particle_pars_fragment:wI,metalnessmap_fragment:SI,metalnessmap_pars_fragment:EI,morphcolor_vertex:TI,morphnormal_vertex:MI,morphtarget_pars_vertex:CI,morphtarget_vertex:AI,normal_fragment_begin:bI,normal_fragment_maps:PI,normal_pars_fragment:II,normal_pars_vertex:RI,normal_vertex:DI,normalmap_pars_fragment:LI,clearcoat_normal_fragment_begin:OI,clearcoat_normal_fragment_maps:NI,clearcoat_pars_fragment:kI,iridescence_pars_fragment:zI,output_fragment:FI,packing:UI,premultiplied_alpha_fragment:BI,project_vertex:VI,dithering_fragment:HI,dithering_pars_fragment:GI,roughnessmap_fragment:WI,roughnessmap_pars_fragment:jI,shadowmap_pars_fragment:qI,shadowmap_pars_vertex:XI,shadowmap_vertex:$I,shadowmask_pars_fragment:YI,skinbase_vertex:QI,skinning_pars_vertex:KI,skinning_vertex:ZI,skinnormal_vertex:JI,specularmap_fragment:eR,specularmap_pars_fragment:tR,tonemapping_fragment:nR,tonemapping_pars_fragment:iR,transmission_fragment:rR,transmission_pars_fragment:sR,uv_pars_fragment:oR,uv_pars_vertex:aR,uv_vertex:lR,uv2_pars_fragment:uR,uv2_pars_vertex:cR,uv2_vertex:hR,worldpos_vertex:fR,background_vert:dR,background_frag:pR,backgroundCube_vert:mR,backgroundCube_frag:gR,cube_vert:_R,cube_frag:vR,depth_vert:yR,depth_frag:xR,distanceRGBA_vert:wR,distanceRGBA_frag:SR,equirect_vert:ER,equirect_frag:TR,linedashed_vert:MR,linedashed_frag:CR,meshbasic_vert:AR,meshbasic_frag:bR,meshlambert_vert:PR,meshlambert_frag:IR,meshmatcap_vert:RR,meshmatcap_frag:DR,meshnormal_vert:LR,meshnormal_frag:OR,meshphong_vert:NR,meshphong_frag:kR,meshphysical_vert:zR,meshphysical_frag:FR,meshtoon_vert:UR,meshtoon_frag:BR,points_vert:VR,points_frag:HR,shadow_vert:GR,shadow_frag:WR,sprite_vert:jR,sprite_frag:qR},nt={common:{diffuse:{value:new dt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new zr},uv2Transform:{value:new zr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ze(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new dt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new dt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new zr}},sprite:{diffuse:{value:new dt(16777215)},opacity:{value:1},center:{value:new ze(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new zr}}},ia={basic:{uniforms:gs([nt.common,nt.specularmap,nt.envmap,nt.aomap,nt.lightmap,nt.fog]),vertexShader:Xt.meshbasic_vert,fragmentShader:Xt.meshbasic_frag},lambert:{uniforms:gs([nt.common,nt.specularmap,nt.envmap,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.fog,nt.lights,{emissive:{value:new dt(0)}}]),vertexShader:Xt.meshlambert_vert,fragmentShader:Xt.meshlambert_frag},phong:{uniforms:gs([nt.common,nt.specularmap,nt.envmap,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.fog,nt.lights,{emissive:{value:new dt(0)},specular:{value:new dt(1118481)},shininess:{value:30}}]),vertexShader:Xt.meshphong_vert,fragmentShader:Xt.meshphong_frag},standard:{uniforms:gs([nt.common,nt.envmap,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.roughnessmap,nt.metalnessmap,nt.fog,nt.lights,{emissive:{value:new dt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Xt.meshphysical_vert,fragmentShader:Xt.meshphysical_frag},toon:{uniforms:gs([nt.common,nt.aomap,nt.lightmap,nt.emissivemap,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.gradientmap,nt.fog,nt.lights,{emissive:{value:new dt(0)}}]),vertexShader:Xt.meshtoon_vert,fragmentShader:Xt.meshtoon_frag},matcap:{uniforms:gs([nt.common,nt.bumpmap,nt.normalmap,nt.displacementmap,nt.fog,{matcap:{value:null}}]),vertexShader:Xt.meshmatcap_vert,fragmentShader:Xt.meshmatcap_frag},points:{uniforms:gs([nt.points,nt.fog]),vertexShader:Xt.points_vert,fragmentShader:Xt.points_frag},dashed:{uniforms:gs([nt.common,nt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Xt.linedashed_vert,fragmentShader:Xt.linedashed_frag},depth:{uniforms:gs([nt.common,nt.displacementmap]),vertexShader:Xt.depth_vert,fragmentShader:Xt.depth_frag},normal:{uniforms:gs([nt.common,nt.bumpmap,nt.normalmap,nt.displacementmap,{opacity:{value:1}}]),vertexShader:Xt.meshnormal_vert,fragmentShader:Xt.meshnormal_frag},sprite:{uniforms:gs([nt.sprite,nt.fog]),vertexShader:Xt.sprite_vert,fragmentShader:Xt.sprite_frag},background:{uniforms:{uvTransform:{value:new zr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Xt.background_vert,fragmentShader:Xt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Xt.backgroundCube_vert,fragmentShader:Xt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Xt.cube_vert,fragmentShader:Xt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Xt.equirect_vert,fragmentShader:Xt.equirect_frag},distanceRGBA:{uniforms:gs([nt.common,nt.displacementmap,{referencePosition:{value:new Z},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Xt.distanceRGBA_vert,fragmentShader:Xt.distanceRGBA_frag},shadow:{uniforms:gs([nt.lights,nt.fog,{color:{value:new dt(0)},opacity:{value:1}}]),vertexShader:Xt.shadow_vert,fragmentShader:Xt.shadow_frag}};ia.physical={uniforms:gs([ia.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ze(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new dt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ze},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new dt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new dt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Xt.meshphysical_vert,fragmentShader:Xt.meshphysical_frag};const Ag={r:0,b:0,g:0};function XR(r,e,t,n,i,s,a){const u=new dt(0);let f=s===!0?0:1,d,m,_=null,y=0,w=null;function T(M,P){let C=!1,b=P.isScene===!0?P.background:null;b&&b.isTexture&&(b=(P.backgroundBlurriness>0?t:e).get(b));const R=r.xr,z=R.getSession&&R.getSession();z&&z.environmentBlendMode==="additive"&&(b=null),b===null?E(u,f):b&&b.isColor&&(E(b,1),C=!0),(r.autoClear||C)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),b&&(b.isCubeTexture||b.mapping===Zf)?(m===void 0&&(m=new rr(new Hu(1,1,1),new ro({name:"BackgroundCubeMaterial",uniforms:Wf(ia.backgroundCube.uniforms),vertexShader:ia.backgroundCube.vertexShader,fragmentShader:ia.backgroundCube.fragmentShader,side:Os,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(B,k,I){this.matrixWorld.copyPosition(I.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(m)),m.material.uniforms.envMap.value=b,m.material.uniforms.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=P.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=P.backgroundIntensity,m.material.toneMapped=b.encoding!==ti,(_!==b||y!==b.version||w!==r.toneMapping)&&(m.material.needsUpdate=!0,_=b,y=b.version,w=r.toneMapping),m.layers.enableAll(),M.unshift(m,m.geometry,m.material,0,0,null)):b&&b.isTexture&&(d===void 0&&(d=new rr(new Jf(2,2),new ro({name:"BackgroundMaterial",uniforms:Wf(ia.background.uniforms),vertexShader:ia.background.vertexShader,fragmentShader:ia.background.fragmentShader,side:Pl,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(d)),d.material.uniforms.t2D.value=b,d.material.uniforms.backgroundIntensity.value=P.backgroundIntensity,d.material.toneMapped=b.encoding!==ti,b.matrixAutoUpdate===!0&&b.updateMatrix(),d.material.uniforms.uvTransform.value.copy(b.matrix),(_!==b||y!==b.version||w!==r.toneMapping)&&(d.material.needsUpdate=!0,_=b,y=b.version,w=r.toneMapping),d.layers.enableAll(),M.unshift(d,d.geometry,d.material,0,0,null))}function E(M,P){M.getRGB(Ag,VM(r)),n.buffers.color.setClear(Ag.r,Ag.g,Ag.b,P,a)}return{getClearColor:function(){return u},setClearColor:function(M,P=1){u.set(M),f=P,E(u,f)},getClearAlpha:function(){return f},setClearAlpha:function(M){f=M,E(u,f)},render:T}}function $R(r,e,t,n){const i=r.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),a=n.isWebGL2||s!==null,u={},f=M(null);let d=f,m=!1;function _(re,de,ye,Ce,K){let oe=!1;if(a){const ne=E(Ce,ye,de);d!==ne&&(d=ne,w(d.object)),oe=P(re,Ce,ye,K),oe&&C(re,Ce,ye,K)}else{const ne=de.wireframe===!0;(d.geometry!==Ce.id||d.program!==ye.id||d.wireframe!==ne)&&(d.geometry=Ce.id,d.program=ye.id,d.wireframe=ne,oe=!0)}K!==null&&t.update(K,34963),(oe||m)&&(m=!1,I(re,de,ye,Ce),K!==null&&r.bindBuffer(34963,t.get(K).buffer))}function y(){return n.isWebGL2?r.createVertexArray():s.createVertexArrayOES()}function w(re){return n.isWebGL2?r.bindVertexArray(re):s.bindVertexArrayOES(re)}function T(re){return n.isWebGL2?r.deleteVertexArray(re):s.deleteVertexArrayOES(re)}function E(re,de,ye){const Ce=ye.wireframe===!0;let K=u[re.id];K===void 0&&(K={},u[re.id]=K);let oe=K[de.id];oe===void 0&&(oe={},K[de.id]=oe);let ne=oe[Ce];return ne===void 0&&(ne=M(y()),oe[Ce]=ne),ne}function M(re){const de=[],ye=[],Ce=[];for(let K=0;K<i;K++)de[K]=0,ye[K]=0,Ce[K]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:de,enabledAttributes:ye,attributeDivisors:Ce,object:re,attributes:{},index:null}}function P(re,de,ye,Ce){const K=d.attributes,oe=de.attributes;let ne=0;const Q=ye.getAttributes();for(const $ in Q)if(Q[$].location>=0){const Ae=K[$];let se=oe[$];if(se===void 0&&($==="instanceMatrix"&&re.instanceMatrix&&(se=re.instanceMatrix),$==="instanceColor"&&re.instanceColor&&(se=re.instanceColor)),Ae===void 0||Ae.attribute!==se||se&&Ae.data!==se.data)return!0;ne++}return d.attributesNum!==ne||d.index!==Ce}function C(re,de,ye,Ce){const K={},oe=de.attributes;let ne=0;const Q=ye.getAttributes();for(const $ in Q)if(Q[$].location>=0){let Ae=oe[$];Ae===void 0&&($==="instanceMatrix"&&re.instanceMatrix&&(Ae=re.instanceMatrix),$==="instanceColor"&&re.instanceColor&&(Ae=re.instanceColor));const se={};se.attribute=Ae,Ae&&Ae.data&&(se.data=Ae.data),K[$]=se,ne++}d.attributes=K,d.attributesNum=ne,d.index=Ce}function b(){const re=d.newAttributes;for(let de=0,ye=re.length;de<ye;de++)re[de]=0}function R(re){z(re,0)}function z(re,de){const ye=d.newAttributes,Ce=d.enabledAttributes,K=d.attributeDivisors;ye[re]=1,Ce[re]===0&&(r.enableVertexAttribArray(re),Ce[re]=1),K[re]!==de&&((n.isWebGL2?r:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](re,de),K[re]=de)}function B(){const re=d.newAttributes,de=d.enabledAttributes;for(let ye=0,Ce=de.length;ye<Ce;ye++)de[ye]!==re[ye]&&(r.disableVertexAttribArray(ye),de[ye]=0)}function k(re,de,ye,Ce,K,oe){n.isWebGL2===!0&&(ye===5124||ye===5125)?r.vertexAttribIPointer(re,de,ye,K,oe):r.vertexAttribPointer(re,de,ye,Ce,K,oe)}function I(re,de,ye,Ce){if(n.isWebGL2===!1&&(re.isInstancedMesh||Ce.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;b();const K=Ce.attributes,oe=ye.getAttributes(),ne=de.defaultAttributeValues;for(const Q in oe){const $=oe[Q];if($.location>=0){let he=K[Q];if(he===void 0&&(Q==="instanceMatrix"&&re.instanceMatrix&&(he=re.instanceMatrix),Q==="instanceColor"&&re.instanceColor&&(he=re.instanceColor)),he!==void 0){const Ae=he.normalized,se=he.itemSize,Ne=t.get(he);if(Ne===void 0)continue;const Oe=Ne.buffer,He=Ne.type,Xe=Ne.bytesPerElement;if(he.isInterleavedBufferAttribute){const Je=he.data,ut=Je.stride,De=he.offset;if(Je.isInstancedInterleavedBuffer){for(let Le=0;Le<$.locationSize;Le++)z($.location+Le,Je.meshPerAttribute);re.isInstancedMesh!==!0&&Ce._maxInstanceCount===void 0&&(Ce._maxInstanceCount=Je.meshPerAttribute*Je.count)}else for(let Le=0;Le<$.locationSize;Le++)R($.location+Le);r.bindBuffer(34962,Oe);for(let Le=0;Le<$.locationSize;Le++)k($.location+Le,se/$.locationSize,He,Ae,ut*Xe,(De+se/$.locationSize*Le)*Xe)}else{if(he.isInstancedBufferAttribute){for(let Je=0;Je<$.locationSize;Je++)z($.location+Je,he.meshPerAttribute);re.isInstancedMesh!==!0&&Ce._maxInstanceCount===void 0&&(Ce._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let Je=0;Je<$.locationSize;Je++)R($.location+Je);r.bindBuffer(34962,Oe);for(let Je=0;Je<$.locationSize;Je++)k($.location+Je,se/$.locationSize,He,Ae,se*Xe,se/$.locationSize*Je*Xe)}}else if(ne!==void 0){const Ae=ne[Q];if(Ae!==void 0)switch(Ae.length){case 2:r.vertexAttrib2fv($.location,Ae);break;case 3:r.vertexAttrib3fv($.location,Ae);break;case 4:r.vertexAttrib4fv($.location,Ae);break;default:r.vertexAttrib1fv($.location,Ae)}}}}B()}function N(){q();for(const re in u){const de=u[re];for(const ye in de){const Ce=de[ye];for(const K in Ce)T(Ce[K].object),delete Ce[K];delete de[ye]}delete u[re]}}function V(re){if(u[re.id]===void 0)return;const de=u[re.id];for(const ye in de){const Ce=de[ye];for(const K in Ce)T(Ce[K].object),delete Ce[K];delete de[ye]}delete u[re.id]}function W(re){for(const de in u){const ye=u[de];if(ye[re.id]===void 0)continue;const Ce=ye[re.id];for(const K in Ce)T(Ce[K].object),delete Ce[K];delete ye[re.id]}}function q(){H(),m=!0,d!==f&&(d=f,w(d.object))}function H(){f.geometry=null,f.program=null,f.wireframe=!1}return{setup:_,reset:q,resetDefaultState:H,dispose:N,releaseStatesOfGeometry:V,releaseStatesOfProgram:W,initAttributes:b,enableAttribute:R,disableUnusedAttributes:B}}function YR(r,e,t,n){const i=n.isWebGL2;let s;function a(d){s=d}function u(d,m){r.drawArrays(s,d,m),t.update(m,s,1)}function f(d,m,_){if(_===0)return;let y,w;if(i)y=r,w="drawArraysInstanced";else if(y=e.get("ANGLE_instanced_arrays"),w="drawArraysInstancedANGLE",y===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[w](s,d,m,_),t.update(m,s,_)}this.setMode=a,this.render=u,this.renderInstances=f}function QR(r,e,t){let n;function i(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const k=e.get("EXT_texture_filter_anisotropic");n=r.getParameter(k.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(k){if(k==="highp"){if(r.getShaderPrecisionFormat(35633,36338).precision>0&&r.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";k="mediump"}return k==="mediump"&&r.getShaderPrecisionFormat(35633,36337).precision>0&&r.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const a=typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext;let u=t.precision!==void 0?t.precision:"highp";const f=s(u);f!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",f,"instead."),u=f);const d=a||e.has("WEBGL_draw_buffers"),m=t.logarithmicDepthBuffer===!0,_=r.getParameter(34930),y=r.getParameter(35660),w=r.getParameter(3379),T=r.getParameter(34076),E=r.getParameter(34921),M=r.getParameter(36347),P=r.getParameter(36348),C=r.getParameter(36349),b=y>0,R=a||e.has("OES_texture_float"),z=b&&R,B=a?r.getParameter(36183):0;return{isWebGL2:a,drawBuffers:d,getMaxAnisotropy:i,getMaxPrecision:s,precision:u,logarithmicDepthBuffer:m,maxTextures:_,maxVertexTextures:y,maxTextureSize:w,maxCubemapSize:T,maxAttributes:E,maxVertexUniforms:M,maxVaryings:P,maxFragmentUniforms:C,vertexTextures:b,floatFragmentTextures:R,floatVertexTextures:z,maxSamples:B}}function KR(r){const e=this;let t=null,n=0,i=!1,s=!1;const a=new Su,u=new zr,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(_,y){const w=_.length!==0||y||n!==0||i;return i=y,n=_.length,w},this.beginShadows=function(){s=!0,m(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(_,y){t=m(_,y,0)},this.setState=function(_,y,w){const T=_.clippingPlanes,E=_.clipIntersection,M=_.clipShadows,P=r.get(_);if(!i||T===null||T.length===0||s&&!M)s?m(null):d();else{const C=s?0:n,b=C*4;let R=P.clippingState||null;f.value=R,R=m(T,y,b,w);for(let z=0;z!==b;++z)R[z]=t[z];P.clippingState=R,this.numIntersection=E?this.numPlanes:0,this.numPlanes+=C}};function d(){f.value!==t&&(f.value=t,f.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function m(_,y,w,T){const E=_!==null?_.length:0;let M=null;if(E!==0){if(M=f.value,T!==!0||M===null){const P=w+E*4,C=y.matrixWorldInverse;u.getNormalMatrix(C),(M===null||M.length<P)&&(M=new Float32Array(P));for(let b=0,R=w;b!==E;++b,R+=4)a.copy(_[b]).applyMatrix4(C,u),a.normal.toArray(M,R),M[R+3]=a.constant}f.value=M,f.needsUpdate=!0}return e.numPlanes=E,e.numIntersection=0,M}}function ZR(r){let e=new WeakMap;function t(a,u){return u===Hf?a.mapping=Iu:u===bp&&(a.mapping=Ru),a}function n(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){const u=a.mapping;if(u===Hf||u===bp)if(e.has(a)){const f=e.get(a).texture;return t(f,a.mapping)}else{const f=a.image;if(f&&f.height>0){const d=new GM(f.height/2);return d.fromEquirectangularTexture(r,a),e.set(a,d),a.addEventListener("dispose",i),t(d.texture,a.mapping)}else return null}}return a}function i(a){const u=a.target;u.removeEventListener("dispose",i);const f=e.get(u);f!==void 0&&(e.delete(u),f.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}class Gu extends nm{constructor(e=-1,t=1,n=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=n-e,a=n+e,u=i+t,f=i-t;if(this.view!==null&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=d*this.view.offsetX,a=s+d*this.view.width,u-=m*this.view.offsetY,f=u-m*this.view.height}this.projectionMatrix.makeOrthographic(s,a,u,f,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Nf=4,Fw=[.125,.215,.35,.446,.526,.582],Vc=20,xv=new Gu,Uw=new dt;let wv=null;const Fc=(1+Math.sqrt(5))/2,vf=1/Fc,Bw=[new Z(1,1,1),new Z(-1,1,1),new Z(1,1,-1),new Z(-1,1,-1),new Z(0,Fc,vf),new Z(0,Fc,-vf),new Z(vf,0,Fc),new Z(-vf,0,Fc),new Z(Fc,vf,0),new Z(-Fc,vf,0)];class Gy{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){wv=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Gw(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Hw(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(wv),e.scissorTest=!1,bg(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Iu||e.mapping===Ru?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),wv=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:ai,minFilter:ai,generateMipmaps:!1,type:Da,format:_s,encoding:Lu,depthBuffer:!1},i=Vw(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Vw(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=JR(s)),this._blurMaterial=eD(s,e,t)}return i}_compileMaterial(e){const t=new rr(this._lodPlanes[0],e);this._renderer.compile(t,xv)}_sceneToCubeUV(e,t,n,i){const u=new yr(90,1,t,n),f=[1,-1,1,1,1,1],d=[1,1,1,-1,-1,-1],m=this._renderer,_=m.autoClear,y=m.toneMapping;m.getClearColor(Uw),m.toneMapping=aa,m.autoClear=!1;const w=new Vu({name:"PMREM.Background",side:Os,depthWrite:!1,depthTest:!1}),T=new rr(new Hu,w);let E=!1;const M=e.background;M?M.isColor&&(w.color.copy(M),e.background=null,E=!0):(w.color.copy(Uw),E=!0);for(let P=0;P<6;P++){const C=P%3;C===0?(u.up.set(0,f[P],0),u.lookAt(d[P],0,0)):C===1?(u.up.set(0,0,f[P]),u.lookAt(0,d[P],0)):(u.up.set(0,f[P],0),u.lookAt(0,0,d[P]));const b=this._cubeSize;bg(i,C*b,P>2?b:0,b,b),m.setRenderTarget(i),E&&m.render(T,u),m.render(e,u)}T.geometry.dispose(),T.material.dispose(),m.toneMapping=y,m.autoClear=_,e.background=M}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===Iu||e.mapping===Ru;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=Gw()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Hw());const s=i?this._cubemapMaterial:this._equirectMaterial,a=new rr(this._lodPlanes[0],s),u=s.uniforms;u.envMap.value=e;const f=this._cubeSize;bg(t,0,0,3*f,2*f),n.setRenderTarget(t),n.render(a,xv)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),a=Bw[(i-1)%Bw.length];this._blur(e,i-1,i,s,a)}t.autoClear=n}_blur(e,t,n,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,i,"latitudinal",s),this._halfBlur(a,e,n,n,i,"longitudinal",s)}_halfBlur(e,t,n,i,s,a,u){const f=this._renderer,d=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const m=3,_=new rr(this._lodPlanes[i],d),y=d.uniforms,w=this._sizeLods[n]-1,T=isFinite(s)?Math.PI/(2*w):2*Math.PI/(2*Vc-1),E=s/T,M=isFinite(s)?1+Math.floor(m*E):Vc;M>Vc&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${M} samples when the maximum is set to ${Vc}`);const P=[];let C=0;for(let k=0;k<Vc;++k){const I=k/E,N=Math.exp(-I*I/2);P.push(N),k===0?C+=N:k<M&&(C+=2*N)}for(let k=0;k<P.length;k++)P[k]=P[k]/C;y.envMap.value=e.texture,y.samples.value=M,y.weights.value=P,y.latitudinal.value=a==="latitudinal",u&&(y.poleAxis.value=u);const{_lodMax:b}=this;y.dTheta.value=T,y.mipInt.value=b-n;const R=this._sizeLods[i],z=3*R*(i>b-Nf?i-b+Nf:0),B=4*(this._cubeSize-R);bg(t,z,B,3*R,2*R),f.setRenderTarget(t),f.render(_,xv)}}function JR(r){const e=[],t=[],n=[];let i=r;const s=r-Nf+1+Fw.length;for(let a=0;a<s;a++){const u=Math.pow(2,i);t.push(u);let f=1/u;a>r-Nf?f=Fw[a-r+Nf-1]:a===0&&(f=0),n.push(f);const d=1/(u-2),m=-d,_=1+d,y=[m,m,_,m,_,_,m,m,_,_,m,_],w=6,T=6,E=3,M=2,P=1,C=new Float32Array(E*T*w),b=new Float32Array(M*T*w),R=new Float32Array(P*T*w);for(let B=0;B<w;B++){const k=B%3*2/3-1,I=B>2?0:-1,N=[k,I,0,k+2/3,I,0,k+2/3,I+1,0,k,I,0,k+2/3,I+1,0,k,I+1,0];C.set(N,E*T*B),b.set(y,M*T*B);const V=[B,B,B,B,B,B];R.set(V,P*T*B)}const z=new en;z.setAttribute("position",new $n(C,E)),z.setAttribute("uv",new $n(b,M)),z.setAttribute("faceIndex",new $n(R,P)),e.push(z),i>Nf&&i--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function Vw(r,e,t){const n=new Ao(r,e,t);return n.texture.mapping=Zf,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function bg(r,e,t,n,i){r.viewport.set(e,t,n,i),r.scissor.set(e,t,n,i)}function eD(r,e,t){const n=new Float32Array(Vc),i=new Z(0,1,0);return new ro({name:"SphericalGaussianBlur",defines:{n:Vc,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${r}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Dx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Cl,depthTest:!1,depthWrite:!1})}function Hw(){return new ro({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Dx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Cl,depthTest:!1,depthWrite:!1})}function Gw(){return new ro({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Dx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Cl,depthTest:!1,depthWrite:!1})}function Dx(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function tD(r){let e=new WeakMap,t=null;function n(u){if(u&&u.isTexture){const f=u.mapping,d=f===Hf||f===bp,m=f===Iu||f===Ru;if(d||m)if(u.isRenderTargetTexture&&u.needsPMREMUpdate===!0){u.needsPMREMUpdate=!1;let _=e.get(u);return t===null&&(t=new Gy(r)),_=d?t.fromEquirectangular(u,_):t.fromCubemap(u,_),e.set(u,_),_.texture}else{if(e.has(u))return e.get(u).texture;{const _=u.image;if(d&&_&&_.height>0||m&&_&&i(_)){t===null&&(t=new Gy(r));const y=d?t.fromEquirectangular(u):t.fromCubemap(u);return e.set(u,y),u.addEventListener("dispose",s),y.texture}else return null}}}return u}function i(u){let f=0;const d=6;for(let m=0;m<d;m++)u[m]!==void 0&&f++;return f===d}function s(u){const f=u.target;f.removeEventListener("dispose",s);const d=e.get(f);d!==void 0&&(e.delete(f),d.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:a}}function nD(r){const e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=r.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const i=t(n);return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function iD(r,e,t,n){const i={},s=new WeakMap;function a(_){const y=_.target;y.index!==null&&e.remove(y.index);for(const T in y.attributes)e.remove(y.attributes[T]);y.removeEventListener("dispose",a),delete i[y.id];const w=s.get(y);w&&(e.remove(w),s.delete(y)),n.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,t.memory.geometries--}function u(_,y){return i[y.id]===!0||(y.addEventListener("dispose",a),i[y.id]=!0,t.memory.geometries++),y}function f(_){const y=_.attributes;for(const T in y)e.update(y[T],34962);const w=_.morphAttributes;for(const T in w){const E=w[T];for(let M=0,P=E.length;M<P;M++)e.update(E[M],34962)}}function d(_){const y=[],w=_.index,T=_.attributes.position;let E=0;if(w!==null){const C=w.array;E=w.version;for(let b=0,R=C.length;b<R;b+=3){const z=C[b+0],B=C[b+1],k=C[b+2];y.push(z,B,B,k,k,z)}}else{const C=T.array;E=T.version;for(let b=0,R=C.length/3-1;b<R;b+=3){const z=b+0,B=b+1,k=b+2;y.push(z,B,B,k,k,z)}}const M=new(UM(y)?Rx:Ix)(y,1);M.version=E;const P=s.get(_);P&&e.remove(P),s.set(_,M)}function m(_){const y=s.get(_);if(y){const w=_.index;w!==null&&y.version<w.version&&d(_)}else d(_);return s.get(_)}return{get:u,update:f,getWireframeAttribute:m}}function rD(r,e,t,n){const i=n.isWebGL2;let s;function a(y){s=y}let u,f;function d(y){u=y.type,f=y.bytesPerElement}function m(y,w){r.drawElements(s,w,u,y*f),t.update(w,s,1)}function _(y,w,T){if(T===0)return;let E,M;if(i)E=r,M="drawElementsInstanced";else if(E=e.get("ANGLE_instanced_arrays"),M="drawElementsInstancedANGLE",E===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}E[M](s,w,u,y*f,T),t.update(w,s,T)}this.setMode=a,this.setIndex=d,this.render=m,this.renderInstances=_}function sD(r){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,a,u){switch(t.calls++,a){case 4:t.triangles+=u*(s/3);break;case 1:t.lines+=u*(s/2);break;case 3:t.lines+=u*(s-1);break;case 2:t.lines+=u*s;break;case 0:t.points+=u*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function i(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:n}}function oD(r,e){return r[0]-e[0]}function aD(r,e){return Math.abs(e[1])-Math.abs(r[1])}function lD(r,e,t){const n={},i=new Float32Array(8),s=new WeakMap,a=new Un,u=[];for(let d=0;d<8;d++)u[d]=[d,0];function f(d,m,_){const y=d.morphTargetInfluences;if(e.isWebGL2===!0){const T=m.morphAttributes.position||m.morphAttributes.normal||m.morphAttributes.color,E=T!==void 0?T.length:0;let M=s.get(m);if(M===void 0||M.count!==E){let de=function(){H.dispose(),s.delete(m),m.removeEventListener("dispose",de)};var w=de;M!==void 0&&M.texture.dispose();const b=m.morphAttributes.position!==void 0,R=m.morphAttributes.normal!==void 0,z=m.morphAttributes.color!==void 0,B=m.morphAttributes.position||[],k=m.morphAttributes.normal||[],I=m.morphAttributes.color||[];let N=0;b===!0&&(N=1),R===!0&&(N=2),z===!0&&(N=3);let V=m.attributes.position.count*N,W=1;V>e.maxTextureSize&&(W=Math.ceil(V/e.maxTextureSize),V=e.maxTextureSize);const q=new Float32Array(V*W*4*E),H=new Y0(q,V,W,E);H.type=Co,H.needsUpdate=!0;const re=N*4;for(let ye=0;ye<E;ye++){const Ce=B[ye],K=k[ye],oe=I[ye],ne=V*W*4*ye;for(let Q=0;Q<Ce.count;Q++){const $=Q*re;b===!0&&(a.fromBufferAttribute(Ce,Q),q[ne+$+0]=a.x,q[ne+$+1]=a.y,q[ne+$+2]=a.z,q[ne+$+3]=0),R===!0&&(a.fromBufferAttribute(K,Q),q[ne+$+4]=a.x,q[ne+$+5]=a.y,q[ne+$+6]=a.z,q[ne+$+7]=0),z===!0&&(a.fromBufferAttribute(oe,Q),q[ne+$+8]=a.x,q[ne+$+9]=a.y,q[ne+$+10]=a.z,q[ne+$+11]=oe.itemSize===4?a.w:1)}}M={count:E,texture:H,size:new ze(V,W)},s.set(m,M),m.addEventListener("dispose",de)}let P=0;for(let b=0;b<y.length;b++)P+=y[b];const C=m.morphTargetsRelative?1:1-P;_.getUniforms().setValue(r,"morphTargetBaseInfluence",C),_.getUniforms().setValue(r,"morphTargetInfluences",y),_.getUniforms().setValue(r,"morphTargetsTexture",M.texture,t),_.getUniforms().setValue(r,"morphTargetsTextureSize",M.size)}else{const T=y===void 0?0:y.length;let E=n[m.id];if(E===void 0||E.length!==T){E=[];for(let R=0;R<T;R++)E[R]=[R,0];n[m.id]=E}for(let R=0;R<T;R++){const z=E[R];z[0]=R,z[1]=y[R]}E.sort(aD);for(let R=0;R<8;R++)R<T&&E[R][1]?(u[R][0]=E[R][0],u[R][1]=E[R][1]):(u[R][0]=Number.MAX_SAFE_INTEGER,u[R][1]=0);u.sort(oD);const M=m.morphAttributes.position,P=m.morphAttributes.normal;let C=0;for(let R=0;R<8;R++){const z=u[R],B=z[0],k=z[1];B!==Number.MAX_SAFE_INTEGER&&k?(M&&m.getAttribute("morphTarget"+R)!==M[B]&&m.setAttribute("morphTarget"+R,M[B]),P&&m.getAttribute("morphNormal"+R)!==P[B]&&m.setAttribute("morphNormal"+R,P[B]),i[R]=k,C+=k):(M&&m.hasAttribute("morphTarget"+R)===!0&&m.deleteAttribute("morphTarget"+R),P&&m.hasAttribute("morphNormal"+R)===!0&&m.deleteAttribute("morphNormal"+R),i[R]=0)}const b=m.morphTargetsRelative?1:1-C;_.getUniforms().setValue(r,"morphTargetBaseInfluence",b),_.getUniforms().setValue(r,"morphTargetInfluences",i)}}return{update:f}}function uD(r,e,t,n){let i=new WeakMap;function s(f){const d=n.render.frame,m=f.geometry,_=e.get(f,m);return i.get(_)!==d&&(e.update(_),i.set(_,d)),f.isInstancedMesh&&(f.hasEventListener("dispose",u)===!1&&f.addEventListener("dispose",u),t.update(f.instanceMatrix,34962),f.instanceColor!==null&&t.update(f.instanceColor,34962)),_}function a(){i=new WeakMap}function u(f){const d=f.target;d.removeEventListener("dispose",u),t.remove(d.instanceMatrix),d.instanceColor!==null&&t.remove(d.instanceColor)}return{update:s,dispose:a}}const jM=new ki,qM=new Y0,XM=new Px,$M=new im,Ww=[],jw=[],qw=new Float32Array(16),Xw=new Float32Array(9),$w=new Float32Array(4);function ed(r,e,t){const n=r[0];if(n<=0||n>0)return r;const i=e*t;let s=Ww[i];if(s===void 0&&(s=new Float32Array(i),Ww[i]=s),e!==0){n.toArray(s,0);for(let a=1,u=0;a!==e;++a)u+=t,r[a].toArray(s,u)}return s}function sr(r,e){if(r.length!==e.length)return!1;for(let t=0,n=r.length;t<n;t++)if(r[t]!==e[t])return!1;return!0}function or(r,e){for(let t=0,n=e.length;t<n;t++)r[t]=e[t]}function K0(r,e){let t=jw[e];t===void 0&&(t=new Int32Array(e),jw[e]=t);for(let n=0;n!==e;++n)t[n]=r.allocateTextureUnit();return t}function cD(r,e){const t=this.cache;t[0]!==e&&(r.uniform1f(this.addr,e),t[0]=e)}function hD(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(sr(t,e))return;r.uniform2fv(this.addr,e),or(t,e)}}function fD(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(sr(t,e))return;r.uniform3fv(this.addr,e),or(t,e)}}function dD(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(sr(t,e))return;r.uniform4fv(this.addr,e),or(t,e)}}function pD(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(sr(t,e))return;r.uniformMatrix2fv(this.addr,!1,e),or(t,e)}else{if(sr(t,n))return;$w.set(n),r.uniformMatrix2fv(this.addr,!1,$w),or(t,n)}}function mD(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(sr(t,e))return;r.uniformMatrix3fv(this.addr,!1,e),or(t,e)}else{if(sr(t,n))return;Xw.set(n),r.uniformMatrix3fv(this.addr,!1,Xw),or(t,n)}}function gD(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(sr(t,e))return;r.uniformMatrix4fv(this.addr,!1,e),or(t,e)}else{if(sr(t,n))return;qw.set(n),r.uniformMatrix4fv(this.addr,!1,qw),or(t,n)}}function _D(r,e){const t=this.cache;t[0]!==e&&(r.uniform1i(this.addr,e),t[0]=e)}function vD(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(sr(t,e))return;r.uniform2iv(this.addr,e),or(t,e)}}function yD(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(sr(t,e))return;r.uniform3iv(this.addr,e),or(t,e)}}function xD(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(sr(t,e))return;r.uniform4iv(this.addr,e),or(t,e)}}function wD(r,e){const t=this.cache;t[0]!==e&&(r.uniform1ui(this.addr,e),t[0]=e)}function SD(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(sr(t,e))return;r.uniform2uiv(this.addr,e),or(t,e)}}function ED(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(sr(t,e))return;r.uniform3uiv(this.addr,e),or(t,e)}}function TD(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(sr(t,e))return;r.uniform4uiv(this.addr,e),or(t,e)}}function MD(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture2D(e||jM,i)}function CD(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||XM,i)}function AD(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||$M,i)}function bD(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||qM,i)}function PD(r){switch(r){case 5126:return cD;case 35664:return hD;case 35665:return fD;case 35666:return dD;case 35674:return pD;case 35675:return mD;case 35676:return gD;case 5124:case 35670:return _D;case 35667:case 35671:return vD;case 35668:case 35672:return yD;case 35669:case 35673:return xD;case 5125:return wD;case 36294:return SD;case 36295:return ED;case 36296:return TD;case 35678:case 36198:case 36298:case 36306:case 35682:return MD;case 35679:case 36299:case 36307:return CD;case 35680:case 36300:case 36308:case 36293:return AD;case 36289:case 36303:case 36311:case 36292:return bD}}function ID(r,e){r.uniform1fv(this.addr,e)}function RD(r,e){const t=ed(e,this.size,2);r.uniform2fv(this.addr,t)}function DD(r,e){const t=ed(e,this.size,3);r.uniform3fv(this.addr,t)}function LD(r,e){const t=ed(e,this.size,4);r.uniform4fv(this.addr,t)}function OD(r,e){const t=ed(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,t)}function ND(r,e){const t=ed(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,t)}function kD(r,e){const t=ed(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,t)}function zD(r,e){r.uniform1iv(this.addr,e)}function FD(r,e){r.uniform2iv(this.addr,e)}function UD(r,e){r.uniform3iv(this.addr,e)}function BD(r,e){r.uniform4iv(this.addr,e)}function VD(r,e){r.uniform1uiv(this.addr,e)}function HD(r,e){r.uniform2uiv(this.addr,e)}function GD(r,e){r.uniform3uiv(this.addr,e)}function WD(r,e){r.uniform4uiv(this.addr,e)}function jD(r,e,t){const n=this.cache,i=e.length,s=K0(t,i);sr(n,s)||(r.uniform1iv(this.addr,s),or(n,s));for(let a=0;a!==i;++a)t.setTexture2D(e[a]||jM,s[a])}function qD(r,e,t){const n=this.cache,i=e.length,s=K0(t,i);sr(n,s)||(r.uniform1iv(this.addr,s),or(n,s));for(let a=0;a!==i;++a)t.setTexture3D(e[a]||XM,s[a])}function XD(r,e,t){const n=this.cache,i=e.length,s=K0(t,i);sr(n,s)||(r.uniform1iv(this.addr,s),or(n,s));for(let a=0;a!==i;++a)t.setTextureCube(e[a]||$M,s[a])}function $D(r,e,t){const n=this.cache,i=e.length,s=K0(t,i);sr(n,s)||(r.uniform1iv(this.addr,s),or(n,s));for(let a=0;a!==i;++a)t.setTexture2DArray(e[a]||qM,s[a])}function YD(r){switch(r){case 5126:return ID;case 35664:return RD;case 35665:return DD;case 35666:return LD;case 35674:return OD;case 35675:return ND;case 35676:return kD;case 5124:case 35670:return zD;case 35667:case 35671:return FD;case 35668:case 35672:return UD;case 35669:case 35673:return BD;case 5125:return VD;case 36294:return HD;case 36295:return GD;case 36296:return WD;case 35678:case 36198:case 36298:case 36306:case 35682:return jD;case 35679:case 36299:case 36307:return qD;case 35680:case 36300:case 36308:case 36293:return XD;case 36289:case 36303:case 36311:case 36292:return $D}}class QD{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=PD(t.type)}}class KD{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=YD(t.type)}}class ZD{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const u=i[s];u.setValue(e,t[u.id],n)}}}const Sv=/(\w+)(\])?(\[|\.)?/g;function Yw(r,e){r.seq.push(e),r.map[e.id]=e}function JD(r,e,t){const n=r.name,i=n.length;for(Sv.lastIndex=0;;){const s=Sv.exec(n),a=Sv.lastIndex;let u=s[1];const f=s[2]==="]",d=s[3];if(f&&(u=u|0),d===void 0||d==="["&&a+2===i){Yw(t,d===void 0?new QD(u,r,e):new KD(u,r,e));break}else{let _=t.map[u];_===void 0&&(_=new ZD(u),Yw(t,_)),t=_}}}class p0{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let i=0;i<n;++i){const s=e.getActiveUniform(t,i),a=e.getUniformLocation(t,s.name);JD(s,a,this)}}setValue(e,t,n,i){const s=this.map[t];s!==void 0&&s.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let s=0,a=t.length;s!==a;++s){const u=t[s],f=n[u.id];f.needsUpdate!==!1&&u.setValue(e,f.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in t&&n.push(a)}return n}}function Qw(r,e,t){const n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),n}let eL=0;function tL(r,e){const t=r.split(`
`),n=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=i;a<s;a++){const u=a+1;n.push(`${u===e?">":" "} ${u}: ${t[a]}`)}return n.join(`
`)}function nL(r){switch(r){case Lu:return["Linear","( value )"];case ti:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",r),["Linear","( value )"]}}function Kw(r,e,t){const n=r.getShaderParameter(e,35713),i=r.getShaderInfoLog(e).trim();if(n&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const a=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+tL(r.getShaderSource(e),a)}else return i}function iL(r,e){const t=nL(e);return"vec4 "+r+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function rL(r,e){let t;switch(e){case hM:t="Linear";break;case fM:t="Reinhard";break;case dM:t="OptimizedCineon";break;case Sx:t="ACESFilmic";break;case pM:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+r+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function sL(r){return[r.extensionDerivatives||r.envMapCubeUVHeight||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||r.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap||r.transmission)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(mp).join(`
`)}function oL(r){const e=[];for(const t in r){const n=r[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function aL(r,e){const t={},n=r.getProgramParameter(e,35721);for(let i=0;i<n;i++){const s=r.getActiveAttrib(e,i),a=s.name;let u=1;s.type===35674&&(u=2),s.type===35675&&(u=3),s.type===35676&&(u=4),t[a]={type:s.type,location:r.getAttribLocation(e,a),locationSize:u}}return t}function mp(r){return r!==""}function Zw(r,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return r.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Jw(r,e){return r.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const lL=/^[ \t]*#include +<([\w\d./]+)>/gm;function Wy(r){return r.replace(lL,uL)}function uL(r,e){const t=Xt[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return Wy(t)}const cL=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function eS(r){return r.replace(cL,hL)}function hL(r,e,t,n){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function tS(r){let e="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function fL(r){let e="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===q0?e="SHADOWMAP_TYPE_PCF":r.shadowMapType===vp?e="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===Hc&&(e="SHADOWMAP_TYPE_VSM"),e}function dL(r){let e="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case Iu:case Ru:e="ENVMAP_TYPE_CUBE";break;case Zf:e="ENVMAP_TYPE_CUBE_UV";break}return e}function pL(r){let e="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case Ru:e="ENVMAP_MODE_REFRACTION";break}return e}function mL(r){let e="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case Zp:e="ENVMAP_BLENDING_MULTIPLY";break;case uM:e="ENVMAP_BLENDING_MIX";break;case cM:e="ENVMAP_BLENDING_ADD";break}return e}function gL(r){const e=r.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function _L(r,e,t,n){const i=r.getContext(),s=t.defines;let a=t.vertexShader,u=t.fragmentShader;const f=fL(t),d=dL(t),m=pL(t),_=mL(t),y=gL(t),w=t.isWebGL2?"":sL(t),T=oL(s),E=i.createProgram();let M,P,C=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(M=[T].filter(mp).join(`
`),M.length>0&&(M+=`
`),P=[w,T].filter(mp).join(`
`),P.length>0&&(P+=`
`)):(M=[tS(t),"#define SHADER_NAME "+t.shaderName,T,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(mp).join(`
`),P=[w,tS(t),"#define SHADER_NAME "+t.shaderName,T,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.envMap?"#define "+m:"",t.envMap?"#define "+_:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+f:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==aa?"#define TONE_MAPPING":"",t.toneMapping!==aa?Xt.tonemapping_pars_fragment:"",t.toneMapping!==aa?rL("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Xt.encodings_pars_fragment,iL("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(mp).join(`
`)),a=Wy(a),a=Zw(a,t),a=Jw(a,t),u=Wy(u),u=Zw(u,t),u=Jw(u,t),a=eS(a),u=eS(u),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(C=`#version 300 es
`,M=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+M,P=["#define varying in",t.glslVersion===Vy?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Vy?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+P);const b=C+M+a,R=C+P+u,z=Qw(i,35633,b),B=Qw(i,35632,R);if(i.attachShader(E,z),i.attachShader(E,B),t.index0AttributeName!==void 0?i.bindAttribLocation(E,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(E,0,"position"),i.linkProgram(E),r.debug.checkShaderErrors){const N=i.getProgramInfoLog(E).trim(),V=i.getShaderInfoLog(z).trim(),W=i.getShaderInfoLog(B).trim();let q=!0,H=!0;if(i.getProgramParameter(E,35714)===!1){q=!1;const re=Kw(i,z,"vertex"),de=Kw(i,B,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(E,35715)+`

Program Info Log: `+N+`
`+re+`
`+de)}else N!==""?console.warn("THREE.WebGLProgram: Program Info Log:",N):(V===""||W==="")&&(H=!1);H&&(this.diagnostics={runnable:q,programLog:N,vertexShader:{log:V,prefix:M},fragmentShader:{log:W,prefix:P}})}i.deleteShader(z),i.deleteShader(B);let k;this.getUniforms=function(){return k===void 0&&(k=new p0(i,E)),k};let I;return this.getAttributes=function(){return I===void 0&&(I=aL(i,E)),I},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(E),this.program=void 0},this.name=t.shaderName,this.id=eL++,this.cacheKey=e,this.usedTimes=1,this.program=E,this.vertexShader=z,this.fragmentShader=B,this}let vL=0;class yL{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new xL(e),t.set(e,n)),n}}class xL{constructor(e){this.id=vL++,this.code=e,this.usedTimes=0}}function wL(r,e,t,n,i,s,a){const u=new Jc,f=new yL,d=[],m=i.isWebGL2,_=i.logarithmicDepthBuffer,y=i.vertexTextures;let w=i.precision;const T={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function E(I,N,V,W,q){const H=W.fog,re=q.geometry,de=I.isMeshStandardMaterial?W.environment:null,ye=(I.isMeshStandardMaterial?t:e).get(I.envMap||de),Ce=ye&&ye.mapping===Zf?ye.image.height:null,K=T[I.type];I.precision!==null&&(w=i.getMaxPrecision(I.precision),w!==I.precision&&console.warn("THREE.WebGLProgram.getParameters:",I.precision,"not supported, using",w,"instead."));const oe=re.morphAttributes.position||re.morphAttributes.normal||re.morphAttributes.color,ne=oe!==void 0?oe.length:0;let Q=0;re.morphAttributes.position!==void 0&&(Q=1),re.morphAttributes.normal!==void 0&&(Q=2),re.morphAttributes.color!==void 0&&(Q=3);let $,he,Ae,se;if(K){const ut=ia[K];$=ut.vertexShader,he=ut.fragmentShader}else $=I.vertexShader,he=I.fragmentShader,f.update(I),Ae=f.getVertexShaderID(I),se=f.getFragmentShaderID(I);const Ne=r.getRenderTarget(),Oe=I.alphaTest>0,He=I.clearcoat>0,Xe=I.iridescence>0;return{isWebGL2:m,shaderID:K,shaderName:I.type,vertexShader:$,fragmentShader:he,defines:I.defines,customVertexShaderID:Ae,customFragmentShaderID:se,isRawShaderMaterial:I.isRawShaderMaterial===!0,glslVersion:I.glslVersion,precision:w,instancing:q.isInstancedMesh===!0,instancingColor:q.isInstancedMesh===!0&&q.instanceColor!==null,supportsVertexTextures:y,outputEncoding:Ne===null?r.outputEncoding:Ne.isXRRenderTarget===!0?Ne.texture.encoding:Lu,map:!!I.map,matcap:!!I.matcap,envMap:!!ye,envMapMode:ye&&ye.mapping,envMapCubeUVHeight:Ce,lightMap:!!I.lightMap,aoMap:!!I.aoMap,emissiveMap:!!I.emissiveMap,bumpMap:!!I.bumpMap,normalMap:!!I.normalMap,objectSpaceNormalMap:I.normalMapType===NM,tangentSpaceNormalMap:I.normalMapType===Bu,decodeVideoTexture:!!I.map&&I.map.isVideoTexture===!0&&I.map.encoding===ti,clearcoat:He,clearcoatMap:He&&!!I.clearcoatMap,clearcoatRoughnessMap:He&&!!I.clearcoatRoughnessMap,clearcoatNormalMap:He&&!!I.clearcoatNormalMap,iridescence:Xe,iridescenceMap:Xe&&!!I.iridescenceMap,iridescenceThicknessMap:Xe&&!!I.iridescenceThicknessMap,displacementMap:!!I.displacementMap,roughnessMap:!!I.roughnessMap,metalnessMap:!!I.metalnessMap,specularMap:!!I.specularMap,specularIntensityMap:!!I.specularIntensityMap,specularColorMap:!!I.specularColorMap,opaque:I.transparent===!1&&I.blending===Qc,alphaMap:!!I.alphaMap,alphaTest:Oe,gradientMap:!!I.gradientMap,sheen:I.sheen>0,sheenColorMap:!!I.sheenColorMap,sheenRoughnessMap:!!I.sheenRoughnessMap,transmission:I.transmission>0,transmissionMap:!!I.transmissionMap,thicknessMap:!!I.thicknessMap,combine:I.combine,vertexTangents:!!I.normalMap&&!!re.attributes.tangent,vertexColors:I.vertexColors,vertexAlphas:I.vertexColors===!0&&!!re.attributes.color&&re.attributes.color.itemSize===4,vertexUvs:!!I.map||!!I.bumpMap||!!I.normalMap||!!I.specularMap||!!I.alphaMap||!!I.emissiveMap||!!I.roughnessMap||!!I.metalnessMap||!!I.clearcoatMap||!!I.clearcoatRoughnessMap||!!I.clearcoatNormalMap||!!I.iridescenceMap||!!I.iridescenceThicknessMap||!!I.displacementMap||!!I.transmissionMap||!!I.thicknessMap||!!I.specularIntensityMap||!!I.specularColorMap||!!I.sheenColorMap||!!I.sheenRoughnessMap,uvsVertexOnly:!(I.map||I.bumpMap||I.normalMap||I.specularMap||I.alphaMap||I.emissiveMap||I.roughnessMap||I.metalnessMap||I.clearcoatNormalMap||I.iridescenceMap||I.iridescenceThicknessMap||I.transmission>0||I.transmissionMap||I.thicknessMap||I.specularIntensityMap||I.specularColorMap||I.sheen>0||I.sheenColorMap||I.sheenRoughnessMap)&&!!I.displacementMap,fog:!!H,useFog:I.fog===!0,fogExp2:H&&H.isFogExp2,flatShading:!!I.flatShading,sizeAttenuation:I.sizeAttenuation,logarithmicDepthBuffer:_,skinning:q.isSkinnedMesh===!0,morphTargets:re.morphAttributes.position!==void 0,morphNormals:re.morphAttributes.normal!==void 0,morphColors:re.morphAttributes.color!==void 0,morphTargetsCount:ne,morphTextureStride:Q,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numSpotLightMaps:N.spotLightMap.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numSpotLightShadowsWithMaps:N.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:I.dithering,shadowMapEnabled:r.shadowMap.enabled&&V.length>0,shadowMapType:r.shadowMap.type,toneMapping:I.toneMapped?r.toneMapping:aa,useLegacyLights:r.useLegacyLights,premultipliedAlpha:I.premultipliedAlpha,doubleSided:I.side===Ra,flipSided:I.side===Os,useDepthPacking:!!I.depthPacking,depthPacking:I.depthPacking||0,index0AttributeName:I.index0AttributeName,extensionDerivatives:I.extensions&&I.extensions.derivatives,extensionFragDepth:I.extensions&&I.extensions.fragDepth,extensionDrawBuffers:I.extensions&&I.extensions.drawBuffers,extensionShaderTextureLOD:I.extensions&&I.extensions.shaderTextureLOD,rendererExtensionFragDepth:m||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:m||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:m||n.has("EXT_shader_texture_lod"),customProgramCacheKey:I.customProgramCacheKey()}}function M(I){const N=[];if(I.shaderID?N.push(I.shaderID):(N.push(I.customVertexShaderID),N.push(I.customFragmentShaderID)),I.defines!==void 0)for(const V in I.defines)N.push(V),N.push(I.defines[V]);return I.isRawShaderMaterial===!1&&(P(N,I),C(N,I),N.push(r.outputEncoding)),N.push(I.customProgramCacheKey),N.join()}function P(I,N){I.push(N.precision),I.push(N.outputEncoding),I.push(N.envMapMode),I.push(N.envMapCubeUVHeight),I.push(N.combine),I.push(N.vertexUvs),I.push(N.fogExp2),I.push(N.sizeAttenuation),I.push(N.morphTargetsCount),I.push(N.morphAttributeCount),I.push(N.numDirLights),I.push(N.numPointLights),I.push(N.numSpotLights),I.push(N.numSpotLightMaps),I.push(N.numHemiLights),I.push(N.numRectAreaLights),I.push(N.numDirLightShadows),I.push(N.numPointLightShadows),I.push(N.numSpotLightShadows),I.push(N.numSpotLightShadowsWithMaps),I.push(N.shadowMapType),I.push(N.toneMapping),I.push(N.numClippingPlanes),I.push(N.numClipIntersection),I.push(N.depthPacking)}function C(I,N){u.disableAll(),N.isWebGL2&&u.enable(0),N.supportsVertexTextures&&u.enable(1),N.instancing&&u.enable(2),N.instancingColor&&u.enable(3),N.map&&u.enable(4),N.matcap&&u.enable(5),N.envMap&&u.enable(6),N.lightMap&&u.enable(7),N.aoMap&&u.enable(8),N.emissiveMap&&u.enable(9),N.bumpMap&&u.enable(10),N.normalMap&&u.enable(11),N.objectSpaceNormalMap&&u.enable(12),N.tangentSpaceNormalMap&&u.enable(13),N.clearcoat&&u.enable(14),N.clearcoatMap&&u.enable(15),N.clearcoatRoughnessMap&&u.enable(16),N.clearcoatNormalMap&&u.enable(17),N.iridescence&&u.enable(18),N.iridescenceMap&&u.enable(19),N.iridescenceThicknessMap&&u.enable(20),N.displacementMap&&u.enable(21),N.specularMap&&u.enable(22),N.roughnessMap&&u.enable(23),N.metalnessMap&&u.enable(24),N.gradientMap&&u.enable(25),N.alphaMap&&u.enable(26),N.alphaTest&&u.enable(27),N.vertexColors&&u.enable(28),N.vertexAlphas&&u.enable(29),N.vertexUvs&&u.enable(30),N.vertexTangents&&u.enable(31),N.uvsVertexOnly&&u.enable(32),I.push(u.mask),u.disableAll(),N.fog&&u.enable(0),N.useFog&&u.enable(1),N.flatShading&&u.enable(2),N.logarithmicDepthBuffer&&u.enable(3),N.skinning&&u.enable(4),N.morphTargets&&u.enable(5),N.morphNormals&&u.enable(6),N.morphColors&&u.enable(7),N.premultipliedAlpha&&u.enable(8),N.shadowMapEnabled&&u.enable(9),N.useLegacyLights&&u.enable(10),N.doubleSided&&u.enable(11),N.flipSided&&u.enable(12),N.useDepthPacking&&u.enable(13),N.dithering&&u.enable(14),N.specularIntensityMap&&u.enable(15),N.specularColorMap&&u.enable(16),N.transmission&&u.enable(17),N.transmissionMap&&u.enable(18),N.thicknessMap&&u.enable(19),N.sheen&&u.enable(20),N.sheenColorMap&&u.enable(21),N.sheenRoughnessMap&&u.enable(22),N.decodeVideoTexture&&u.enable(23),N.opaque&&u.enable(24),I.push(u.mask)}function b(I){const N=T[I.type];let V;if(N){const W=ia[N];V=tm.clone(W.uniforms)}else V=I.uniforms;return V}function R(I,N){let V;for(let W=0,q=d.length;W<q;W++){const H=d[W];if(H.cacheKey===N){V=H,++V.usedTimes;break}}return V===void 0&&(V=new _L(r,N,I,s),d.push(V)),V}function z(I){if(--I.usedTimes===0){const N=d.indexOf(I);d[N]=d[d.length-1],d.pop(),I.destroy()}}function B(I){f.remove(I)}function k(){f.dispose()}return{getParameters:E,getProgramCacheKey:M,getUniforms:b,acquireProgram:R,releaseProgram:z,releaseShaderCache:B,programs:d,dispose:k}}function SL(){let r=new WeakMap;function e(s){let a=r.get(s);return a===void 0&&(a={},r.set(s,a)),a}function t(s){r.delete(s)}function n(s,a,u){r.get(s)[a]=u}function i(){r=new WeakMap}return{get:e,remove:t,update:n,dispose:i}}function EL(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function nS(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function iS(){const r=[];let e=0;const t=[],n=[],i=[];function s(){e=0,t.length=0,n.length=0,i.length=0}function a(_,y,w,T,E,M){let P=r[e];return P===void 0?(P={id:_.id,object:_,geometry:y,material:w,groupOrder:T,renderOrder:_.renderOrder,z:E,group:M},r[e]=P):(P.id=_.id,P.object=_,P.geometry=y,P.material=w,P.groupOrder=T,P.renderOrder=_.renderOrder,P.z=E,P.group=M),e++,P}function u(_,y,w,T,E,M){const P=a(_,y,w,T,E,M);w.transmission>0?n.push(P):w.transparent===!0?i.push(P):t.push(P)}function f(_,y,w,T,E,M){const P=a(_,y,w,T,E,M);w.transmission>0?n.unshift(P):w.transparent===!0?i.unshift(P):t.unshift(P)}function d(_,y){t.length>1&&t.sort(_||EL),n.length>1&&n.sort(y||nS),i.length>1&&i.sort(y||nS)}function m(){for(let _=e,y=r.length;_<y;_++){const w=r[_];if(w.id===null)break;w.id=null,w.object=null,w.geometry=null,w.material=null,w.group=null}}return{opaque:t,transmissive:n,transparent:i,init:s,push:u,unshift:f,finish:m,sort:d}}function TL(){let r=new WeakMap;function e(n,i){const s=r.get(n);let a;return s===void 0?(a=new iS,r.set(n,[a])):i>=s.length?(a=new iS,s.push(a)):a=s[i],a}function t(){r=new WeakMap}return{get:e,dispose:t}}function ML(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Z,color:new dt};break;case"SpotLight":t={position:new Z,direction:new Z,color:new dt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Z,color:new dt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Z,skyColor:new dt,groundColor:new dt};break;case"RectAreaLight":t={color:new dt,position:new Z,halfWidth:new Z,halfHeight:new Z};break}return r[e.id]=t,t}}}function CL(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ze};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ze};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ze,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[e.id]=t,t}}}let AL=0;function bL(r,e){return(e.castShadow?2:0)-(r.castShadow?2:0)+(e.map?1:0)-(r.map?1:0)}function PL(r,e){const t=new ML,n=CL(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let m=0;m<9;m++)i.probe.push(new Z);const s=new Z,a=new Jt,u=new Jt;function f(m,_){let y=0,w=0,T=0;for(let W=0;W<9;W++)i.probe[W].set(0,0,0);let E=0,M=0,P=0,C=0,b=0,R=0,z=0,B=0,k=0,I=0;m.sort(bL);const N=_===!0?Math.PI:1;for(let W=0,q=m.length;W<q;W++){const H=m[W],re=H.color,de=H.intensity,ye=H.distance,Ce=H.shadow&&H.shadow.map?H.shadow.map.texture:null;if(H.isAmbientLight)y+=re.r*de*N,w+=re.g*de*N,T+=re.b*de*N;else if(H.isLightProbe)for(let K=0;K<9;K++)i.probe[K].addScaledVector(H.sh.coefficients[K],de);else if(H.isDirectionalLight){const K=t.get(H);if(K.color.copy(H.color).multiplyScalar(H.intensity*N),H.castShadow){const oe=H.shadow,ne=n.get(H);ne.shadowBias=oe.bias,ne.shadowNormalBias=oe.normalBias,ne.shadowRadius=oe.radius,ne.shadowMapSize=oe.mapSize,i.directionalShadow[E]=ne,i.directionalShadowMap[E]=Ce,i.directionalShadowMatrix[E]=H.shadow.matrix,R++}i.directional[E]=K,E++}else if(H.isSpotLight){const K=t.get(H);K.position.setFromMatrixPosition(H.matrixWorld),K.color.copy(re).multiplyScalar(de*N),K.distance=ye,K.coneCos=Math.cos(H.angle),K.penumbraCos=Math.cos(H.angle*(1-H.penumbra)),K.decay=H.decay,i.spot[P]=K;const oe=H.shadow;if(H.map&&(i.spotLightMap[k]=H.map,k++,oe.updateMatrices(H),H.castShadow&&I++),i.spotLightMatrix[P]=oe.matrix,H.castShadow){const ne=n.get(H);ne.shadowBias=oe.bias,ne.shadowNormalBias=oe.normalBias,ne.shadowRadius=oe.radius,ne.shadowMapSize=oe.mapSize,i.spotShadow[P]=ne,i.spotShadowMap[P]=Ce,B++}P++}else if(H.isRectAreaLight){const K=t.get(H);K.color.copy(re).multiplyScalar(de),K.halfWidth.set(H.width*.5,0,0),K.halfHeight.set(0,H.height*.5,0),i.rectArea[C]=K,C++}else if(H.isPointLight){const K=t.get(H);if(K.color.copy(H.color).multiplyScalar(H.intensity*N),K.distance=H.distance,K.decay=H.decay,H.castShadow){const oe=H.shadow,ne=n.get(H);ne.shadowBias=oe.bias,ne.shadowNormalBias=oe.normalBias,ne.shadowRadius=oe.radius,ne.shadowMapSize=oe.mapSize,ne.shadowCameraNear=oe.camera.near,ne.shadowCameraFar=oe.camera.far,i.pointShadow[M]=ne,i.pointShadowMap[M]=Ce,i.pointShadowMatrix[M]=H.shadow.matrix,z++}i.point[M]=K,M++}else if(H.isHemisphereLight){const K=t.get(H);K.skyColor.copy(H.color).multiplyScalar(de*N),K.groundColor.copy(H.groundColor).multiplyScalar(de*N),i.hemi[b]=K,b++}}C>0&&(e.isWebGL2||r.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=nt.LTC_FLOAT_1,i.rectAreaLTC2=nt.LTC_FLOAT_2):r.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=nt.LTC_HALF_1,i.rectAreaLTC2=nt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=y,i.ambient[1]=w,i.ambient[2]=T;const V=i.hash;(V.directionalLength!==E||V.pointLength!==M||V.spotLength!==P||V.rectAreaLength!==C||V.hemiLength!==b||V.numDirectionalShadows!==R||V.numPointShadows!==z||V.numSpotShadows!==B||V.numSpotMaps!==k)&&(i.directional.length=E,i.spot.length=P,i.rectArea.length=C,i.point.length=M,i.hemi.length=b,i.directionalShadow.length=R,i.directionalShadowMap.length=R,i.pointShadow.length=z,i.pointShadowMap.length=z,i.spotShadow.length=B,i.spotShadowMap.length=B,i.directionalShadowMatrix.length=R,i.pointShadowMatrix.length=z,i.spotLightMatrix.length=B+k-I,i.spotLightMap.length=k,i.numSpotLightShadowsWithMaps=I,V.directionalLength=E,V.pointLength=M,V.spotLength=P,V.rectAreaLength=C,V.hemiLength=b,V.numDirectionalShadows=R,V.numPointShadows=z,V.numSpotShadows=B,V.numSpotMaps=k,i.version=AL++)}function d(m,_){let y=0,w=0,T=0,E=0,M=0;const P=_.matrixWorldInverse;for(let C=0,b=m.length;C<b;C++){const R=m[C];if(R.isDirectionalLight){const z=i.directional[y];z.direction.setFromMatrixPosition(R.matrixWorld),s.setFromMatrixPosition(R.target.matrixWorld),z.direction.sub(s),z.direction.transformDirection(P),y++}else if(R.isSpotLight){const z=i.spot[T];z.position.setFromMatrixPosition(R.matrixWorld),z.position.applyMatrix4(P),z.direction.setFromMatrixPosition(R.matrixWorld),s.setFromMatrixPosition(R.target.matrixWorld),z.direction.sub(s),z.direction.transformDirection(P),T++}else if(R.isRectAreaLight){const z=i.rectArea[E];z.position.setFromMatrixPosition(R.matrixWorld),z.position.applyMatrix4(P),u.identity(),a.copy(R.matrixWorld),a.premultiply(P),u.extractRotation(a),z.halfWidth.set(R.width*.5,0,0),z.halfHeight.set(0,R.height*.5,0),z.halfWidth.applyMatrix4(u),z.halfHeight.applyMatrix4(u),E++}else if(R.isPointLight){const z=i.point[w];z.position.setFromMatrixPosition(R.matrixWorld),z.position.applyMatrix4(P),w++}else if(R.isHemisphereLight){const z=i.hemi[M];z.direction.setFromMatrixPosition(R.matrixWorld),z.direction.transformDirection(P),M++}}}return{setup:f,setupView:d,state:i}}function rS(r,e){const t=new PL(r,e),n=[],i=[];function s(){n.length=0,i.length=0}function a(_){n.push(_)}function u(_){i.push(_)}function f(_){t.setup(n,_)}function d(_){t.setupView(n,_)}return{init:s,state:{lightsArray:n,shadowsArray:i,lights:t},setupLights:f,setupLightsView:d,pushLight:a,pushShadow:u}}function IL(r,e){let t=new WeakMap;function n(s,a=0){const u=t.get(s);let f;return u===void 0?(f=new rS(r,e),t.set(s,[f])):a>=u.length?(f=new rS(r,e),u.push(f)):f=u[a],f}function i(){t=new WeakMap}return{get:n,dispose:i}}class Lx extends Zr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=LM,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Ox extends Zr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Z,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const RL=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,DL=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function LL(r,e,t){let n=new Q0;const i=new ze,s=new ze,a=new Un,u=new Lx({depthPacking:OM}),f=new Ox,d={},m=t.maxTextureSize,_={[Pl]:Os,[Os]:Pl,[Ra]:Ra},y=new ro({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ze},radius:{value:4}},vertexShader:RL,fragmentShader:DL}),w=y.clone();w.defines.HORIZONTAL_PASS=1;const T=new en;T.setAttribute("position",new $n(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const E=new rr(T,y),M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=q0,this.render=function(R,z,B){if(M.enabled===!1||M.autoUpdate===!1&&M.needsUpdate===!1||R.length===0)return;const k=r.getRenderTarget(),I=r.getActiveCubeFace(),N=r.getActiveMipmapLevel(),V=r.state;V.setBlending(Cl),V.buffers.color.setClear(1,1,1,1),V.buffers.depth.setTest(!0),V.setScissorTest(!1);for(let W=0,q=R.length;W<q;W++){const H=R[W],re=H.shadow;if(re===void 0){console.warn("THREE.WebGLShadowMap:",H,"has no shadow.");continue}if(re.autoUpdate===!1&&re.needsUpdate===!1)continue;i.copy(re.mapSize);const de=re.getFrameExtents();if(i.multiply(de),s.copy(re.mapSize),(i.x>m||i.y>m)&&(i.x>m&&(s.x=Math.floor(m/de.x),i.x=s.x*de.x,re.mapSize.x=s.x),i.y>m&&(s.y=Math.floor(m/de.y),i.y=s.y*de.y,re.mapSize.y=s.y)),re.map===null){const Ce=this.type!==Hc?{minFilter:Oi,magFilter:Oi}:{};re.map=new Ao(i.x,i.y,Ce),re.map.texture.name=H.name+".shadowMap",re.camera.updateProjectionMatrix()}r.setRenderTarget(re.map),r.clear();const ye=re.getViewportCount();for(let Ce=0;Ce<ye;Ce++){const K=re.getViewport(Ce);a.set(s.x*K.x,s.y*K.y,s.x*K.z,s.y*K.w),V.viewport(a),re.updateMatrices(H,Ce),n=re.getFrustum(),b(z,B,re.camera,H,this.type)}re.isPointLightShadow!==!0&&this.type===Hc&&P(re,B),re.needsUpdate=!1}M.needsUpdate=!1,r.setRenderTarget(k,I,N)};function P(R,z){const B=e.update(E);y.defines.VSM_SAMPLES!==R.blurSamples&&(y.defines.VSM_SAMPLES=R.blurSamples,w.defines.VSM_SAMPLES=R.blurSamples,y.needsUpdate=!0,w.needsUpdate=!0),R.mapPass===null&&(R.mapPass=new Ao(i.x,i.y)),y.uniforms.shadow_pass.value=R.map.texture,y.uniforms.resolution.value=R.mapSize,y.uniforms.radius.value=R.radius,r.setRenderTarget(R.mapPass),r.clear(),r.renderBufferDirect(z,null,B,y,E,null),w.uniforms.shadow_pass.value=R.mapPass.texture,w.uniforms.resolution.value=R.mapSize,w.uniforms.radius.value=R.radius,r.setRenderTarget(R.map),r.clear(),r.renderBufferDirect(z,null,B,w,E,null)}function C(R,z,B,k,I,N){let V=null;const W=B.isPointLight===!0?R.customDistanceMaterial:R.customDepthMaterial;if(W!==void 0)V=W;else if(V=B.isPointLight===!0?f:u,r.localClippingEnabled&&z.clipShadows===!0&&Array.isArray(z.clippingPlanes)&&z.clippingPlanes.length!==0||z.displacementMap&&z.displacementScale!==0||z.alphaMap&&z.alphaTest>0||z.map&&z.alphaTest>0){const q=V.uuid,H=z.uuid;let re=d[q];re===void 0&&(re={},d[q]=re);let de=re[H];de===void 0&&(de=V.clone(),re[H]=de),V=de}return V.visible=z.visible,V.wireframe=z.wireframe,N===Hc?V.side=z.shadowSide!==null?z.shadowSide:z.side:V.side=z.shadowSide!==null?z.shadowSide:_[z.side],V.alphaMap=z.alphaMap,V.alphaTest=z.alphaTest,V.map=z.map,V.clipShadows=z.clipShadows,V.clippingPlanes=z.clippingPlanes,V.clipIntersection=z.clipIntersection,V.displacementMap=z.displacementMap,V.displacementScale=z.displacementScale,V.displacementBias=z.displacementBias,V.wireframeLinewidth=z.wireframeLinewidth,V.linewidth=z.linewidth,B.isPointLight===!0&&V.isMeshDistanceMaterial===!0&&(V.referencePosition.setFromMatrixPosition(B.matrixWorld),V.nearDistance=k,V.farDistance=I),V}function b(R,z,B,k,I){if(R.visible===!1)return;if(R.layers.test(z.layers)&&(R.isMesh||R.isLine||R.isPoints)&&(R.castShadow||R.receiveShadow&&I===Hc)&&(!R.frustumCulled||n.intersectsObject(R))){R.modelViewMatrix.multiplyMatrices(B.matrixWorldInverse,R.matrixWorld);const W=e.update(R),q=R.material;if(Array.isArray(q)){const H=W.groups;for(let re=0,de=H.length;re<de;re++){const ye=H[re],Ce=q[ye.materialIndex];if(Ce&&Ce.visible){const K=C(R,Ce,k,B.near,B.far,I);r.renderBufferDirect(B,null,W,K,R,ye)}}}else if(q.visible){const H=C(R,q,k,B.near,B.far,I);r.renderBufferDirect(B,null,W,H,R,null)}}const V=R.children;for(let W=0,q=V.length;W<q;W++)b(V[W],z,B,k,I)}}function OL(r,e,t){const n=t.isWebGL2;function i(){let le=!1;const be=new Un;let Fe=null;const tt=new Un(0,0,0,0);return{setMask:function(ct){Fe!==ct&&!le&&(r.colorMask(ct,ct,ct,ct),Fe=ct)},setLocked:function(ct){le=ct},setClear:function(ct,an,Wn,ri,Yi){Yi===!0&&(ct*=ri,an*=ri,Wn*=ri),be.set(ct,an,Wn,ri),tt.equals(be)===!1&&(r.clearColor(ct,an,Wn,ri),tt.copy(be))},reset:function(){le=!1,Fe=null,tt.set(-1,0,0,0)}}}function s(){let le=!1,be=null,Fe=null,tt=null;return{setTest:function(ct){ct?Oe(2929):He(2929)},setMask:function(ct){be!==ct&&!le&&(r.depthMask(ct),be=ct)},setFunc:function(ct){if(Fe!==ct){switch(ct){case nM:r.depthFunc(512);break;case iM:r.depthFunc(519);break;case rM:r.depthFunc(513);break;case x0:r.depthFunc(515);break;case sM:r.depthFunc(514);break;case oM:r.depthFunc(518);break;case aM:r.depthFunc(516);break;case lM:r.depthFunc(517);break;default:r.depthFunc(515)}Fe=ct}},setLocked:function(ct){le=ct},setClear:function(ct){tt!==ct&&(r.clearDepth(ct),tt=ct)},reset:function(){le=!1,be=null,Fe=null,tt=null}}}function a(){let le=!1,be=null,Fe=null,tt=null,ct=null,an=null,Wn=null,ri=null,Yi=null;return{setTest:function(_n){le||(_n?Oe(2960):He(2960))},setMask:function(_n){be!==_n&&!le&&(r.stencilMask(_n),be=_n)},setFunc:function(_n,Ci,vn){(Fe!==_n||tt!==Ci||ct!==vn)&&(r.stencilFunc(_n,Ci,vn),Fe=_n,tt=Ci,ct=vn)},setOp:function(_n,Ci,vn){(an!==_n||Wn!==Ci||ri!==vn)&&(r.stencilOp(_n,Ci,vn),an=_n,Wn=Ci,ri=vn)},setLocked:function(_n){le=_n},setClear:function(_n){Yi!==_n&&(r.clearStencil(_n),Yi=_n)},reset:function(){le=!1,be=null,Fe=null,tt=null,ct=null,an=null,Wn=null,ri=null,Yi=null}}}const u=new i,f=new s,d=new a,m=new WeakMap,_=new WeakMap;let y={},w={},T=new WeakMap,E=[],M=null,P=!1,C=null,b=null,R=null,z=null,B=null,k=null,I=null,N=!1,V=null,W=null,q=null,H=null,re=null;const de=r.getParameter(35661);let ye=!1,Ce=0;const K=r.getParameter(7938);K.indexOf("WebGL")!==-1?(Ce=parseFloat(/^WebGL (\d)/.exec(K)[1]),ye=Ce>=1):K.indexOf("OpenGL ES")!==-1&&(Ce=parseFloat(/^OpenGL ES (\d)/.exec(K)[1]),ye=Ce>=2);let oe=null,ne={};const Q=r.getParameter(3088),$=r.getParameter(2978),he=new Un().fromArray(Q),Ae=new Un().fromArray($);function se(le,be,Fe){const tt=new Uint8Array(4),ct=r.createTexture();r.bindTexture(le,ct),r.texParameteri(le,10241,9728),r.texParameteri(le,10240,9728);for(let an=0;an<Fe;an++)r.texImage2D(be+an,0,6408,1,1,0,6408,5121,tt);return ct}const Ne={};Ne[3553]=se(3553,3553,1),Ne[34067]=se(34067,34069,6),u.setClear(0,0,0,1),f.setClear(1),d.setClear(0),Oe(2929),f.setFunc(x0),et(!1),It(fy),Oe(2884),Qe(Cl);function Oe(le){y[le]!==!0&&(r.enable(le),y[le]=!0)}function He(le){y[le]!==!1&&(r.disable(le),y[le]=!1)}function Xe(le,be){return w[le]!==be?(r.bindFramebuffer(le,be),w[le]=be,n&&(le===36009&&(w[36160]=be),le===36160&&(w[36009]=be)),!0):!1}function Je(le,be){let Fe=E,tt=!1;if(le)if(Fe=T.get(be),Fe===void 0&&(Fe=[],T.set(be,Fe)),le.isWebGLMultipleRenderTargets){const ct=le.texture;if(Fe.length!==ct.length||Fe[0]!==36064){for(let an=0,Wn=ct.length;an<Wn;an++)Fe[an]=36064+an;Fe.length=ct.length,tt=!0}}else Fe[0]!==36064&&(Fe[0]=36064,tt=!0);else Fe[0]!==1029&&(Fe[0]=1029,tt=!0);tt&&(t.isWebGL2?r.drawBuffers(Fe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Fe))}function ut(le){return M!==le?(r.useProgram(le),M=le,!0):!1}const De={[Bc]:32774,[jT]:32778,[qT]:32779};if(n)De[gy]=32775,De[_y]=32776;else{const le=e.get("EXT_blend_minmax");le!==null&&(De[gy]=le.MIN_EXT,De[_y]=le.MAX_EXT)}const Le={[XT]:0,[$T]:1,[YT]:768,[xx]:770,[tM]:776,[JT]:774,[KT]:772,[QT]:769,[wx]:771,[eM]:775,[ZT]:773};function Qe(le,be,Fe,tt,ct,an,Wn,ri){if(le===Cl){P===!0&&(He(3042),P=!1);return}if(P===!1&&(Oe(3042),P=!0),le!==WT){if(le!==C||ri!==N){if((b!==Bc||B!==Bc)&&(r.blendEquation(32774),b=Bc,B=Bc),ri)switch(le){case Qc:r.blendFuncSeparate(1,771,1,771);break;case dy:r.blendFunc(1,1);break;case py:r.blendFuncSeparate(0,769,0,1);break;case my:r.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",le);break}else switch(le){case Qc:r.blendFuncSeparate(770,771,1,771);break;case dy:r.blendFunc(770,1);break;case py:r.blendFuncSeparate(0,769,0,1);break;case my:r.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",le);break}R=null,z=null,k=null,I=null,C=le,N=ri}return}ct=ct||be,an=an||Fe,Wn=Wn||tt,(be!==b||ct!==B)&&(r.blendEquationSeparate(De[be],De[ct]),b=be,B=ct),(Fe!==R||tt!==z||an!==k||Wn!==I)&&(r.blendFuncSeparate(Le[Fe],Le[tt],Le[an],Le[Wn]),R=Fe,z=tt,k=an,I=Wn),C=le,N=!1}function gt(le,be){le.side===Ra?He(2884):Oe(2884);let Fe=le.side===Os;be&&(Fe=!Fe),et(Fe),le.blending===Qc&&le.transparent===!1?Qe(Cl):Qe(le.blending,le.blendEquation,le.blendSrc,le.blendDst,le.blendEquationAlpha,le.blendSrcAlpha,le.blendDstAlpha,le.premultipliedAlpha),f.setFunc(le.depthFunc),f.setTest(le.depthTest),f.setMask(le.depthWrite),u.setMask(le.colorWrite);const tt=le.stencilWrite;d.setTest(tt),tt&&(d.setMask(le.stencilWriteMask),d.setFunc(le.stencilFunc,le.stencilRef,le.stencilFuncMask),d.setOp(le.stencilFail,le.stencilZFail,le.stencilZPass)),Pt(le.polygonOffset,le.polygonOffsetFactor,le.polygonOffsetUnits),le.alphaToCoverage===!0?Oe(32926):He(32926)}function et(le){V!==le&&(le?r.frontFace(2304):r.frontFace(2305),V=le)}function It(le){le!==VT?(Oe(2884),le!==W&&(le===fy?r.cullFace(1029):le===HT?r.cullFace(1028):r.cullFace(1032))):He(2884),W=le}function At(le){le!==q&&(ye&&r.lineWidth(le),q=le)}function Pt(le,be,Fe){le?(Oe(32823),(H!==be||re!==Fe)&&(r.polygonOffset(be,Fe),H=be,re=Fe)):He(32823)}function Yt(le){le?Oe(3089):He(3089)}function tn(le){le===void 0&&(le=33984+de-1),oe!==le&&(r.activeTexture(le),oe=le)}function ee(le,be,Fe){Fe===void 0&&(oe===null?Fe=33984+de-1:Fe=oe);let tt=ne[Fe];tt===void 0&&(tt={type:void 0,texture:void 0},ne[Fe]=tt),(tt.type!==le||tt.texture!==be)&&(oe!==Fe&&(r.activeTexture(Fe),oe=Fe),r.bindTexture(le,be||Ne[le]),tt.type=le,tt.texture=be)}function X(){const le=ne[oe];le!==void 0&&le.type!==void 0&&(r.bindTexture(le.type,null),le.type=void 0,le.texture=void 0)}function Se(){try{r.compressedTexImage2D.apply(r,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function $e(){try{r.compressedTexImage3D.apply(r,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function Ue(){try{r.texSubImage2D.apply(r,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function je(){try{r.texSubImage3D.apply(r,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function _t(){try{r.compressedTexSubImage2D.apply(r,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function st(){try{r.compressedTexSubImage3D.apply(r,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function Re(){try{r.texStorage2D.apply(r,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function Et(){try{r.texStorage3D.apply(r,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function ht(){try{r.texImage2D.apply(r,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function Rt(){try{r.texImage3D.apply(r,arguments)}catch(le){console.error("THREE.WebGLState:",le)}}function bt(le){he.equals(le)===!1&&(r.scissor(le.x,le.y,le.z,le.w),he.copy(le))}function Tt(le){Ae.equals(le)===!1&&(r.viewport(le.x,le.y,le.z,le.w),Ae.copy(le))}function rn(le,be){let Fe=_.get(be);Fe===void 0&&(Fe=new WeakMap,_.set(be,Fe));let tt=Fe.get(le);tt===void 0&&(tt=r.getUniformBlockIndex(be,le.name),Fe.set(le,tt))}function Cn(le,be){const tt=_.get(be).get(le);m.get(be)!==tt&&(r.uniformBlockBinding(be,tt,le.__bindingPointIndex),m.set(be,tt))}function Bn(){r.disable(3042),r.disable(2884),r.disable(2929),r.disable(32823),r.disable(3089),r.disable(2960),r.disable(32926),r.blendEquation(32774),r.blendFunc(1,0),r.blendFuncSeparate(1,0,1,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(513),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(519,0,4294967295),r.stencilOp(7680,7680,7680),r.clearStencil(0),r.cullFace(1029),r.frontFace(2305),r.polygonOffset(0,0),r.activeTexture(33984),r.bindFramebuffer(36160,null),n===!0&&(r.bindFramebuffer(36009,null),r.bindFramebuffer(36008,null)),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),y={},oe=null,ne={},w={},T=new WeakMap,E=[],M=null,P=!1,C=null,b=null,R=null,z=null,B=null,k=null,I=null,N=!1,V=null,W=null,q=null,H=null,re=null,he.set(0,0,r.canvas.width,r.canvas.height),Ae.set(0,0,r.canvas.width,r.canvas.height),u.reset(),f.reset(),d.reset()}return{buffers:{color:u,depth:f,stencil:d},enable:Oe,disable:He,bindFramebuffer:Xe,drawBuffers:Je,useProgram:ut,setBlending:Qe,setMaterial:gt,setFlipSided:et,setCullFace:It,setLineWidth:At,setPolygonOffset:Pt,setScissorTest:Yt,activeTexture:tn,bindTexture:ee,unbindTexture:X,compressedTexImage2D:Se,compressedTexImage3D:$e,texImage2D:ht,texImage3D:Rt,updateUBOMapping:rn,uniformBlockBinding:Cn,texStorage2D:Re,texStorage3D:Et,texSubImage2D:Ue,texSubImage3D:je,compressedTexSubImage2D:_t,compressedTexSubImage3D:st,scissor:bt,viewport:Tt,reset:Bn}}function NL(r,e,t,n,i,s,a){const u=i.isWebGL2,f=i.maxTextures,d=i.maxCubemapSize,m=i.maxTextureSize,_=i.maxSamples,y=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,w=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),T=new WeakMap;let E;const M=new WeakMap;let P=!1;try{P=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function C(ee,X){return P?new OffscreenCanvas(ee,X):kp("canvas")}function b(ee,X,Se,$e){let Ue=1;if((ee.width>$e||ee.height>$e)&&(Ue=$e/Math.max(ee.width,ee.height)),Ue<1||X===!0)if(typeof HTMLImageElement<"u"&&ee instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ee instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ee instanceof ImageBitmap){const je=X?FM:Math.floor,_t=je(Ue*ee.width),st=je(Ue*ee.height);E===void 0&&(E=C(_t,st));const Re=Se?C(_t,st):E;return Re.width=_t,Re.height=st,Re.getContext("2d").drawImage(ee,0,0,_t,st),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ee.width+"x"+ee.height+") to ("+_t+"x"+st+")."),Re}else return"data"in ee&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ee.width+"x"+ee.height+")."),ee;return ee}function R(ee){return Hy(ee.width)&&Hy(ee.height)}function z(ee){return u?!1:ee.wrapS!==Kr||ee.wrapT!==Kr||ee.minFilter!==Oi&&ee.minFilter!==ai}function B(ee,X){return ee.generateMipmaps&&X&&ee.minFilter!==Oi&&ee.minFilter!==ai}function k(ee){r.generateMipmap(ee)}function I(ee,X,Se,$e,Ue=!1){if(u===!1)return X;if(ee!==null){if(r[ee]!==void 0)return r[ee];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ee+"'")}let je=X;return X===6403&&(Se===5126&&(je=33326),Se===5131&&(je=33325),Se===5121&&(je=33321)),X===33319&&(Se===5126&&(je=33328),Se===5131&&(je=33327),Se===5121&&(je=33323)),X===6408&&(Se===5126&&(je=34836),Se===5131&&(je=34842),Se===5121&&(je=$e===ti&&Ue===!1?35907:32856),Se===32819&&(je=32854),Se===32820&&(je=32855)),(je===33325||je===33326||je===33327||je===33328||je===34842||je===34836)&&e.get("EXT_color_buffer_float"),je}function N(ee,X,Se){return B(ee,Se)===!0||ee.isFramebufferTexture&&ee.minFilter!==Oi&&ee.minFilter!==ai?Math.log2(Math.max(X.width,X.height))+1:ee.mipmaps!==void 0&&ee.mipmaps.length>0?ee.mipmaps.length:ee.isCompressedTexture&&Array.isArray(ee.image)?X.mipmaps.length:1}function V(ee){return ee===Oi||ee===w0||ee===yp?9728:9729}function W(ee){const X=ee.target;X.removeEventListener("dispose",W),H(X),X.isVideoTexture&&T.delete(X)}function q(ee){const X=ee.target;X.removeEventListener("dispose",q),de(X)}function H(ee){const X=n.get(ee);if(X.__webglInit===void 0)return;const Se=ee.source,$e=M.get(Se);if($e){const Ue=$e[X.__cacheKey];Ue.usedTimes--,Ue.usedTimes===0&&re(ee),Object.keys($e).length===0&&M.delete(Se)}n.remove(ee)}function re(ee){const X=n.get(ee);r.deleteTexture(X.__webglTexture);const Se=ee.source,$e=M.get(Se);delete $e[X.__cacheKey],a.memory.textures--}function de(ee){const X=ee.texture,Se=n.get(ee),$e=n.get(X);if($e.__webglTexture!==void 0&&(r.deleteTexture($e.__webglTexture),a.memory.textures--),ee.depthTexture&&ee.depthTexture.dispose(),ee.isWebGLCubeRenderTarget)for(let Ue=0;Ue<6;Ue++)r.deleteFramebuffer(Se.__webglFramebuffer[Ue]),Se.__webglDepthbuffer&&r.deleteRenderbuffer(Se.__webglDepthbuffer[Ue]);else{if(r.deleteFramebuffer(Se.__webglFramebuffer),Se.__webglDepthbuffer&&r.deleteRenderbuffer(Se.__webglDepthbuffer),Se.__webglMultisampledFramebuffer&&r.deleteFramebuffer(Se.__webglMultisampledFramebuffer),Se.__webglColorRenderbuffer)for(let Ue=0;Ue<Se.__webglColorRenderbuffer.length;Ue++)Se.__webglColorRenderbuffer[Ue]&&r.deleteRenderbuffer(Se.__webglColorRenderbuffer[Ue]);Se.__webglDepthRenderbuffer&&r.deleteRenderbuffer(Se.__webglDepthRenderbuffer)}if(ee.isWebGLMultipleRenderTargets)for(let Ue=0,je=X.length;Ue<je;Ue++){const _t=n.get(X[Ue]);_t.__webglTexture&&(r.deleteTexture(_t.__webglTexture),a.memory.textures--),n.remove(X[Ue])}n.remove(X),n.remove(ee)}let ye=0;function Ce(){ye=0}function K(){const ee=ye;return ee>=f&&console.warn("THREE.WebGLTextures: Trying to use "+ee+" texture units while this GPU supports only "+f),ye+=1,ee}function oe(ee){const X=[];return X.push(ee.wrapS),X.push(ee.wrapT),X.push(ee.wrapR||0),X.push(ee.magFilter),X.push(ee.minFilter),X.push(ee.anisotropy),X.push(ee.internalFormat),X.push(ee.format),X.push(ee.type),X.push(ee.generateMipmaps),X.push(ee.premultiplyAlpha),X.push(ee.flipY),X.push(ee.unpackAlignment),X.push(ee.encoding),X.join()}function ne(ee,X){const Se=n.get(ee);if(ee.isVideoTexture&&Yt(ee),ee.isRenderTargetTexture===!1&&ee.version>0&&Se.__version!==ee.version){const $e=ee.image;if($e===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if($e.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{He(Se,ee,X);return}}t.bindTexture(3553,Se.__webglTexture,33984+X)}function Q(ee,X){const Se=n.get(ee);if(ee.version>0&&Se.__version!==ee.version){He(Se,ee,X);return}t.bindTexture(35866,Se.__webglTexture,33984+X)}function $(ee,X){const Se=n.get(ee);if(ee.version>0&&Se.__version!==ee.version){He(Se,ee,X);return}t.bindTexture(32879,Se.__webglTexture,33984+X)}function he(ee,X){const Se=n.get(ee);if(ee.version>0&&Se.__version!==ee.version){Xe(Se,ee,X);return}t.bindTexture(34067,Se.__webglTexture,33984+X)}const Ae={[Pp]:10497,[Kr]:33071,[Ip]:33648},se={[Oi]:9728,[w0]:9984,[yp]:9986,[ai]:9729,[Ex]:9985,[Du]:9987};function Ne(ee,X,Se){if(Se?(r.texParameteri(ee,10242,Ae[X.wrapS]),r.texParameteri(ee,10243,Ae[X.wrapT]),(ee===32879||ee===35866)&&r.texParameteri(ee,32882,Ae[X.wrapR]),r.texParameteri(ee,10240,se[X.magFilter]),r.texParameteri(ee,10241,se[X.minFilter])):(r.texParameteri(ee,10242,33071),r.texParameteri(ee,10243,33071),(ee===32879||ee===35866)&&r.texParameteri(ee,32882,33071),(X.wrapS!==Kr||X.wrapT!==Kr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),r.texParameteri(ee,10240,V(X.magFilter)),r.texParameteri(ee,10241,V(X.minFilter)),X.minFilter!==Oi&&X.minFilter!==ai&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const $e=e.get("EXT_texture_filter_anisotropic");if(X.magFilter===Oi||X.minFilter!==yp&&X.minFilter!==Du||X.type===Co&&e.has("OES_texture_float_linear")===!1||u===!1&&X.type===Da&&e.has("OES_texture_half_float_linear")===!1)return;(X.anisotropy>1||n.get(X).__currentAnisotropy)&&(r.texParameterf(ee,$e.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(X.anisotropy,i.getMaxAnisotropy())),n.get(X).__currentAnisotropy=X.anisotropy)}}function Oe(ee,X){let Se=!1;ee.__webglInit===void 0&&(ee.__webglInit=!0,X.addEventListener("dispose",W));const $e=X.source;let Ue=M.get($e);Ue===void 0&&(Ue={},M.set($e,Ue));const je=oe(X);if(je!==ee.__cacheKey){Ue[je]===void 0&&(Ue[je]={texture:r.createTexture(),usedTimes:0},a.memory.textures++,Se=!0),Ue[je].usedTimes++;const _t=Ue[ee.__cacheKey];_t!==void 0&&(Ue[ee.__cacheKey].usedTimes--,_t.usedTimes===0&&re(X)),ee.__cacheKey=je,ee.__webglTexture=Ue[je].texture}return Se}function He(ee,X,Se){let $e=3553;(X.isDataArrayTexture||X.isCompressedArrayTexture)&&($e=35866),X.isData3DTexture&&($e=32879);const Ue=Oe(ee,X),je=X.source;t.bindTexture($e,ee.__webglTexture,33984+Se);const _t=n.get(je);if(je.version!==_t.__version||Ue===!0){t.activeTexture(33984+Se),r.pixelStorei(37440,X.flipY),r.pixelStorei(37441,X.premultiplyAlpha),r.pixelStorei(3317,X.unpackAlignment),r.pixelStorei(37443,0);const st=z(X)&&R(X.image)===!1;let Re=b(X.image,st,!1,m);Re=tn(X,Re);const Et=R(Re)||u,ht=s.convert(X.format,X.encoding);let Rt=s.convert(X.type),bt=I(X.internalFormat,ht,Rt,X.encoding,X.isVideoTexture);Ne($e,X,Et);let Tt;const rn=X.mipmaps,Cn=u&&X.isVideoTexture!==!0,Bn=_t.__version===void 0||Ue===!0,le=N(X,Re,Et);if(X.isDepthTexture)bt=6402,u?X.type===Co?bt=36012:X.type===Eu?bt=33190:X.type===Kc?bt=35056:bt=33189:X.type===Co&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),X.format===Cu&&bt===6402&&X.type!==Tx&&X.type!==Eu&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),X.type=Eu,Rt=s.convert(X.type)),X.format===ih&&bt===6402&&(bt=34041,X.type!==Kc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),X.type=Kc,Rt=s.convert(X.type))),Bn&&(Cn?t.texStorage2D(3553,1,bt,Re.width,Re.height):t.texImage2D(3553,0,bt,Re.width,Re.height,0,ht,Rt,null));else if(X.isDataTexture)if(rn.length>0&&Et){Cn&&Bn&&t.texStorage2D(3553,le,bt,rn[0].width,rn[0].height);for(let be=0,Fe=rn.length;be<Fe;be++)Tt=rn[be],Cn?t.texSubImage2D(3553,be,0,0,Tt.width,Tt.height,ht,Rt,Tt.data):t.texImage2D(3553,be,bt,Tt.width,Tt.height,0,ht,Rt,Tt.data);X.generateMipmaps=!1}else Cn?(Bn&&t.texStorage2D(3553,le,bt,Re.width,Re.height),t.texSubImage2D(3553,0,0,0,Re.width,Re.height,ht,Rt,Re.data)):t.texImage2D(3553,0,bt,Re.width,Re.height,0,ht,Rt,Re.data);else if(X.isCompressedTexture)if(X.isCompressedArrayTexture){Cn&&Bn&&t.texStorage3D(35866,le,bt,rn[0].width,rn[0].height,Re.depth);for(let be=0,Fe=rn.length;be<Fe;be++)Tt=rn[be],X.format!==_s?ht!==null?Cn?t.compressedTexSubImage3D(35866,be,0,0,0,Tt.width,Tt.height,Re.depth,ht,Tt.data,0,0):t.compressedTexImage3D(35866,be,bt,Tt.width,Tt.height,Re.depth,0,Tt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Cn?t.texSubImage3D(35866,be,0,0,0,Tt.width,Tt.height,Re.depth,ht,Rt,Tt.data):t.texImage3D(35866,be,bt,Tt.width,Tt.height,Re.depth,0,ht,Rt,Tt.data)}else{Cn&&Bn&&t.texStorage2D(3553,le,bt,rn[0].width,rn[0].height);for(let be=0,Fe=rn.length;be<Fe;be++)Tt=rn[be],X.format!==_s?ht!==null?Cn?t.compressedTexSubImage2D(3553,be,0,0,Tt.width,Tt.height,ht,Tt.data):t.compressedTexImage2D(3553,be,bt,Tt.width,Tt.height,0,Tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Cn?t.texSubImage2D(3553,be,0,0,Tt.width,Tt.height,ht,Rt,Tt.data):t.texImage2D(3553,be,bt,Tt.width,Tt.height,0,ht,Rt,Tt.data)}else if(X.isDataArrayTexture)Cn?(Bn&&t.texStorage3D(35866,le,bt,Re.width,Re.height,Re.depth),t.texSubImage3D(35866,0,0,0,0,Re.width,Re.height,Re.depth,ht,Rt,Re.data)):t.texImage3D(35866,0,bt,Re.width,Re.height,Re.depth,0,ht,Rt,Re.data);else if(X.isData3DTexture)Cn?(Bn&&t.texStorage3D(32879,le,bt,Re.width,Re.height,Re.depth),t.texSubImage3D(32879,0,0,0,0,Re.width,Re.height,Re.depth,ht,Rt,Re.data)):t.texImage3D(32879,0,bt,Re.width,Re.height,Re.depth,0,ht,Rt,Re.data);else if(X.isFramebufferTexture){if(Bn)if(Cn)t.texStorage2D(3553,le,bt,Re.width,Re.height);else{let be=Re.width,Fe=Re.height;for(let tt=0;tt<le;tt++)t.texImage2D(3553,tt,bt,be,Fe,0,ht,Rt,null),be>>=1,Fe>>=1}}else if(rn.length>0&&Et){Cn&&Bn&&t.texStorage2D(3553,le,bt,rn[0].width,rn[0].height);for(let be=0,Fe=rn.length;be<Fe;be++)Tt=rn[be],Cn?t.texSubImage2D(3553,be,0,0,ht,Rt,Tt):t.texImage2D(3553,be,bt,ht,Rt,Tt);X.generateMipmaps=!1}else Cn?(Bn&&t.texStorage2D(3553,le,bt,Re.width,Re.height),t.texSubImage2D(3553,0,0,0,ht,Rt,Re)):t.texImage2D(3553,0,bt,ht,Rt,Re);B(X,Et)&&k($e),_t.__version=je.version,X.onUpdate&&X.onUpdate(X)}ee.__version=X.version}function Xe(ee,X,Se){if(X.image.length!==6)return;const $e=Oe(ee,X),Ue=X.source;t.bindTexture(34067,ee.__webglTexture,33984+Se);const je=n.get(Ue);if(Ue.version!==je.__version||$e===!0){t.activeTexture(33984+Se),r.pixelStorei(37440,X.flipY),r.pixelStorei(37441,X.premultiplyAlpha),r.pixelStorei(3317,X.unpackAlignment),r.pixelStorei(37443,0);const _t=X.isCompressedTexture||X.image[0].isCompressedTexture,st=X.image[0]&&X.image[0].isDataTexture,Re=[];for(let be=0;be<6;be++)!_t&&!st?Re[be]=b(X.image[be],!1,!0,d):Re[be]=st?X.image[be].image:X.image[be],Re[be]=tn(X,Re[be]);const Et=Re[0],ht=R(Et)||u,Rt=s.convert(X.format,X.encoding),bt=s.convert(X.type),Tt=I(X.internalFormat,Rt,bt,X.encoding),rn=u&&X.isVideoTexture!==!0,Cn=je.__version===void 0||$e===!0;let Bn=N(X,Et,ht);Ne(34067,X,ht);let le;if(_t){rn&&Cn&&t.texStorage2D(34067,Bn,Tt,Et.width,Et.height);for(let be=0;be<6;be++){le=Re[be].mipmaps;for(let Fe=0;Fe<le.length;Fe++){const tt=le[Fe];X.format!==_s?Rt!==null?rn?t.compressedTexSubImage2D(34069+be,Fe,0,0,tt.width,tt.height,Rt,tt.data):t.compressedTexImage2D(34069+be,Fe,Tt,tt.width,tt.height,0,tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):rn?t.texSubImage2D(34069+be,Fe,0,0,tt.width,tt.height,Rt,bt,tt.data):t.texImage2D(34069+be,Fe,Tt,tt.width,tt.height,0,Rt,bt,tt.data)}}}else{le=X.mipmaps,rn&&Cn&&(le.length>0&&Bn++,t.texStorage2D(34067,Bn,Tt,Re[0].width,Re[0].height));for(let be=0;be<6;be++)if(st){rn?t.texSubImage2D(34069+be,0,0,0,Re[be].width,Re[be].height,Rt,bt,Re[be].data):t.texImage2D(34069+be,0,Tt,Re[be].width,Re[be].height,0,Rt,bt,Re[be].data);for(let Fe=0;Fe<le.length;Fe++){const ct=le[Fe].image[be].image;rn?t.texSubImage2D(34069+be,Fe+1,0,0,ct.width,ct.height,Rt,bt,ct.data):t.texImage2D(34069+be,Fe+1,Tt,ct.width,ct.height,0,Rt,bt,ct.data)}}else{rn?t.texSubImage2D(34069+be,0,0,0,Rt,bt,Re[be]):t.texImage2D(34069+be,0,Tt,Rt,bt,Re[be]);for(let Fe=0;Fe<le.length;Fe++){const tt=le[Fe];rn?t.texSubImage2D(34069+be,Fe+1,0,0,Rt,bt,tt.image[be]):t.texImage2D(34069+be,Fe+1,Tt,Rt,bt,tt.image[be])}}}B(X,ht)&&k(34067),je.__version=Ue.version,X.onUpdate&&X.onUpdate(X)}ee.__version=X.version}function Je(ee,X,Se,$e,Ue){const je=s.convert(Se.format,Se.encoding),_t=s.convert(Se.type),st=I(Se.internalFormat,je,_t,Se.encoding);n.get(X).__hasExternalTextures||(Ue===32879||Ue===35866?t.texImage3D(Ue,0,st,X.width,X.height,X.depth,0,je,_t,null):t.texImage2D(Ue,0,st,X.width,X.height,0,je,_t,null)),t.bindFramebuffer(36160,ee),Pt(X)?y.framebufferTexture2DMultisampleEXT(36160,$e,Ue,n.get(Se).__webglTexture,0,At(X)):(Ue===3553||Ue>=34069&&Ue<=34074)&&r.framebufferTexture2D(36160,$e,Ue,n.get(Se).__webglTexture,0),t.bindFramebuffer(36160,null)}function ut(ee,X,Se){if(r.bindRenderbuffer(36161,ee),X.depthBuffer&&!X.stencilBuffer){let $e=33189;if(Se||Pt(X)){const Ue=X.depthTexture;Ue&&Ue.isDepthTexture&&(Ue.type===Co?$e=36012:Ue.type===Eu&&($e=33190));const je=At(X);Pt(X)?y.renderbufferStorageMultisampleEXT(36161,je,$e,X.width,X.height):r.renderbufferStorageMultisample(36161,je,$e,X.width,X.height)}else r.renderbufferStorage(36161,$e,X.width,X.height);r.framebufferRenderbuffer(36160,36096,36161,ee)}else if(X.depthBuffer&&X.stencilBuffer){const $e=At(X);Se&&Pt(X)===!1?r.renderbufferStorageMultisample(36161,$e,35056,X.width,X.height):Pt(X)?y.renderbufferStorageMultisampleEXT(36161,$e,35056,X.width,X.height):r.renderbufferStorage(36161,34041,X.width,X.height),r.framebufferRenderbuffer(36160,33306,36161,ee)}else{const $e=X.isWebGLMultipleRenderTargets===!0?X.texture:[X.texture];for(let Ue=0;Ue<$e.length;Ue++){const je=$e[Ue],_t=s.convert(je.format,je.encoding),st=s.convert(je.type),Re=I(je.internalFormat,_t,st,je.encoding),Et=At(X);Se&&Pt(X)===!1?r.renderbufferStorageMultisample(36161,Et,Re,X.width,X.height):Pt(X)?y.renderbufferStorageMultisampleEXT(36161,Et,Re,X.width,X.height):r.renderbufferStorage(36161,Re,X.width,X.height)}}r.bindRenderbuffer(36161,null)}function De(ee,X){if(X&&X.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,ee),!(X.depthTexture&&X.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(X.depthTexture).__webglTexture||X.depthTexture.image.width!==X.width||X.depthTexture.image.height!==X.height)&&(X.depthTexture.image.width=X.width,X.depthTexture.image.height=X.height,X.depthTexture.needsUpdate=!0),ne(X.depthTexture,0);const $e=n.get(X.depthTexture).__webglTexture,Ue=At(X);if(X.depthTexture.format===Cu)Pt(X)?y.framebufferTexture2DMultisampleEXT(36160,36096,3553,$e,0,Ue):r.framebufferTexture2D(36160,36096,3553,$e,0);else if(X.depthTexture.format===ih)Pt(X)?y.framebufferTexture2DMultisampleEXT(36160,33306,3553,$e,0,Ue):r.framebufferTexture2D(36160,33306,3553,$e,0);else throw new Error("Unknown depthTexture format")}function Le(ee){const X=n.get(ee),Se=ee.isWebGLCubeRenderTarget===!0;if(ee.depthTexture&&!X.__autoAllocateDepthBuffer){if(Se)throw new Error("target.depthTexture not supported in Cube render targets");De(X.__webglFramebuffer,ee)}else if(Se){X.__webglDepthbuffer=[];for(let $e=0;$e<6;$e++)t.bindFramebuffer(36160,X.__webglFramebuffer[$e]),X.__webglDepthbuffer[$e]=r.createRenderbuffer(),ut(X.__webglDepthbuffer[$e],ee,!1)}else t.bindFramebuffer(36160,X.__webglFramebuffer),X.__webglDepthbuffer=r.createRenderbuffer(),ut(X.__webglDepthbuffer,ee,!1);t.bindFramebuffer(36160,null)}function Qe(ee,X,Se){const $e=n.get(ee);X!==void 0&&Je($e.__webglFramebuffer,ee,ee.texture,36064,3553),Se!==void 0&&Le(ee)}function gt(ee){const X=ee.texture,Se=n.get(ee),$e=n.get(X);ee.addEventListener("dispose",q),ee.isWebGLMultipleRenderTargets!==!0&&($e.__webglTexture===void 0&&($e.__webglTexture=r.createTexture()),$e.__version=X.version,a.memory.textures++);const Ue=ee.isWebGLCubeRenderTarget===!0,je=ee.isWebGLMultipleRenderTargets===!0,_t=R(ee)||u;if(Ue){Se.__webglFramebuffer=[];for(let st=0;st<6;st++)Se.__webglFramebuffer[st]=r.createFramebuffer()}else{if(Se.__webglFramebuffer=r.createFramebuffer(),je)if(i.drawBuffers){const st=ee.texture;for(let Re=0,Et=st.length;Re<Et;Re++){const ht=n.get(st[Re]);ht.__webglTexture===void 0&&(ht.__webglTexture=r.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(u&&ee.samples>0&&Pt(ee)===!1){const st=je?X:[X];Se.__webglMultisampledFramebuffer=r.createFramebuffer(),Se.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,Se.__webglMultisampledFramebuffer);for(let Re=0;Re<st.length;Re++){const Et=st[Re];Se.__webglColorRenderbuffer[Re]=r.createRenderbuffer(),r.bindRenderbuffer(36161,Se.__webglColorRenderbuffer[Re]);const ht=s.convert(Et.format,Et.encoding),Rt=s.convert(Et.type),bt=I(Et.internalFormat,ht,Rt,Et.encoding,ee.isXRRenderTarget===!0),Tt=At(ee);r.renderbufferStorageMultisample(36161,Tt,bt,ee.width,ee.height),r.framebufferRenderbuffer(36160,36064+Re,36161,Se.__webglColorRenderbuffer[Re])}r.bindRenderbuffer(36161,null),ee.depthBuffer&&(Se.__webglDepthRenderbuffer=r.createRenderbuffer(),ut(Se.__webglDepthRenderbuffer,ee,!0)),t.bindFramebuffer(36160,null)}}if(Ue){t.bindTexture(34067,$e.__webglTexture),Ne(34067,X,_t);for(let st=0;st<6;st++)Je(Se.__webglFramebuffer[st],ee,X,36064,34069+st);B(X,_t)&&k(34067),t.unbindTexture()}else if(je){const st=ee.texture;for(let Re=0,Et=st.length;Re<Et;Re++){const ht=st[Re],Rt=n.get(ht);t.bindTexture(3553,Rt.__webglTexture),Ne(3553,ht,_t),Je(Se.__webglFramebuffer,ee,ht,36064+Re,3553),B(ht,_t)&&k(3553)}t.unbindTexture()}else{let st=3553;(ee.isWebGL3DRenderTarget||ee.isWebGLArrayRenderTarget)&&(u?st=ee.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(st,$e.__webglTexture),Ne(st,X,_t),Je(Se.__webglFramebuffer,ee,X,36064,st),B(X,_t)&&k(st),t.unbindTexture()}ee.depthBuffer&&Le(ee)}function et(ee){const X=R(ee)||u,Se=ee.isWebGLMultipleRenderTargets===!0?ee.texture:[ee.texture];for(let $e=0,Ue=Se.length;$e<Ue;$e++){const je=Se[$e];if(B(je,X)){const _t=ee.isWebGLCubeRenderTarget?34067:3553,st=n.get(je).__webglTexture;t.bindTexture(_t,st),k(_t),t.unbindTexture()}}}function It(ee){if(u&&ee.samples>0&&Pt(ee)===!1){const X=ee.isWebGLMultipleRenderTargets?ee.texture:[ee.texture],Se=ee.width,$e=ee.height;let Ue=16384;const je=[],_t=ee.stencilBuffer?33306:36096,st=n.get(ee),Re=ee.isWebGLMultipleRenderTargets===!0;if(Re)for(let Et=0;Et<X.length;Et++)t.bindFramebuffer(36160,st.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064+Et,36161,null),t.bindFramebuffer(36160,st.__webglFramebuffer),r.framebufferTexture2D(36009,36064+Et,3553,null,0);t.bindFramebuffer(36008,st.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,st.__webglFramebuffer);for(let Et=0;Et<X.length;Et++){je.push(36064+Et),ee.depthBuffer&&je.push(_t);const ht=st.__ignoreDepthValues!==void 0?st.__ignoreDepthValues:!1;if(ht===!1&&(ee.depthBuffer&&(Ue|=256),ee.stencilBuffer&&(Ue|=1024)),Re&&r.framebufferRenderbuffer(36008,36064,36161,st.__webglColorRenderbuffer[Et]),ht===!0&&(r.invalidateFramebuffer(36008,[_t]),r.invalidateFramebuffer(36009,[_t])),Re){const Rt=n.get(X[Et]).__webglTexture;r.framebufferTexture2D(36009,36064,3553,Rt,0)}r.blitFramebuffer(0,0,Se,$e,0,0,Se,$e,Ue,9728),w&&r.invalidateFramebuffer(36008,je)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),Re)for(let Et=0;Et<X.length;Et++){t.bindFramebuffer(36160,st.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064+Et,36161,st.__webglColorRenderbuffer[Et]);const ht=n.get(X[Et]).__webglTexture;t.bindFramebuffer(36160,st.__webglFramebuffer),r.framebufferTexture2D(36009,36064+Et,3553,ht,0)}t.bindFramebuffer(36009,st.__webglMultisampledFramebuffer)}}function At(ee){return Math.min(_,ee.samples)}function Pt(ee){const X=n.get(ee);return u&&ee.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&X.__useRenderToTexture!==!1}function Yt(ee){const X=a.render.frame;T.get(ee)!==X&&(T.set(ee,X),ee.update())}function tn(ee,X){const Se=ee.encoding,$e=ee.format,Ue=ee.type;return ee.isCompressedTexture===!0||ee.isVideoTexture===!0||ee.format===S0||Se!==Lu&&(Se===ti?u===!1?e.has("EXT_sRGB")===!0&&$e===_s?(ee.format=S0,ee.minFilter=ai,ee.generateMipmaps=!1):X=bx.sRGBToLinear(X):($e!==_s||Ue!==Il)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Se)),X}this.allocateTextureUnit=K,this.resetTextureUnits=Ce,this.setTexture2D=ne,this.setTexture2DArray=Q,this.setTexture3D=$,this.setTextureCube=he,this.rebindTextures=Qe,this.setupRenderTarget=gt,this.updateRenderTargetMipmap=et,this.updateMultisampleRenderTarget=It,this.setupDepthRenderbuffer=Le,this.setupFrameBufferTexture=Je,this.useMultisampledRTT=Pt}function YM(r,e,t){const n=t.isWebGL2;function i(s,a=null){let u;if(s===Il)return 5121;if(s===vM)return 32819;if(s===yM)return 32820;if(s===mM)return 5120;if(s===gM)return 5122;if(s===Tx)return 5123;if(s===_M)return 5124;if(s===Eu)return 5125;if(s===Co)return 5126;if(s===Da)return n?5131:(u=e.get("OES_texture_half_float"),u!==null?u.HALF_FLOAT_OES:null);if(s===xM)return 6406;if(s===_s)return 6408;if(s===wM)return 6409;if(s===SM)return 6410;if(s===Cu)return 6402;if(s===ih)return 34041;if(s===S0)return u=e.get("EXT_sRGB"),u!==null?u.SRGB_ALPHA_EXT:null;if(s===EM)return 6403;if(s===TM)return 36244;if(s===MM)return 33319;if(s===CM)return 33320;if(s===AM)return 36249;if(s===a0||s===l0||s===u0||s===c0)if(a===ti)if(u=e.get("WEBGL_compressed_texture_s3tc_srgb"),u!==null){if(s===a0)return u.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===l0)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===u0)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===c0)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(u=e.get("WEBGL_compressed_texture_s3tc"),u!==null){if(s===a0)return u.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===l0)return u.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===u0)return u.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===c0)return u.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===vy||s===yy||s===xy||s===wy)if(u=e.get("WEBGL_compressed_texture_pvrtc"),u!==null){if(s===vy)return u.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===yy)return u.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===xy)return u.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===wy)return u.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===bM)return u=e.get("WEBGL_compressed_texture_etc1"),u!==null?u.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===Sy||s===Ey)if(u=e.get("WEBGL_compressed_texture_etc"),u!==null){if(s===Sy)return a===ti?u.COMPRESSED_SRGB8_ETC2:u.COMPRESSED_RGB8_ETC2;if(s===Ey)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:u.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===Ty||s===My||s===Cy||s===Ay||s===by||s===Py||s===Iy||s===Ry||s===Dy||s===Ly||s===Oy||s===Ny||s===ky||s===zy)if(u=e.get("WEBGL_compressed_texture_astc"),u!==null){if(s===Ty)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:u.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===My)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:u.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===Cy)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:u.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===Ay)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:u.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===by)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:u.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===Py)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:u.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===Iy)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:u.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===Ry)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:u.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===Dy)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:u.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===Ly)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:u.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===Oy)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:u.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===Ny)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:u.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===ky)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:u.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===zy)return a===ti?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:u.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===h0)if(u=e.get("EXT_texture_compression_bptc"),u!==null){if(s===h0)return a===ti?u.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:u.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===PM||s===Fy||s===Uy||s===By)if(u=e.get("EXT_texture_compression_rgtc"),u!==null){if(s===h0)return u.COMPRESSED_RED_RGTC1_EXT;if(s===Fy)return u.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===Uy)return u.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===By)return u.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Kc?n?34042:(u=e.get("WEBGL_depth_texture"),u!==null?u.UNSIGNED_INT_24_8_WEBGL:null):r[s]!==void 0?r[s]:null}return{convert:i}}class QM extends yr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class kf extends In{constructor(){super(),this.isGroup=!0,this.type="Group"}}const kL={type:"move"};class Ev{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new kf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new kf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Z,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Z),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new kf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Z,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Z),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,s=null,a=null;const u=this._targetRay,f=this._grip,d=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(d&&e.hand){a=!0;for(const E of e.hand.values()){const M=t.getJointPose(E,n),P=this._getHandJoint(d,E);M!==null&&(P.matrix.fromArray(M.transform.matrix),P.matrix.decompose(P.position,P.rotation,P.scale),P.jointRadius=M.radius),P.visible=M!==null}const m=d.joints["index-finger-tip"],_=d.joints["thumb-tip"],y=m.position.distanceTo(_.position),w=.02,T=.005;d.inputState.pinching&&y>w+T?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!d.inputState.pinching&&y<=w-T&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else f!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(f.matrix.fromArray(s.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),s.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(s.linearVelocity)):f.hasLinearVelocity=!1,s.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(s.angularVelocity)):f.hasAngularVelocity=!1));u!==null&&(i=t.getPose(e.targetRaySpace,n),i===null&&s!==null&&(i=s),i!==null&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),i.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(i.linearVelocity)):u.hasLinearVelocity=!1,i.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(i.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(kL)))}return u!==null&&(u.visible=i!==null),f!==null&&(f.visible=s!==null),d!==null&&(d.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new kf;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class KM extends ki{constructor(e,t,n,i,s,a,u,f,d,m){if(m=m!==void 0?m:Cu,m!==Cu&&m!==ih)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&m===Cu&&(n=Eu),n===void 0&&m===ih&&(n=Kc),super(null,i,s,a,u,f,m,n,d),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=u!==void 0?u:Oi,this.minFilter=f!==void 0?f:Oi,this.flipY=!1,this.generateMipmaps=!1}}class zL extends za{constructor(e,t){super();const n=this;let i=null,s=1,a=null,u="local-floor",f=1,d=null,m=null,_=null,y=null,w=null,T=null;const E=t.getContextAttributes();let M=null,P=null;const C=[],b=[],R=new Set,z=new Map,B=new yr;B.layers.enable(1),B.viewport=new Un;const k=new yr;k.layers.enable(2),k.viewport=new Un;const I=[B,k],N=new QM;N.layers.enable(1),N.layers.enable(2);let V=null,W=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function($){let he=C[$];return he===void 0&&(he=new Ev,C[$]=he),he.getTargetRaySpace()},this.getControllerGrip=function($){let he=C[$];return he===void 0&&(he=new Ev,C[$]=he),he.getGripSpace()},this.getHand=function($){let he=C[$];return he===void 0&&(he=new Ev,C[$]=he),he.getHandSpace()};function q($){const he=b.indexOf($.inputSource);if(he===-1)return;const Ae=C[he];Ae!==void 0&&Ae.dispatchEvent({type:$.type,data:$.inputSource})}function H(){i.removeEventListener("select",q),i.removeEventListener("selectstart",q),i.removeEventListener("selectend",q),i.removeEventListener("squeeze",q),i.removeEventListener("squeezestart",q),i.removeEventListener("squeezeend",q),i.removeEventListener("end",H),i.removeEventListener("inputsourceschange",re);for(let $=0;$<C.length;$++){const he=b[$];he!==null&&(b[$]=null,C[$].disconnect(he))}V=null,W=null,e.setRenderTarget(M),w=null,y=null,_=null,i=null,P=null,Q.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function($){s=$,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function($){u=$,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||a},this.setReferenceSpace=function($){d=$},this.getBaseLayer=function(){return y!==null?y:w},this.getBinding=function(){return _},this.getFrame=function(){return T},this.getSession=function(){return i},this.setSession=async function($){if(i=$,i!==null){if(M=e.getRenderTarget(),i.addEventListener("select",q),i.addEventListener("selectstart",q),i.addEventListener("selectend",q),i.addEventListener("squeeze",q),i.addEventListener("squeezestart",q),i.addEventListener("squeezeend",q),i.addEventListener("end",H),i.addEventListener("inputsourceschange",re),E.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const he={antialias:i.renderState.layers===void 0?E.antialias:!0,alpha:E.alpha,depth:E.depth,stencil:E.stencil,framebufferScaleFactor:s};w=new XRWebGLLayer(i,t,he),i.updateRenderState({baseLayer:w}),P=new Ao(w.framebufferWidth,w.framebufferHeight,{format:_s,type:Il,encoding:e.outputEncoding,stencilBuffer:E.stencil})}else{let he=null,Ae=null,se=null;E.depth&&(se=E.stencil?35056:33190,he=E.stencil?ih:Cu,Ae=E.stencil?Kc:Eu);const Ne={colorFormat:32856,depthFormat:se,scaleFactor:s};_=new XRWebGLBinding(i,t),y=_.createProjectionLayer(Ne),i.updateRenderState({layers:[y]}),P=new Ao(y.textureWidth,y.textureHeight,{format:_s,type:Il,depthTexture:new KM(y.textureWidth,y.textureHeight,Ae,void 0,void 0,void 0,void 0,void 0,void 0,he),stencilBuffer:E.stencil,encoding:e.outputEncoding,samples:E.antialias?4:0});const Oe=e.properties.get(P);Oe.__ignoreDepthValues=y.ignoreDepthValues}P.isXRRenderTarget=!0,this.setFoveation(f),d=null,a=await i.requestReferenceSpace(u),Q.setContext(i),Q.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};function re($){for(let he=0;he<$.removed.length;he++){const Ae=$.removed[he],se=b.indexOf(Ae);se>=0&&(b[se]=null,C[se].disconnect(Ae))}for(let he=0;he<$.added.length;he++){const Ae=$.added[he];let se=b.indexOf(Ae);if(se===-1){for(let Oe=0;Oe<C.length;Oe++)if(Oe>=b.length){b.push(Ae),se=Oe;break}else if(b[Oe]===null){b[Oe]=Ae,se=Oe;break}if(se===-1)break}const Ne=C[se];Ne&&Ne.connect(Ae)}}const de=new Z,ye=new Z;function Ce($,he,Ae){de.setFromMatrixPosition(he.matrixWorld),ye.setFromMatrixPosition(Ae.matrixWorld);const se=de.distanceTo(ye),Ne=he.projectionMatrix.elements,Oe=Ae.projectionMatrix.elements,He=Ne[14]/(Ne[10]-1),Xe=Ne[14]/(Ne[10]+1),Je=(Ne[9]+1)/Ne[5],ut=(Ne[9]-1)/Ne[5],De=(Ne[8]-1)/Ne[0],Le=(Oe[8]+1)/Oe[0],Qe=He*De,gt=He*Le,et=se/(-De+Le),It=et*-De;he.matrixWorld.decompose($.position,$.quaternion,$.scale),$.translateX(It),$.translateZ(et),$.matrixWorld.compose($.position,$.quaternion,$.scale),$.matrixWorldInverse.copy($.matrixWorld).invert();const At=He+et,Pt=Xe+et,Yt=Qe-It,tn=gt+(se-It),ee=Je*Xe/Pt*At,X=ut*Xe/Pt*At;$.projectionMatrix.makePerspective(Yt,tn,ee,X,At,Pt)}function K($,he){he===null?$.matrixWorld.copy($.matrix):$.matrixWorld.multiplyMatrices(he.matrixWorld,$.matrix),$.matrixWorldInverse.copy($.matrixWorld).invert()}this.updateCamera=function($){if(i===null)return;N.near=k.near=B.near=$.near,N.far=k.far=B.far=$.far,(V!==N.near||W!==N.far)&&(i.updateRenderState({depthNear:N.near,depthFar:N.far}),V=N.near,W=N.far);const he=$.parent,Ae=N.cameras;K(N,he);for(let Ne=0;Ne<Ae.length;Ne++)K(Ae[Ne],he);N.matrixWorld.decompose(N.position,N.quaternion,N.scale),$.matrix.copy(N.matrix),$.matrix.decompose($.position,$.quaternion,$.scale);const se=$.children;for(let Ne=0,Oe=se.length;Ne<Oe;Ne++)se[Ne].updateMatrixWorld(!0);Ae.length===2?Ce(N,B,k):N.projectionMatrix.copy(B.projectionMatrix)},this.getCamera=function(){return N},this.getFoveation=function(){if(!(y===null&&w===null))return f},this.setFoveation=function($){f=$,y!==null&&(y.fixedFoveation=$),w!==null&&w.fixedFoveation!==void 0&&(w.fixedFoveation=$)},this.getPlanes=function(){return R};let oe=null;function ne($,he){if(m=he.getViewerPose(d||a),T=he,m!==null){const Ae=m.views;w!==null&&(e.setRenderTargetFramebuffer(P,w.framebuffer),e.setRenderTarget(P));let se=!1;Ae.length!==N.cameras.length&&(N.cameras.length=0,se=!0);for(let Ne=0;Ne<Ae.length;Ne++){const Oe=Ae[Ne];let He=null;if(w!==null)He=w.getViewport(Oe);else{const Je=_.getViewSubImage(y,Oe);He=Je.viewport,Ne===0&&(e.setRenderTargetTextures(P,Je.colorTexture,y.ignoreDepthValues?void 0:Je.depthStencilTexture),e.setRenderTarget(P))}let Xe=I[Ne];Xe===void 0&&(Xe=new yr,Xe.layers.enable(Ne),Xe.viewport=new Un,I[Ne]=Xe),Xe.matrix.fromArray(Oe.transform.matrix),Xe.projectionMatrix.fromArray(Oe.projectionMatrix),Xe.viewport.set(He.x,He.y,He.width,He.height),Ne===0&&N.matrix.copy(Xe.matrix),se===!0&&N.cameras.push(Xe)}}for(let Ae=0;Ae<C.length;Ae++){const se=b[Ae],Ne=C[Ae];se!==null&&Ne!==void 0&&Ne.update(se,he,d||a)}if(oe&&oe($,he),he.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:he.detectedPlanes});let Ae=null;for(const se of R)he.detectedPlanes.has(se)||(Ae===null&&(Ae=[]),Ae.push(se));if(Ae!==null)for(const se of Ae)R.delete(se),z.delete(se),n.dispatchEvent({type:"planeremoved",data:se});for(const se of he.detectedPlanes)if(!R.has(se))R.add(se),z.set(se,he.lastChangedTime),n.dispatchEvent({type:"planeadded",data:se});else{const Ne=z.get(se);se.lastChangedTime>Ne&&(z.set(se,se.lastChangedTime),n.dispatchEvent({type:"planechanged",data:se}))}}T=null}const Q=new WM;Q.setAnimationLoop(ne),this.setAnimationLoop=function($){oe=$},this.dispose=function(){}}}function FL(r,e){function t(E,M){M.color.getRGB(E.fogColor.value,VM(r)),M.isFog?(E.fogNear.value=M.near,E.fogFar.value=M.far):M.isFogExp2&&(E.fogDensity.value=M.density)}function n(E,M,P,C,b){M.isMeshBasicMaterial||M.isMeshLambertMaterial?i(E,M):M.isMeshToonMaterial?(i(E,M),m(E,M)):M.isMeshPhongMaterial?(i(E,M),d(E,M)):M.isMeshStandardMaterial?(i(E,M),_(E,M),M.isMeshPhysicalMaterial&&y(E,M,b)):M.isMeshMatcapMaterial?(i(E,M),w(E,M)):M.isMeshDepthMaterial?i(E,M):M.isMeshDistanceMaterial?(i(E,M),T(E,M)):M.isMeshNormalMaterial?i(E,M):M.isLineBasicMaterial?(s(E,M),M.isLineDashedMaterial&&a(E,M)):M.isPointsMaterial?u(E,M,P,C):M.isSpriteMaterial?f(E,M):M.isShadowMaterial?(E.color.value.copy(M.color),E.opacity.value=M.opacity):M.isShaderMaterial&&(M.uniformsNeedUpdate=!1)}function i(E,M){E.opacity.value=M.opacity,M.color&&E.diffuse.value.copy(M.color),M.emissive&&E.emissive.value.copy(M.emissive).multiplyScalar(M.emissiveIntensity),M.map&&(E.map.value=M.map),M.alphaMap&&(E.alphaMap.value=M.alphaMap),M.bumpMap&&(E.bumpMap.value=M.bumpMap,E.bumpScale.value=M.bumpScale,M.side===Os&&(E.bumpScale.value*=-1)),M.displacementMap&&(E.displacementMap.value=M.displacementMap,E.displacementScale.value=M.displacementScale,E.displacementBias.value=M.displacementBias),M.emissiveMap&&(E.emissiveMap.value=M.emissiveMap),M.normalMap&&(E.normalMap.value=M.normalMap,E.normalScale.value.copy(M.normalScale),M.side===Os&&E.normalScale.value.negate()),M.specularMap&&(E.specularMap.value=M.specularMap),M.alphaTest>0&&(E.alphaTest.value=M.alphaTest);const P=e.get(M).envMap;if(P&&(E.envMap.value=P,E.flipEnvMap.value=P.isCubeTexture&&P.isRenderTargetTexture===!1?-1:1,E.reflectivity.value=M.reflectivity,E.ior.value=M.ior,E.refractionRatio.value=M.refractionRatio),M.lightMap){E.lightMap.value=M.lightMap;const R=r.useLegacyLights===!0?Math.PI:1;E.lightMapIntensity.value=M.lightMapIntensity*R}M.aoMap&&(E.aoMap.value=M.aoMap,E.aoMapIntensity.value=M.aoMapIntensity);let C;M.map?C=M.map:M.specularMap?C=M.specularMap:M.displacementMap?C=M.displacementMap:M.normalMap?C=M.normalMap:M.bumpMap?C=M.bumpMap:M.roughnessMap?C=M.roughnessMap:M.metalnessMap?C=M.metalnessMap:M.alphaMap?C=M.alphaMap:M.emissiveMap?C=M.emissiveMap:M.clearcoatMap?C=M.clearcoatMap:M.clearcoatNormalMap?C=M.clearcoatNormalMap:M.clearcoatRoughnessMap?C=M.clearcoatRoughnessMap:M.iridescenceMap?C=M.iridescenceMap:M.iridescenceThicknessMap?C=M.iridescenceThicknessMap:M.specularIntensityMap?C=M.specularIntensityMap:M.specularColorMap?C=M.specularColorMap:M.transmissionMap?C=M.transmissionMap:M.thicknessMap?C=M.thicknessMap:M.sheenColorMap?C=M.sheenColorMap:M.sheenRoughnessMap&&(C=M.sheenRoughnessMap),C!==void 0&&(C.isWebGLRenderTarget&&(C=C.texture),C.matrixAutoUpdate===!0&&C.updateMatrix(),E.uvTransform.value.copy(C.matrix));let b;M.aoMap?b=M.aoMap:M.lightMap&&(b=M.lightMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),E.uv2Transform.value.copy(b.matrix))}function s(E,M){E.diffuse.value.copy(M.color),E.opacity.value=M.opacity}function a(E,M){E.dashSize.value=M.dashSize,E.totalSize.value=M.dashSize+M.gapSize,E.scale.value=M.scale}function u(E,M,P,C){E.diffuse.value.copy(M.color),E.opacity.value=M.opacity,E.size.value=M.size*P,E.scale.value=C*.5,M.map&&(E.map.value=M.map),M.alphaMap&&(E.alphaMap.value=M.alphaMap),M.alphaTest>0&&(E.alphaTest.value=M.alphaTest);let b;M.map?b=M.map:M.alphaMap&&(b=M.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),E.uvTransform.value.copy(b.matrix))}function f(E,M){E.diffuse.value.copy(M.color),E.opacity.value=M.opacity,E.rotation.value=M.rotation,M.map&&(E.map.value=M.map),M.alphaMap&&(E.alphaMap.value=M.alphaMap),M.alphaTest>0&&(E.alphaTest.value=M.alphaTest);let P;M.map?P=M.map:M.alphaMap&&(P=M.alphaMap),P!==void 0&&(P.matrixAutoUpdate===!0&&P.updateMatrix(),E.uvTransform.value.copy(P.matrix))}function d(E,M){E.specular.value.copy(M.specular),E.shininess.value=Math.max(M.shininess,1e-4)}function m(E,M){M.gradientMap&&(E.gradientMap.value=M.gradientMap)}function _(E,M){E.roughness.value=M.roughness,E.metalness.value=M.metalness,M.roughnessMap&&(E.roughnessMap.value=M.roughnessMap),M.metalnessMap&&(E.metalnessMap.value=M.metalnessMap),e.get(M).envMap&&(E.envMapIntensity.value=M.envMapIntensity)}function y(E,M,P){E.ior.value=M.ior,M.sheen>0&&(E.sheenColor.value.copy(M.sheenColor).multiplyScalar(M.sheen),E.sheenRoughness.value=M.sheenRoughness,M.sheenColorMap&&(E.sheenColorMap.value=M.sheenColorMap),M.sheenRoughnessMap&&(E.sheenRoughnessMap.value=M.sheenRoughnessMap)),M.clearcoat>0&&(E.clearcoat.value=M.clearcoat,E.clearcoatRoughness.value=M.clearcoatRoughness,M.clearcoatMap&&(E.clearcoatMap.value=M.clearcoatMap),M.clearcoatRoughnessMap&&(E.clearcoatRoughnessMap.value=M.clearcoatRoughnessMap),M.clearcoatNormalMap&&(E.clearcoatNormalScale.value.copy(M.clearcoatNormalScale),E.clearcoatNormalMap.value=M.clearcoatNormalMap,M.side===Os&&E.clearcoatNormalScale.value.negate())),M.iridescence>0&&(E.iridescence.value=M.iridescence,E.iridescenceIOR.value=M.iridescenceIOR,E.iridescenceThicknessMinimum.value=M.iridescenceThicknessRange[0],E.iridescenceThicknessMaximum.value=M.iridescenceThicknessRange[1],M.iridescenceMap&&(E.iridescenceMap.value=M.iridescenceMap),M.iridescenceThicknessMap&&(E.iridescenceThicknessMap.value=M.iridescenceThicknessMap)),M.transmission>0&&(E.transmission.value=M.transmission,E.transmissionSamplerMap.value=P.texture,E.transmissionSamplerSize.value.set(P.width,P.height),M.transmissionMap&&(E.transmissionMap.value=M.transmissionMap),E.thickness.value=M.thickness,M.thicknessMap&&(E.thicknessMap.value=M.thicknessMap),E.attenuationDistance.value=M.attenuationDistance,E.attenuationColor.value.copy(M.attenuationColor)),E.specularIntensity.value=M.specularIntensity,E.specularColor.value.copy(M.specularColor),M.specularIntensityMap&&(E.specularIntensityMap.value=M.specularIntensityMap),M.specularColorMap&&(E.specularColorMap.value=M.specularColorMap)}function w(E,M){M.matcap&&(E.matcap.value=M.matcap)}function T(E,M){E.referencePosition.value.copy(M.referencePosition),E.nearDistance.value=M.nearDistance,E.farDistance.value=M.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:n}}function UL(r,e,t,n){let i={},s={},a=[];const u=t.isWebGL2?r.getParameter(35375):0;function f(C,b){const R=b.program;n.uniformBlockBinding(C,R)}function d(C,b){let R=i[C.id];R===void 0&&(T(C),R=m(C),i[C.id]=R,C.addEventListener("dispose",M));const z=b.program;n.updateUBOMapping(C,z);const B=e.render.frame;s[C.id]!==B&&(y(C),s[C.id]=B)}function m(C){const b=_();C.__bindingPointIndex=b;const R=r.createBuffer(),z=C.__size,B=C.usage;return r.bindBuffer(35345,R),r.bufferData(35345,z,B),r.bindBuffer(35345,null),r.bindBufferBase(35345,b,R),R}function _(){for(let C=0;C<u;C++)if(a.indexOf(C)===-1)return a.push(C),C;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function y(C){const b=i[C.id],R=C.uniforms,z=C.__cache;r.bindBuffer(35345,b);for(let B=0,k=R.length;B<k;B++){const I=R[B];if(w(I,B,z)===!0){const N=I.__offset,V=Array.isArray(I.value)?I.value:[I.value];let W=0;for(let q=0;q<V.length;q++){const H=V[q],re=E(H);typeof H=="number"?(I.__data[0]=H,r.bufferSubData(35345,N+W,I.__data)):H.isMatrix3?(I.__data[0]=H.elements[0],I.__data[1]=H.elements[1],I.__data[2]=H.elements[2],I.__data[3]=H.elements[0],I.__data[4]=H.elements[3],I.__data[5]=H.elements[4],I.__data[6]=H.elements[5],I.__data[7]=H.elements[0],I.__data[8]=H.elements[6],I.__data[9]=H.elements[7],I.__data[10]=H.elements[8],I.__data[11]=H.elements[0]):(H.toArray(I.__data,W),W+=re.storage/Float32Array.BYTES_PER_ELEMENT)}r.bufferSubData(35345,N,I.__data)}}r.bindBuffer(35345,null)}function w(C,b,R){const z=C.value;if(R[b]===void 0){if(typeof z=="number")R[b]=z;else{const B=Array.isArray(z)?z:[z],k=[];for(let I=0;I<B.length;I++)k.push(B[I].clone());R[b]=k}return!0}else if(typeof z=="number"){if(R[b]!==z)return R[b]=z,!0}else{const B=Array.isArray(R[b])?R[b]:[R[b]],k=Array.isArray(z)?z:[z];for(let I=0;I<B.length;I++){const N=B[I];if(N.equals(k[I])===!1)return N.copy(k[I]),!0}}return!1}function T(C){const b=C.uniforms;let R=0;const z=16;let B=0;for(let k=0,I=b.length;k<I;k++){const N=b[k],V={boundary:0,storage:0},W=Array.isArray(N.value)?N.value:[N.value];for(let q=0,H=W.length;q<H;q++){const re=W[q],de=E(re);V.boundary+=de.boundary,V.storage+=de.storage}if(N.__data=new Float32Array(V.storage/Float32Array.BYTES_PER_ELEMENT),N.__offset=R,k>0){B=R%z;const q=z-B;B!==0&&q-V.boundary<0&&(R+=z-B,N.__offset=R)}R+=V.storage}return B=R%z,B>0&&(R+=z-B),C.__size=R,C.__cache={},this}function E(C){const b={boundary:0,storage:0};return typeof C=="number"?(b.boundary=4,b.storage=4):C.isVector2?(b.boundary=8,b.storage=8):C.isVector3||C.isColor?(b.boundary=16,b.storage=12):C.isVector4?(b.boundary=16,b.storage=16):C.isMatrix3?(b.boundary=48,b.storage=48):C.isMatrix4?(b.boundary=64,b.storage=64):C.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",C),b}function M(C){const b=C.target;b.removeEventListener("dispose",M);const R=a.indexOf(b.__bindingPointIndex);a.splice(R,1),r.deleteBuffer(i[b.id]),delete i[b.id],delete s[b.id]}function P(){for(const C in i)r.deleteBuffer(i[C]);a=[],i={},s={}}return{bind:f,update:d,dispose:P}}function BL(){const r=kp("canvas");return r.style.display="block",r}function Z0(r={}){this.isWebGLRenderer=!0;const e=r.canvas!==void 0?r.canvas:BL(),t=r.context!==void 0?r.context:null,n=r.depth!==void 0?r.depth:!0,i=r.stencil!==void 0?r.stencil:!0,s=r.antialias!==void 0?r.antialias:!1,a=r.premultipliedAlpha!==void 0?r.premultipliedAlpha:!0,u=r.preserveDrawingBuffer!==void 0?r.preserveDrawingBuffer:!1,f=r.powerPreference!==void 0?r.powerPreference:"default",d=r.failIfMajorPerformanceCaveat!==void 0?r.failIfMajorPerformanceCaveat:!1;let m;t!==null?m=t.getContextAttributes().alpha:m=r.alpha!==void 0?r.alpha:!1;let _=null,y=null;const w=[],T=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Lu,this.useLegacyLights=!0,this.toneMapping=aa,this.toneMappingExposure=1;const E=this;let M=!1,P=0,C=0,b=null,R=-1,z=null;const B=new Un,k=new Un;let I=null,N=e.width,V=e.height,W=1,q=null,H=null;const re=new Un(0,0,N,V),de=new Un(0,0,N,V);let ye=!1;const Ce=new Q0;let K=!1,oe=!1,ne=null;const Q=new Jt,$=new Z,he={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ae(){return b===null?W:1}let se=t;function Ne(Y,ge){for(let Ee=0;Ee<Y.length;Ee++){const pe=Y[Ee],Ie=e.getContext(pe,ge);if(Ie!==null)return Ie}return null}try{const Y={alpha:!0,depth:n,stencil:i,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:u,powerPreference:f,failIfMajorPerformanceCaveat:d};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${j0}`),e.addEventListener("webglcontextlost",Rt,!1),e.addEventListener("webglcontextrestored",bt,!1),e.addEventListener("webglcontextcreationerror",Tt,!1),se===null){const ge=["webgl2","webgl","experimental-webgl"];if(E.isWebGL1Renderer===!0&&ge.shift(),se=Ne(ge,Y),se===null)throw Ne(ge)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}se.getShaderPrecisionFormat===void 0&&(se.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Y){throw console.error("THREE.WebGLRenderer: "+Y.message),Y}let Oe,He,Xe,Je,ut,De,Le,Qe,gt,et,It,At,Pt,Yt,tn,ee,X,Se,$e,Ue,je,_t,st,Re;function Et(){Oe=new nD(se),He=new QR(se,Oe,r),Oe.init(He),_t=new YM(se,Oe,He),Xe=new OL(se,Oe,He),Je=new sD,ut=new SL,De=new NL(se,Oe,Xe,ut,He,_t,Je),Le=new ZR(E),Qe=new tD(E),gt=new pP(se,He),st=new $R(se,Oe,gt,He),et=new iD(se,gt,Je,st),It=new uD(se,et,gt,Je),$e=new lD(se,He,De),ee=new KR(ut),At=new wL(E,Le,Qe,Oe,He,st,ee),Pt=new FL(E,ut),Yt=new TL,tn=new IL(Oe,He),Se=new XR(E,Le,Qe,Xe,It,m,a),X=new LL(E,It,He),Re=new UL(se,Je,He,Xe),Ue=new YR(se,Oe,Je,He),je=new rD(se,Oe,Je,He),Je.programs=At.programs,E.capabilities=He,E.extensions=Oe,E.properties=ut,E.renderLists=Yt,E.shadowMap=X,E.state=Xe,E.info=Je}Et();const ht=new zL(E,se);this.xr=ht,this.getContext=function(){return se},this.getContextAttributes=function(){return se.getContextAttributes()},this.forceContextLoss=function(){const Y=Oe.get("WEBGL_lose_context");Y&&Y.loseContext()},this.forceContextRestore=function(){const Y=Oe.get("WEBGL_lose_context");Y&&Y.restoreContext()},this.getPixelRatio=function(){return W},this.setPixelRatio=function(Y){Y!==void 0&&(W=Y,this.setSize(N,V,!1))},this.getSize=function(Y){return Y.set(N,V)},this.setSize=function(Y,ge,Ee=!0){if(ht.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}N=Y,V=ge,e.width=Math.floor(Y*W),e.height=Math.floor(ge*W),Ee===!0&&(e.style.width=Y+"px",e.style.height=ge+"px"),this.setViewport(0,0,Y,ge)},this.getDrawingBufferSize=function(Y){return Y.set(N*W,V*W).floor()},this.setDrawingBufferSize=function(Y,ge,Ee){N=Y,V=ge,W=Ee,e.width=Math.floor(Y*Ee),e.height=Math.floor(ge*Ee),this.setViewport(0,0,Y,ge)},this.getCurrentViewport=function(Y){return Y.copy(B)},this.getViewport=function(Y){return Y.copy(re)},this.setViewport=function(Y,ge,Ee,pe){Y.isVector4?re.set(Y.x,Y.y,Y.z,Y.w):re.set(Y,ge,Ee,pe),Xe.viewport(B.copy(re).multiplyScalar(W).floor())},this.getScissor=function(Y){return Y.copy(de)},this.setScissor=function(Y,ge,Ee,pe){Y.isVector4?de.set(Y.x,Y.y,Y.z,Y.w):de.set(Y,ge,Ee,pe),Xe.scissor(k.copy(de).multiplyScalar(W).floor())},this.getScissorTest=function(){return ye},this.setScissorTest=function(Y){Xe.setScissorTest(ye=Y)},this.setOpaqueSort=function(Y){q=Y},this.setTransparentSort=function(Y){H=Y},this.getClearColor=function(Y){return Y.copy(Se.getClearColor())},this.setClearColor=function(){Se.setClearColor.apply(Se,arguments)},this.getClearAlpha=function(){return Se.getClearAlpha()},this.setClearAlpha=function(){Se.setClearAlpha.apply(Se,arguments)},this.clear=function(Y=!0,ge=!0,Ee=!0){let pe=0;Y&&(pe|=16384),ge&&(pe|=256),Ee&&(pe|=1024),se.clear(pe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Rt,!1),e.removeEventListener("webglcontextrestored",bt,!1),e.removeEventListener("webglcontextcreationerror",Tt,!1),Yt.dispose(),tn.dispose(),ut.dispose(),Le.dispose(),Qe.dispose(),It.dispose(),st.dispose(),Re.dispose(),At.dispose(),ht.dispose(),ht.removeEventListener("sessionstart",Fe),ht.removeEventListener("sessionend",tt),ne&&(ne.dispose(),ne=null),ct.stop()};function Rt(Y){Y.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),M=!0}function bt(){console.log("THREE.WebGLRenderer: Context Restored."),M=!1;const Y=Je.autoReset,ge=X.enabled,Ee=X.autoUpdate,pe=X.needsUpdate,Ie=X.type;Et(),Je.autoReset=Y,X.enabled=ge,X.autoUpdate=Ee,X.needsUpdate=pe,X.type=Ie}function Tt(Y){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Y.statusMessage)}function rn(Y){const ge=Y.target;ge.removeEventListener("dispose",rn),Cn(ge)}function Cn(Y){Bn(Y),ut.remove(Y)}function Bn(Y){const ge=ut.get(Y).programs;ge!==void 0&&(ge.forEach(function(Ee){At.releaseProgram(Ee)}),Y.isShaderMaterial&&At.releaseShaderCache(Y))}this.renderBufferDirect=function(Y,ge,Ee,pe,Ie,Mt){ge===null&&(ge=he);const kt=Ie.isMesh&&Ie.matrixWorld.determinant()<0,Lt=ca(Y,ge,Ee,pe,Ie);Xe.setMaterial(pe,kt);let Ft=Ee.index,Ht=1;pe.wireframe===!0&&(Ft=et.getWireframeAttribute(Ee),Ht=2);const Qt=Ee.drawRange,Kt=Ee.attributes.position;let Nn=Qt.start*Ht,_i=(Qt.start+Qt.count)*Ht;Mt!==null&&(Nn=Math.max(Nn,Mt.start*Ht),_i=Math.min(_i,(Mt.start+Mt.count)*Ht)),Ft!==null?(Nn=Math.max(Nn,0),_i=Math.min(_i,Ft.count)):Kt!=null&&(Nn=Math.max(Nn,0),_i=Math.min(_i,Kt.count));const Sr=_i-Nn;if(Sr<0||Sr===1/0)return;st.setup(Ie,pe,Lt,Ee,Ft);let ys,Yn=Ue;if(Ft!==null&&(ys=gt.get(Ft),Yn=je,Yn.setIndex(ys)),Ie.isMesh)pe.wireframe===!0?(Xe.setLineWidth(pe.wireframeLinewidth*Ae()),Yn.setMode(1)):Yn.setMode(4);else if(Ie.isLine){let vt=pe.linewidth;vt===void 0&&(vt=1),Xe.setLineWidth(vt*Ae()),Ie.isLineSegments?Yn.setMode(1):Ie.isLineLoop?Yn.setMode(2):Yn.setMode(3)}else Ie.isPoints?Yn.setMode(0):Ie.isSprite&&Yn.setMode(4);if(Ie.isInstancedMesh)Yn.renderInstances(Nn,Sr,Ie.count);else if(Ee.isInstancedBufferGeometry){const vt=Ee._maxInstanceCount!==void 0?Ee._maxInstanceCount:1/0,xs=Math.min(Ee.instanceCount,vt);Yn.renderInstances(Nn,Sr,xs)}else Yn.render(Nn,Sr)},this.compile=function(Y,ge){function Ee(pe,Ie,Mt){pe.transparent===!0&&pe.side===Ra&&pe.forceSinglePass===!1?(pe.side=Os,pe.needsUpdate=!0,Ci(pe,Ie,Mt),pe.side=Pl,pe.needsUpdate=!0,Ci(pe,Ie,Mt),pe.side=Ra):Ci(pe,Ie,Mt)}y=tn.get(Y),y.init(),T.push(y),Y.traverseVisible(function(pe){pe.isLight&&pe.layers.test(ge.layers)&&(y.pushLight(pe),pe.castShadow&&y.pushShadow(pe))}),y.setupLights(E.useLegacyLights),Y.traverse(function(pe){const Ie=pe.material;if(Ie)if(Array.isArray(Ie))for(let Mt=0;Mt<Ie.length;Mt++){const kt=Ie[Mt];Ee(kt,Y,pe)}else Ee(Ie,Y,pe)}),T.pop(),y=null};let le=null;function be(Y){le&&le(Y)}function Fe(){ct.stop()}function tt(){ct.start()}const ct=new WM;ct.setAnimationLoop(be),typeof self<"u"&&ct.setContext(self),this.setAnimationLoop=function(Y){le=Y,ht.setAnimationLoop(Y),Y===null?ct.stop():ct.start()},ht.addEventListener("sessionstart",Fe),ht.addEventListener("sessionend",tt),this.render=function(Y,ge){if(ge!==void 0&&ge.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(M===!0)return;Y.matrixWorldAutoUpdate===!0&&Y.updateMatrixWorld(),ge.parent===null&&ge.matrixWorldAutoUpdate===!0&&ge.updateMatrixWorld(),ht.enabled===!0&&ht.isPresenting===!0&&(ht.cameraAutoUpdate===!0&&ht.updateCamera(ge),ge=ht.getCamera()),Y.isScene===!0&&Y.onBeforeRender(E,Y,ge,b),y=tn.get(Y,T.length),y.init(),T.push(y),Q.multiplyMatrices(ge.projectionMatrix,ge.matrixWorldInverse),Ce.setFromProjectionMatrix(Q),oe=this.localClippingEnabled,K=ee.init(this.clippingPlanes,oe),_=Yt.get(Y,w.length),_.init(),w.push(_),an(Y,ge,0,E.sortObjects),_.finish(),E.sortObjects===!0&&_.sort(q,H),K===!0&&ee.beginShadows();const Ee=y.state.shadowsArray;if(X.render(Ee,Y,ge),K===!0&&ee.endShadows(),this.info.autoReset===!0&&this.info.reset(),Se.render(_,Y),y.setupLights(E.useLegacyLights),ge.isArrayCamera){const pe=ge.cameras;for(let Ie=0,Mt=pe.length;Ie<Mt;Ie++){const kt=pe[Ie];Wn(_,Y,kt,kt.viewport)}}else Wn(_,Y,ge);b!==null&&(De.updateMultisampleRenderTarget(b),De.updateRenderTargetMipmap(b)),Y.isScene===!0&&Y.onAfterRender(E,Y,ge),st.resetDefaultState(),R=-1,z=null,T.pop(),T.length>0?y=T[T.length-1]:y=null,w.pop(),w.length>0?_=w[w.length-1]:_=null};function an(Y,ge,Ee,pe){if(Y.visible===!1)return;if(Y.layers.test(ge.layers)){if(Y.isGroup)Ee=Y.renderOrder;else if(Y.isLOD)Y.autoUpdate===!0&&Y.update(ge);else if(Y.isLight)y.pushLight(Y),Y.castShadow&&y.pushShadow(Y);else if(Y.isSprite){if(!Y.frustumCulled||Ce.intersectsSprite(Y)){pe&&$.setFromMatrixPosition(Y.matrixWorld).applyMatrix4(Q);const kt=It.update(Y),Lt=Y.material;Lt.visible&&_.push(Y,kt,Lt,Ee,$.z,null)}}else if((Y.isMesh||Y.isLine||Y.isPoints)&&(Y.isSkinnedMesh&&Y.skeleton.frame!==Je.render.frame&&(Y.skeleton.update(),Y.skeleton.frame=Je.render.frame),!Y.frustumCulled||Ce.intersectsObject(Y))){pe&&$.setFromMatrixPosition(Y.matrixWorld).applyMatrix4(Q);const kt=It.update(Y),Lt=Y.material;if(Array.isArray(Lt)){const Ft=kt.groups;for(let Ht=0,Qt=Ft.length;Ht<Qt;Ht++){const Kt=Ft[Ht],Nn=Lt[Kt.materialIndex];Nn&&Nn.visible&&_.push(Y,kt,Nn,Ee,$.z,Kt)}}else Lt.visible&&_.push(Y,kt,Lt,Ee,$.z,null)}}const Mt=Y.children;for(let kt=0,Lt=Mt.length;kt<Lt;kt++)an(Mt[kt],ge,Ee,pe)}function Wn(Y,ge,Ee,pe){const Ie=Y.opaque,Mt=Y.transmissive,kt=Y.transparent;y.setupLightsView(Ee),K===!0&&ee.setGlobalState(E.clippingPlanes,Ee),Mt.length>0&&ri(Ie,ge,Ee),pe&&Xe.viewport(B.copy(pe)),Ie.length>0&&Yi(Ie,ge,Ee),Mt.length>0&&Yi(Mt,ge,Ee),kt.length>0&&Yi(kt,ge,Ee),Xe.buffers.depth.setTest(!0),Xe.buffers.depth.setMask(!0),Xe.buffers.color.setMask(!0),Xe.setPolygonOffset(!1)}function ri(Y,ge,Ee){const pe=He.isWebGL2;ne===null&&(ne=new Ao(1024,1024,{generateMipmaps:!0,type:Oe.has("EXT_color_buffer_half_float")?Da:Il,minFilter:Du,samples:pe&&s===!0?4:0}));const Ie=E.getRenderTarget();E.setRenderTarget(ne),E.clear();const Mt=E.toneMapping;E.toneMapping=aa,Yi(Y,ge,Ee),E.toneMapping=Mt,De.updateMultisampleRenderTarget(ne),De.updateRenderTargetMipmap(ne),E.setRenderTarget(Ie)}function Yi(Y,ge,Ee){const pe=ge.isScene===!0?ge.overrideMaterial:null;for(let Ie=0,Mt=Y.length;Ie<Mt;Ie++){const kt=Y[Ie],Lt=kt.object,Ft=kt.geometry,Ht=pe===null?kt.material:pe,Qt=kt.group;Lt.layers.test(Ee.layers)&&_n(Lt,ge,Ee,Ft,Ht,Qt)}}function _n(Y,ge,Ee,pe,Ie,Mt){Y.onBeforeRender(E,ge,Ee,pe,Ie,Mt),Y.modelViewMatrix.multiplyMatrices(Ee.matrixWorldInverse,Y.matrixWorld),Y.normalMatrix.getNormalMatrix(Y.modelViewMatrix),Ie.onBeforeRender(E,ge,Ee,pe,Y,Mt),Ie.transparent===!0&&Ie.side===Ra&&Ie.forceSinglePass===!1?(Ie.side=Os,Ie.needsUpdate=!0,E.renderBufferDirect(Ee,ge,pe,Ie,Y,Mt),Ie.side=Pl,Ie.needsUpdate=!0,E.renderBufferDirect(Ee,ge,pe,Ie,Y,Mt),Ie.side=Ra):E.renderBufferDirect(Ee,ge,pe,Ie,Y,Mt),Y.onAfterRender(E,ge,Ee,pe,Ie,Mt)}function Ci(Y,ge,Ee){ge.isScene!==!0&&(ge=he);const pe=ut.get(Y),Ie=y.state.lights,Mt=y.state.shadowsArray,kt=Ie.state.version,Lt=At.getParameters(Y,Ie.state,Mt,ge,Ee),Ft=At.getProgramCacheKey(Lt);let Ht=pe.programs;pe.environment=Y.isMeshStandardMaterial?ge.environment:null,pe.fog=ge.fog,pe.envMap=(Y.isMeshStandardMaterial?Qe:Le).get(Y.envMap||pe.environment),Ht===void 0&&(Y.addEventListener("dispose",rn),Ht=new Map,pe.programs=Ht);let Qt=Ht.get(Ft);if(Qt!==void 0){if(pe.currentProgram===Qt&&pe.lightsStateVersion===kt)return vn(Y,Lt),Qt}else Lt.uniforms=At.getUniforms(Y),Y.onBuild(Ee,Lt,E),Y.onBeforeCompile(Lt,E),Qt=At.acquireProgram(Lt,Ft),Ht.set(Ft,Qt),pe.uniforms=Lt.uniforms;const Kt=pe.uniforms;(!Y.isShaderMaterial&&!Y.isRawShaderMaterial||Y.clipping===!0)&&(Kt.clippingPlanes=ee.uniform),vn(Y,Lt),pe.needsLights=oo(Y),pe.lightsStateVersion=kt,pe.needsLights&&(Kt.ambientLightColor.value=Ie.state.ambient,Kt.lightProbe.value=Ie.state.probe,Kt.directionalLights.value=Ie.state.directional,Kt.directionalLightShadows.value=Ie.state.directionalShadow,Kt.spotLights.value=Ie.state.spot,Kt.spotLightShadows.value=Ie.state.spotShadow,Kt.rectAreaLights.value=Ie.state.rectArea,Kt.ltc_1.value=Ie.state.rectAreaLTC1,Kt.ltc_2.value=Ie.state.rectAreaLTC2,Kt.pointLights.value=Ie.state.point,Kt.pointLightShadows.value=Ie.state.pointShadow,Kt.hemisphereLights.value=Ie.state.hemi,Kt.directionalShadowMap.value=Ie.state.directionalShadowMap,Kt.directionalShadowMatrix.value=Ie.state.directionalShadowMatrix,Kt.spotShadowMap.value=Ie.state.spotShadowMap,Kt.spotLightMatrix.value=Ie.state.spotLightMatrix,Kt.spotLightMap.value=Ie.state.spotLightMap,Kt.pointShadowMap.value=Ie.state.pointShadowMap,Kt.pointShadowMatrix.value=Ie.state.pointShadowMatrix);const Nn=Qt.getUniforms(),_i=p0.seqWithValue(Nn.seq,Kt);return pe.currentProgram=Qt,pe.uniformsList=_i,Qt}function vn(Y,ge){const Ee=ut.get(Y);Ee.outputEncoding=ge.outputEncoding,Ee.instancing=ge.instancing,Ee.skinning=ge.skinning,Ee.morphTargets=ge.morphTargets,Ee.morphNormals=ge.morphNormals,Ee.morphColors=ge.morphColors,Ee.morphTargetsCount=ge.morphTargetsCount,Ee.numClippingPlanes=ge.numClippingPlanes,Ee.numIntersection=ge.numClipIntersection,Ee.vertexAlphas=ge.vertexAlphas,Ee.vertexTangents=ge.vertexTangents,Ee.toneMapping=ge.toneMapping}function ca(Y,ge,Ee,pe,Ie){ge.isScene!==!0&&(ge=he),De.resetTextureUnits();const Mt=ge.fog,kt=pe.isMeshStandardMaterial?ge.environment:null,Lt=b===null?E.outputEncoding:b.isXRRenderTarget===!0?b.texture.encoding:Lu,Ft=(pe.isMeshStandardMaterial?Qe:Le).get(pe.envMap||kt),Ht=pe.vertexColors===!0&&!!Ee.attributes.color&&Ee.attributes.color.itemSize===4,Qt=!!pe.normalMap&&!!Ee.attributes.tangent,Kt=!!Ee.morphAttributes.position,Nn=!!Ee.morphAttributes.normal,_i=!!Ee.morphAttributes.color,Sr=pe.toneMapped?E.toneMapping:aa,ys=Ee.morphAttributes.position||Ee.morphAttributes.normal||Ee.morphAttributes.color,Yn=ys!==void 0?ys.length:0,vt=ut.get(pe),xs=y.state.lights;if(K===!0&&(oe===!0||Y!==z)){const ln=Y===z&&pe.id===R;ee.setState(pe,Y,ln)}let Rn=!1;pe.version===vt.__version?(vt.needsLights&&vt.lightsStateVersion!==xs.state.version||vt.outputEncoding!==Lt||Ie.isInstancedMesh&&vt.instancing===!1||!Ie.isInstancedMesh&&vt.instancing===!0||Ie.isSkinnedMesh&&vt.skinning===!1||!Ie.isSkinnedMesh&&vt.skinning===!0||vt.envMap!==Ft||pe.fog===!0&&vt.fog!==Mt||vt.numClippingPlanes!==void 0&&(vt.numClippingPlanes!==ee.numPlanes||vt.numIntersection!==ee.numIntersection)||vt.vertexAlphas!==Ht||vt.vertexTangents!==Qt||vt.morphTargets!==Kt||vt.morphNormals!==Nn||vt.morphColors!==_i||vt.toneMapping!==Sr||He.isWebGL2===!0&&vt.morphTargetsCount!==Yn)&&(Rn=!0):(Rn=!0,vt.__version=pe.version);let zi=vt.currentProgram;Rn===!0&&(zi=Ci(pe,ge,Ie));let Er=!1,es=!1,ts=!1;const An=zi.getUniforms(),Ut=vt.uniforms;if(Xe.useProgram(zi.program)&&(Er=!0,es=!0,ts=!0),pe.id!==R&&(R=pe.id,es=!0),Er||z!==Y){if(An.setValue(se,"projectionMatrix",Y.projectionMatrix),He.logarithmicDepthBuffer&&An.setValue(se,"logDepthBufFC",2/(Math.log(Y.far+1)/Math.LN2)),z!==Y&&(z=Y,es=!0,ts=!0),pe.isShaderMaterial||pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshStandardMaterial||pe.envMap){const ln=An.map.cameraPosition;ln!==void 0&&ln.setValue(se,$.setFromMatrixPosition(Y.matrixWorld))}(pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshLambertMaterial||pe.isMeshBasicMaterial||pe.isMeshStandardMaterial||pe.isShaderMaterial)&&An.setValue(se,"isOrthographic",Y.isOrthographicCamera===!0),(pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshLambertMaterial||pe.isMeshBasicMaterial||pe.isMeshStandardMaterial||pe.isShaderMaterial||pe.isShadowMaterial||Ie.isSkinnedMesh)&&An.setValue(se,"viewMatrix",Y.matrixWorldInverse)}if(Ie.isSkinnedMesh){An.setOptional(se,Ie,"bindMatrix"),An.setOptional(se,Ie,"bindMatrixInverse");const ln=Ie.skeleton;ln&&(He.floatVertexTextures?(ln.boneTexture===null&&ln.computeBoneTexture(),An.setValue(se,"boneTexture",ln.boneTexture,De),An.setValue(se,"boneTextureSize",ln.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const mn=Ee.morphAttributes;if((mn.position!==void 0||mn.normal!==void 0||mn.color!==void 0&&He.isWebGL2===!0)&&$e.update(Ie,Ee,zi),(es||vt.receiveShadow!==Ie.receiveShadow)&&(vt.receiveShadow=Ie.receiveShadow,An.setValue(se,"receiveShadow",Ie.receiveShadow)),pe.isMeshGouraudMaterial&&pe.envMap!==null&&(Ut.envMap.value=Ft,Ut.flipEnvMap.value=Ft.isCubeTexture&&Ft.isRenderTargetTexture===!1?-1:1),es&&(An.setValue(se,"toneMappingExposure",E.toneMappingExposure),vt.needsLights&&Jr(Ut,ts),Mt&&pe.fog===!0&&Pt.refreshFogUniforms(Ut,Mt),Pt.refreshMaterialUniforms(Ut,pe,W,V,ne),p0.upload(se,vt.uniformsList,Ut,De)),pe.isShaderMaterial&&pe.uniformsNeedUpdate===!0&&(p0.upload(se,vt.uniformsList,Ut,De),pe.uniformsNeedUpdate=!1),pe.isSpriteMaterial&&An.setValue(se,"center",Ie.center),An.setValue(se,"modelViewMatrix",Ie.modelViewMatrix),An.setValue(se,"normalMatrix",Ie.normalMatrix),An.setValue(se,"modelMatrix",Ie.matrixWorld),pe.isShaderMaterial||pe.isRawShaderMaterial){const ln=pe.uniformsGroups;for(let Qn=0,Ai=ln.length;Qn<Ai;Qn++)if(He.isWebGL2){const ns=ln[Qn];Re.update(ns,zi),Re.bind(ns,zi)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return zi}function Jr(Y,ge){Y.ambientLightColor.needsUpdate=ge,Y.lightProbe.needsUpdate=ge,Y.directionalLights.needsUpdate=ge,Y.directionalLightShadows.needsUpdate=ge,Y.pointLights.needsUpdate=ge,Y.pointLightShadows.needsUpdate=ge,Y.spotLights.needsUpdate=ge,Y.spotLightShadows.needsUpdate=ge,Y.rectAreaLights.needsUpdate=ge,Y.hemisphereLights.needsUpdate=ge}function oo(Y){return Y.isMeshLambertMaterial||Y.isMeshToonMaterial||Y.isMeshPhongMaterial||Y.isMeshStandardMaterial||Y.isShadowMaterial||Y.isShaderMaterial&&Y.lights===!0}this.getActiveCubeFace=function(){return P},this.getActiveMipmapLevel=function(){return C},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(Y,ge,Ee){ut.get(Y.texture).__webglTexture=ge,ut.get(Y.depthTexture).__webglTexture=Ee;const pe=ut.get(Y);pe.__hasExternalTextures=!0,pe.__hasExternalTextures&&(pe.__autoAllocateDepthBuffer=Ee===void 0,pe.__autoAllocateDepthBuffer||Oe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),pe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Y,ge){const Ee=ut.get(Y);Ee.__webglFramebuffer=ge,Ee.__useDefaultFramebuffer=ge===void 0},this.setRenderTarget=function(Y,ge=0,Ee=0){b=Y,P=ge,C=Ee;let pe=!0,Ie=null,Mt=!1,kt=!1;if(Y){const Ft=ut.get(Y);Ft.__useDefaultFramebuffer!==void 0?(Xe.bindFramebuffer(36160,null),pe=!1):Ft.__webglFramebuffer===void 0?De.setupRenderTarget(Y):Ft.__hasExternalTextures&&De.rebindTextures(Y,ut.get(Y.texture).__webglTexture,ut.get(Y.depthTexture).__webglTexture);const Ht=Y.texture;(Ht.isData3DTexture||Ht.isDataArrayTexture||Ht.isCompressedArrayTexture)&&(kt=!0);const Qt=ut.get(Y).__webglFramebuffer;Y.isWebGLCubeRenderTarget?(Ie=Qt[ge],Mt=!0):He.isWebGL2&&Y.samples>0&&De.useMultisampledRTT(Y)===!1?Ie=ut.get(Y).__webglMultisampledFramebuffer:Ie=Qt,B.copy(Y.viewport),k.copy(Y.scissor),I=Y.scissorTest}else B.copy(re).multiplyScalar(W).floor(),k.copy(de).multiplyScalar(W).floor(),I=ye;if(Xe.bindFramebuffer(36160,Ie)&&He.drawBuffers&&pe&&Xe.drawBuffers(Y,Ie),Xe.viewport(B),Xe.scissor(k),Xe.setScissorTest(I),Mt){const Ft=ut.get(Y.texture);se.framebufferTexture2D(36160,36064,34069+ge,Ft.__webglTexture,Ee)}else if(kt){const Ft=ut.get(Y.texture),Ht=ge||0;se.framebufferTextureLayer(36160,36064,Ft.__webglTexture,Ee||0,Ht)}R=-1},this.readRenderTargetPixels=function(Y,ge,Ee,pe,Ie,Mt,kt){if(!(Y&&Y.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Lt=ut.get(Y).__webglFramebuffer;if(Y.isWebGLCubeRenderTarget&&kt!==void 0&&(Lt=Lt[kt]),Lt){Xe.bindFramebuffer(36160,Lt);try{const Ft=Y.texture,Ht=Ft.format,Qt=Ft.type;if(Ht!==_s&&_t.convert(Ht)!==se.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Kt=Qt===Da&&(Oe.has("EXT_color_buffer_half_float")||He.isWebGL2&&Oe.has("EXT_color_buffer_float"));if(Qt!==Il&&_t.convert(Qt)!==se.getParameter(35738)&&!(Qt===Co&&(He.isWebGL2||Oe.has("OES_texture_float")||Oe.has("WEBGL_color_buffer_float")))&&!Kt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ge>=0&&ge<=Y.width-pe&&Ee>=0&&Ee<=Y.height-Ie&&se.readPixels(ge,Ee,pe,Ie,_t.convert(Ht),_t.convert(Qt),Mt)}finally{const Ft=b!==null?ut.get(b).__webglFramebuffer:null;Xe.bindFramebuffer(36160,Ft)}}},this.copyFramebufferToTexture=function(Y,ge,Ee=0){const pe=Math.pow(2,-Ee),Ie=Math.floor(ge.image.width*pe),Mt=Math.floor(ge.image.height*pe);De.setTexture2D(ge,0),se.copyTexSubImage2D(3553,Ee,0,0,Y.x,Y.y,Ie,Mt),Xe.unbindTexture()},this.copyTextureToTexture=function(Y,ge,Ee,pe=0){const Ie=ge.image.width,Mt=ge.image.height,kt=_t.convert(Ee.format),Lt=_t.convert(Ee.type);De.setTexture2D(Ee,0),se.pixelStorei(37440,Ee.flipY),se.pixelStorei(37441,Ee.premultiplyAlpha),se.pixelStorei(3317,Ee.unpackAlignment),ge.isDataTexture?se.texSubImage2D(3553,pe,Y.x,Y.y,Ie,Mt,kt,Lt,ge.image.data):ge.isCompressedTexture?se.compressedTexSubImage2D(3553,pe,Y.x,Y.y,ge.mipmaps[0].width,ge.mipmaps[0].height,kt,ge.mipmaps[0].data):se.texSubImage2D(3553,pe,Y.x,Y.y,kt,Lt,ge.image),pe===0&&Ee.generateMipmaps&&se.generateMipmap(3553),Xe.unbindTexture()},this.copyTextureToTexture3D=function(Y,ge,Ee,pe,Ie=0){if(E.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Mt=Y.max.x-Y.min.x+1,kt=Y.max.y-Y.min.y+1,Lt=Y.max.z-Y.min.z+1,Ft=_t.convert(pe.format),Ht=_t.convert(pe.type);let Qt;if(pe.isData3DTexture)De.setTexture3D(pe,0),Qt=32879;else if(pe.isDataArrayTexture)De.setTexture2DArray(pe,0),Qt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}se.pixelStorei(37440,pe.flipY),se.pixelStorei(37441,pe.premultiplyAlpha),se.pixelStorei(3317,pe.unpackAlignment);const Kt=se.getParameter(3314),Nn=se.getParameter(32878),_i=se.getParameter(3316),Sr=se.getParameter(3315),ys=se.getParameter(32877),Yn=Ee.isCompressedTexture?Ee.mipmaps[0]:Ee.image;se.pixelStorei(3314,Yn.width),se.pixelStorei(32878,Yn.height),se.pixelStorei(3316,Y.min.x),se.pixelStorei(3315,Y.min.y),se.pixelStorei(32877,Y.min.z),Ee.isDataTexture||Ee.isData3DTexture?se.texSubImage3D(Qt,Ie,ge.x,ge.y,ge.z,Mt,kt,Lt,Ft,Ht,Yn.data):Ee.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),se.compressedTexSubImage3D(Qt,Ie,ge.x,ge.y,ge.z,Mt,kt,Lt,Ft,Yn.data)):se.texSubImage3D(Qt,Ie,ge.x,ge.y,ge.z,Mt,kt,Lt,Ft,Ht,Yn),se.pixelStorei(3314,Kt),se.pixelStorei(32878,Nn),se.pixelStorei(3316,_i),se.pixelStorei(3315,Sr),se.pixelStorei(32877,ys),Ie===0&&pe.generateMipmaps&&se.generateMipmap(Qt),Xe.unbindTexture()},this.initTexture=function(Y){Y.isCubeTexture?De.setTextureCube(Y,0):Y.isData3DTexture?De.setTexture3D(Y,0):Y.isDataArrayTexture||Y.isCompressedArrayTexture?De.setTexture2DArray(Y,0):De.setTexture2D(Y,0),Xe.unbindTexture()},this.resetState=function(){P=0,C=0,b=null,Xe.reset(),st.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(Z0.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(r){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!r}}});class ZM extends Z0{}ZM.prototype.isWebGL1Renderer=!0;class J0{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new dt(e),this.density=t}clone(){return new J0(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class e_{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new dt(e),this.near=t,this.far=n}clone(){return new e_(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Nx extends In{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class t_{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Op,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=no()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=no()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=no()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ms=new Z;class rh{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)ms.fromBufferAttribute(this,t),ms.applyMatrix4(e),this.setXYZ(t,ms.x,ms.y,ms.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ms.fromBufferAttribute(this,t),ms.applyNormalMatrix(e),this.setXYZ(t,ms.x,ms.y,ms.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ms.fromBufferAttribute(this,t),ms.transformDirection(e),this.setXYZ(t,ms.x,ms.y,ms.z);return this}setX(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Xn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Ml(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Ml(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Ml(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Ml(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),i=Xn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xn(t,this.array),n=Xn(n,this.array),i=Xn(i,this.array),s=Xn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new $n(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new rh(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class kx extends Zr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new dt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let yf;const np=new Z,xf=new Z,wf=new Z,Sf=new ze,ip=new ze,JM=new Jt,Pg=new Z,rp=new Z,Ig=new Z,sS=new ze,Tv=new ze,oS=new ze;class eC extends In{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",yf===void 0){yf=new en;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new t_(t,5);yf.setIndex([0,1,2,0,2,3]),yf.setAttribute("position",new rh(n,3,0,!1)),yf.setAttribute("uv",new rh(n,2,3,!1))}this.geometry=yf,this.material=e!==void 0?e:new kx,this.center=new ze(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),xf.setFromMatrixScale(this.matrixWorld),JM.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),wf.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&xf.multiplyScalar(-wf.z);const n=this.material.rotation;let i,s;n!==0&&(s=Math.cos(n),i=Math.sin(n));const a=this.center;Rg(Pg.set(-.5,-.5,0),wf,a,xf,i,s),Rg(rp.set(.5,-.5,0),wf,a,xf,i,s),Rg(Ig.set(.5,.5,0),wf,a,xf,i,s),sS.set(0,0),Tv.set(1,0),oS.set(1,1);let u=e.ray.intersectTriangle(Pg,rp,Ig,!1,np);if(u===null&&(Rg(rp.set(-.5,.5,0),wf,a,xf,i,s),Tv.set(0,1),u=e.ray.intersectTriangle(Pg,Ig,rp,!1,np),u===null))return;const f=e.ray.origin.distanceTo(np);f<e.near||f>e.far||t.push({distance:f,point:np.clone(),uv:To.getUV(np,Pg,rp,Ig,sS,Tv,oS,new ze),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Rg(r,e,t,n,i,s){Sf.subVectors(r,t).addScalar(.5).multiply(n),i!==void 0?(ip.x=s*Sf.x-i*Sf.y,ip.y=i*Sf.x+s*Sf.y):ip.copy(Sf),r.copy(e),r.x+=ip.x,r.y+=ip.y,r.applyMatrix4(JM)}const Dg=new Z,aS=new Z;class tC extends In{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Dg.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(Dg);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Dg.setFromMatrixPosition(e.matrixWorld),aS.setFromMatrixPosition(this.matrixWorld);const n=Dg.distanceTo(aS)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let a=t[i].distance;if(t[i].object.visible&&(a-=a*t[i].hysteresis),n>=a)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,s=n.length;i<s;i++){const a=n[i];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const lS=new Z,uS=new Un,cS=new Un,VL=new Z,hS=new Jt;class nC extends rr{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Jt,this.bindMatrixInverse=new Jt}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Un,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,i=this.geometry;uS.fromBufferAttribute(i.attributes.skinIndex,e),cS.fromBufferAttribute(i.attributes.skinWeight,e),lS.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=cS.getComponent(s);if(a!==0){const u=uS.getComponent(s);hS.multiplyMatrices(n.bones[u].matrixWorld,n.boneInverses[u]),t.addScaledVector(VL.copy(lS).applyMatrix4(hS),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class zx extends In{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Bf extends ki{constructor(e=null,t=1,n=1,i,s,a,u,f,d=Oi,m=Oi,_,y){super(null,a,u,f,d,m,i,s,_,y),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const fS=new Jt,HL=new Jt;class n_{constructor(e=[],t=[]){this.uuid=no(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new Jt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Jt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const u=e[s]?e[s].matrixWorld:HL;fS.multiplyMatrices(u,t[s]),fS.toArray(n,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new n_(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=zM(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Bf(t,e,e,_s,Co);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const s=e.bones[n];let a=t[s];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new zx),this.bones.push(a),this.boneInverses.push(new Jt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const a=t[i];e.bones.push(a.uuid);const u=n[i];e.boneInverses.push(u.toArray())}return e}}class jf extends $n{constructor(e,t,n,i=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const dS=new Jt,pS=new Jt,Lg=[],GL=new Jt,sp=new rr;class iC extends rr{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new jf(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let i=0;i<n;i++)this.setMatrixAt(i,GL)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const n=this.matrixWorld,i=this.count;if(sp.geometry=this.geometry,sp.material=this.material,sp.material!==void 0)for(let s=0;s<i;s++){this.getMatrixAt(s,dS),pS.multiplyMatrices(n,dS),sp.matrixWorld=pS,sp.raycast(e,Lg);for(let a=0,u=Lg.length;a<u;a++){const f=Lg[a];f.instanceId=s,f.object=this,t.push(f)}Lg.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new jf(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class vs extends Zr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new dt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const mS=new Z,gS=new Z,_S=new Jt,Mv=new Jp,Og=new mh;class Ou extends In{constructor(e=new en,t=new vs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,s=t.count;i<s;i++)mS.fromBufferAttribute(t,i-1),gS.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=mS.distanceTo(gS);e.setAttribute("lineDistance",new pt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Og.copy(n.boundingSphere),Og.applyMatrix4(i),Og.radius+=s,e.ray.intersectsSphere(Og)===!1)return;_S.copy(i).invert(),Mv.copy(e.ray).applyMatrix4(_S);const u=s/((this.scale.x+this.scale.y+this.scale.z)/3),f=u*u,d=new Z,m=new Z,_=new Z,y=new Z,w=this.isLineSegments?2:1,T=n.index,M=n.attributes.position;if(T!==null){const P=Math.max(0,a.start),C=Math.min(T.count,a.start+a.count);for(let b=P,R=C-1;b<R;b+=w){const z=T.getX(b),B=T.getX(b+1);if(d.fromBufferAttribute(M,z),m.fromBufferAttribute(M,B),Mv.distanceSqToSegment(d,m,y,_)>f)continue;y.applyMatrix4(this.matrixWorld);const I=e.ray.origin.distanceTo(y);I<e.near||I>e.far||t.push({distance:I,point:_.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else{const P=Math.max(0,a.start),C=Math.min(M.count,a.start+a.count);for(let b=P,R=C-1;b<R;b+=w){if(d.fromBufferAttribute(M,b),m.fromBufferAttribute(M,b+1),Mv.distanceSqToSegment(d,m,y,_)>f)continue;y.applyMatrix4(this.matrixWorld);const B=e.ray.origin.distanceTo(y);B<e.near||B>e.far||t.push({distance:B,point:_.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const u=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}}const vS=new Z,yS=new Z;class Fa extends Ou{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,s=t.count;i<s;i+=2)vS.fromBufferAttribute(t,i),yS.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+vS.distanceTo(yS);e.setAttribute("lineDistance",new pt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class rC extends Ou{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Fx extends Zr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new dt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const xS=new Jt,jy=new Jp,Ng=new mh,kg=new Z;class sC extends In{constructor(e=new en,t=new Fx){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Ng.copy(n.boundingSphere),Ng.applyMatrix4(i),Ng.radius+=s,e.ray.intersectsSphere(Ng)===!1)return;xS.copy(i).invert(),jy.copy(e.ray).applyMatrix4(xS);const u=s/((this.scale.x+this.scale.y+this.scale.z)/3),f=u*u,d=n.index,_=n.attributes.position;if(d!==null){const y=Math.max(0,a.start),w=Math.min(d.count,a.start+a.count);for(let T=y,E=w;T<E;T++){const M=d.getX(T);kg.fromBufferAttribute(_,M),wS(kg,M,f,i,e,t,this)}}else{const y=Math.max(0,a.start),w=Math.min(_.count,a.start+a.count);for(let T=y,E=w;T<E;T++)kg.fromBufferAttribute(_,T),wS(kg,T,f,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const u=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}}function wS(r,e,t,n,i,s,a){const u=jy.distanceSqToPoint(r);if(u<t){const f=new Z;jy.closestPointToPoint(r,f),f.applyMatrix4(n);const d=i.ray.origin.distanceTo(f);if(d<i.near||d>i.far)return;s.push({distance:d,distanceToRay:Math.sqrt(u),point:f,index:e,face:null,object:a})}}class WL extends ki{constructor(e,t,n,i,s,a,u,f,d){super(e,t,n,i,s,a,u,f,d),this.isVideoTexture=!0,this.minFilter=a!==void 0?a:ai,this.magFilter=s!==void 0?s:ai,this.generateMipmaps=!1;const m=this;function _(){m.needsUpdate=!0,e.requestVideoFrameCallback(_)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(_)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class jL extends ki{constructor(e,t,n){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=Oi,this.minFilter=Oi,this.generateMipmaps=!1,this.needsUpdate=!0}}class Ux extends ki{constructor(e,t,n,i,s,a,u,f,d,m,_,y){super(null,a,u,f,d,m,i,s,_,y),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class qL extends Ux{constructor(e,t,n,i,s,a){super(e,t,n,s,a),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=Kr}}class XL extends ki{constructor(e,t,n,i,s,a,u,f,d){super(e,t,n,i,s,a,u,f,d),this.isCanvasTexture=!0,this.needsUpdate=!0}}class la{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),s+=n.distanceTo(i),t.push(s),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const s=n.length;let a;t?a=t:a=e*n[s-1];let u=0,f=s-1,d;for(;u<=f;)if(i=Math.floor(u+(f-u)/2),d=n[i]-a,d<0)u=i+1;else if(d>0)f=i-1;else{f=i;break}if(i=f,n[i]===a)return i/(s-1);const m=n[i],y=n[i+1]-m,w=(a-m)/y;return(i+w)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const a=this.getPoint(i),u=this.getPoint(s),f=t||(a.isVector2?new ze:new Z);return f.copy(u).sub(a).normalize(),f}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new Z,i=[],s=[],a=[],u=new Z,f=new Jt;for(let w=0;w<=e;w++){const T=w/e;i[w]=this.getTangentAt(T,new Z)}s[0]=new Z,a[0]=new Z;let d=Number.MAX_VALUE;const m=Math.abs(i[0].x),_=Math.abs(i[0].y),y=Math.abs(i[0].z);m<=d&&(d=m,n.set(1,0,0)),_<=d&&(d=_,n.set(0,1,0)),y<=d&&n.set(0,0,1),u.crossVectors(i[0],n).normalize(),s[0].crossVectors(i[0],u),a[0].crossVectors(i[0],s[0]);for(let w=1;w<=e;w++){if(s[w]=s[w-1].clone(),a[w]=a[w-1].clone(),u.crossVectors(i[w-1],i[w]),u.length()>Number.EPSILON){u.normalize();const T=Math.acos(Ni(i[w-1].dot(i[w]),-1,1));s[w].applyMatrix4(f.makeRotationAxis(u,T))}a[w].crossVectors(i[w],s[w])}if(t===!0){let w=Math.acos(Ni(s[0].dot(s[e]),-1,1));w/=e,i[0].dot(u.crossVectors(s[0],s[e]))>0&&(w=-w);for(let T=1;T<=e;T++)s[T].applyMatrix4(f.makeRotationAxis(i[T],w*T)),a[T].crossVectors(i[T],s[T])}return{tangents:i,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class i_ extends la{constructor(e=0,t=0,n=1,i=1,s=0,a=Math.PI*2,u=!1,f=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=u,this.aRotation=f}getPoint(e,t){const n=t||new ze,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(a?s=0:s=i),this.aClockwise===!0&&!a&&(s===i?s=-i:s=s-i);const u=this.aStartAngle+e*s;let f=this.aX+this.xRadius*Math.cos(u),d=this.aY+this.yRadius*Math.sin(u);if(this.aRotation!==0){const m=Math.cos(this.aRotation),_=Math.sin(this.aRotation),y=f-this.aX,w=d-this.aY;f=y*m-w*_+this.aX,d=y*_+w*m+this.aY}return n.set(f,d)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class oC extends i_{constructor(e,t,n,i,s,a){super(e,t,n,n,i,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function Bx(){let r=0,e=0,t=0,n=0;function i(s,a,u,f){r=s,e=u,t=-3*s+3*a-2*u-f,n=2*s-2*a+u+f}return{initCatmullRom:function(s,a,u,f,d){i(a,u,d*(u-s),d*(f-a))},initNonuniformCatmullRom:function(s,a,u,f,d,m,_){let y=(a-s)/d-(u-s)/(d+m)+(u-a)/m,w=(u-a)/m-(f-a)/(m+_)+(f-u)/_;y*=m,w*=m,i(a,u,y,w)},calc:function(s){const a=s*s,u=a*s;return r+e*s+t*a+n*u}}}const zg=new Z,Cv=new Bx,Av=new Bx,bv=new Bx;class aC extends la{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new Z){const n=t,i=this.points,s=i.length,a=(s-(this.closed?0:1))*e;let u=Math.floor(a),f=a-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/s)+1)*s:f===0&&u===s-1&&(u=s-2,f=1);let d,m;this.closed||u>0?d=i[(u-1)%s]:(zg.subVectors(i[0],i[1]).add(i[0]),d=zg);const _=i[u%s],y=i[(u+1)%s];if(this.closed||u+2<s?m=i[(u+2)%s]:(zg.subVectors(i[s-1],i[s-2]).add(i[s-1]),m=zg),this.curveType==="centripetal"||this.curveType==="chordal"){const w=this.curveType==="chordal"?.5:.25;let T=Math.pow(d.distanceToSquared(_),w),E=Math.pow(_.distanceToSquared(y),w),M=Math.pow(y.distanceToSquared(m),w);E<1e-4&&(E=1),T<1e-4&&(T=E),M<1e-4&&(M=E),Cv.initNonuniformCatmullRom(d.x,_.x,y.x,m.x,T,E,M),Av.initNonuniformCatmullRom(d.y,_.y,y.y,m.y,T,E,M),bv.initNonuniformCatmullRom(d.z,_.z,y.z,m.z,T,E,M)}else this.curveType==="catmullrom"&&(Cv.initCatmullRom(d.x,_.x,y.x,m.x,this.tension),Av.initCatmullRom(d.y,_.y,y.y,m.y,this.tension),bv.initCatmullRom(d.z,_.z,y.z,m.z,this.tension));return n.set(Cv.calc(f),Av.calc(f),bv.calc(f)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new Z().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function SS(r,e,t,n,i){const s=(n-e)*.5,a=(i-t)*.5,u=r*r,f=r*u;return(2*t-2*n+s+a)*f+(-3*t+3*n-2*s-a)*u+s*r+t}function $L(r,e){const t=1-r;return t*t*e}function YL(r,e){return 2*(1-r)*r*e}function QL(r,e){return r*r*e}function wp(r,e,t,n){return $L(r,e)+YL(r,t)+QL(r,n)}function KL(r,e){const t=1-r;return t*t*t*e}function ZL(r,e){const t=1-r;return 3*t*t*r*e}function JL(r,e){return 3*(1-r)*r*r*e}function e4(r,e){return r*r*r*e}function Sp(r,e,t,n,i){return KL(r,e)+ZL(r,t)+JL(r,n)+e4(r,i)}class Vx extends la{constructor(e=new ze,t=new ze,n=new ze,i=new ze){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new ze){const n=t,i=this.v0,s=this.v1,a=this.v2,u=this.v3;return n.set(Sp(e,i.x,s.x,a.x,u.x),Sp(e,i.y,s.y,a.y,u.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class lC extends la{constructor(e=new Z,t=new Z,n=new Z,i=new Z){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new Z){const n=t,i=this.v0,s=this.v1,a=this.v2,u=this.v3;return n.set(Sp(e,i.x,s.x,a.x,u.x),Sp(e,i.y,s.y,a.y,u.y),Sp(e,i.z,s.z,a.z,u.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class r_ extends la{constructor(e=new ze,t=new ze){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ze){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ze){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class uC extends la{constructor(e=new Z,t=new Z){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Z){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Z){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Hx extends la{constructor(e=new ze,t=new ze,n=new ze){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ze){const n=t,i=this.v0,s=this.v1,a=this.v2;return n.set(wp(e,i.x,s.x,a.x),wp(e,i.y,s.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Gx extends la{constructor(e=new Z,t=new Z,n=new Z){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Z){const n=t,i=this.v0,s=this.v1,a=this.v2;return n.set(wp(e,i.x,s.x,a.x),wp(e,i.y,s.y,a.y),wp(e,i.z,s.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Wx extends la{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ze){const n=t,i=this.points,s=(i.length-1)*e,a=Math.floor(s),u=s-a,f=i[a===0?a:a-1],d=i[a],m=i[a>i.length-2?i.length-1:a+1],_=i[a>i.length-3?i.length-1:a+2];return n.set(SS(u,f.x,d.x,m.x,_.x),SS(u,f.y,d.y,m.y,_.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new ze().fromArray(i))}return this}}var jx=Object.freeze({__proto__:null,ArcCurve:oC,CatmullRomCurve3:aC,CubicBezierCurve:Vx,CubicBezierCurve3:lC,EllipseCurve:i_,LineCurve:r_,LineCurve3:uC,QuadraticBezierCurve:Hx,QuadraticBezierCurve3:Gx,SplineCurve:Wx});class cC extends la{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new r_(t,e))}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=n){const a=i[s]-n,u=this.curves[s],f=u.getLength(),d=f===0?0:1-a/f;return u.getPointAt(d,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,s=this.curves;i<s.length;i++){const a=s[i],u=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,f=a.getPoints(u);for(let d=0;d<f.length;d++){const m=f[d];n&&n.equals(m)||(t.push(m),n=m)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new jx[i.type]().fromJSON(i))}return this}}class zp extends cC{constructor(e){super(),this.type="Path",this.currentPoint=new ze,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new r_(this.currentPoint.clone(),new ze(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const s=new Hx(this.currentPoint.clone(),new ze(e,t),new ze(n,i));return this.curves.push(s),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,s,a){const u=new Vx(this.currentPoint.clone(),new ze(e,t),new ze(n,i),new ze(s,a));return this.curves.push(u),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Wx(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,s,a){const u=this.currentPoint.x,f=this.currentPoint.y;return this.absarc(e+u,t+f,n,i,s,a),this}absarc(e,t,n,i,s,a){return this.absellipse(e,t,n,n,i,s,a),this}ellipse(e,t,n,i,s,a,u,f){const d=this.currentPoint.x,m=this.currentPoint.y;return this.absellipse(e+d,t+m,n,i,s,a,u,f),this}absellipse(e,t,n,i,s,a,u,f){const d=new i_(e,t,n,i,s,a,u,f);if(this.curves.length>0){const _=d.getPoint(0);_.equals(this.currentPoint)||this.lineTo(_.x,_.y)}this.curves.push(d);const m=d.getPoint(1);return this.currentPoint.copy(m),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class td extends en{constructor(e=[new ze(0,-.5),new ze(.5,0),new ze(0,.5)],t=12,n=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=Ni(i,0,Math.PI*2);const s=[],a=[],u=[],f=[],d=[],m=1/t,_=new Z,y=new ze,w=new Z,T=new Z,E=new Z;let M=0,P=0;for(let C=0;C<=e.length-1;C++)switch(C){case 0:M=e[C+1].x-e[C].x,P=e[C+1].y-e[C].y,w.x=P*1,w.y=-M,w.z=P*0,E.copy(w),w.normalize(),f.push(w.x,w.y,w.z);break;case e.length-1:f.push(E.x,E.y,E.z);break;default:M=e[C+1].x-e[C].x,P=e[C+1].y-e[C].y,w.x=P*1,w.y=-M,w.z=P*0,T.copy(w),w.x+=E.x,w.y+=E.y,w.z+=E.z,w.normalize(),f.push(w.x,w.y,w.z),E.copy(T)}for(let C=0;C<=t;C++){const b=n+C*m*i,R=Math.sin(b),z=Math.cos(b);for(let B=0;B<=e.length-1;B++){_.x=e[B].x*R,_.y=e[B].y,_.z=e[B].x*z,a.push(_.x,_.y,_.z),y.x=C/t,y.y=B/(e.length-1),u.push(y.x,y.y);const k=f[3*B+0]*R,I=f[3*B+1],N=f[3*B+0]*z;d.push(k,I,N)}}for(let C=0;C<t;C++)for(let b=0;b<e.length-1;b++){const R=b+C*e.length,z=R,B=R+e.length,k=R+e.length+1,I=R+1;s.push(z,B,I),s.push(k,I,B)}this.setIndex(s),this.setAttribute("position",new pt(a,3)),this.setAttribute("uv",new pt(u,2)),this.setAttribute("normal",new pt(d,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new td(e.points,e.segments,e.phiStart,e.phiLength)}}class rm extends td{constructor(e=1,t=1,n=4,i=8){const s=new zp;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(n),i),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:i}}static fromJSON(e){return new rm(e.radius,e.length,e.capSegments,e.radialSegments)}}class sm extends en{constructor(e=1,t=32,n=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const s=[],a=[],u=[],f=[],d=new Z,m=new ze;a.push(0,0,0),u.push(0,0,1),f.push(.5,.5);for(let _=0,y=3;_<=t;_++,y+=3){const w=n+_/t*i;d.x=e*Math.cos(w),d.y=e*Math.sin(w),a.push(d.x,d.y,d.z),u.push(0,0,1),m.x=(a[y]/e+1)/2,m.y=(a[y+1]/e+1)/2,f.push(m.x,m.y)}for(let _=1;_<=t;_++)s.push(_,_+1,0);this.setIndex(s),this.setAttribute("position",new pt(a,3)),this.setAttribute("normal",new pt(u,3)),this.setAttribute("uv",new pt(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sm(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class gh extends en{constructor(e=1,t=1,n=1,i=32,s=1,a=!1,u=0,f=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:u,thetaLength:f};const d=this;i=Math.floor(i),s=Math.floor(s);const m=[],_=[],y=[],w=[];let T=0;const E=[],M=n/2;let P=0;C(),a===!1&&(e>0&&b(!0),t>0&&b(!1)),this.setIndex(m),this.setAttribute("position",new pt(_,3)),this.setAttribute("normal",new pt(y,3)),this.setAttribute("uv",new pt(w,2));function C(){const R=new Z,z=new Z;let B=0;const k=(t-e)/n;for(let I=0;I<=s;I++){const N=[],V=I/s,W=V*(t-e)+e;for(let q=0;q<=i;q++){const H=q/i,re=H*f+u,de=Math.sin(re),ye=Math.cos(re);z.x=W*de,z.y=-V*n+M,z.z=W*ye,_.push(z.x,z.y,z.z),R.set(de,k,ye).normalize(),y.push(R.x,R.y,R.z),w.push(H,1-V),N.push(T++)}E.push(N)}for(let I=0;I<i;I++)for(let N=0;N<s;N++){const V=E[N][I],W=E[N+1][I],q=E[N+1][I+1],H=E[N][I+1];m.push(V,W,H),m.push(W,q,H),B+=6}d.addGroup(P,B,0),P+=B}function b(R){const z=T,B=new ze,k=new Z;let I=0;const N=R===!0?e:t,V=R===!0?1:-1;for(let q=1;q<=i;q++)_.push(0,M*V,0),y.push(0,V,0),w.push(.5,.5),T++;const W=T;for(let q=0;q<=i;q++){const re=q/i*f+u,de=Math.cos(re),ye=Math.sin(re);k.x=N*ye,k.y=M*V,k.z=N*de,_.push(k.x,k.y,k.z),y.push(0,V,0),B.x=de*.5+.5,B.y=ye*.5*V+.5,w.push(B.x,B.y),T++}for(let q=0;q<i;q++){const H=z+q,re=W+q;R===!0?m.push(re,re+1,H):m.push(re+1,re,H),I+=3}d.addGroup(P,I,R===!0?1:2),P+=I}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gh(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class om extends gh{constructor(e=1,t=1,n=32,i=1,s=!1,a=0,u=Math.PI*2){super(0,e,t,n,i,s,a,u),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:u}}static fromJSON(e){return new om(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ol extends en{constructor(e=[],t=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const s=[],a=[];u(i),d(n),m(),this.setAttribute("position",new pt(s,3)),this.setAttribute("normal",new pt(s.slice(),3)),this.setAttribute("uv",new pt(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function u(C){const b=new Z,R=new Z,z=new Z;for(let B=0;B<t.length;B+=3)w(t[B+0],b),w(t[B+1],R),w(t[B+2],z),f(b,R,z,C)}function f(C,b,R,z){const B=z+1,k=[];for(let I=0;I<=B;I++){k[I]=[];const N=C.clone().lerp(R,I/B),V=b.clone().lerp(R,I/B),W=B-I;for(let q=0;q<=W;q++)q===0&&I===B?k[I][q]=N:k[I][q]=N.clone().lerp(V,q/W)}for(let I=0;I<B;I++)for(let N=0;N<2*(B-I)-1;N++){const V=Math.floor(N/2);N%2===0?(y(k[I][V+1]),y(k[I+1][V]),y(k[I][V])):(y(k[I][V+1]),y(k[I+1][V+1]),y(k[I+1][V]))}}function d(C){const b=new Z;for(let R=0;R<s.length;R+=3)b.x=s[R+0],b.y=s[R+1],b.z=s[R+2],b.normalize().multiplyScalar(C),s[R+0]=b.x,s[R+1]=b.y,s[R+2]=b.z}function m(){const C=new Z;for(let b=0;b<s.length;b+=3){C.x=s[b+0],C.y=s[b+1],C.z=s[b+2];const R=M(C)/2/Math.PI+.5,z=P(C)/Math.PI+.5;a.push(R,1-z)}T(),_()}function _(){for(let C=0;C<a.length;C+=6){const b=a[C+0],R=a[C+2],z=a[C+4],B=Math.max(b,R,z),k=Math.min(b,R,z);B>.9&&k<.1&&(b<.2&&(a[C+0]+=1),R<.2&&(a[C+2]+=1),z<.2&&(a[C+4]+=1))}}function y(C){s.push(C.x,C.y,C.z)}function w(C,b){const R=C*3;b.x=e[R+0],b.y=e[R+1],b.z=e[R+2]}function T(){const C=new Z,b=new Z,R=new Z,z=new Z,B=new ze,k=new ze,I=new ze;for(let N=0,V=0;N<s.length;N+=9,V+=6){C.set(s[N+0],s[N+1],s[N+2]),b.set(s[N+3],s[N+4],s[N+5]),R.set(s[N+6],s[N+7],s[N+8]),B.set(a[V+0],a[V+1]),k.set(a[V+2],a[V+3]),I.set(a[V+4],a[V+5]),z.copy(C).add(b).add(R).divideScalar(3);const W=M(z);E(B,V+0,C,W),E(k,V+2,b,W),E(I,V+4,R,W)}}function E(C,b,R,z){z<0&&C.x===1&&(a[b]=C.x-1),R.x===0&&R.z===0&&(a[b]=z/2/Math.PI+.5)}function M(C){return Math.atan2(C.z,-C.x)}function P(C){return Math.atan2(-C.y,Math.sqrt(C.x*C.x+C.z*C.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ol(e.vertices,e.indices,e.radius,e.details)}}class am extends Ol{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new am(e.radius,e.detail)}}const Fg=new Z,Ug=new Z,Pv=new Z,Bg=new To;class hC extends en{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(Zc*t),a=e.getIndex(),u=e.getAttribute("position"),f=a?a.count:u.count,d=[0,0,0],m=["a","b","c"],_=new Array(3),y={},w=[];for(let T=0;T<f;T+=3){a?(d[0]=a.getX(T),d[1]=a.getX(T+1),d[2]=a.getX(T+2)):(d[0]=T,d[1]=T+1,d[2]=T+2);const{a:E,b:M,c:P}=Bg;if(E.fromBufferAttribute(u,d[0]),M.fromBufferAttribute(u,d[1]),P.fromBufferAttribute(u,d[2]),Bg.getNormal(Pv),_[0]=`${Math.round(E.x*i)},${Math.round(E.y*i)},${Math.round(E.z*i)}`,_[1]=`${Math.round(M.x*i)},${Math.round(M.y*i)},${Math.round(M.z*i)}`,_[2]=`${Math.round(P.x*i)},${Math.round(P.y*i)},${Math.round(P.z*i)}`,!(_[0]===_[1]||_[1]===_[2]||_[2]===_[0]))for(let C=0;C<3;C++){const b=(C+1)%3,R=_[C],z=_[b],B=Bg[m[C]],k=Bg[m[b]],I=`${R}_${z}`,N=`${z}_${R}`;N in y&&y[N]?(Pv.dot(y[N].normal)<=s&&(w.push(B.x,B.y,B.z),w.push(k.x,k.y,k.z)),y[N]=null):I in y||(y[I]={index0:d[C],index1:d[b],normal:Pv.clone()})}}for(const T in y)if(y[T]){const{index0:E,index1:M}=y[T];Fg.fromBufferAttribute(u,E),Ug.fromBufferAttribute(u,M),w.push(Fg.x,Fg.y,Fg.z),w.push(Ug.x,Ug.y,Ug.z)}this.setAttribute("position",new pt(w,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class eh extends zp{constructor(e){super(e),this.uuid=no(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new zp().fromJSON(i))}return this}}const t4={triangulate:function(r,e,t=2){const n=e&&e.length,i=n?e[0]*t:r.length;let s=fC(r,0,i,t,!0);const a=[];if(!s||s.next===s.prev)return a;let u,f,d,m,_,y,w;if(n&&(s=o4(r,e,s,t)),r.length>80*t){u=d=r[0],f=m=r[1];for(let T=t;T<i;T+=t)_=r[T],y=r[T+1],_<u&&(u=_),y<f&&(f=y),_>d&&(d=_),y>m&&(m=y);w=Math.max(d-u,m-f),w=w!==0?32767/w:0}return Fp(s,a,t,u,f,w,0),a}};function fC(r,e,t,n,i){let s,a;if(i===_4(r,e,t,n)>0)for(s=e;s<t;s+=n)a=ES(s,r[s],r[s+1],a);else for(s=t-n;s>=e;s-=n)a=ES(s,r[s],r[s+1],a);return a&&s_(a,a.next)&&(Bp(a),a=a.next),a}function sh(r,e){if(!r)return r;e||(e=r);let t=r,n;do if(n=!1,!t.steiner&&(s_(t,t.next)||gi(t.prev,t,t.next)===0)){if(Bp(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Fp(r,e,t,n,i,s,a){if(!r)return;!a&&s&&h4(r,n,i,s);let u=r,f,d;for(;r.prev!==r.next;){if(f=r.prev,d=r.next,s?i4(r,n,i,s):n4(r)){e.push(f.i/t|0),e.push(r.i/t|0),e.push(d.i/t|0),Bp(r),r=d.next,u=d.next;continue}if(r=d,r===u){a?a===1?(r=r4(sh(r),e,t),Fp(r,e,t,n,i,s,2)):a===2&&s4(r,e,t,n,i,s):Fp(sh(r),e,t,n,i,s,1);break}}}function n4(r){const e=r.prev,t=r,n=r.next;if(gi(e,t,n)>=0)return!1;const i=e.x,s=t.x,a=n.x,u=e.y,f=t.y,d=n.y,m=i<s?i<a?i:a:s<a?s:a,_=u<f?u<d?u:d:f<d?f:d,y=i>s?i>a?i:a:s>a?s:a,w=u>f?u>d?u:d:f>d?f:d;let T=n.next;for(;T!==e;){if(T.x>=m&&T.x<=y&&T.y>=_&&T.y<=w&&zf(i,u,s,f,a,d,T.x,T.y)&&gi(T.prev,T,T.next)>=0)return!1;T=T.next}return!0}function i4(r,e,t,n){const i=r.prev,s=r,a=r.next;if(gi(i,s,a)>=0)return!1;const u=i.x,f=s.x,d=a.x,m=i.y,_=s.y,y=a.y,w=u<f?u<d?u:d:f<d?f:d,T=m<_?m<y?m:y:_<y?_:y,E=u>f?u>d?u:d:f>d?f:d,M=m>_?m>y?m:y:_>y?_:y,P=qy(w,T,e,t,n),C=qy(E,M,e,t,n);let b=r.prevZ,R=r.nextZ;for(;b&&b.z>=P&&R&&R.z<=C;){if(b.x>=w&&b.x<=E&&b.y>=T&&b.y<=M&&b!==i&&b!==a&&zf(u,m,f,_,d,y,b.x,b.y)&&gi(b.prev,b,b.next)>=0||(b=b.prevZ,R.x>=w&&R.x<=E&&R.y>=T&&R.y<=M&&R!==i&&R!==a&&zf(u,m,f,_,d,y,R.x,R.y)&&gi(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;b&&b.z>=P;){if(b.x>=w&&b.x<=E&&b.y>=T&&b.y<=M&&b!==i&&b!==a&&zf(u,m,f,_,d,y,b.x,b.y)&&gi(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;R&&R.z<=C;){if(R.x>=w&&R.x<=E&&R.y>=T&&R.y<=M&&R!==i&&R!==a&&zf(u,m,f,_,d,y,R.x,R.y)&&gi(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function r4(r,e,t){let n=r;do{const i=n.prev,s=n.next.next;!s_(i,s)&&dC(i,n,n.next,s)&&Up(i,s)&&Up(s,i)&&(e.push(i.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),Bp(n),Bp(n.next),n=r=s),n=n.next}while(n!==r);return sh(n)}function s4(r,e,t,n,i,s){let a=r;do{let u=a.next.next;for(;u!==a.prev;){if(a.i!==u.i&&p4(a,u)){let f=pC(a,u);a=sh(a,a.next),f=sh(f,f.next),Fp(a,e,t,n,i,s,0),Fp(f,e,t,n,i,s,0);return}u=u.next}a=a.next}while(a!==r)}function o4(r,e,t,n){const i=[];let s,a,u,f,d;for(s=0,a=e.length;s<a;s++)u=e[s]*n,f=s<a-1?e[s+1]*n:r.length,d=fC(r,u,f,n,!1),d===d.next&&(d.steiner=!0),i.push(d4(d));for(i.sort(a4),s=0;s<i.length;s++)t=l4(i[s],t);return t}function a4(r,e){return r.x-e.x}function l4(r,e){const t=u4(r,e);if(!t)return e;const n=pC(t,r);return sh(n,n.next),sh(t,t.next)}function u4(r,e){let t=e,n=-1/0,i;const s=r.x,a=r.y;do{if(a<=t.y&&a>=t.next.y&&t.next.y!==t.y){const y=t.x+(a-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(y<=s&&y>n&&(n=y,i=t.x<t.next.x?t:t.next,y===s))return i}t=t.next}while(t!==e);if(!i)return null;const u=i,f=i.x,d=i.y;let m=1/0,_;t=i;do s>=t.x&&t.x>=f&&s!==t.x&&zf(a<d?s:n,a,f,d,a<d?n:s,a,t.x,t.y)&&(_=Math.abs(a-t.y)/(s-t.x),Up(t,r)&&(_<m||_===m&&(t.x>i.x||t.x===i.x&&c4(i,t)))&&(i=t,m=_)),t=t.next;while(t!==u);return i}function c4(r,e){return gi(r.prev,r,e.prev)<0&&gi(e.next,r,r.next)<0}function h4(r,e,t,n){let i=r;do i.z===0&&(i.z=qy(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,f4(i)}function f4(r){let e,t,n,i,s,a,u,f,d=1;do{for(t=r,r=null,s=null,a=0;t;){for(a++,n=t,u=0,e=0;e<d&&(u++,n=n.nextZ,!!n);e++);for(f=d;u>0||f>0&&n;)u!==0&&(f===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,u--):(i=n,n=n.nextZ,f--),s?s.nextZ=i:r=i,i.prevZ=s,s=i;t=n}s.nextZ=null,d*=2}while(a>1);return r}function qy(r,e,t,n,i){return r=(r-t)*i|0,e=(e-n)*i|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function d4(r){let e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function zf(r,e,t,n,i,s,a,u){return(i-a)*(e-u)>=(r-a)*(s-u)&&(r-a)*(n-u)>=(t-a)*(e-u)&&(t-a)*(s-u)>=(i-a)*(n-u)}function p4(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!m4(r,e)&&(Up(r,e)&&Up(e,r)&&g4(r,e)&&(gi(r.prev,r,e.prev)||gi(r,e.prev,e))||s_(r,e)&&gi(r.prev,r,r.next)>0&&gi(e.prev,e,e.next)>0)}function gi(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function s_(r,e){return r.x===e.x&&r.y===e.y}function dC(r,e,t,n){const i=Hg(gi(r,e,t)),s=Hg(gi(r,e,n)),a=Hg(gi(t,n,r)),u=Hg(gi(t,n,e));return!!(i!==s&&a!==u||i===0&&Vg(r,t,e)||s===0&&Vg(r,n,e)||a===0&&Vg(t,r,n)||u===0&&Vg(t,e,n))}function Vg(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function Hg(r){return r>0?1:r<0?-1:0}function m4(r,e){let t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&dC(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function Up(r,e){return gi(r.prev,r,r.next)<0?gi(r,e,r.next)>=0&&gi(r,r.prev,e)>=0:gi(r,e,r.prev)<0||gi(r,r.next,e)<0}function g4(r,e){let t=r,n=!1;const i=(r.x+e.x)/2,s=(r.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==r);return n}function pC(r,e){const t=new Xy(r.i,r.x,r.y),n=new Xy(e.i,e.x,e.y),i=r.next,s=e.prev;return r.next=e,e.prev=r,t.next=i,i.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function ES(r,e,t,n){const i=new Xy(r,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Bp(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Xy(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _4(r,e,t,n){let i=0;for(let s=e,a=t-n;s<t;s+=n)i+=(r[a]-r[s])*(r[s+1]+r[a+1]),a=s;return i}class La{static area(e){const t=e.length;let n=0;for(let i=t-1,s=0;s<t;i=s++)n+=e[i].x*e[s].y-e[s].x*e[i].y;return n*.5}static isClockWise(e){return La.area(e)<0}static triangulateShape(e,t){const n=[],i=[],s=[];TS(e),MS(n,e);let a=e.length;t.forEach(TS);for(let f=0;f<t.length;f++)i.push(a),a+=t[f].length,MS(n,t[f]);const u=t4.triangulate(n,i);for(let f=0;f<u.length;f+=3)s.push(u.slice(f,f+3));return s}}function TS(r){const e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function MS(r,e){for(let t=0;t<e.length;t++)r.push(e[t].x),r.push(e[t].y)}class lm extends en{constructor(e=new eh([new ze(.5,.5),new ze(-.5,.5),new ze(-.5,-.5),new ze(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],s=[];for(let u=0,f=e.length;u<f;u++){const d=e[u];a(d)}this.setAttribute("position",new pt(i,3)),this.setAttribute("uv",new pt(s,2)),this.computeVertexNormals();function a(u){const f=[],d=t.curveSegments!==void 0?t.curveSegments:12,m=t.steps!==void 0?t.steps:1,_=t.depth!==void 0?t.depth:1;let y=t.bevelEnabled!==void 0?t.bevelEnabled:!0,w=t.bevelThickness!==void 0?t.bevelThickness:.2,T=t.bevelSize!==void 0?t.bevelSize:w-.1,E=t.bevelOffset!==void 0?t.bevelOffset:0,M=t.bevelSegments!==void 0?t.bevelSegments:3;const P=t.extrudePath,C=t.UVGenerator!==void 0?t.UVGenerator:v4;let b,R=!1,z,B,k,I;P&&(b=P.getSpacedPoints(m),R=!0,y=!1,z=P.computeFrenetFrames(m,!1),B=new Z,k=new Z,I=new Z),y||(M=0,w=0,T=0,E=0);const N=u.extractPoints(d);let V=N.shape;const W=N.holes;if(!La.isClockWise(V)){V=V.reverse();for(let De=0,Le=W.length;De<Le;De++){const Qe=W[De];La.isClockWise(Qe)&&(W[De]=Qe.reverse())}}const H=La.triangulateShape(V,W),re=V;for(let De=0,Le=W.length;De<Le;De++){const Qe=W[De];V=V.concat(Qe)}function de(De,Le,Qe){return Le||console.error("THREE.ExtrudeGeometry: vec does not exist"),De.clone().addScaledVector(Le,Qe)}const ye=V.length,Ce=H.length;function K(De,Le,Qe){let gt,et,It;const At=De.x-Le.x,Pt=De.y-Le.y,Yt=Qe.x-De.x,tn=Qe.y-De.y,ee=At*At+Pt*Pt,X=At*tn-Pt*Yt;if(Math.abs(X)>Number.EPSILON){const Se=Math.sqrt(ee),$e=Math.sqrt(Yt*Yt+tn*tn),Ue=Le.x-Pt/Se,je=Le.y+At/Se,_t=Qe.x-tn/$e,st=Qe.y+Yt/$e,Re=((_t-Ue)*tn-(st-je)*Yt)/(At*tn-Pt*Yt);gt=Ue+At*Re-De.x,et=je+Pt*Re-De.y;const Et=gt*gt+et*et;if(Et<=2)return new ze(gt,et);It=Math.sqrt(Et/2)}else{let Se=!1;At>Number.EPSILON?Yt>Number.EPSILON&&(Se=!0):At<-Number.EPSILON?Yt<-Number.EPSILON&&(Se=!0):Math.sign(Pt)===Math.sign(tn)&&(Se=!0),Se?(gt=-Pt,et=At,It=Math.sqrt(ee)):(gt=At,et=Pt,It=Math.sqrt(ee/2))}return new ze(gt/It,et/It)}const oe=[];for(let De=0,Le=re.length,Qe=Le-1,gt=De+1;De<Le;De++,Qe++,gt++)Qe===Le&&(Qe=0),gt===Le&&(gt=0),oe[De]=K(re[De],re[Qe],re[gt]);const ne=[];let Q,$=oe.concat();for(let De=0,Le=W.length;De<Le;De++){const Qe=W[De];Q=[];for(let gt=0,et=Qe.length,It=et-1,At=gt+1;gt<et;gt++,It++,At++)It===et&&(It=0),At===et&&(At=0),Q[gt]=K(Qe[gt],Qe[It],Qe[At]);ne.push(Q),$=$.concat(Q)}for(let De=0;De<M;De++){const Le=De/M,Qe=w*Math.cos(Le*Math.PI/2),gt=T*Math.sin(Le*Math.PI/2)+E;for(let et=0,It=re.length;et<It;et++){const At=de(re[et],oe[et],gt);Oe(At.x,At.y,-Qe)}for(let et=0,It=W.length;et<It;et++){const At=W[et];Q=ne[et];for(let Pt=0,Yt=At.length;Pt<Yt;Pt++){const tn=de(At[Pt],Q[Pt],gt);Oe(tn.x,tn.y,-Qe)}}}const he=T+E;for(let De=0;De<ye;De++){const Le=y?de(V[De],$[De],he):V[De];R?(k.copy(z.normals[0]).multiplyScalar(Le.x),B.copy(z.binormals[0]).multiplyScalar(Le.y),I.copy(b[0]).add(k).add(B),Oe(I.x,I.y,I.z)):Oe(Le.x,Le.y,0)}for(let De=1;De<=m;De++)for(let Le=0;Le<ye;Le++){const Qe=y?de(V[Le],$[Le],he):V[Le];R?(k.copy(z.normals[De]).multiplyScalar(Qe.x),B.copy(z.binormals[De]).multiplyScalar(Qe.y),I.copy(b[De]).add(k).add(B),Oe(I.x,I.y,I.z)):Oe(Qe.x,Qe.y,_/m*De)}for(let De=M-1;De>=0;De--){const Le=De/M,Qe=w*Math.cos(Le*Math.PI/2),gt=T*Math.sin(Le*Math.PI/2)+E;for(let et=0,It=re.length;et<It;et++){const At=de(re[et],oe[et],gt);Oe(At.x,At.y,_+Qe)}for(let et=0,It=W.length;et<It;et++){const At=W[et];Q=ne[et];for(let Pt=0,Yt=At.length;Pt<Yt;Pt++){const tn=de(At[Pt],Q[Pt],gt);R?Oe(tn.x,tn.y+b[m-1].y,b[m-1].x+Qe):Oe(tn.x,tn.y,_+Qe)}}}Ae(),se();function Ae(){const De=i.length/3;if(y){let Le=0,Qe=ye*Le;for(let gt=0;gt<Ce;gt++){const et=H[gt];He(et[2]+Qe,et[1]+Qe,et[0]+Qe)}Le=m+M*2,Qe=ye*Le;for(let gt=0;gt<Ce;gt++){const et=H[gt];He(et[0]+Qe,et[1]+Qe,et[2]+Qe)}}else{for(let Le=0;Le<Ce;Le++){const Qe=H[Le];He(Qe[2],Qe[1],Qe[0])}for(let Le=0;Le<Ce;Le++){const Qe=H[Le];He(Qe[0]+ye*m,Qe[1]+ye*m,Qe[2]+ye*m)}}n.addGroup(De,i.length/3-De,0)}function se(){const De=i.length/3;let Le=0;Ne(re,Le),Le+=re.length;for(let Qe=0,gt=W.length;Qe<gt;Qe++){const et=W[Qe];Ne(et,Le),Le+=et.length}n.addGroup(De,i.length/3-De,1)}function Ne(De,Le){let Qe=De.length;for(;--Qe>=0;){const gt=Qe;let et=Qe-1;et<0&&(et=De.length-1);for(let It=0,At=m+M*2;It<At;It++){const Pt=ye*It,Yt=ye*(It+1),tn=Le+gt+Pt,ee=Le+et+Pt,X=Le+et+Yt,Se=Le+gt+Yt;Xe(tn,ee,X,Se)}}}function Oe(De,Le,Qe){f.push(De),f.push(Le),f.push(Qe)}function He(De,Le,Qe){Je(De),Je(Le),Je(Qe);const gt=i.length/3,et=C.generateTopUV(n,i,gt-3,gt-2,gt-1);ut(et[0]),ut(et[1]),ut(et[2])}function Xe(De,Le,Qe,gt){Je(De),Je(Le),Je(gt),Je(Le),Je(Qe),Je(gt);const et=i.length/3,It=C.generateSideWallUV(n,i,et-6,et-3,et-2,et-1);ut(It[0]),ut(It[1]),ut(It[3]),ut(It[1]),ut(It[2]),ut(It[3])}function Je(De){i.push(f[De*3+0]),i.push(f[De*3+1]),i.push(f[De*3+2])}function ut(De){s.push(De.x),s.push(De.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return y4(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,a=e.shapes.length;s<a;s++){const u=t[e.shapes[s]];n.push(u)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new jx[i.type]().fromJSON(i)),new lm(n,e.options)}}const v4={generateTopUV:function(r,e,t,n,i){const s=e[t*3],a=e[t*3+1],u=e[n*3],f=e[n*3+1],d=e[i*3],m=e[i*3+1];return[new ze(s,a),new ze(u,f),new ze(d,m)]},generateSideWallUV:function(r,e,t,n,i,s){const a=e[t*3],u=e[t*3+1],f=e[t*3+2],d=e[n*3],m=e[n*3+1],_=e[n*3+2],y=e[i*3],w=e[i*3+1],T=e[i*3+2],E=e[s*3],M=e[s*3+1],P=e[s*3+2];return Math.abs(u-m)<Math.abs(a-d)?[new ze(a,1-f),new ze(d,1-_),new ze(y,1-T),new ze(E,1-P)]:[new ze(u,1-f),new ze(m,1-_),new ze(w,1-T),new ze(M,1-P)]}};function y4(r,e,t){if(t.shapes=[],Array.isArray(r))for(let n=0,i=r.length;n<i;n++){const s=r[n];t.shapes.push(s.uuid)}else t.shapes.push(r.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class um extends Ol{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new um(e.radius,e.detail)}}class nd extends Ol{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new nd(e.radius,e.detail)}}class cm extends en{constructor(e=.5,t=1,n=32,i=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:s,thetaLength:a},n=Math.max(3,n),i=Math.max(1,i);const u=[],f=[],d=[],m=[];let _=e;const y=(t-e)/i,w=new Z,T=new ze;for(let E=0;E<=i;E++){for(let M=0;M<=n;M++){const P=s+M/n*a;w.x=_*Math.cos(P),w.y=_*Math.sin(P),f.push(w.x,w.y,w.z),d.push(0,0,1),T.x=(w.x/t+1)/2,T.y=(w.y/t+1)/2,m.push(T.x,T.y)}_+=y}for(let E=0;E<i;E++){const M=E*(n+1);for(let P=0;P<n;P++){const C=P+M,b=C,R=C+n+1,z=C+n+2,B=C+1;u.push(b,R,B),u.push(R,z,B)}}this.setIndex(u),this.setAttribute("position",new pt(f,3)),this.setAttribute("normal",new pt(d,3)),this.setAttribute("uv",new pt(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cm(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class hm extends en{constructor(e=new eh([new ze(0,.5),new ze(-.5,-.5),new ze(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],s=[],a=[];let u=0,f=0;if(Array.isArray(e)===!1)d(e);else for(let m=0;m<e.length;m++)d(e[m]),this.addGroup(u,f,m),u+=f,f=0;this.setIndex(n),this.setAttribute("position",new pt(i,3)),this.setAttribute("normal",new pt(s,3)),this.setAttribute("uv",new pt(a,2));function d(m){const _=i.length/3,y=m.extractPoints(t);let w=y.shape;const T=y.holes;La.isClockWise(w)===!1&&(w=w.reverse());for(let M=0,P=T.length;M<P;M++){const C=T[M];La.isClockWise(C)===!0&&(T[M]=C.reverse())}const E=La.triangulateShape(w,T);for(let M=0,P=T.length;M<P;M++){const C=T[M];w=w.concat(C)}for(let M=0,P=w.length;M<P;M++){const C=w[M];i.push(C.x,C.y,0),s.push(0,0,1),a.push(C.x,C.y)}for(let M=0,P=E.length;M<P;M++){const C=E[M],b=C[0]+_,R=C[1]+_,z=C[2]+_;n.push(b,R,z),f+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return x4(t,e)}static fromJSON(e,t){const n=[];for(let i=0,s=e.shapes.length;i<s;i++){const a=t[e.shapes[i]];n.push(a)}return new hm(n,e.curveSegments)}}function x4(r,e){if(e.shapes=[],Array.isArray(r))for(let t=0,n=r.length;t<n;t++){const i=r[t];e.shapes.push(i.uuid)}else e.shapes.push(r.uuid);return e}class id extends en{constructor(e=1,t=32,n=16,i=0,s=Math.PI*2,a=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:s,thetaStart:a,thetaLength:u},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const f=Math.min(a+u,Math.PI);let d=0;const m=[],_=new Z,y=new Z,w=[],T=[],E=[],M=[];for(let P=0;P<=n;P++){const C=[],b=P/n;let R=0;P==0&&a==0?R=.5/t:P==n&&f==Math.PI&&(R=-.5/t);for(let z=0;z<=t;z++){const B=z/t;_.x=-e*Math.cos(i+B*s)*Math.sin(a+b*u),_.y=e*Math.cos(a+b*u),_.z=e*Math.sin(i+B*s)*Math.sin(a+b*u),T.push(_.x,_.y,_.z),y.copy(_).normalize(),E.push(y.x,y.y,y.z),M.push(B+R,1-b),C.push(d++)}m.push(C)}for(let P=0;P<n;P++)for(let C=0;C<t;C++){const b=m[P][C+1],R=m[P][C],z=m[P+1][C],B=m[P+1][C+1];(P!==0||a>0)&&w.push(b,R,B),(P!==n-1||f<Math.PI)&&w.push(R,z,B)}this.setIndex(w),this.setAttribute("position",new pt(T,3)),this.setAttribute("normal",new pt(E,3)),this.setAttribute("uv",new pt(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new id(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class fm extends Ol{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new fm(e.radius,e.detail)}}class dm extends en{constructor(e=1,t=.4,n=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:s},n=Math.floor(n),i=Math.floor(i);const a=[],u=[],f=[],d=[],m=new Z,_=new Z,y=new Z;for(let w=0;w<=n;w++)for(let T=0;T<=i;T++){const E=T/i*s,M=w/n*Math.PI*2;_.x=(e+t*Math.cos(M))*Math.cos(E),_.y=(e+t*Math.cos(M))*Math.sin(E),_.z=t*Math.sin(M),u.push(_.x,_.y,_.z),m.x=e*Math.cos(E),m.y=e*Math.sin(E),y.subVectors(_,m).normalize(),f.push(y.x,y.y,y.z),d.push(T/i),d.push(w/n)}for(let w=1;w<=n;w++)for(let T=1;T<=i;T++){const E=(i+1)*w+T-1,M=(i+1)*(w-1)+T-1,P=(i+1)*(w-1)+T,C=(i+1)*w+T;a.push(E,M,C),a.push(M,P,C)}this.setIndex(a),this.setAttribute("position",new pt(u,3)),this.setAttribute("normal",new pt(f,3)),this.setAttribute("uv",new pt(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dm(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class pm extends en{constructor(e=1,t=.4,n=64,i=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:s,q:a},n=Math.floor(n),i=Math.floor(i);const u=[],f=[],d=[],m=[],_=new Z,y=new Z,w=new Z,T=new Z,E=new Z,M=new Z,P=new Z;for(let b=0;b<=n;++b){const R=b/n*s*Math.PI*2;C(R,s,a,e,w),C(R+.01,s,a,e,T),M.subVectors(T,w),P.addVectors(T,w),E.crossVectors(M,P),P.crossVectors(E,M),E.normalize(),P.normalize();for(let z=0;z<=i;++z){const B=z/i*Math.PI*2,k=-t*Math.cos(B),I=t*Math.sin(B);_.x=w.x+(k*P.x+I*E.x),_.y=w.y+(k*P.y+I*E.y),_.z=w.z+(k*P.z+I*E.z),f.push(_.x,_.y,_.z),y.subVectors(_,w).normalize(),d.push(y.x,y.y,y.z),m.push(b/n),m.push(z/i)}}for(let b=1;b<=n;b++)for(let R=1;R<=i;R++){const z=(i+1)*(b-1)+(R-1),B=(i+1)*b+(R-1),k=(i+1)*b+R,I=(i+1)*(b-1)+R;u.push(z,B,I),u.push(B,k,I)}this.setIndex(u),this.setAttribute("position",new pt(f,3)),this.setAttribute("normal",new pt(d,3)),this.setAttribute("uv",new pt(m,2));function C(b,R,z,B,k){const I=Math.cos(b),N=Math.sin(b),V=z/R*b,W=Math.cos(V);k.x=B*(2+W)*.5*I,k.y=B*(2+W)*N*.5,k.z=B*Math.sin(V)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pm(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class mm extends en{constructor(e=new Gx(new Z(-1,-1,0),new Z(-1,1,0),new Z(1,1,0)),t=64,n=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const u=new Z,f=new Z,d=new ze;let m=new Z;const _=[],y=[],w=[],T=[];E(),this.setIndex(T),this.setAttribute("position",new pt(_,3)),this.setAttribute("normal",new pt(y,3)),this.setAttribute("uv",new pt(w,2));function E(){for(let b=0;b<t;b++)M(b);M(s===!1?t:0),C(),P()}function M(b){m=e.getPointAt(b/t,m);const R=a.normals[b],z=a.binormals[b];for(let B=0;B<=i;B++){const k=B/i*Math.PI*2,I=Math.sin(k),N=-Math.cos(k);f.x=N*R.x+I*z.x,f.y=N*R.y+I*z.y,f.z=N*R.z+I*z.z,f.normalize(),y.push(f.x,f.y,f.z),u.x=m.x+n*f.x,u.y=m.y+n*f.y,u.z=m.z+n*f.z,_.push(u.x,u.y,u.z)}}function P(){for(let b=1;b<=t;b++)for(let R=1;R<=i;R++){const z=(i+1)*(b-1)+(R-1),B=(i+1)*b+(R-1),k=(i+1)*b+R,I=(i+1)*(b-1)+R;T.push(z,B,I),T.push(B,k,I)}}function C(){for(let b=0;b<=t;b++)for(let R=0;R<=i;R++)d.x=b/t,d.y=R/i,w.push(d.x,d.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new mm(new jx[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class mC extends en{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,i=new Z,s=new Z;if(e.index!==null){const a=e.attributes.position,u=e.index;let f=e.groups;f.length===0&&(f=[{start:0,count:u.count,materialIndex:0}]);for(let d=0,m=f.length;d<m;++d){const _=f[d],y=_.start,w=_.count;for(let T=y,E=y+w;T<E;T+=3)for(let M=0;M<3;M++){const P=u.getX(T+M),C=u.getX(T+(M+1)%3);i.fromBufferAttribute(a,P),s.fromBufferAttribute(a,C),CS(i,s,n)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let u=0,f=a.count/3;u<f;u++)for(let d=0;d<3;d++){const m=3*u+d,_=3*u+(d+1)%3;i.fromBufferAttribute(a,m),s.fromBufferAttribute(a,_),CS(i,s,n)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new pt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function CS(r,e,t){const n=`${r.x},${r.y},${r.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${r.x},${r.y},${r.z}`;return t.has(n)===!0||t.has(i)===!0?!1:(t.add(n),t.add(i),!0)}var AS=Object.freeze({__proto__:null,BoxGeometry:Hu,CapsuleGeometry:rm,CircleGeometry:sm,ConeGeometry:om,CylinderGeometry:gh,DodecahedronGeometry:am,EdgesGeometry:hC,ExtrudeGeometry:lm,IcosahedronGeometry:um,LatheGeometry:td,OctahedronGeometry:nd,PlaneGeometry:Jf,PolyhedronGeometry:Ol,RingGeometry:cm,ShapeGeometry:hm,SphereGeometry:id,TetrahedronGeometry:fm,TorusGeometry:dm,TorusKnotGeometry:pm,TubeGeometry:mm,WireframeGeometry:mC});class gC extends Zr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new dt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class _C extends ro{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class qx extends Zr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new dt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bu,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Xx extends qx{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ze(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ni(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new dt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new dt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new dt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class vC extends Zr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new dt(16777215),this.specular=new dt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bu,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class yC extends Zr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new dt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bu,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class xC extends Zr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bu,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class wC extends Zr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new dt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new dt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bu,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class SC extends Zr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new dt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bu,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class EC extends vs{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Eo(r,e,t){return $x(r)?new r.constructor(r.subarray(e,t!==void 0?t:r.length)):r.slice(e,t)}function qc(r,e,t){return!r||!t&&r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)}function $x(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function TC(r){function e(i,s){return r[i]-r[s]}const t=r.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(e),n}function $y(r,e,t){const n=r.length,i=new r.constructor(n);for(let s=0,a=0;a!==n;++s){const u=t[s]*e;for(let f=0;f!==e;++f)i[a++]=r[u+f]}return i}function Yx(r,e,t,n){let i=1,s=r[0];for(;s!==void 0&&s[n]===void 0;)s=r[i++];if(s===void 0)return;let a=s[n];if(a!==void 0)if(Array.isArray(a))do a=s[n],a!==void 0&&(e.push(s.time),t.push.apply(t,a)),s=r[i++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[n],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=r[i++];while(s!==void 0);else do a=s[n],a!==void 0&&(e.push(s.time),t.push(a)),s=r[i++];while(s!==void 0)}function w4(r,e,t,n,i=30){const s=r.clone();s.name=e;const a=[];for(let f=0;f<s.tracks.length;++f){const d=s.tracks[f],m=d.getValueSize(),_=[],y=[];for(let w=0;w<d.times.length;++w){const T=d.times[w]*i;if(!(T<t||T>=n)){_.push(d.times[w]);for(let E=0;E<m;++E)y.push(d.values[w*m+E])}}_.length!==0&&(d.times=qc(_,d.times.constructor),d.values=qc(y,d.values.constructor),a.push(d))}s.tracks=a;let u=1/0;for(let f=0;f<s.tracks.length;++f)u>s.tracks[f].times[0]&&(u=s.tracks[f].times[0]);for(let f=0;f<s.tracks.length;++f)s.tracks[f].shift(-1*u);return s.resetDuration(),s}function S4(r,e=0,t=r,n=30){n<=0&&(n=30);const i=t.tracks.length,s=e/n;for(let a=0;a<i;++a){const u=t.tracks[a],f=u.ValueTypeName;if(f==="bool"||f==="string")continue;const d=r.tracks.find(function(P){return P.name===u.name&&P.ValueTypeName===f});if(d===void 0)continue;let m=0;const _=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=_/3);let y=0;const w=d.getValueSize();d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=w/3);const T=u.times.length-1;let E;if(s<=u.times[0]){const P=m,C=_-m;E=Eo(u.values,P,C)}else if(s>=u.times[T]){const P=T*_+m,C=P+_-m;E=Eo(u.values,P,C)}else{const P=u.createInterpolant(),C=m,b=_-m;P.evaluate(s),E=Eo(P.resultBuffer,C,b)}f==="quaternion"&&new Ns().fromArray(E).normalize().conjugate().toArray(E);const M=d.times.length;for(let P=0;P<M;++P){const C=P*w+y;if(f==="quaternion")Ns.multiplyQuaternionsFlat(d.values,C,E,0,d.values,C);else{const b=w-y*2;for(let R=0;R<b;++R)d.values[C+R]-=E[R]}}}return r.blendMode=Mx,r}const E4={arraySlice:Eo,convertArray:qc,isTypedArray:$x,getKeyframeOrder:TC,sortedArray:$y,flattenJSON:Yx,subclip:w4,makeClipAdditive:S4};class gm{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],s=t[n-1];e:{t:{let a;n:{i:if(!(e<i)){for(let u=n+2;;){if(i===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===u)break;if(s=i,i=t[++n],e<i)break t}a=t.length;break n}if(!(e>=s)){const u=t[1];e<u&&(n=2,s=u);for(let f=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===f)break;if(i=s,s=t[--n-1],e>=s)break t}a=n,n=0;break n}break e}for(;n<a;){const u=n+a>>>1;e<t[u]?a=u:n=u+1}if(i=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,i)}return this.interpolate_(n,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i;for(let a=0;a!==i;++a)t[a]=n[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class MC extends gm{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Gc,endingEnd:Gc}}intervalChanged_(e,t,n){const i=this.parameterPositions;let s=e-2,a=e+1,u=i[s],f=i[a];if(u===void 0)switch(this.getSettings_().endingStart){case Wc:s=e,u=2*t-n;break;case Lp:s=i.length-2,u=t+i[s]-i[s+1];break;default:s=e,u=n}if(f===void 0)switch(this.getSettings_().endingEnd){case Wc:a=e,f=2*n-t;break;case Lp:a=1,f=n+i[1]-i[0];break;default:a=e-1,f=t}const d=(n-t)*.5,m=this.valueSize;this._weightPrev=d/(t-u),this._weightNext=d/(f-n),this._offsetPrev=s*m,this._offsetNext=a*m}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,u=this.valueSize,f=e*u,d=f-u,m=this._offsetPrev,_=this._offsetNext,y=this._weightPrev,w=this._weightNext,T=(n-t)/(i-t),E=T*T,M=E*T,P=-y*M+2*y*E-y*T,C=(1+y)*M+(-1.5-2*y)*E+(-.5+y)*T+1,b=(-1-w)*M+(1.5+w)*E+.5*T,R=w*M-w*E;for(let z=0;z!==u;++z)s[z]=P*a[m+z]+C*a[d+z]+b*a[f+z]+R*a[_+z];return s}}class Qx extends gm{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,u=this.valueSize,f=e*u,d=f-u,m=(n-t)/(i-t),_=1-m;for(let y=0;y!==u;++y)s[y]=a[d+y]*_+a[f+y]*m;return s}}class CC extends gm{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class ua{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=qc(t,this.TimeBufferType),this.values=qc(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:qc(e.times,Array),values:qc(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new CC(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Qx(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new MC(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Rp:t=this.InterpolantFactoryMethodDiscrete;break;case Dp:t=this.InterpolantFactoryMethodLinear;break;case f0:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Rp;case this.InterpolantFactoryMethodLinear:return Dp;case this.InterpolantFactoryMethodSmooth:return f0}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let s=0,a=i-1;for(;s!==i&&n[s]<e;)++s;for(;a!==-1&&n[a]>t;)--a;if(++a,s!==0||a!==i){s>=a&&(a=Math.max(a,1),s=a-1);const u=this.getValueSize();this.times=Eo(n,s,a),this.values=Eo(this.values,s*u,a*u)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let u=0;u!==s;u++){const f=n[u];if(typeof f=="number"&&isNaN(f)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,u,f),e=!1;break}if(a!==null&&a>f){console.error("THREE.KeyframeTrack: Out of order keys.",this,u,f,a),e=!1;break}a=f}if(i!==void 0&&$x(i))for(let u=0,f=i.length;u!==f;++u){const d=i[u];if(isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,d),e=!1;break}}return e}optimize(){const e=Eo(this.times),t=Eo(this.values),n=this.getValueSize(),i=this.getInterpolation()===f0,s=e.length-1;let a=1;for(let u=1;u<s;++u){let f=!1;const d=e[u],m=e[u+1];if(d!==m&&(u!==1||d!==e[0]))if(i)f=!0;else{const _=u*n,y=_-n,w=_+n;for(let T=0;T!==n;++T){const E=t[_+T];if(E!==t[y+T]||E!==t[w+T]){f=!0;break}}}if(f){if(u!==a){e[a]=e[u];const _=u*n,y=a*n;for(let w=0;w!==n;++w)t[y+w]=t[_+w]}++a}}if(s>0){e[a]=e[s];for(let u=s*n,f=a*n,d=0;d!==n;++d)t[f+d]=t[u+d];++a}return a!==e.length?(this.times=Eo(e,0,a),this.values=Eo(t,0,a*n)):(this.times=e,this.values=t),this}clone(){const e=Eo(this.times,0),t=Eo(this.values,0),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}ua.prototype.TimeBufferType=Float32Array;ua.prototype.ValueBufferType=Float32Array;ua.prototype.DefaultInterpolation=Dp;class _h extends ua{}_h.prototype.ValueTypeName="bool";_h.prototype.ValueBufferType=Array;_h.prototype.DefaultInterpolation=Rp;_h.prototype.InterpolantFactoryMethodLinear=void 0;_h.prototype.InterpolantFactoryMethodSmooth=void 0;class Kx extends ua{}Kx.prototype.ValueTypeName="color";class Vp extends ua{}Vp.prototype.ValueTypeName="number";class AC extends gm{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,u=this.valueSize,f=(n-t)/(i-t);let d=e*u;for(let m=d+u;d!==m;d+=4)Ns.slerpFlat(s,0,a,d-u,a,d,f);return s}}class rd extends ua{InterpolantFactoryMethodLinear(e){return new AC(this.times,this.values,this.getValueSize(),e)}}rd.prototype.ValueTypeName="quaternion";rd.prototype.DefaultInterpolation=Dp;rd.prototype.InterpolantFactoryMethodSmooth=void 0;class vh extends ua{}vh.prototype.ValueTypeName="string";vh.prototype.ValueBufferType=Array;vh.prototype.DefaultInterpolation=Rp;vh.prototype.InterpolantFactoryMethodLinear=void 0;vh.prototype.InterpolantFactoryMethodSmooth=void 0;class Hp extends ua{}Hp.prototype.ValueTypeName="vector";class Gp{constructor(e,t=-1,n,i=$0){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=no(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let a=0,u=n.length;a!==u;++a)t.push(M4(n[a]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=n.length;s!==a;++s)t.push(ua.toJSON(n[s]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const s=t.length,a=[];for(let u=0;u<s;u++){let f=[],d=[];f.push((u+s-1)%s,u,(u+1)%s),d.push(0,1,0);const m=TC(f);f=$y(f,1,m),d=$y(d,1,m),!i&&f[0]===0&&(f.push(s),d.push(d[0])),a.push(new Vp(".morphTargetInfluences["+t[u].name+"]",f,d).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},s=/^([\w-]*?)([\d]+)$/;for(let u=0,f=e.length;u<f;u++){const d=e[u],m=d.name.match(s);if(m&&m.length>1){const _=m[1];let y=i[_];y||(i[_]=y=[]),y.push(d)}}const a=[];for(const u in i)a.push(this.CreateFromMorphTargetSequence(u,i[u],t,n));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(_,y,w,T,E){if(w.length!==0){const M=[],P=[];Yx(w,M,P,T),M.length!==0&&E.push(new _(y,M,P))}},i=[],s=e.name||"default",a=e.fps||30,u=e.blendMode;let f=e.length||-1;const d=e.hierarchy||[];for(let _=0;_<d.length;_++){const y=d[_].keys;if(!(!y||y.length===0))if(y[0].morphTargets){const w={};let T;for(T=0;T<y.length;T++)if(y[T].morphTargets)for(let E=0;E<y[T].morphTargets.length;E++)w[y[T].morphTargets[E]]=-1;for(const E in w){const M=[],P=[];for(let C=0;C!==y[T].morphTargets.length;++C){const b=y[T];M.push(b.time),P.push(b.morphTarget===E?1:0)}i.push(new Vp(".morphTargetInfluence["+E+"]",M,P))}f=w.length*a}else{const w=".bones["+t[_].name+"]";n(Hp,w+".position",y,"pos",i),n(rd,w+".quaternion",y,"rot",i),n(Hp,w+".scale",y,"scl",i)}}return i.length===0?null:new this(s,f,i,u)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,i=e.length;n!==i;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function T4(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Vp;case"vector":case"vector2":case"vector3":case"vector4":return Hp;case"color":return Kx;case"quaternion":return rd;case"bool":case"boolean":return _h;case"string":return vh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function M4(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=T4(r.type);if(r.times===void 0){const t=[],n=[];Yx(r.keys,t,n,"value"),r.times=t,r.values=n}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}const oh={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class Zx{constructor(e,t,n){const i=this;let s=!1,a=0,u=0,f;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(m){u++,s===!1&&i.onStart!==void 0&&i.onStart(m,a,u),s=!0},this.itemEnd=function(m){a++,i.onProgress!==void 0&&i.onProgress(m,a,u),a===u&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(m){i.onError!==void 0&&i.onError(m)},this.resolveURL=function(m){return f?f(m):m},this.setURLModifier=function(m){return f=m,this},this.addHandler=function(m,_){return d.push(m,_),this},this.removeHandler=function(m){const _=d.indexOf(m);return _!==-1&&d.splice(_,2),this},this.getHandler=function(m){for(let _=0,y=d.length;_<y;_+=2){const w=d[_],T=d[_+1];if(w.global&&(w.lastIndex=0),w.test(m))return T}return null}}}const bC=new Zx;class so{constructor(e){this.manager=e!==void 0?e:bC,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,s){n.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Sl={};class C4 extends Error{constructor(e,t){super(e),this.response=t}}class Rl extends so{constructor(e){super(e)}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=oh.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Sl[e]!==void 0){Sl[e].push({onLoad:t,onProgress:n,onError:i});return}Sl[e]=[],Sl[e].push({onLoad:t,onProgress:n,onError:i});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),u=this.mimeType,f=this.responseType;fetch(a).then(d=>{if(d.status===200||d.status===0){if(d.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||d.body===void 0||d.body.getReader===void 0)return d;const m=Sl[e],_=d.body.getReader(),y=d.headers.get("Content-Length")||d.headers.get("X-File-Size"),w=y?parseInt(y):0,T=w!==0;let E=0;const M=new ReadableStream({start(P){C();function C(){_.read().then(({done:b,value:R})=>{if(b)P.close();else{E+=R.byteLength;const z=new ProgressEvent("progress",{lengthComputable:T,loaded:E,total:w});for(let B=0,k=m.length;B<k;B++){const I=m[B];I.onProgress&&I.onProgress(z)}P.enqueue(R),C()}})}}});return new Response(M)}else throw new C4(`fetch for "${d.url}" responded with ${d.status}: ${d.statusText}`,d)}).then(d=>{switch(f){case"arraybuffer":return d.arrayBuffer();case"blob":return d.blob();case"document":return d.text().then(m=>new DOMParser().parseFromString(m,u));case"json":return d.json();default:if(u===void 0)return d.text();{const _=/charset="?([^;"\s]*)"?/i.exec(u),y=_&&_[1]?_[1].toLowerCase():void 0,w=new TextDecoder(y);return d.arrayBuffer().then(T=>w.decode(T))}}}).then(d=>{oh.add(e,d);const m=Sl[e];delete Sl[e];for(let _=0,y=m.length;_<y;_++){const w=m[_];w.onLoad&&w.onLoad(d)}}).catch(d=>{const m=Sl[e];if(m===void 0)throw this.manager.itemError(e),d;delete Sl[e];for(let _=0,y=m.length;_<y;_++){const w=m[_];w.onError&&w.onError(d)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class A4 extends so{constructor(e){super(e)}load(e,t,n,i){const s=this,a=new Rl(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(u){try{t(s.parse(JSON.parse(u)))}catch(f){i?i(f):console.error(f),s.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=Gp.parse(e[n]);t.push(i)}return t}}class b4 extends so{constructor(e){super(e)}load(e,t,n,i){const s=this,a=[],u=new Ux,f=new Rl(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(s.withCredentials);let d=0;function m(_){f.load(e[_],function(y){const w=s.parse(y,!0);a[_]={width:w.width,height:w.height,format:w.format,mipmaps:w.mipmaps},d+=1,d===6&&(w.mipmapCount===1&&(u.minFilter=ai),u.image=a,u.format=w.format,u.needsUpdate=!0,t&&t(u))},n,i)}if(Array.isArray(e))for(let _=0,y=e.length;_<y;++_)m(_);else f.load(e,function(_){const y=s.parse(_,!0);if(y.isCubemap){const w=y.mipmaps.length/y.mipmapCount;for(let T=0;T<w;T++){a[T]={mipmaps:[]};for(let E=0;E<y.mipmapCount;E++)a[T].mipmaps.push(y.mipmaps[T*y.mipmapCount+E]),a[T].format=y.format,a[T].width=y.width,a[T].height=y.height}u.image=a}else u.image.width=y.width,u.image.height=y.height,u.mipmaps=y.mipmaps;y.mipmapCount===1&&(u.minFilter=ai),u.format=y.format,u.needsUpdate=!0,t&&t(u)},n,i);return u}}class Wp extends so{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=oh.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const u=kp("img");function f(){m(),oh.add(e,this),t&&t(this),s.manager.itemEnd(e)}function d(_){m(),i&&i(_),s.manager.itemError(e),s.manager.itemEnd(e)}function m(){u.removeEventListener("load",f,!1),u.removeEventListener("error",d,!1)}return u.addEventListener("load",f,!1),u.addEventListener("error",d,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),s.manager.itemStart(e),u.src=e,u}}class P4 extends so{constructor(e){super(e)}load(e,t,n,i){const s=new im,a=new Wp(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let u=0;function f(d){a.load(e[d],function(m){s.images[d]=m,u++,u===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let d=0;d<e.length;++d)f(d);return s}}class PC extends so{constructor(e){super(e)}load(e,t,n,i){const s=this,a=new Bf,u=new Rl(this.manager);return u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setPath(this.path),u.setWithCredentials(s.withCredentials),u.load(e,function(f){const d=s.parse(f);d&&(d.image!==void 0?a.image=d.image:d.data!==void 0&&(a.image.width=d.width,a.image.height=d.height,a.image.data=d.data),a.wrapS=d.wrapS!==void 0?d.wrapS:Kr,a.wrapT=d.wrapT!==void 0?d.wrapT:Kr,a.magFilter=d.magFilter!==void 0?d.magFilter:ai,a.minFilter=d.minFilter!==void 0?d.minFilter:ai,a.anisotropy=d.anisotropy!==void 0?d.anisotropy:1,d.encoding!==void 0&&(a.encoding=d.encoding),d.flipY!==void 0&&(a.flipY=d.flipY),d.format!==void 0&&(a.format=d.format),d.type!==void 0&&(a.type=d.type),d.mipmaps!==void 0&&(a.mipmaps=d.mipmaps,a.minFilter=Du),d.mipmapCount===1&&(a.minFilter=ai),d.generateMipmaps!==void 0&&(a.generateMipmaps=d.generateMipmaps),a.needsUpdate=!0,t&&t(a,d))},n,i),a}}class I4 extends so{constructor(e){super(e)}load(e,t,n,i){const s=new ki,a=new Wp(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(u){s.image=u,s.needsUpdate=!0,t!==void 0&&t(s)},n,i),s}}class Wu extends In{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new dt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class IC extends Wu{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(In.DEFAULT_UP),this.updateMatrix(),this.groundColor=new dt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Iv=new Jt,bS=new Z,PS=new Z;class Jx{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ze(512,512),this.map=null,this.mapPass=null,this.matrix=new Jt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Q0,this._frameExtents=new ze(1,1),this._viewportCount=1,this._viewports=[new Un(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;bS.setFromMatrixPosition(e.matrixWorld),t.position.copy(bS),PS.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(PS),t.updateMatrixWorld(),Iv.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Iv),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Iv)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class R4 extends Jx{constructor(){super(new yr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=Np*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class RC extends Wu{constructor(e,t,n=0,i=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(In.DEFAULT_UP),this.updateMatrix(),this.target=new In,this.distance=n,this.angle=i,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new R4}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const IS=new Jt,op=new Z,Rv=new Z;class D4 extends Jx{constructor(){super(new yr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ze(4,2),this._viewportCount=6,this._viewports=[new Un(2,1,1,1),new Un(0,1,1,1),new Un(3,1,1,1),new Un(1,1,1,1),new Un(3,0,1,1),new Un(1,0,1,1)],this._cubeDirections=[new Z(1,0,0),new Z(-1,0,0),new Z(0,0,1),new Z(0,0,-1),new Z(0,1,0),new Z(0,-1,0)],this._cubeUps=[new Z(0,1,0),new Z(0,1,0),new Z(0,1,0),new Z(0,1,0),new Z(0,0,1),new Z(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),op.setFromMatrixPosition(e.matrixWorld),n.position.copy(op),Rv.copy(n.position),Rv.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Rv),n.updateMatrixWorld(),i.makeTranslation(-op.x,-op.y,-op.z),IS.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(IS)}}class DC extends Wu{constructor(e,t,n=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new D4}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class L4 extends Jx{constructor(){super(new Gu(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class LC extends Wu{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(In.DEFAULT_UP),this.updateMatrix(),this.target=new In,this.shadow=new L4}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class OC extends Wu{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class NC extends Wu{constructor(e,t,n=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class kC{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Z)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*i),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],1.092548*(n*i)),t.addScaledVector(a[5],1.092548*(i*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(n*s)),t.addScaledVector(a[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*i),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*n),t.addScaledVector(a[4],2*.429043*n*i),t.addScaledVector(a[5],2*.429043*i*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*n*s),t.addScaledVector(a[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const n=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-i*i)}}class o_ extends Wu{constructor(e=new kC,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class a_ extends so{constructor(e){super(e),this.textures={}}load(e,t,n,i){const s=this,a=new Rl(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(u){try{t(s.parse(JSON.parse(u)))}catch(f){i?i(f):console.error(f),s.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=a_.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new dt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==1&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(i.uniforms[s]={},a.type){case"t":i.uniforms[s].value=n(a.value);break;case"c":i.uniforms[s].value=new dt().setHex(a.value);break;case"v2":i.uniforms[s].value=new ze().fromArray(a.value);break;case"v3":i.uniforms[s].value=new Z().fromArray(a.value);break;case"v4":i.uniforms[s].value=new Un().fromArray(a.value);break;case"m3":i.uniforms[s].value=new zr().fromArray(a.value);break;case"m4":i.uniforms[s].value=new Jt().fromArray(a.value);break;default:i.uniforms[s].value=a.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new ze().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new ze().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:gC,SpriteMaterial:kx,RawShaderMaterial:_C,ShaderMaterial:ro,PointsMaterial:Fx,MeshPhysicalMaterial:Xx,MeshStandardMaterial:qx,MeshPhongMaterial:vC,MeshToonMaterial:yC,MeshNormalMaterial:xC,MeshLambertMaterial:wC,MeshDepthMaterial:Lx,MeshDistanceMaterial:Ox,MeshBasicMaterial:Vu,MeshMatcapMaterial:SC,LineDashedMaterial:EC,LineBasicMaterial:vs,Material:Zr};return new t[e]}}class Yy{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class zC extends en{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class FC extends so{constructor(e){super(e)}load(e,t,n,i){const s=this,a=new Rl(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(u){try{t(s.parse(JSON.parse(u)))}catch(f){i?i(f):console.error(f),s.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(w,T){if(t[T]!==void 0)return t[T];const M=w.interleavedBuffers[T],P=s(w,M.buffer),C=Of(M.type,P),b=new t_(C,M.stride);return b.uuid=M.uuid,t[T]=b,b}function s(w,T){if(n[T]!==void 0)return n[T];const M=w.arrayBuffers[T],P=new Uint32Array(M).buffer;return n[T]=P,P}const a=e.isInstancedBufferGeometry?new zC:new en,u=e.data.index;if(u!==void 0){const w=Of(u.type,u.array);a.setIndex(new $n(w,1))}const f=e.data.attributes;for(const w in f){const T=f[w];let E;if(T.isInterleavedBufferAttribute){const M=i(e.data,T.data);E=new rh(M,T.itemSize,T.offset,T.normalized)}else{const M=Of(T.type,T.array),P=T.isInstancedBufferAttribute?jf:$n;E=new P(M,T.itemSize,T.normalized)}T.name!==void 0&&(E.name=T.name),T.usage!==void 0&&E.setUsage(T.usage),T.updateRange!==void 0&&(E.updateRange.offset=T.updateRange.offset,E.updateRange.count=T.updateRange.count),a.setAttribute(w,E)}const d=e.data.morphAttributes;if(d)for(const w in d){const T=d[w],E=[];for(let M=0,P=T.length;M<P;M++){const C=T[M];let b;if(C.isInterleavedBufferAttribute){const R=i(e.data,C.data);b=new rh(R,C.itemSize,C.offset,C.normalized)}else{const R=Of(C.type,C.array);b=new $n(R,C.itemSize,C.normalized)}C.name!==void 0&&(b.name=C.name),E.push(b)}a.morphAttributes[w]=E}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const _=e.data.groups||e.data.drawcalls||e.data.offsets;if(_!==void 0)for(let w=0,T=_.length;w!==T;++w){const E=_[w];a.addGroup(E.start,E.count,E.materialIndex)}const y=e.data.boundingSphere;if(y!==void 0){const w=new Z;y.center!==void 0&&w.fromArray(y.center),a.boundingSphere=new mh(w,y.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class O4 extends so{constructor(e){super(e)}load(e,t,n,i){const s=this,a=this.path===""?Yy.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const u=new Rl(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(f){let d=null;try{d=JSON.parse(f)}catch(_){i!==void 0&&i(_),console.error("THREE:ObjectLoader: Can't parse "+e+".",_.message);return}const m=d.metadata;if(m===void 0||m.type===void 0||m.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(d,t)},n,i)}async loadAsync(e,t){const n=this,i=this.path===""?Yy.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new Rl(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,t),u=JSON.parse(a),f=u.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(u)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),a=this.parseImages(e.images,function(){t!==void 0&&t(d)}),u=this.parseTextures(e.textures,a),f=this.parseMaterials(e.materials,u),d=this.parseObject(e.object,s,f,u,n),m=this.parseSkeletons(e.skeletons,d);if(this.bindSkeletons(d,m),t!==void 0){let _=!1;for(const y in a)if(a[y].data instanceof HTMLImageElement){_=!0;break}_===!1&&t(d)}return d}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),u=this.parseMaterials(e.materials,a),f=this.parseObject(e.object,i,u,a,t),d=this.parseSkeletons(e.skeletons,f);return this.bindSkeletons(f,d),f}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const s=new eh().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const u=new n_().fromJSON(e[s],i);n[u.uuid]=u}return n}parseGeometries(e,t){const n={};if(e!==void 0){const i=new FC;for(let s=0,a=e.length;s<a;s++){let u;const f=e[s];switch(f.type){case"BufferGeometry":case"InstancedBufferGeometry":u=i.parse(f);break;default:f.type in AS?u=AS[f.type].fromJSON(f,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${f.type}"`)}u.uuid=f.uuid,f.name!==void 0&&(u.name=f.name),f.userData!==void 0&&(u.userData=f.userData),n[f.uuid]=u}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const s=new a_;s.setTextures(t);for(let a=0,u=e.length;a<u;a++){const f=e[a];n[f.uuid]===void 0&&(n[f.uuid]=s.parse(f)),i[f.uuid]=n[f.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],s=Gp.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const n=this,i={};let s;function a(f){return n.manager.itemStart(f),s.load(f,function(){n.manager.itemEnd(f)},void 0,function(){n.manager.itemError(f),n.manager.itemEnd(f)})}function u(f){if(typeof f=="string"){const d=f,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:n.resourcePath+d;return a(m)}else return f.data?{data:Of(f.type,f.data),width:f.width,height:f.height}:null}if(e!==void 0&&e.length>0){const f=new Zx(t);s=new Wp(f),s.setCrossOrigin(this.crossOrigin);for(let d=0,m=e.length;d<m;d++){const _=e[d],y=_.url;if(Array.isArray(y)){const w=[];for(let T=0,E=y.length;T<E;T++){const M=y[T],P=u(M);P!==null&&(P instanceof HTMLImageElement?w.push(P):w.push(new Bf(P.data,P.width,P.height)))}i[_.uuid]=new jc(w)}else{const w=u(_.url);i[_.uuid]=new jc(w)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function s(a){if(typeof a=="string"){const u=a,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:t.resourcePath+u;return await i.loadAsync(f)}else return a.data?{data:Of(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){i=new Wp(this.manager),i.setCrossOrigin(this.crossOrigin);for(let a=0,u=e.length;a<u;a++){const f=e[a],d=f.url;if(Array.isArray(d)){const m=[];for(let _=0,y=d.length;_<y;_++){const w=d[_],T=await s(w);T!==null&&(T instanceof HTMLImageElement?m.push(T):m.push(new Bf(T.data,T.width,T.height)))}n[f.uuid]=new jc(m)}else{const m=await s(f.url);n[f.uuid]=new jc(m)}}}return n}parseTextures(e,t){function n(s,a){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const i={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const u=e[s];u.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',u.uuid),t[u.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",u.image);const f=t[u.image],d=f.data;let m;Array.isArray(d)?(m=new im,d.length===6&&(m.needsUpdate=!0)):(d&&d.data?m=new Bf:m=new ki,d&&(m.needsUpdate=!0)),m.source=f,m.uuid=u.uuid,u.name!==void 0&&(m.name=u.name),u.mapping!==void 0&&(m.mapping=n(u.mapping,N4)),u.offset!==void 0&&m.offset.fromArray(u.offset),u.repeat!==void 0&&m.repeat.fromArray(u.repeat),u.center!==void 0&&m.center.fromArray(u.center),u.rotation!==void 0&&(m.rotation=u.rotation),u.wrap!==void 0&&(m.wrapS=n(u.wrap[0],RS),m.wrapT=n(u.wrap[1],RS)),u.format!==void 0&&(m.format=u.format),u.internalFormat!==void 0&&(m.internalFormat=u.internalFormat),u.type!==void 0&&(m.type=u.type),u.encoding!==void 0&&(m.encoding=u.encoding),u.minFilter!==void 0&&(m.minFilter=n(u.minFilter,DS)),u.magFilter!==void 0&&(m.magFilter=n(u.magFilter,DS)),u.anisotropy!==void 0&&(m.anisotropy=u.anisotropy),u.flipY!==void 0&&(m.flipY=u.flipY),u.generateMipmaps!==void 0&&(m.generateMipmaps=u.generateMipmaps),u.premultiplyAlpha!==void 0&&(m.premultiplyAlpha=u.premultiplyAlpha),u.unpackAlignment!==void 0&&(m.unpackAlignment=u.unpackAlignment),u.userData!==void 0&&(m.userData=u.userData),i[u.uuid]=m}return i}parseObject(e,t,n,i,s){let a;function u(y){return t[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",y),t[y]}function f(y){if(y!==void 0){if(Array.isArray(y)){const w=[];for(let T=0,E=y.length;T<E;T++){const M=y[T];n[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",M),w.push(n[M])}return w}return n[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",y),n[y]}}function d(y){return i[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",y),i[y]}let m,_;switch(e.type){case"Scene":a=new Nx,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new dt(e.background):a.background=d(e.background)),e.environment!==void 0&&(a.environment=d(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new e_(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new J0(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":a=new yr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Gu(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new OC(e.color,e.intensity);break;case"DirectionalLight":a=new LC(e.color,e.intensity);break;case"PointLight":a=new DC(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new NC(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new RC(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new IC(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new o_().fromJSON(e);break;case"SkinnedMesh":m=u(e.geometry),_=f(e.material),a=new nC(m,_),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":m=u(e.geometry),_=f(e.material),a=new rr(m,_);break;case"InstancedMesh":m=u(e.geometry),_=f(e.material);const y=e.count,w=e.instanceMatrix,T=e.instanceColor;a=new iC(m,_,y),a.instanceMatrix=new jf(new Float32Array(w.array),16),T!==void 0&&(a.instanceColor=new jf(new Float32Array(T.array),T.itemSize));break;case"LOD":a=new tC;break;case"Line":a=new Ou(u(e.geometry),f(e.material));break;case"LineLoop":a=new rC(u(e.geometry),f(e.material));break;case"LineSegments":a=new Fa(u(e.geometry),f(e.material));break;case"PointCloud":case"Points":a=new sC(u(e.geometry),f(e.material));break;case"Sprite":a=new eC(f(e.material));break;case"Group":a=new kf;break;case"Bone":a=new zx;break;default:a=new In}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const y=e.children;for(let w=0;w<y.length;w++)a.add(this.parseObject(y[w],t,n,i,s))}if(e.animations!==void 0){const y=e.animations;for(let w=0;w<y.length;w++){const T=y[w];a.animations.push(s[T])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const y=e.levels;for(let w=0;w<y.length;w++){const T=y[w],E=a.getObjectByProperty("uuid",T.object);E!==void 0&&a.addLevel(E,T.distance,T.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}}const N4={UVMapping:X0,CubeReflectionMapping:Iu,CubeRefractionMapping:Ru,EquirectangularReflectionMapping:Hf,EquirectangularRefractionMapping:bp,CubeUVReflectionMapping:Zf},RS={RepeatWrapping:Pp,ClampToEdgeWrapping:Kr,MirroredRepeatWrapping:Ip},DS={NearestFilter:Oi,NearestMipmapNearestFilter:w0,NearestMipmapLinearFilter:yp,LinearFilter:ai,LinearMipmapNearestFilter:Ex,LinearMipmapLinearFilter:Du};class k4 extends so{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=oh.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const u={};u.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",u.headers=this.requestHeader,fetch(e,u).then(function(f){return f.blob()}).then(function(f){return createImageBitmap(f,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(f){oh.add(e,f),t&&t(f),s.manager.itemEnd(e)}).catch(function(f){i&&i(f),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let Gg;class e1{static getContext(){return Gg===void 0&&(Gg=new(window.AudioContext||window.webkitAudioContext)),Gg}static setContext(e){Gg=e}}class z4 extends so{constructor(e){super(e)}load(e,t,n,i){const s=this,a=new Rl(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(u){try{const f=u.slice(0);e1.getContext().decodeAudioData(f,function(m){t(m)})}catch(f){i?i(f):console.error(f),s.manager.itemError(e)}},n,i)}}class F4 extends o_{constructor(e,t,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const i=new dt().set(e),s=new dt().set(t),a=new Z(i.r,i.g,i.b),u=new Z(s.r,s.g,s.b),f=Math.sqrt(Math.PI),d=f*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(u).multiplyScalar(f),this.sh.coefficients[1].copy(a).sub(u).multiplyScalar(d)}}class U4 extends o_{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const n=new dt().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const LS=new Jt,OS=new Jt,Rc=new Jt;class B4{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new yr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new yr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Rc.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,a=t.near*Math.tan(Zc*t.fov*.5)/t.zoom;let u,f;OS.elements[12]=-i,LS.elements[12]=i,u=-a*t.aspect+s,f=a*t.aspect+s,Rc.elements[0]=2*t.near/(f-u),Rc.elements[8]=(f+u)/(f-u),this.cameraL.projectionMatrix.copy(Rc),u=-a*t.aspect-s,f=a*t.aspect-s,Rc.elements[0]=2*t.near/(f-u),Rc.elements[8]=(f+u)/(f-u),this.cameraR.projectionMatrix.copy(Rc)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(OS),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(LS)}}class l_{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=NS(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=NS();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function NS(){return(typeof performance>"u"?Date:performance).now()}const Dc=new Z,kS=new Ns,V4=new Z,Lc=new Z;class H4 extends In{constructor(){super(),this.type="AudioListener",this.context=e1.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new l_}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Dc,kS,V4),Lc.set(0,0,-1).applyQuaternion(kS),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Dc.x,i),t.positionY.linearRampToValueAtTime(Dc.y,i),t.positionZ.linearRampToValueAtTime(Dc.z,i),t.forwardX.linearRampToValueAtTime(Lc.x,i),t.forwardY.linearRampToValueAtTime(Lc.y,i),t.forwardZ.linearRampToValueAtTime(Lc.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(Dc.x,Dc.y,Dc.z),t.setOrientation(Lc.x,Lc.y,Lc.z,n.x,n.y,n.z)}}class UC extends In{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Oc=new Z,zS=new Ns,G4=new Z,Nc=new Z;class W4 extends UC{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Oc,zS,G4),Nc.set(0,0,1).applyQuaternion(zS);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Oc.x,n),t.positionY.linearRampToValueAtTime(Oc.y,n),t.positionZ.linearRampToValueAtTime(Oc.z,n),t.orientationX.linearRampToValueAtTime(Nc.x,n),t.orientationY.linearRampToValueAtTime(Nc.y,n),t.orientationZ.linearRampToValueAtTime(Nc.z,n)}else t.setPosition(Oc.x,Oc.y,Oc.z),t.setOrientation(Nc.x,Nc.y,Nc.z)}}class j4{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class BC{constructor(e,t,n){this.binding=e,this.valueSize=n;let i,s,a;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,s=e*i+i;let a=this.cumulativeWeight;if(a===0){for(let u=0;u!==i;++u)n[s+u]=n[u];a=t}else{a+=t;const u=t/a;this._mixBufferRegion(n,s,0,u,i)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,u=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const f=t*this._origIndex;this._mixBufferRegion(n,i,f,1-s,t)}a>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let f=t,d=t+t;f!==d;++f)if(n[f]!==n[f+t]){u.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let s=n,a=i;s!==a;++s)t[s]=t[i+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,s){if(i>=.5)for(let a=0;a!==s;++a)e[t+a]=e[n+a]}_slerp(e,t,n,i){Ns.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,s){const a=this._workIndex*s;Ns.multiplyQuaternionsFlat(e,a,e,t,e,n),Ns.slerpFlat(e,t,e,t,e,a,i)}_lerp(e,t,n,i,s){const a=1-i;for(let u=0;u!==s;++u){const f=t+u;e[f]=e[f]*a+e[n+u]*i}}_lerpAdditive(e,t,n,i,s){for(let a=0;a!==s;++a){const u=t+a;e[u]=e[u]+e[n+a]*i}}}const t1="\\[\\]\\.:\\/",q4=new RegExp("["+t1+"]","g"),n1="[^"+t1+"]",X4="[^"+t1.replace("\\.","")+"]",$4=/((?:WC+[\/:])*)/.source.replace("WC",n1),Y4=/(WCOD+)?/.source.replace("WCOD",X4),Q4=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",n1),K4=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",n1),Z4=new RegExp("^"+$4+Y4+Q4+K4+"$"),J4=["material","materials","bones","map"];class eO{constructor(e,t,n){const i=n||Tn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=n.length;i!==s;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Tn{constructor(e,t,n){this.path=t,this.parsedPath=n||Tn.parseTrackName(t),this.node=Tn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Tn.Composite(e,t,n):new Tn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(q4,"")}static parseTrackName(e){const t=Z4.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=n.nodeName.substring(i+1);J4.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let a=0;a<s.length;a++){const u=s[a];if(u.name===t||u.uuid===t)return u;const f=n(u.children);if(f)return f}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=Tn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let d=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===d){d=m;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(d!==void 0){if(e[d]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[d]}}const a=e[i];if(a===void 0){const d=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+i+" but it wasn't found.",e);return}let u=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?u=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let f=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}f=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(f=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(f=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[f],this.setValue=this.SetterByBindingTypeAndVersioning[f][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Tn.Composite=eO;Tn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Tn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Tn.prototype.GetterByBindingType=[Tn.prototype._getValue_direct,Tn.prototype._getValue_array,Tn.prototype._getValue_arrayElement,Tn.prototype._getValue_toArray];Tn.prototype.SetterByBindingTypeAndVersioning=[[Tn.prototype._setValue_direct,Tn.prototype._setValue_direct_setNeedsUpdate,Tn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Tn.prototype._setValue_array,Tn.prototype._setValue_array_setNeedsUpdate,Tn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Tn.prototype._setValue_arrayElement,Tn.prototype._setValue_arrayElement_setNeedsUpdate,Tn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Tn.prototype._setValue_fromArray,Tn.prototype._setValue_fromArray_setNeedsUpdate,Tn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class tO{constructor(){this.isAnimationObjectGroup=!0,this.uuid=no(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,s=this._bindings,a=s.length;let u,f=e.length,d=this.nCachedObjects_;for(let m=0,_=arguments.length;m!==_;++m){const y=arguments[m],w=y.uuid;let T=t[w];if(T===void 0){T=f++,t[w]=T,e.push(y);for(let E=0,M=a;E!==M;++E)s[E].push(new Tn(y,n[E],i[E]))}else if(T<d){u=e[T];const E=--d,M=e[E];t[M.uuid]=T,e[T]=M,t[w]=E,e[E]=y;for(let P=0,C=a;P!==C;++P){const b=s[P],R=b[E];let z=b[T];b[T]=R,z===void 0&&(z=new Tn(y,n[P],i[P])),b[E]=z}}else e[T]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=d}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_;for(let a=0,u=arguments.length;a!==u;++a){const f=arguments[a],d=f.uuid,m=t[d];if(m!==void 0&&m>=s){const _=s++,y=e[_];t[y.uuid]=m,e[m]=y,t[d]=_,e[_]=f;for(let w=0,T=i;w!==T;++w){const E=n[w],M=E[_],P=E[m];E[m]=M,E[_]=P}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_,a=e.length;for(let u=0,f=arguments.length;u!==f;++u){const d=arguments[u],m=d.uuid,_=t[m];if(_!==void 0)if(delete t[m],_<s){const y=--s,w=e[y],T=--a,E=e[T];t[w.uuid]=_,e[_]=w,t[E.uuid]=y,e[y]=E,e.pop();for(let M=0,P=i;M!==P;++M){const C=n[M],b=C[y],R=C[T];C[_]=b,C[y]=R,C.pop()}}else{const y=--a,w=e[y];y>0&&(t[w.uuid]=_),e[_]=w,e.pop();for(let T=0,E=i;T!==E;++T){const M=n[T];M[_]=M[y],M.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const s=this._bindings;if(i!==void 0)return s[i];const a=this._paths,u=this._parsedPaths,f=this._objects,d=f.length,m=this.nCachedObjects_,_=new Array(d);i=s.length,n[e]=i,a.push(e),u.push(t),s.push(_);for(let y=m,w=f.length;y!==w;++y){const T=f[y];_[y]=new Tn(T,e,t)}return _}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,s=this._parsedPaths,a=this._bindings,u=a.length-1,f=a[u],d=e[u];t[d]=n,a[n]=f,a.pop(),s[n]=s[u],s.pop(),i[n]=i[u],i.pop()}}}class nO{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const s=t.tracks,a=s.length,u=new Array(a),f={endingStart:Gc,endingEnd:Gc};for(let d=0;d!==a;++d){const m=s[d].createInterpolant(null);u[d]=m,m.settings=f}this._interpolantSettings=f,this._interpolants=u,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=RM,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const i=this._clip.duration,s=e._clip.duration,a=s/i,u=i/s;e.warp(1,a,t),this.warp(u,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,s=i.time,a=this.timeScale;let u=this._timeScaleInterpolant;u===null&&(u=i._lendControlInterpolant(),this._timeScaleInterpolant=u);const f=u.parameterPositions,d=u.sampleValues;return f[0]=s,f[1]=s+n,d[0]=e/a,d[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const f=(e-s)*n;f<0||n===0?t=0:(this._startTime=null,t=n*f)}t*=this._updateTimeScale(e);const a=this._updateTime(t),u=this._updateWeight(e);if(u>0){const f=this._interpolants,d=this._propertyBindings;switch(this.blendMode){case Mx:for(let m=0,_=f.length;m!==_;++m)f[m].evaluate(a),d[m].accumulateAdditive(u);break;case $0:default:for(let m=0,_=f.length;m!==_;++m)f[m].evaluate(a),d[m].accumulate(i,u)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,s=this._loopCount;const a=n===DM;if(e===0)return s===-1?i:a&&(s&1)===1?t-i:i;if(n===IM){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),i>=t||i<0){const u=Math.floor(i/t);i-=t*u,s+=Math.abs(u);const f=this.repetitions-s;if(f<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(f===1){const d=e<0;this._setEndings(d,!d,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:u})}}else this.time=i;if(a&&(s&1)===1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=Wc,i.endingEnd=Wc):(e?i.endingStart=this.zeroSlopeAtStart?Wc:Gc:i.endingStart=Lp,t?i.endingEnd=this.zeroSlopeAtEnd?Wc:Gc:i.endingEnd=Lp)}_scheduleFading(e,t,n){const i=this._mixer,s=i.time;let a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);const u=a.parameterPositions,f=a.sampleValues;return u[0]=s,f[0]=t,u[1]=s+e,f[1]=n,this}}const iO=new Float32Array(1);class rO extends za{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,s=i.length,a=e._propertyBindings,u=e._interpolants,f=n.uuid,d=this._bindingsByRootAndName;let m=d[f];m===void 0&&(m={},d[f]=m);for(let _=0;_!==s;++_){const y=i[_],w=y.name;let T=m[w];if(T!==void 0)++T.referenceCount,a[_]=T;else{if(T=a[_],T!==void 0){T._cacheIndex===null&&(++T.referenceCount,this._addInactiveBinding(T,f,w));continue}const E=t&&t._propertyBindings[_].binding.parsedPath;T=new BC(Tn.create(n,w,E),y.ValueTypeName,y.getValueSize()),++T.referenceCount,this._addInactiveBinding(T,f,w),a[_]=T}u[_].resultBuffer=T.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const u=a.knownActions;e._byClipCacheIndex=u.length,u.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,u=a[s],f=u.knownActions,d=f[f.length-1],m=e._byClipCacheIndex;d._byClipCacheIndex=m,f[m]=d,f.pop(),e._byClipCacheIndex=null;const _=u.actionByRoot,y=(e._localRoot||this._root).uuid;delete _[y],f.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,s=this._bindings;let a=i[t];a===void 0&&(a={},i[t]=a),a[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,s=n.path,a=this._bindingsByRootAndName,u=a[i],f=t[t.length-1],d=e._cacheIndex;f._cacheIndex=d,t[d]=f,t.pop(),delete u[s],Object.keys(u).length===0&&delete a[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new Qx(new Float32Array(2),new Float32Array(2),1,iO),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const i=t||this._root,s=i.uuid;let a=typeof e=="string"?Gp.findByName(i,e):e;const u=a!==null?a.uuid:e,f=this._actionsByClip[u];let d=null;if(n===void 0&&(a!==null?n=a.blendMode:n=$0),f!==void 0){const _=f.actionByRoot[s];if(_!==void 0&&_.blendMode===n)return _;d=f.knownActions[0],a===null&&(a=d._clip)}if(a===null)return null;const m=new nO(this,a,t,n);return this._bindAction(m,d),this._addInactiveAction(m,u,s),m}existingAction(e,t){const n=t||this._root,i=n.uuid,s=typeof e=="string"?Gp.findByName(n,e):e,a=s?s.uuid:e,u=this._actionsByClip[a];return u!==void 0&&u.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let d=0;d!==n;++d)t[d]._update(i,e,s,a);const u=this._bindings,f=this._nActiveBindings;for(let d=0;d!==f;++d)u[d].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,s=i[n];if(s!==void 0){const a=s.knownActions;for(let u=0,f=a.length;u!==f;++u){const d=a[u];this._deactivateAction(d);const m=d._cacheIndex,_=t[t.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,_._cacheIndex=m,t[m]=_,t.pop(),this._removeInactiveBindingsForAction(d)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const a in n){const u=n[a].actionByRoot,f=u[t];f!==void 0&&(this._deactivateAction(f),this._removeInactiveAction(f))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const a in s){const u=s[a];u.restoreOriginalState(),this._removeInactiveBinding(u)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class u_{constructor(e){this.value=e}clone(){return new u_(this.value.clone===void 0?this.value:this.value.clone())}}let sO=0;class oO extends za{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:sO++}),this.name="",this.usage=Op,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++)this.uniforms.push(t[n].clone());return this}clone(){return new this.constructor().copy(this)}}class aO extends t_{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class lO{constructor(e,t,n,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class VC{constructor(e,t,n=0,i=1/0){this.ray=new Jp(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Jc,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return Qy(e,this,n,t),n.sort(FS),n}intersectObjects(e,t=!0,n=[]){for(let i=0,s=e.length;i<s;i++)Qy(e[i],this,n,t);return n.sort(FS),n}}function FS(r,e){return r.distance-e.distance}function Qy(r,e,t,n){if(r.layers.test(e.layers)&&r.raycast(e,t),n===!0){const i=r.children;for(let s=0,a=i.length;s<a;s++)Qy(i[s],e,t,!0)}}class uO{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ni(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class cO{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}const US=new ze;class hO{constructor(e=new ze(1/0,1/0),t=new ze(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=US.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,US).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const BS=new Z,Wg=new Z;class fO{constructor(e=new Z,t=new Z){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){BS.subVectors(e,this.start),Wg.subVectors(this.end,this.start);const n=Wg.dot(Wg);let s=Wg.dot(BS)/n;return t&&(s=Ni(s,0,1)),s}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const VS=new Z;class dO extends In{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new en,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,u=1,f=32;a<f;a++,u++){const d=a/f*Math.PI*2,m=u/f*Math.PI*2;i.push(Math.cos(d),Math.sin(d),1,Math.cos(m),Math.sin(m),1)}n.setAttribute("position",new pt(i,3));const s=new vs({fog:!1,toneMapped:!1});this.cone=new Fa(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),VS.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(VS),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const yu=new Z,jg=new Jt,Dv=new Jt;class pO extends Fa{constructor(e){const t=HC(e),n=new en,i=[],s=[],a=new dt(0,0,1),u=new dt(0,1,0);for(let d=0;d<t.length;d++){const m=t[d];m.parent&&m.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(a.r,a.g,a.b),s.push(u.r,u.g,u.b))}n.setAttribute("position",new pt(i,3)),n.setAttribute("color",new pt(s,3));const f=new vs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,f),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");Dv.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const u=t[s];u.parent&&u.parent.isBone&&(jg.multiplyMatrices(Dv,u.matrixWorld),yu.setFromMatrixPosition(jg),i.setXYZ(a,yu.x,yu.y,yu.z),jg.multiplyMatrices(Dv,u.parent.matrixWorld),yu.setFromMatrixPosition(jg),i.setXYZ(a+1,yu.x,yu.y,yu.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function HC(r){const e=[];r.isBone===!0&&e.push(r);for(let t=0;t<r.children.length;t++)e.push.apply(e,HC(r.children[t]));return e}class mO extends rr{constructor(e,t,n){const i=new id(t,4,2),s=new Vu({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const gO=new Z,HS=new dt,GS=new dt;class _O extends In{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new nd(t);i.rotateY(Math.PI*.5),this.material=new Vu({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),a=new Float32Array(s.count*3);i.setAttribute("color",new $n(a,3)),this.add(new rr(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");HS.copy(this.light.color),GS.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const s=n<i/2?HS:GS;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(gO.setFromMatrixPosition(this.light.matrixWorld).negate())}}class vO extends Fa{constructor(e=10,t=10,n=4473924,i=8947848){n=new dt(n),i=new dt(i);const s=t/2,a=e/t,u=e/2,f=[],d=[];for(let y=0,w=0,T=-u;y<=t;y++,T+=a){f.push(-u,0,T,u,0,T),f.push(T,0,-u,T,0,u);const E=y===s?n:i;E.toArray(d,w),w+=3,E.toArray(d,w),w+=3,E.toArray(d,w),w+=3,E.toArray(d,w),w+=3}const m=new en;m.setAttribute("position",new pt(f,3)),m.setAttribute("color",new pt(d,3));const _=new vs({vertexColors:!0,toneMapped:!1});super(m,_),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class yO extends Fa{constructor(e=10,t=16,n=8,i=64,s=4473924,a=8947848){s=new dt(s),a=new dt(a);const u=[],f=[];if(t>1)for(let _=0;_<t;_++){const y=_/t*(Math.PI*2),w=Math.sin(y)*e,T=Math.cos(y)*e;u.push(0,0,0),u.push(w,0,T);const E=_&1?s:a;f.push(E.r,E.g,E.b),f.push(E.r,E.g,E.b)}for(let _=0;_<n;_++){const y=_&1?s:a,w=e-e/n*_;for(let T=0;T<i;T++){let E=T/i*(Math.PI*2),M=Math.sin(E)*w,P=Math.cos(E)*w;u.push(M,0,P),f.push(y.r,y.g,y.b),E=(T+1)/i*(Math.PI*2),M=Math.sin(E)*w,P=Math.cos(E)*w,u.push(M,0,P),f.push(y.r,y.g,y.b)}}const d=new en;d.setAttribute("position",new pt(u,3)),d.setAttribute("color",new pt(f,3));const m=new vs({vertexColors:!0,toneMapped:!1});super(d,m),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const WS=new Z,qg=new Z,jS=new Z;class xO extends In{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new en;i.setAttribute("position",new pt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new vs({fog:!1,toneMapped:!1});this.lightPlane=new Ou(i,s),this.add(this.lightPlane),i=new en,i.setAttribute("position",new pt([0,0,0,0,0,1],3)),this.targetLine=new Ou(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),WS.setFromMatrixPosition(this.light.matrixWorld),qg.setFromMatrixPosition(this.light.target.matrixWorld),jS.subVectors(qg,WS),this.lightPlane.lookAt(qg),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(qg),this.targetLine.scale.z=jS.length()}}const Xg=new Z,Ei=new nm;class wO extends Fa{constructor(e){const t=new en,n=new vs({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],a={};u("n1","n2"),u("n2","n4"),u("n4","n3"),u("n3","n1"),u("f1","f2"),u("f2","f4"),u("f4","f3"),u("f3","f1"),u("n1","f1"),u("n2","f2"),u("n3","f3"),u("n4","f4"),u("p","n1"),u("p","n2"),u("p","n3"),u("p","n4"),u("u1","u2"),u("u2","u3"),u("u3","u1"),u("c","t"),u("p","c"),u("cn1","cn2"),u("cn3","cn4"),u("cf1","cf2"),u("cf3","cf4");function u(T,E){f(T),f(E)}function f(T){i.push(0,0,0),s.push(0,0,0),a[T]===void 0&&(a[T]=[]),a[T].push(i.length/3-1)}t.setAttribute("position",new pt(i,3)),t.setAttribute("color",new pt(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const d=new dt(16755200),m=new dt(16711680),_=new dt(43775),y=new dt(16777215),w=new dt(3355443);this.setColors(d,m,_,y,w)}setColors(e,t,n,i,s){const u=this.geometry.getAttribute("color");u.setXYZ(0,e.r,e.g,e.b),u.setXYZ(1,e.r,e.g,e.b),u.setXYZ(2,e.r,e.g,e.b),u.setXYZ(3,e.r,e.g,e.b),u.setXYZ(4,e.r,e.g,e.b),u.setXYZ(5,e.r,e.g,e.b),u.setXYZ(6,e.r,e.g,e.b),u.setXYZ(7,e.r,e.g,e.b),u.setXYZ(8,e.r,e.g,e.b),u.setXYZ(9,e.r,e.g,e.b),u.setXYZ(10,e.r,e.g,e.b),u.setXYZ(11,e.r,e.g,e.b),u.setXYZ(12,e.r,e.g,e.b),u.setXYZ(13,e.r,e.g,e.b),u.setXYZ(14,e.r,e.g,e.b),u.setXYZ(15,e.r,e.g,e.b),u.setXYZ(16,e.r,e.g,e.b),u.setXYZ(17,e.r,e.g,e.b),u.setXYZ(18,e.r,e.g,e.b),u.setXYZ(19,e.r,e.g,e.b),u.setXYZ(20,e.r,e.g,e.b),u.setXYZ(21,e.r,e.g,e.b),u.setXYZ(22,e.r,e.g,e.b),u.setXYZ(23,e.r,e.g,e.b),u.setXYZ(24,t.r,t.g,t.b),u.setXYZ(25,t.r,t.g,t.b),u.setXYZ(26,t.r,t.g,t.b),u.setXYZ(27,t.r,t.g,t.b),u.setXYZ(28,t.r,t.g,t.b),u.setXYZ(29,t.r,t.g,t.b),u.setXYZ(30,t.r,t.g,t.b),u.setXYZ(31,t.r,t.g,t.b),u.setXYZ(32,n.r,n.g,n.b),u.setXYZ(33,n.r,n.g,n.b),u.setXYZ(34,n.r,n.g,n.b),u.setXYZ(35,n.r,n.g,n.b),u.setXYZ(36,n.r,n.g,n.b),u.setXYZ(37,n.r,n.g,n.b),u.setXYZ(38,i.r,i.g,i.b),u.setXYZ(39,i.r,i.g,i.b),u.setXYZ(40,s.r,s.g,s.b),u.setXYZ(41,s.r,s.g,s.b),u.setXYZ(42,s.r,s.g,s.b),u.setXYZ(43,s.r,s.g,s.b),u.setXYZ(44,s.r,s.g,s.b),u.setXYZ(45,s.r,s.g,s.b),u.setXYZ(46,s.r,s.g,s.b),u.setXYZ(47,s.r,s.g,s.b),u.setXYZ(48,s.r,s.g,s.b),u.setXYZ(49,s.r,s.g,s.b),u.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,i=1;Ei.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Li("c",t,e,Ei,0,0,-1),Li("t",t,e,Ei,0,0,1),Li("n1",t,e,Ei,-1,-1,-1),Li("n2",t,e,Ei,n,-1,-1),Li("n3",t,e,Ei,-1,i,-1),Li("n4",t,e,Ei,n,i,-1),Li("f1",t,e,Ei,-1,-1,1),Li("f2",t,e,Ei,n,-1,1),Li("f3",t,e,Ei,-1,i,1),Li("f4",t,e,Ei,n,i,1),Li("u1",t,e,Ei,n*.7,i*1.1,-1),Li("u2",t,e,Ei,-1*.7,i*1.1,-1),Li("u3",t,e,Ei,0,i*2,-1),Li("cf1",t,e,Ei,-1,0,1),Li("cf2",t,e,Ei,n,0,1),Li("cf3",t,e,Ei,0,-1,1),Li("cf4",t,e,Ei,0,i,1),Li("cn1",t,e,Ei,-1,0,-1),Li("cn2",t,e,Ei,n,0,-1),Li("cn3",t,e,Ei,0,-1,-1),Li("cn4",t,e,Ei,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Li(r,e,t,n,i,s,a){Xg.set(i,s,a).unproject(n);const u=e[r];if(u!==void 0){const f=t.getAttribute("position");for(let d=0,m=u.length;d<m;d++)f.setXYZ(u[d],Xg.x,Xg.y,Xg.z)}}const $g=new ph;class SO extends Fa{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new en;s.setIndex(new $n(n,1)),s.setAttribute("position",new $n(i,3)),super(s,new vs({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&$g.setFromObject(this.object),$g.isEmpty())return;const t=$g.min,n=$g.max,i=this.geometry.attributes.position,s=i.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class EO extends Fa{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new en;s.setIndex(new $n(n,1)),s.setAttribute("position",new pt(i,3)),super(s,new vs({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class TO extends Ou{constructor(e,t=1,n=16776960){const i=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new en;a.setAttribute("position",new pt(s,3)),a.computeBoundingSphere(),super(a,new vs({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const u=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],f=new en;f.setAttribute("position",new pt(u,3)),f.computeBoundingSphere(),this.add(new rr(f,new Vu({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const qS=new Z;let Yg,Lv;class MO extends In{constructor(e=new Z(0,0,1),t=new Z(0,0,0),n=1,i=16776960,s=n*.2,a=s*.2){super(),this.type="ArrowHelper",Yg===void 0&&(Yg=new en,Yg.setAttribute("position",new pt([0,0,0,0,1,0],3)),Lv=new gh(0,.5,1,5,1),Lv.translate(0,-.5,0)),this.position.copy(t),this.line=new Ou(Yg,new vs({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new rr(Lv,new Vu({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{qS.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(qS,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class CO extends Fa{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new en;i.setAttribute("position",new pt(t,3)),i.setAttribute("color",new pt(n,3));const s=new vs({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,n){const i=new dt,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(n),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class AO{constructor(){this.type="ShapePath",this.color=new dt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new zp,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,s,a){return this.currentPath.bezierCurveTo(e,t,n,i,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(P){const C=[];for(let b=0,R=P.length;b<R;b++){const z=P[b],B=new eh;B.curves=z.curves,C.push(B)}return C}function n(P,C){const b=C.length;let R=!1;for(let z=b-1,B=0;B<b;z=B++){let k=C[z],I=C[B],N=I.x-k.x,V=I.y-k.y;if(Math.abs(V)>Number.EPSILON){if(V<0&&(k=C[B],N=-N,I=C[z],V=-V),P.y<k.y||P.y>I.y)continue;if(P.y===k.y){if(P.x===k.x)return!0}else{const W=V*(P.x-k.x)-N*(P.y-k.y);if(W===0)return!0;if(W<0)continue;R=!R}}else{if(P.y!==k.y)continue;if(I.x<=P.x&&P.x<=k.x||k.x<=P.x&&P.x<=I.x)return!0}}return R}const i=La.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,u,f;const d=[];if(s.length===1)return u=s[0],f=new eh,f.curves=u.curves,d.push(f),d;let m=!i(s[0].getPoints());m=e?!m:m;const _=[],y=[];let w=[],T=0,E;y[T]=void 0,w[T]=[];for(let P=0,C=s.length;P<C;P++)u=s[P],E=u.getPoints(),a=i(E),a=e?!a:a,a?(!m&&y[T]&&T++,y[T]={s:new eh,p:E},y[T].s.curves=u.curves,m&&T++,w[T]=[]):w[T].push({h:u,p:E[0]});if(!y[0])return t(s);if(y.length>1){let P=!1,C=0;for(let b=0,R=y.length;b<R;b++)_[b]=[];for(let b=0,R=y.length;b<R;b++){const z=w[b];for(let B=0;B<z.length;B++){const k=z[B];let I=!0;for(let N=0;N<y.length;N++)n(k.p,y[N].p)&&(b!==N&&C++,I?(I=!1,_[N].push(k)):P=!0);I&&_[b].push(k)}}C>0&&P===!1&&(w=_)}let M;for(let P=0,C=y.length;P<C;P++){f=y[P].s,d.push(f),M=w[P];for(let b=0,R=M.length;b<R;b++)f.holes.push(M[b].h)}return d}}const Tl=bO();function bO(){const r=new ArrayBuffer(4),e=new Float32Array(r),t=new Uint32Array(r),n=new Uint32Array(512),i=new Uint32Array(512);for(let f=0;f<256;++f){const d=f-127;d<-27?(n[f]=0,n[f|256]=32768,i[f]=24,i[f|256]=24):d<-14?(n[f]=1024>>-d-14,n[f|256]=1024>>-d-14|32768,i[f]=-d-1,i[f|256]=-d-1):d<=15?(n[f]=d+15<<10,n[f|256]=d+15<<10|32768,i[f]=13,i[f|256]=13):d<128?(n[f]=31744,n[f|256]=64512,i[f]=24,i[f|256]=24):(n[f]=31744,n[f|256]=64512,i[f]=13,i[f|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),u=new Uint32Array(64);for(let f=1;f<1024;++f){let d=f<<13,m=0;for(;(d&8388608)===0;)d<<=1,m-=8388608;d&=-8388609,m+=947912704,s[f]=d|m}for(let f=1024;f<2048;++f)s[f]=939524096+(f-1024<<13);for(let f=1;f<31;++f)a[f]=f<<23;a[31]=1199570944,a[32]=2147483648;for(let f=33;f<63;++f)a[f]=2147483648+(f-32<<23);a[63]=3347054592;for(let f=1;f<64;++f)f!==32&&(u[f]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:i,mantissaTable:s,exponentTable:a,offsetTable:u}}function PO(r){Math.abs(r)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),r=Ni(r,-65504,65504),Tl.floatView[0]=r;const e=Tl.uint32View[0],t=e>>23&511;return Tl.baseTable[t]+((e&8388607)>>Tl.shiftTable[t])}function IO(r){const e=r>>10;return Tl.uint32View[0]=Tl.mantissaTable[Tl.offsetTable[e]+(r&1023)]+Tl.exponentTable[e],Tl.floatView[0]}const gp={toHalfFloat:PO,fromHalfFloat:IO};class RO extends Hu{constructor(e,t,n,i,s,a){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,t,n,i,s,a)}}class DO extends rm{constructor(e,t,n,i){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,t,n,i)}}class LO extends sm{constructor(e,t,n,i){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,t,n,i)}}class OO extends om{constructor(e,t,n,i,s,a,u){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,t,n,i,s,a,u)}}class NO extends gh{constructor(e,t,n,i,s,a,u,f){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,t,n,i,s,a,u,f)}}class kO extends am{constructor(e,t){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,t)}}class zO extends lm{constructor(e,t){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,t)}}class FO extends um{constructor(e,t){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,t)}}class UO extends td{constructor(e,t,n,i){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,t,n,i)}}class BO extends nd{constructor(e,t){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,t)}}class VO extends Jf{constructor(e,t,n,i){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,t,n,i)}}class HO extends Ol{constructor(e,t,n,i){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,t,n,i)}}class GO extends cm{constructor(e,t,n,i,s,a){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,t,n,i,s,a)}}class WO extends hm{constructor(e,t){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,t)}}class jO extends id{constructor(e,t,n,i,s,a,u){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,t,n,i,s,a,u)}}class qO extends fm{constructor(e,t){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,t)}}class XO extends dm{constructor(e,t,n,i,s){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,t,n,i,s)}}class $O extends pm{constructor(e,t,n,i,s,a){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,t,n,i,s,a)}}class YO extends mm{constructor(e,t,n,i,s){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,t,n,i,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:j0}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=j0);const GC=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:Sx,AddEquation:Bc,AddOperation:cM,AdditiveAnimationBlendMode:Mx,AdditiveBlending:dy,AlphaFormat:xM,AlwaysDepth:iM,AlwaysStencilFunc:kM,AmbientLight:OC,AmbientLightProbe:U4,AnimationClip:Gp,AnimationLoader:A4,AnimationMixer:rO,AnimationObjectGroup:tO,AnimationUtils:E4,ArcCurve:oC,ArrayCamera:QM,ArrowHelper:MO,Audio:UC,AudioAnalyser:j4,AudioContext:e1,AudioListener:H4,AudioLoader:z4,AxesHelper:CO,BackSide:Os,BasicDepthPacking:LM,BasicShadowMap:GT,Bone:zx,BooleanKeyframeTrack:_h,Box2:hO,Box3:ph,Box3Helper:EO,BoxBufferGeometry:RO,BoxGeometry:Hu,BoxHelper:SO,BufferAttribute:$n,BufferGeometry:en,BufferGeometryLoader:FC,ByteType:mM,Cache:oh,Camera:nm,CameraHelper:wO,CanvasTexture:XL,CapsuleBufferGeometry:DO,CapsuleGeometry:rm,CatmullRomCurve3:aC,CineonToneMapping:dM,CircleBufferGeometry:LO,CircleGeometry:sm,ClampToEdgeWrapping:Kr,Clock:l_,Color:dt,ColorKeyframeTrack:Kx,ColorManagement:$r,CompressedArrayTexture:qL,CompressedTexture:Ux,CompressedTextureLoader:b4,ConeBufferGeometry:OO,ConeGeometry:om,CubeCamera:HM,CubeReflectionMapping:Iu,CubeRefractionMapping:Ru,CubeTexture:im,CubeTextureLoader:P4,CubeUVReflectionMapping:Zf,CubicBezierCurve:Vx,CubicBezierCurve3:lC,CubicInterpolant:MC,CullFaceBack:fy,CullFaceFront:HT,CullFaceFrontBack:Hb,CullFaceNone:VT,Curve:la,CurvePath:cC,CustomBlending:WT,CustomToneMapping:pM,CylinderBufferGeometry:NO,CylinderGeometry:gh,Cylindrical:cO,Data3DTexture:Px,DataArrayTexture:Y0,DataTexture:Bf,DataTextureLoader:PC,DataUtils:gp,DecrementStencilOp:t3,DecrementWrapStencilOp:i3,DefaultLoadingManager:bC,DepthFormat:Cu,DepthStencilFormat:ih,DepthTexture:KM,DirectionalLight:LC,DirectionalLightHelper:xO,DiscreteInterpolant:CC,DisplayP3ColorSpace:Cx,DodecahedronBufferGeometry:kO,DodecahedronGeometry:am,DoubleSide:Ra,DstAlphaFactor:KT,DstColorFactor:JT,DynamicCopyUsage:v3,DynamicDrawUsage:f3,DynamicReadUsage:m3,EdgesGeometry:hC,EllipseCurve:i_,EqualDepth:sM,EqualStencilFunc:a3,EquirectangularReflectionMapping:Hf,EquirectangularRefractionMapping:bp,Euler:em,EventDispatcher:za,ExtrudeBufferGeometry:zO,ExtrudeGeometry:lm,FileLoader:Rl,Float16BufferAttribute:sP,Float32BufferAttribute:pt,Float64BufferAttribute:oP,FloatType:Co,Fog:e_,FogExp2:J0,FramebufferTexture:jL,FrontSide:Pl,Frustum:Q0,GLBufferAttribute:lO,GLSL1:x3,GLSL3:Vy,GreaterDepth:aM,GreaterEqualDepth:oM,GreaterEqualStencilFunc:h3,GreaterStencilFunc:u3,GridHelper:vO,Group:kf,HalfFloatType:Da,HemisphereLight:IC,HemisphereLightHelper:_O,HemisphereLightProbe:F4,IcosahedronBufferGeometry:FO,IcosahedronGeometry:um,ImageBitmapLoader:k4,ImageLoader:Wp,ImageUtils:bx,IncrementStencilOp:e3,IncrementWrapStencilOp:n3,InstancedBufferAttribute:jf,InstancedBufferGeometry:zC,InstancedInterleavedBuffer:aO,InstancedMesh:iC,Int16BufferAttribute:iP,Int32BufferAttribute:rP,Int8BufferAttribute:eP,IntType:_M,InterleavedBuffer:t_,InterleavedBufferAttribute:rh,Interpolant:gm,InterpolateDiscrete:Rp,InterpolateLinear:Dp,InterpolateSmooth:f0,InvertStencilOp:r3,KeepStencilOp:d0,KeyframeTrack:ua,LOD:tC,LatheBufferGeometry:UO,LatheGeometry:td,Layers:Jc,LessDepth:rM,LessEqualDepth:x0,LessEqualStencilFunc:l3,LessStencilFunc:o3,Light:Wu,LightProbe:o_,Line:Ou,Line3:fO,LineBasicMaterial:vs,LineCurve:r_,LineCurve3:uC,LineDashedMaterial:EC,LineLoop:rC,LineSegments:Fa,LinearEncoding:Lu,LinearFilter:ai,LinearInterpolant:Qx,LinearMipMapLinearFilter:Xb,LinearMipMapNearestFilter:qb,LinearMipmapLinearFilter:Du,LinearMipmapNearestFilter:Ex,LinearSRGBColorSpace:Gf,LinearToneMapping:hM,Loader:so,LoaderUtils:Yy,LoadingManager:Zx,LoopOnce:IM,LoopPingPong:DM,LoopRepeat:RM,LuminanceAlphaFormat:SM,LuminanceFormat:wM,MOUSE:Bb,Material:Zr,MaterialLoader:a_,MathUtils:O3,Matrix3:zr,Matrix4:Jt,MaxEquation:_y,Mesh:rr,MeshBasicMaterial:Vu,MeshDepthMaterial:Lx,MeshDistanceMaterial:Ox,MeshLambertMaterial:wC,MeshMatcapMaterial:SC,MeshNormalMaterial:xC,MeshPhongMaterial:vC,MeshPhysicalMaterial:Xx,MeshStandardMaterial:qx,MeshToonMaterial:yC,MinEquation:gy,MirroredRepeatWrapping:Ip,MixOperation:uM,MultiplyBlending:my,MultiplyOperation:Zp,NearestFilter:Oi,NearestMipMapLinearFilter:jb,NearestMipMapNearestFilter:Wb,NearestMipmapLinearFilter:yp,NearestMipmapNearestFilter:w0,NeverDepth:nM,NeverStencilFunc:s3,NoBlending:Cl,NoColorSpace:Kb,NoToneMapping:aa,NormalAnimationBlendMode:$0,NormalBlending:Qc,NotEqualDepth:lM,NotEqualStencilFunc:c3,NumberKeyframeTrack:Vp,Object3D:In,ObjectLoader:O4,ObjectSpaceNormalMap:NM,OctahedronBufferGeometry:BO,OctahedronGeometry:nd,OneFactor:$T,OneMinusDstAlphaFactor:ZT,OneMinusDstColorFactor:eM,OneMinusSrcAlphaFactor:wx,OneMinusSrcColorFactor:QT,OrthographicCamera:Gu,PCFShadowMap:q0,PCFSoftShadowMap:vp,PMREMGenerator:Gy,Path:zp,PerspectiveCamera:yr,Plane:Su,PlaneBufferGeometry:VO,PlaneGeometry:Jf,PlaneHelper:TO,PointLight:DC,PointLightHelper:mO,Points:sC,PointsMaterial:Fx,PolarGridHelper:yO,PolyhedronBufferGeometry:HO,PolyhedronGeometry:Ol,PositionalAudio:W4,PropertyBinding:Tn,PropertyMixer:BC,QuadraticBezierCurve:Hx,QuadraticBezierCurve3:Gx,Quaternion:Ns,QuaternionKeyframeTrack:rd,QuaternionLinearInterpolant:AC,RED_GREEN_RGTC2_Format:Uy,RED_RGTC1_Format:PM,REVISION:j0,RGBADepthPacking:OM,RGBAFormat:_s,RGBAIntegerFormat:AM,RGBA_ASTC_10x10_Format:Ny,RGBA_ASTC_10x5_Format:Dy,RGBA_ASTC_10x6_Format:Ly,RGBA_ASTC_10x8_Format:Oy,RGBA_ASTC_12x10_Format:ky,RGBA_ASTC_12x12_Format:zy,RGBA_ASTC_4x4_Format:Ty,RGBA_ASTC_5x4_Format:My,RGBA_ASTC_5x5_Format:Cy,RGBA_ASTC_6x5_Format:Ay,RGBA_ASTC_6x6_Format:by,RGBA_ASTC_8x5_Format:Py,RGBA_ASTC_8x6_Format:Iy,RGBA_ASTC_8x8_Format:Ry,RGBA_BPTC_Format:h0,RGBA_ETC2_EAC_Format:Ey,RGBA_PVRTC_2BPPV1_Format:wy,RGBA_PVRTC_4BPPV1_Format:xy,RGBA_S3TC_DXT1_Format:l0,RGBA_S3TC_DXT3_Format:u0,RGBA_S3TC_DXT5_Format:c0,RGB_ETC1_Format:bM,RGB_ETC2_Format:Sy,RGB_PVRTC_2BPPV1_Format:yy,RGB_PVRTC_4BPPV1_Format:vy,RGB_S3TC_DXT1_Format:a0,RGFormat:MM,RGIntegerFormat:CM,RawShaderMaterial:_C,Ray:Jp,Raycaster:VC,RectAreaLight:NC,RedFormat:EM,RedIntegerFormat:TM,ReinhardToneMapping:fM,RepeatWrapping:Pp,ReplaceStencilOp:Jb,ReverseSubtractEquation:qT,RingBufferGeometry:GO,RingGeometry:cm,SIGNED_RED_GREEN_RGTC2_Format:By,SIGNED_RED_RGTC1_Format:Fy,SRGBColorSpace:na,Scene:Nx,ShaderChunk:Xt,ShaderLib:ia,ShaderMaterial:ro,ShadowMaterial:gC,Shape:eh,ShapeBufferGeometry:WO,ShapeGeometry:hm,ShapePath:AO,ShapeUtils:La,ShortType:gM,Skeleton:n_,SkeletonHelper:pO,SkinnedMesh:nC,Source:jc,Sphere:mh,SphereBufferGeometry:jO,SphereGeometry:id,Spherical:uO,SphericalHarmonics3:kC,SplineCurve:Wx,SpotLight:RC,SpotLightHelper:dO,Sprite:eC,SpriteMaterial:kx,SrcAlphaFactor:xx,SrcAlphaSaturateFactor:tM,SrcColorFactor:YT,StaticCopyUsage:_3,StaticDrawUsage:Op,StaticReadUsage:p3,StereoCamera:B4,StreamCopyUsage:y3,StreamDrawUsage:d3,StreamReadUsage:g3,StringKeyframeTrack:vh,SubtractEquation:jT,SubtractiveBlending:py,TOUCH:Vb,TangentSpaceNormalMap:Bu,TetrahedronBufferGeometry:qO,TetrahedronGeometry:fm,Texture:ki,TextureLoader:I4,TorusBufferGeometry:XO,TorusGeometry:dm,TorusKnotBufferGeometry:$O,TorusKnotGeometry:pm,Triangle:To,TriangleFanDrawMode:Qb,TriangleStripDrawMode:Yb,TrianglesDrawMode:$b,TubeBufferGeometry:YO,TubeGeometry:mm,TwoPassDoubleSide:Gb,UVMapping:X0,Uint16BufferAttribute:Ix,Uint32BufferAttribute:Rx,Uint8BufferAttribute:tP,Uint8ClampedBufferAttribute:nP,Uniform:u_,UniformsGroup:oO,UniformsLib:nt,UniformsUtils:tm,UnsignedByteType:Il,UnsignedInt248Type:Kc,UnsignedIntType:Eu,UnsignedShort4444Type:vM,UnsignedShort5551Type:yM,UnsignedShortType:Tx,VSMShadowMap:Hc,Vector2:ze,Vector3:Z,Vector4:Un,VectorKeyframeTrack:Hp,VideoTexture:WL,WebGL1Renderer:ZM,WebGL3DRenderTarget:W3,WebGLArrayRenderTarget:G3,WebGLCubeRenderTarget:GM,WebGLMultipleRenderTargets:j3,WebGLRenderTarget:Ao,WebGLRenderer:Z0,WebGLUtils:YM,WireframeGeometry:mC,WrapAroundEnding:Lp,ZeroCurvatureEnding:Gc,ZeroFactor:XT,ZeroSlopeEnding:Wc,ZeroStencilOp:Zb,_SRGBAFormat:S0,sRGBEncoding:ti},Symbol.toStringTag,{value:"Module"}));var c_=class{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}},QO=new Gu(-1,1,1,-1,0,1),i1=new en;i1.setAttribute("position",new pt([-1,3,0,-1,-1,0,3,-1,0],3));i1.setAttribute("uv",new pt([0,2,0,0,2,0],2));var KO=class{constructor(e){this._mesh=new rr(i1,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,QO)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}},XS=class extends c_{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){let i=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let a,u;this.inverse?(a=0,u=1):(a=1,u=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),s.buffers.stencil.setFunc(i.ALWAYS,a,4294967295),s.buffers.stencil.setClear(u),s.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(i.EQUAL,1,4294967295),s.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),s.buffers.stencil.setLocked(!0)}},ZO=class extends c_{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}},$S=class extends c_{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof ro?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=tm.clone(e.uniforms),this.material=new ro({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new KO(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}},YS={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;

		}`},JO=class{constructor(e,t){if(this.renderer=e,t===void 0){let n={minFilter:ai,magFilter:ai,format:_s},i=e.getSize(new ze);this._pixelRatio=e.getPixelRatio(),this._width=i.width,this._height=i.height,t=new Ao(this._width*this._pixelRatio,this._height*this._pixelRatio,n),t.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],YS===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),$S===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new $S(YS),this.clock=new l_}swapBuffers(){let e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){let t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());let t=this.renderer.getRenderTarget(),n=!1;for(let i=0,s=this.passes.length;i<s;i++){let a=this.passes[i];if(a.enabled!==!1){if(a.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),a.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),a.needsSwap){if(n){let u=this.renderer.getContext(),f=this.renderer.state.buffers.stencil;f.setFunc(u.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),f.setFunc(u.EQUAL,1,4294967295)}this.swapBuffers()}XS!==void 0&&(a instanceof XS?n=!0:a instanceof ZO&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){let t=this.renderer.getSize(new ze);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;let n=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(n,i),this.renderTarget2.setSize(n,i);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(n,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}};new Gu(-1,1,1,-1,0,1);var WC=new en;WC.setAttribute("position",new pt([-1,3,0,-1,-1,0,3,-1,0],3));WC.setAttribute("uv",new pt([0,2,0,0,2,0],2));var eN=class extends c_{constructor(e,t,n,i,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=i,this.clearAlpha=s!==void 0?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new dt}render(e,t,n){let i=e.autoClear;e.autoClear=!1;let s,a;this.overrideMaterial!==void 0&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=a),e.autoClear=i}},Xi={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},tN=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return min(x + y, 1.0) * opacity + x * (1.0 - opacity);

}
`,nN=`vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {

	return y * opacity + x * (1.0 - opacity);

}

vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	float a = min(y.a, opacity);

	return vec4(blend(x.rgb, y.rgb, a), max(x.a, a));

}
`,iN=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return (x + y) * 0.5 * opacity + x * (1.0 - opacity);

}
`,rN=`float blend(const in float x, const in float y) {

	return (y == 0.0) ? y : max(1.0 - (1.0 - x) / y, 0.0);

}

vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 z = vec4(
		blend(x.r, y.r),
		blend(x.g, y.g),
		blend(x.b, y.b),
		blend(x.a, y.a)
	);

	return z * opacity + x * (1.0 - opacity);

}
`,sN=`float blend(const in float x, const in float y) {

	return (y == 1.0) ? y : min(x / (1.0 - y), 1.0);

}

vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 z = vec4(
		blend(x.r, y.r),
		blend(x.g, y.g),
		blend(x.b, y.b),
		blend(x.a, y.a)
	);

	return z * opacity + x * (1.0 - opacity);

}
`,oN=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return min(x, y) * opacity + x * (1.0 - opacity);

}
`,aN=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return abs(x - y) * opacity + x * (1.0 - opacity);

}
`,lN=`float blend(const in float x, const in float y) {

	return (y > 0.0) ? min(x / y, 1.0) : 1.0;

}

vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 z = vec4(
		blend(x.r, y.r),
		blend(x.g, y.g),
		blend(x.b, y.b),
		blend(x.a, y.a)
	);

	return z * opacity + x * (1.0 - opacity);

}
`,uN=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return (x + y - 2.0 * x * y) * opacity + x * (1.0 - opacity);

}
`,cN=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return max(x, y) * opacity + x * (1.0 - opacity);

}
`,hN=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return x * y * opacity + x * (1.0 - opacity);

}
`,fN=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return (1.0 - abs(1.0 - x - y)) * opacity + x * (1.0 - opacity);

}
`,dN=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return y * opacity + x * (1.0 - opacity);

}
`,pN=`float blend(const in float x, const in float y) {

	return (x < 0.5) ? (2.0 * x * y) : (1.0 - 2.0 * (1.0 - x) * (1.0 - y));

}

vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 z = vec4(
		blend(x.r, y.r),
		blend(x.g, y.g),
		blend(x.b, y.b),
		blend(x.a, y.a)
	);

	return z * opacity + x * (1.0 - opacity);

}
`,mN=`float blend(const in float x, const in float y) {

	return (y == 1.0) ? y : min(x * x / (1.0 - y), 1.0);

}

vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 z = vec4(
		blend(x.r, y.r),
		blend(x.g, y.g),
		blend(x.b, y.b),
		blend(x.a, y.a)
	);

	return z * opacity + x * (1.0 - opacity);

}
`,gN=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return (1.0 - (1.0 - x) * (1.0 - y)) * opacity + x * (1.0 - opacity);

}
`,_N=`float blend(const in float x, const in float y) {

	return (y < 0.5) ?
		(2.0 * x * y + x * x * (1.0 - 2.0 * y)) :
		(sqrt(x) * (2.0 * y - 1.0) + 2.0 * x * (1.0 - y));

}

vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	vec4 z = vec4(
		blend(x.r, y.r),
		blend(x.g, y.g),
		blend(x.b, y.b),
		blend(x.a, y.a)
	);

	return z * opacity + x * (1.0 - opacity);

}
`,vN=`vec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {

	return max(x + y - 1.0, 0.0) * opacity + x * (1.0 - opacity);

}
`,yN=new Map([[Xi.SKIP,null],[Xi.ADD,tN],[Xi.ALPHA,nN],[Xi.AVERAGE,iN],[Xi.COLOR_BURN,rN],[Xi.COLOR_DODGE,sN],[Xi.DARKEN,oN],[Xi.DIFFERENCE,aN],[Xi.EXCLUSION,uN],[Xi.LIGHTEN,cN],[Xi.MULTIPLY,hN],[Xi.DIVIDE,lN],[Xi.NEGATION,fN],[Xi.NORMAL,dN],[Xi.OVERLAY,pN],[Xi.REFLECT,mN],[Xi.SCREEN,gN],[Xi.SOFT_LIGHT,_N],[Xi.SUBTRACT,vN]]),xN=class extends za{constructor(e,t=1){super(),this.blendFunction=e,this.opacity=new u_(t)}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e,this.dispatchEvent({type:"change"})}getShaderCode(){return yN.get(this.blendFunction)}},Ef={uniforms:{tDiffuse:{value:null},shape:{value:1},radius:{value:2},rotateR:{value:Math.PI/12*1},rotateG:{value:Math.PI/12*2},rotateB:{value:Math.PI/12*3},scatter:{value:1},width:{value:20},height:{value:20},blending:{value:1},blendingMode:{value:1},greyscale:{value:!1},disable:{value:!1}},vertexShader:`

		varying vec2 vUV;
		varying vec3 vPosition;

		void main() {

			vUV = uv;
			vPosition = position;

			gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);

		}`,fragmentShader:`

		#define SQRT2_MINUS_ONE 0.41421356
		#define SQRT2_HALF_MINUS_ONE 0.20710678
		#define PI2 6.28318531
		#define SHAPE_DOT 1
		#define SHAPE_ELLIPSE 2
		#define SHAPE_LINE 3
		#define SHAPE_SQUARE 4
		#define BLENDING_LINEAR 1
		#define BLENDING_MULTIPLY 2
		#define BLENDING_ADD 3
		#define BLENDING_LIGHTER 4
		#define BLENDING_DARKER 5
		uniform sampler2D tDiffuse;
		uniform float radius;
		uniform float rotateR;
		uniform float rotateG;
		uniform float rotateB;
		uniform float scatter;
		uniform float width;
		uniform float height;
		uniform int shape;
		uniform bool disable;
		uniform float blending;
		uniform int blendingMode;
		varying vec2 vUV;
		varying vec3 vPosition;
		uniform bool greyscale;
		const int samples = 8;

		float blend( float a, float b, float t ) {

		// linear blend
			return a * ( 1.0 - t ) + b * t;

		}

		float hypot( float x, float y ) {

		// vector magnitude
			return sqrt( x * x + y * y );

		}

		float rand( vec2 seed ){

		// get pseudo-random number
			return fract( sin( dot( seed.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );

		}

		float distanceToDotRadius( float channel, vec2 coord, vec2 normal, vec2 p, float angle, float rad_max ) {

		// apply shape-specific transforms
			float dist = hypot( coord.x - p.x, coord.y - p.y );
			float rad = channel;

			if ( shape == SHAPE_DOT ) {

				rad = pow( abs( rad ), 1.125 ) * rad_max;

			} else if ( shape == SHAPE_ELLIPSE ) {

				rad = pow( abs( rad ), 1.125 ) * rad_max;

				if ( dist != 0.0 ) {
					float dot_p = abs( ( p.x - coord.x ) / dist * normal.x + ( p.y - coord.y ) / dist * normal.y );
					dist = ( dist * ( 1.0 - SQRT2_HALF_MINUS_ONE ) ) + dot_p * dist * SQRT2_MINUS_ONE;
				}

			} else if ( shape == SHAPE_LINE ) {

				rad = pow( abs( rad ), 1.5) * rad_max;
				float dot_p = ( p.x - coord.x ) * normal.x + ( p.y - coord.y ) * normal.y;
				dist = hypot( normal.x * dot_p, normal.y * dot_p );

			} else if ( shape == SHAPE_SQUARE ) {

				float theta = atan( p.y - coord.y, p.x - coord.x ) - angle;
				float sin_t = abs( sin( theta ) );
				float cos_t = abs( cos( theta ) );
				rad = pow( abs( rad ), 1.4 );
				rad = rad_max * ( rad + ( ( sin_t > cos_t ) ? rad - sin_t * rad : rad - cos_t * rad ) );

			}

			return rad - dist;

		}

		struct Cell {

		// grid sample positions
			vec2 normal;
			vec2 p1;
			vec2 p2;
			vec2 p3;
			vec2 p4;
			float samp2;
			float samp1;
			float samp3;
			float samp4;

		};

		vec4 getSample( vec2 point ) {

		// multi-sampled point
			vec4 tex = texture2D( tDiffuse, vec2( point.x / width, point.y / height ) );
			float base = rand( vec2( floor( point.x ), floor( point.y ) ) ) * PI2;
			float step = PI2 / float( samples );
			// float dist = radius * 0.66;
			float dist = radius * 0.0;

			for ( int i = 0; i < samples; ++i ) {

				float r = base + step * float( i );
				vec2 coord = point + vec2( cos( r ) * dist, sin( r ) * dist );
				tex += texture2D( tDiffuse, vec2( coord.x / width, coord.y / height ) );

			}

			tex /= float( samples ) + 1.0;
			return tex;

		}

		float getDotColour( Cell c, vec2 p, int channel, float angle, float aa ) {

		// get colour for given point
			float dist_c_1, dist_c_2, dist_c_3, dist_c_4, res;

			if ( channel == 0 ) {

				c.samp1 = getSample( c.p1 ).r;
				c.samp2 = getSample( c.p2 ).r;
				c.samp3 = getSample( c.p3 ).r;
				c.samp4 = getSample( c.p4 ).r;

			} else if (channel == 1) {

				c.samp1 = getSample( c.p1 ).g;
				c.samp2 = getSample( c.p2 ).g;
				c.samp3 = getSample( c.p3 ).g;
				c.samp4 = getSample( c.p4 ).g;

			} else {

				c.samp1 = getSample( c.p1 ).b;
				c.samp3 = getSample( c.p3 ).b;
				c.samp2 = getSample( c.p2 ).b;
				c.samp4 = getSample( c.p4 ).b;

			}

			dist_c_1 = distanceToDotRadius( c.samp1, c.p1, c.normal, p, angle, radius );
			dist_c_2 = distanceToDotRadius( c.samp2, c.p2, c.normal, p, angle, radius );
			dist_c_3 = distanceToDotRadius( c.samp3, c.p3, c.normal, p, angle, radius );
			dist_c_4 = distanceToDotRadius( c.samp4, c.p4, c.normal, p, angle, radius );
			res = ( dist_c_1 > 0.0 ) ? clamp( dist_c_1 / aa, 0.0, 1.0 ) : 0.0;
			// res = 0.0;
			res += ( dist_c_2 > 0.0 ) ? clamp( dist_c_2 / aa, 0.0, 1.0 ) : 0.0;
			res += ( dist_c_3 > 0.0 ) ? clamp( dist_c_3 / aa, 0.0, 1.0 ) : 0.0;
			res += ( dist_c_4 > 0.0 ) ? clamp( dist_c_4 / aa, 0.0, 1.0 ) : 0.0;
			res = clamp( res, 0.0, 1.0 );

			return res;
			// return 2

		}

		Cell getReferenceCell( vec2 p, vec2 origin, float grid_angle, float step ) {

		// get containing cell
			Cell c;

		// calc grid
			vec2 n = vec2( cos( grid_angle ), sin( grid_angle ) );
			float threshold = step * 0.5;
			float dot_normal = n.x * ( p.x - origin.x ) + n.y * ( p.y - origin.y );
			float dot_line = -n.y * ( p.x - origin.x ) + n.x * ( p.y - origin.y );
			vec2 offset = vec2( n.x * dot_normal, n.y * dot_normal );
			float offset_normal = mod( hypot( offset.x, offset.y ), step );
			float normal_dir = ( dot_normal < 0.0 ) ? 1.0 : -1.0;
			float normal_scale = ( ( offset_normal < threshold ) ? -offset_normal : step - offset_normal ) * normal_dir;
			float offset_line = mod( hypot( ( p.x - offset.x ) - origin.x, ( p.y - offset.y ) - origin.y ), step );
			float line_dir = ( dot_line < 0.0 ) ? 1.0 : -1.0;
			float line_scale = ( ( offset_line < threshold ) ? -offset_line : step - offset_line ) * line_dir;

		// get closest corner
			c.normal = n;
			c.p1.x = p.x - n.x * normal_scale + n.y * line_scale;
			c.p1.y = p.y - n.y * normal_scale - n.x * line_scale;

		// scatter
			if ( scatter != 0.0 ) {

				float off_mag = scatter * threshold * 0.5;
				float off_angle = rand( vec2( floor( c.p1.x ), floor( c.p1.y ) ) ) * PI2;
				c.p1.x += cos( off_angle ) * off_mag;
				c.p1.y += sin( off_angle ) * off_mag;

			}

		// find corners
			float normal_step = normal_dir * ( ( offset_normal < threshold ) ? step : -step );
			float line_step = line_dir * ( ( offset_line < threshold ) ? step : -step );
			c.p2.x = c.p1.x - n.x * normal_step;
			c.p2.y = c.p1.y - n.y * normal_step;
			c.p3.x = c.p1.x + n.y * line_step;
			c.p3.y = c.p1.y - n.x * line_step;
			c.p4.x = c.p1.x - n.x * normal_step + n.y * line_step;
			c.p4.y = c.p1.y - n.y * normal_step - n.x * line_step;

			return c;

		}

		float blendColour( float a, float b, float t ) {

		// blend colours
			if ( blendingMode == BLENDING_LINEAR ) {
				return blend( a, b, 1.0 - t );
			} else if ( blendingMode == BLENDING_ADD ) {
				return blend( a, min( 1.0, a + b ), t );
			} else if ( blendingMode == BLENDING_MULTIPLY ) {
				return blend( a, max( 0.0, a * b ), t );
			} else if ( blendingMode == BLENDING_LIGHTER ) {
				return blend( a, max( a, b ), t );
			} else if ( blendingMode == BLENDING_DARKER ) {
				return blend( a, min( a, b ), t );
			} else {
				return blend( a, b, 1.0 - t );
			}

		}

		void main() {

			if ( ! disable ) {

		// setup
				vec2 p = vec2( vUV.x * width, vUV.y * height ) - vec2(vPosition.x, vPosition.y) * 3.0; // - position values to remove black borders.
				vec2 origin = vec2( 0, 0 );
				float aa = ( radius < 2.5 ) ? radius * 0.5 : 1.25;
				// float aa = 0.0;

		// get channel samples
				Cell cell_r = getReferenceCell( p, origin, rotateR, radius );
				Cell cell_g = getReferenceCell( p, origin, rotateG, radius );
				Cell cell_b = getReferenceCell( p, origin, rotateB, radius );
				float r = getDotColour( cell_r, p, 0, rotateR, aa );
				float g = getDotColour( cell_g, p, 1, rotateG, aa );
				float b = getDotColour( cell_b, p, 2, rotateB, aa );

		// blend with original
				vec4 colour = texture2D( tDiffuse, vUV );
				
				// add masking before blendColour
				if (colour.r == 0.0) {
					r = 0.0;
				} else {
					r = blendColour( r, colour.r, blending );
				}

				if (colour.g == 0.0) {
					g = 0.0;
				} else {
					g = blendColour( g, colour.g, blending );
				}

				if (colour.b == 0.0) {
					b = 0.0;
				} else {
					b = blendColour( b, colour.b, blending );
				}
				
				
				

				if ( greyscale ) {
					r = g = b = (r + b + g) / 3.0;
				}

				// add alpha channel to each r, g, b colors
				vec4 vR;
				vec4 vG;
				vec4 vB;
	
				// apply transparent to outside of mesh
				if (r == 0.0 && colour.r == 0.0) {
					vR = vec4( 0, 0, 0, 0 );
				} else {
					vR = vec4( r, 0, 0, 1 );
				}
	
				if (g == 0.0 && colour.g == 0.0) {
					vG = vec4( 0, 0, 0, 0 );
				} else {
					vG = vec4( 0, g, 0, 1 );
				}
	
				if (b == 0.0 && colour.b == 0.0) {
					vB = vec4( 0, 0, 0, 0 );
				} else {
					vB = vec4( 0, 0, b, 1 );
				}

				// gl_FragColor = vec4( r, g, b, 1.0 );
				gl_FragColor = vR + vG + vB;

			} else {

				gl_FragColor = texture2D( tDiffuse, vUV );

			}

		}`},wN=class{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}},SN=new Gu(-1,1,1,-1,0,1),r1=new en;r1.setAttribute("position",new pt([-1,3,0,-1,-1,0,3,-1,0],3));r1.setAttribute("uv",new pt([0,2,0,0,2,0],2));var EN=class{constructor(e){this._mesh=new rr(r1,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,SN)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}},TN=class extends wN{constructor(r,e,t){super(),Ef===void 0&&console.error("THREE.HalftonePass requires HalftoneShader"),this.uniforms=tm.clone(Ef.uniforms),this.material=new ro({uniforms:this.uniforms,fragmentShader:Ef.fragmentShader,vertexShader:Ef.vertexShader}),this.uniforms.width.value=r,this.uniforms.height.value=e,this.uniforms.disable.value=t.disable,this.fsQuad=new EN(this.material),this.blendMode=new xN(Xi.SCREEN),this.extensions=null}render(r,e,t){this.material.uniforms.tDiffuse.value=t.texture,this.renderToScreen?(r.setRenderTarget(null),this.fsQuad.render(r)):(r.setRenderTarget(e),this.clear&&r.clear(),this.fsQuad.render(r))}setSize(r,e){this.uniforms.width.value=r,this.uniforms.height.value=e}initialize(r,e,t){}addEventListener(){}getAttributes(){return this.attributes}getFragmentShader(){return Ef.fragmentShader}getVertexShader(){return Ef.vertexShader}update(r,e,t){}},Ov={exports:{}},xu={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QS;function MN(){return QS||(QS=1,xu.ConcurrentRoot=1,xu.ContinuousEventPriority=4,xu.DefaultEventPriority=16,xu.DiscreteEventPriority=1,xu.IdleEventPriority=536870912,xu.LegacyRoot=0),xu}var KS;function CN(){return KS||(KS=1,Ov.exports=MN()),Ov.exports}var Ff=CN();function AN(r){let e;const t=new Set,n=(d,m)=>{const _=typeof d=="function"?d(e):d;if(_!==e){const y=e;e=m?_:Object.assign({},e,_),t.forEach(w=>w(e,y))}},i=()=>e,s=(d,m=i,_=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let y=m(e);function w(){const T=m(e);if(!_(y,T)){const E=y;d(y=T,E)}}return t.add(w),()=>t.delete(w)},f={setState:n,getState:i,subscribe:(d,m,_)=>m||_?s(d,m,_):(t.add(d),()=>t.delete(d)),destroy:()=>t.clear()};return e=r(n,i,f),f}const bN=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),ZS=bN?at.useEffect:at.useLayoutEffect;function PN(r){const e=typeof r=="function"?AN(r):r,t=(n=e.getState,i=Object.is)=>{const[,s]=at.useReducer(M=>M+1,0),a=e.getState(),u=at.useRef(a),f=at.useRef(n),d=at.useRef(i),m=at.useRef(!1),_=at.useRef();_.current===void 0&&(_.current=n(a));let y,w=!1;(u.current!==a||f.current!==n||d.current!==i||m.current)&&(y=n(a),w=!i(_.current,y)),ZS(()=>{w&&(_.current=y),u.current=a,f.current=n,d.current=i,m.current=!1});const T=at.useRef(a);ZS(()=>{const M=()=>{try{const C=e.getState(),b=f.current(C);d.current(_.current,b)||(u.current=C,_.current=b,s())}catch{m.current=!0,s()}},P=e.subscribe(M);return e.getState()!==T.current&&M(),P},[]);const E=w?y:_.current;return at.useDebugValue(E),E};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[t,e];return{next(){const i=n.length<=0;return{value:n.shift(),done:i}}}},t}const IN=r=>typeof r=="object"&&typeof r.then=="function",Xc=[];function jC(r,e,t=(n,i)=>n===i){if(r===e)return!0;if(!r||!e)return!1;const n=r.length;if(e.length!==n)return!1;for(let i=0;i<n;i++)if(!t(r[i],e[i]))return!1;return!0}function qC(r,e=null,t=!1,n={}){e===null&&(e=[r]);for(const s of Xc)if(jC(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return n.lifespan&&n.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,n.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:n.equal,remove:()=>{const s=Xc.indexOf(i);s!==-1&&Xc.splice(s,1)},promise:(IN(r)?r:r(...e)).then(s=>{i.response=s,n.lifespan&&n.lifespan>0&&(i.timeout=setTimeout(i.remove,n.lifespan))}).catch(s=>i.error=s)};if(Xc.push(i),!t)throw i.promise}const RN=(r,e,t)=>qC(r,e,!1,t),DN=(r,e,t)=>void qC(r,e,!0,t),LN=r=>{if(r===void 0||r.length===0)Xc.splice(0,Xc.length);else{const e=Xc.find(t=>jC(r,t.keys,t.equal));e&&e.remove()}};var Nv={exports:{}},kv={exports:{}},zv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JS;function ON(){return JS||(JS=1,function(r){function e(K,oe){var ne=K.length;K.push(oe);e:for(;0<ne;){var Q=ne-1>>>1,$=K[Q];if(0<i($,oe))K[Q]=oe,K[ne]=$,ne=Q;else break e}}function t(K){return K.length===0?null:K[0]}function n(K){if(K.length===0)return null;var oe=K[0],ne=K.pop();if(ne!==oe){K[0]=ne;e:for(var Q=0,$=K.length,he=$>>>1;Q<he;){var Ae=2*(Q+1)-1,se=K[Ae],Ne=Ae+1,Oe=K[Ne];if(0>i(se,ne))Ne<$&&0>i(Oe,se)?(K[Q]=Oe,K[Ne]=ne,Q=Ne):(K[Q]=se,K[Ae]=ne,Q=Ae);else if(Ne<$&&0>i(Oe,ne))K[Q]=Oe,K[Ne]=ne,Q=Ne;else break e}}return oe}function i(K,oe){var ne=K.sortIndex-oe.sortIndex;return ne!==0?ne:K.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var a=Date,u=a.now();r.unstable_now=function(){return a.now()-u}}var f=[],d=[],m=1,_=null,y=3,w=!1,T=!1,E=!1,M=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(K){for(var oe=t(d);oe!==null;){if(oe.callback===null)n(d);else if(oe.startTime<=K)n(d),oe.sortIndex=oe.expirationTime,e(f,oe);else break;oe=t(d)}}function R(K){if(E=!1,b(K),!T)if(t(f)!==null)T=!0,ye(z);else{var oe=t(d);oe!==null&&Ce(R,oe.startTime-K)}}function z(K,oe){T=!1,E&&(E=!1,P(I),I=-1),w=!0;var ne=y;try{for(b(oe),_=t(f);_!==null&&(!(_.expirationTime>oe)||K&&!W());){var Q=_.callback;if(typeof Q=="function"){_.callback=null,y=_.priorityLevel;var $=Q(_.expirationTime<=oe);oe=r.unstable_now(),typeof $=="function"?_.callback=$:_===t(f)&&n(f),b(oe)}else n(f);_=t(f)}if(_!==null)var he=!0;else{var Ae=t(d);Ae!==null&&Ce(R,Ae.startTime-oe),he=!1}return he}finally{_=null,y=ne,w=!1}}var B=!1,k=null,I=-1,N=5,V=-1;function W(){return!(r.unstable_now()-V<N)}function q(){if(k!==null){var K=r.unstable_now();V=K;var oe=!0;try{oe=k(!0,K)}finally{oe?H():(B=!1,k=null)}}else B=!1}var H;if(typeof C=="function")H=function(){C(q)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,de=re.port2;re.port1.onmessage=q,H=function(){de.postMessage(null)}}else H=function(){M(q,0)};function ye(K){k=K,B||(B=!0,H())}function Ce(K,oe){I=M(function(){K(r.unstable_now())},oe)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(K){K.callback=null},r.unstable_continueExecution=function(){T||w||(T=!0,ye(z))},r.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<K?Math.floor(1e3/K):5},r.unstable_getCurrentPriorityLevel=function(){return y},r.unstable_getFirstCallbackNode=function(){return t(f)},r.unstable_next=function(K){switch(y){case 1:case 2:case 3:var oe=3;break;default:oe=y}var ne=y;y=oe;try{return K()}finally{y=ne}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(K,oe){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ne=y;y=K;try{return oe()}finally{y=ne}},r.unstable_scheduleCallback=function(K,oe,ne){var Q=r.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?Q+ne:Q):ne=Q,K){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,K={id:m++,callback:oe,priorityLevel:K,startTime:ne,expirationTime:$,sortIndex:-1},ne>Q?(K.sortIndex=ne,e(d,K),t(f)===null&&K===t(d)&&(E?(P(I),I=-1):E=!0,Ce(R,ne-Q))):(K.sortIndex=$,e(f,K),T||w||(T=!0,ye(z))),K},r.unstable_shouldYield=W,r.unstable_wrapCallback=function(K){var oe=y;return function(){var ne=y;y=oe;try{return K.apply(this,arguments)}finally{y=ne}}}}(zv)),zv}var eE;function XC(){return eE||(eE=1,kv.exports=ON()),kv.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fv,tE;function NN(){return tE||(tE=1,Fv=function(e){var t={},n=W0(),i=XC(),s=Object.assign;function a(c){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+c,v=1;v<arguments.length;v++)h+="&args[]="+encodeURIComponent(arguments[v]);return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,f=Symbol.for("react.element"),d=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),T=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),R=Symbol.for("react.offscreen"),z=Symbol.iterator;function B(c){return c===null||typeof c!="object"?null:(c=z&&c[z]||c["@@iterator"],typeof c=="function"?c:null)}function k(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case m:return"Fragment";case d:return"Portal";case y:return"Profiler";case _:return"StrictMode";case M:return"Suspense";case P:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case T:return(c.displayName||"Context")+".Consumer";case w:return(c._context.displayName||"Context")+".Provider";case E:var h=c.render;return c=c.displayName,c||(c=h.displayName||h.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case C:return h=c.displayName||null,h!==null?h:k(c.type)||"Memo";case b:h=c._payload,c=c._init;try{return k(c(h))}catch{}}return null}function I(c){var h=c.type;switch(c.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=h.render,c=c.displayName||c.name||"",h.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return k(h);case 8:return h===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function N(c){var h=c,v=c;if(c.alternate)for(;h.return;)h=h.return;else{c=h;do h=c,(h.flags&4098)!==0&&(v=h.return),c=h.return;while(c)}return h.tag===3?v:null}function V(c){if(N(c)!==c)throw Error(a(188))}function W(c){var h=c.alternate;if(!h){if(h=N(c),h===null)throw Error(a(188));return h!==c?null:c}for(var v=c,S=h;;){var D=v.return;if(D===null)break;var F=D.alternate;if(F===null){if(S=D.return,S!==null){v=S;continue}break}if(D.child===F.child){for(F=D.child;F;){if(F===v)return V(D),c;if(F===S)return V(D),h;F=F.sibling}throw Error(a(188))}if(v.return!==S.return)v=D,S=F;else{for(var J=!1,ue=D.child;ue;){if(ue===v){J=!0,v=D,S=F;break}if(ue===S){J=!0,S=D,v=F;break}ue=ue.sibling}if(!J){for(ue=F.child;ue;){if(ue===v){J=!0,v=F,S=D;break}if(ue===S){J=!0,S=F,v=D;break}ue=ue.sibling}if(!J)throw Error(a(189))}}if(v.alternate!==S)throw Error(a(190))}if(v.tag!==3)throw Error(a(188));return v.stateNode.current===v?c:h}function q(c){return c=W(c),c!==null?H(c):null}function H(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var h=H(c);if(h!==null)return h;c=c.sibling}return null}function re(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){if(c.tag!==4){var h=re(c);if(h!==null)return h}c=c.sibling}return null}var de=Array.isArray,ye=e.getPublicInstance,Ce=e.getRootHostContext,K=e.getChildHostContext,oe=e.prepareForCommit,ne=e.resetAfterCommit,Q=e.createInstance,$=e.appendInitialChild,he=e.finalizeInitialChildren,Ae=e.prepareUpdate,se=e.shouldSetTextContent,Ne=e.createTextInstance,Oe=e.scheduleTimeout,He=e.cancelTimeout,Xe=e.noTimeout,Je=e.isPrimaryRenderer,ut=e.supportsMutation,De=e.supportsPersistence,Le=e.supportsHydration,Qe=e.getInstanceFromNode,gt=e.preparePortalMount,et=e.getCurrentEventPriority,It=e.detachDeletedInstance,At=e.supportsMicrotasks,Pt=e.scheduleMicrotask,Yt=e.supportsTestSelectors,tn=e.findFiberRoot,ee=e.getBoundingRect,X=e.getTextContent,Se=e.isHiddenSubtree,$e=e.matchAccessibilityRole,Ue=e.setFocusIfFocusable,je=e.setupIntersectionObserver,_t=e.appendChild,st=e.appendChildToContainer,Re=e.commitTextUpdate,Et=e.commitMount,ht=e.commitUpdate,Rt=e.insertBefore,bt=e.insertInContainerBefore,Tt=e.removeChild,rn=e.removeChildFromContainer,Cn=e.resetTextContent,Bn=e.hideInstance,le=e.hideTextInstance,be=e.unhideInstance,Fe=e.unhideTextInstance,tt=e.clearContainer,ct=e.cloneInstance,an=e.createContainerChildSet,Wn=e.appendChildToContainerChildSet,ri=e.finalizeContainerChildren,Yi=e.replaceContainerChildren,_n=e.cloneHiddenInstance,Ci=e.cloneHiddenTextInstance,vn=e.canHydrateInstance,ca=e.canHydrateTextInstance,Jr=e.canHydrateSuspenseInstance,oo=e.isSuspenseInstancePending,Y=e.isSuspenseInstanceFallback,ge=e.registerSuspenseInstanceRetry,Ee=e.getNextHydratableSibling,pe=e.getFirstHydratableChild,Ie=e.getFirstHydratableChildWithinContainer,Mt=e.getFirstHydratableChildWithinSuspenseInstance,kt=e.hydrateInstance,Lt=e.hydrateTextInstance,Ft=e.hydrateSuspenseInstance,Ht=e.getNextHydratableInstanceAfterSuspenseInstance,Qt=e.commitHydratedContainer,Kt=e.commitHydratedSuspenseInstance,Nn=e.clearSuspenseBoundary,_i=e.clearSuspenseBoundaryFromContainer,Sr=e.shouldDeleteUnhydratedTailInstances,ys=e.didNotMatchHydratedContainerTextInstance,Yn=e.didNotMatchHydratedTextInstance,vt;function xs(c){if(vt===void 0)try{throw Error()}catch(v){var h=v.stack.trim().match(/\n( *(at )?)/);vt=h&&h[1]||""}return`
`+vt+c}var Rn=!1;function zi(c,h){if(!c||Rn)return"";Rn=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(Ye){var S=Ye}Reflect.construct(c,[],h)}else{try{h.call()}catch(Ye){S=Ye}c.call(h.prototype)}else{try{throw Error()}catch(Ye){S=Ye}c()}}catch(Ye){if(Ye&&S&&typeof Ye.stack=="string"){for(var D=Ye.stack.split(`
`),F=S.stack.split(`
`),J=D.length-1,ue=F.length-1;1<=J&&0<=ue&&D[J]!==F[ue];)ue--;for(;1<=J&&0<=ue;J--,ue--)if(D[J]!==F[ue]){if(J!==1||ue!==1)do if(J--,ue--,0>ue||D[J]!==F[ue]){var Me=`
`+D[J].replace(" at new "," at ");return c.displayName&&Me.includes("<anonymous>")&&(Me=Me.replace("<anonymous>",c.displayName)),Me}while(1<=J&&0<=ue);break}}}finally{Rn=!1,Error.prepareStackTrace=v}return(c=c?c.displayName||c.name:"")?xs(c):""}var Er=Object.prototype.hasOwnProperty,es=[],ts=-1;function An(c){return{current:c}}function Ut(c){0>ts||(c.current=es[ts],es[ts]=null,ts--)}function mn(c,h){ts++,es[ts]=c.current,c.current=h}var ln={},Qn=An(ln),Ai=An(!1),ns=ln;function Fs(c,h){var v=c.type.contextTypes;if(!v)return ln;var S=c.stateNode;if(S&&S.__reactInternalMemoizedUnmaskedChildContext===h)return S.__reactInternalMemoizedMaskedChildContext;var D={},F;for(F in v)D[F]=h[F];return S&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=h,c.__reactInternalMemoizedMaskedChildContext=D),D}function bi(c){return c=c.childContextTypes,c!=null}function Us(){Ut(Ai),Ut(Qn)}function ha(c,h,v){if(Qn.current!==ln)throw Error(a(168));mn(Qn,h),mn(Ai,v)}function wh(c,h,v){var S=c.stateNode;if(h=h.childContextTypes,typeof S.getChildContext!="function")return v;S=S.getChildContext();for(var D in S)if(!(D in h))throw Error(a(108,I(c)||"Unknown",D));return s({},v,S)}function ws(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||ln,ns=Qn.current,mn(Qn,c),mn(Ai,Ai.current),!0}function Ur(c,h,v){var S=c.stateNode;if(!S)throw Error(a(169));v?(c=wh(c,h,ns),S.__reactInternalMemoizedMergedChildContext=c,Ut(Ai),Ut(Qn),mn(Qn,c)):Ut(Ai),mn(Ai,v)}var Qi=Math.clz32?Math.clz32:kn,fa=Math.log,da=Math.LN2;function kn(c){return c>>>=0,c===0?32:31-(fa(c)/da|0)|0}var Bs=64,sn=4194304;function Ss(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function Ua(c,h){var v=c.pendingLanes;if(v===0)return 0;var S=0,D=c.suspendedLanes,F=c.pingedLanes,J=v&268435455;if(J!==0){var ue=J&~D;ue!==0?S=Ss(ue):(F&=J,F!==0&&(S=Ss(F)))}else J=v&~D,J!==0?S=Ss(J):F!==0&&(S=Ss(F));if(S===0)return 0;if(h!==0&&h!==S&&(h&D)===0&&(D=S&-S,F=h&-h,D>=F||D===16&&(F&4194240)!==0))return h;if((S&4)!==0&&(S|=v&16),h=c.entangledLanes,h!==0)for(c=c.entanglements,h&=S;0<h;)v=31-Qi(h),D=1<<v,S|=c[v],h&=~D;return S}function Nl(c,h){switch(c){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sh(c,h){for(var v=c.suspendedLanes,S=c.pingedLanes,D=c.expirationTimes,F=c.pendingLanes;0<F;){var J=31-Qi(F),ue=1<<J,Me=D[J];Me===-1?((ue&v)===0||(ue&S)!==0)&&(D[J]=Nl(ue,h)):Me<=h&&(c.expiredLanes|=ue),F&=~ue}}function kl(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function zl(c){for(var h=[],v=0;31>v;v++)h.push(c);return h}function bo(c,h,v){c.pendingLanes|=h,h!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,h=31-Qi(h),c[h]=v}function ao(c,h){var v=c.pendingLanes&~h;c.pendingLanes=h,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=h,c.mutableReadLanes&=h,c.entangledLanes&=h,h=c.entanglements;var S=c.eventTimes;for(c=c.expirationTimes;0<v;){var D=31-Qi(v),F=1<<D;h[D]=0,S[D]=-1,c[D]=-1,v&=~F}}function Pi(c,h){var v=c.entangledLanes|=h;for(c=c.entanglements;v;){var S=31-Qi(v),D=1<<S;D&h|c[S]&h&&(c[S]|=h),v&=~D}}var jt=0;function Es(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var lo=i.unstable_scheduleCallback,is=i.unstable_cancelCallback,uo=i.unstable_shouldYield,ad=i.unstable_requestPaint,fi=i.unstable_now,ar=i.unstable_ImmediatePriority,ld=i.unstable_UserBlockingPriority,Fl=i.unstable_NormalPriority,Po=i.unstable_IdlePriority,co=null,rs=null;function Vs(c){if(rs&&typeof rs.onCommitFiberRoot=="function")try{rs.onCommitFiberRoot(co,c,void 0,(c.current.flags&128)===128)}catch{}}function Hs(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var Fi=typeof Object.is=="function"?Object.is:Hs,lr=null,zn=!1,qu=!1;function Ul(c){lr===null?lr=[c]:lr.push(c)}function Ba(c){zn=!0,Ul(c)}function Tr(){if(!qu&&lr!==null){qu=!0;var c=0,h=jt;try{var v=lr;for(jt=1;c<v.length;c++){var S=v[c];do S=S(!0);while(S!==null)}lr=null,zn=!1}catch(D){throw lr!==null&&(lr=lr.slice(c+1)),lo(ar,Tr),D}finally{jt=h,qu=!1}}return null}var Xu=u.ReactCurrentBatchConfig;function ur(c,h){if(Fi(c,h))return!0;if(typeof c!="object"||c===null||typeof h!="object"||h===null)return!1;var v=Object.keys(c),S=Object.keys(h);if(v.length!==S.length)return!1;for(S=0;S<v.length;S++){var D=v[S];if(!Er.call(h,D)||!Fi(c[D],h[D]))return!1}return!0}function Bl(c){switch(c.tag){case 5:return xs(c.type);case 16:return xs("Lazy");case 13:return xs("Suspense");case 19:return xs("SuspenseList");case 0:case 2:case 15:return c=zi(c.type,!1),c;case 11:return c=zi(c.type.render,!1),c;case 1:return c=zi(c.type,!0),c;default:return""}}function Kn(c,h){if(c&&c.defaultProps){h=s({},h),c=c.defaultProps;for(var v in c)h[v]===void 0&&(h[v]=c[v]);return h}return h}var pa=An(null),Io=null,Mr=null,Va=null;function Ii(){Va=Mr=Io=null}function Ts(c,h,v){Je?(mn(pa,h._currentValue),h._currentValue=v):(mn(pa,h._currentValue2),h._currentValue2=v)}function ma(c){var h=pa.current;Ut(pa),Je?c._currentValue=h:c._currentValue2=h}function Ms(c,h,v){for(;c!==null;){var S=c.alternate;if((c.childLanes&h)!==h?(c.childLanes|=h,S!==null&&(S.childLanes|=h)):S!==null&&(S.childLanes&h)!==h&&(S.childLanes|=h),c===v)break;c=c.return}}function ga(c,h){Io=c,Va=Mr=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&h)!==0&&(Gi=!0),c.firstContext=null)}function Ki(c){var h=Je?c._currentValue:c._currentValue2;if(Va!==c)if(c={context:c,memoizedValue:h,next:null},Mr===null){if(Io===null)throw Error(a(308));Mr=c,Io.dependencies={lanes:0,firstContext:c}}else Mr=Mr.next=c;return h}var Ui=null,Cr=!1;function Ro(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ha(c,h){c=c.updateQueue,h.updateQueue===c&&(h.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function ss(c,h){return{eventTime:c,lane:h,tag:0,payload:null,callback:null,next:null}}function Gs(c,h){var v=c.updateQueue;v!==null&&(v=v.shared,pi!==null&&(c.mode&1)!==0&&($t&2)===0?(c=v.interleaved,c===null?(h.next=h,Ui===null?Ui=[v]:Ui.push(v)):(h.next=c.next,c.next=h),v.interleaved=h):(c=v.pending,c===null?h.next=h:(h.next=c.next,c.next=h),v.pending=h))}function Do(c,h,v){if(h=h.updateQueue,h!==null&&(h=h.shared,(v&4194240)!==0)){var S=h.lanes;S&=c.pendingLanes,v|=S,h.lanes=v,Pi(c,v)}}function Ga(c,h){var v=c.updateQueue,S=c.alternate;if(S!==null&&(S=S.updateQueue,v===S)){var D=null,F=null;if(v=v.firstBaseUpdate,v!==null){do{var J={eventTime:v.eventTime,lane:v.lane,tag:v.tag,payload:v.payload,callback:v.callback,next:null};F===null?D=F=J:F=F.next=J,v=v.next}while(v!==null);F===null?D=F=h:F=F.next=h}else D=F=h;v={baseState:S.baseState,firstBaseUpdate:D,lastBaseUpdate:F,shared:S.shared,effects:S.effects},c.updateQueue=v;return}c=v.lastBaseUpdate,c===null?v.firstBaseUpdate=h:c.next=h,v.lastBaseUpdate=h}function Wa(c,h,v,S){var D=c.updateQueue;Cr=!1;var F=D.firstBaseUpdate,J=D.lastBaseUpdate,ue=D.shared.pending;if(ue!==null){D.shared.pending=null;var Me=ue,Ye=Me.next;Me.next=null,J===null?F=Ye:J.next=Ye,J=Me;var ft=c.alternate;ft!==null&&(ft=ft.updateQueue,ue=ft.lastBaseUpdate,ue!==J&&(ue===null?ft.firstBaseUpdate=Ye:ue.next=Ye,ft.lastBaseUpdate=Me))}if(F!==null){var Gt=D.baseState;J=0,ft=Ye=Me=null,ue=F;do{var Dt=ue.lane,Zt=ue.eventTime;if((S&Dt)===Dt){ft!==null&&(ft=ft.next={eventTime:Zt,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var ot=c,nr=ue;switch(Dt=h,Zt=v,nr.tag){case 1:if(ot=nr.payload,typeof ot=="function"){Gt=ot.call(Zt,Gt,Dt);break e}Gt=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=nr.payload,Dt=typeof ot=="function"?ot.call(Zt,Gt,Dt):ot,Dt==null)break e;Gt=s({},Gt,Dt);break e;case 2:Cr=!0}}ue.callback!==null&&ue.lane!==0&&(c.flags|=64,Dt=D.effects,Dt===null?D.effects=[ue]:Dt.push(ue))}else Zt={eventTime:Zt,lane:Dt,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},ft===null?(Ye=ft=Zt,Me=Gt):ft=ft.next=Zt,J|=Dt;if(ue=ue.next,ue===null){if(ue=D.shared.pending,ue===null)break;Dt=ue,ue=Dt.next,Dt.next=null,D.lastBaseUpdate=Dt,D.shared.pending=null}}while(!0);if(ft===null&&(Me=Gt),D.baseState=Me,D.firstBaseUpdate=Ye,D.lastBaseUpdate=ft,h=D.shared.interleaved,h!==null){D=h;do J|=D.lane,D=D.next;while(D!==h)}else F===null&&(D.shared.lanes=0);go|=J,c.lanes=J,c.memoizedState=Gt}}function ho(c,h,v){if(c=h.effects,h.effects=null,c!==null)for(h=0;h<c.length;h++){var S=c[h],D=S.callback;if(D!==null){if(S.callback=null,S=v,typeof D!="function")throw Error(a(191,D));D.call(S)}}}var $u=new n.Component().refs;function Vl(c,h,v,S){h=c.memoizedState,v=v(S,h),v=v==null?h:s({},h,v),c.memoizedState=v,c.lanes===0&&(c.updateQueue.baseState=v)}var ja={isMounted:function(c){return(c=c._reactInternals)?N(c)===c:!1},enqueueSetState:function(c,h,v){c=c._reactInternals;var S=xn(),D=Ks(c),F=ss(S,D);F.payload=h,v!=null&&(F.callback=v),Gs(c,F),h=pr(c,D,S),h!==null&&Do(h,c,D)},enqueueReplaceState:function(c,h,v){c=c._reactInternals;var S=xn(),D=Ks(c),F=ss(S,D);F.tag=1,F.payload=h,v!=null&&(F.callback=v),Gs(c,F),h=pr(c,D,S),h!==null&&Do(h,c,D)},enqueueForceUpdate:function(c,h){c=c._reactInternals;var v=xn(),S=Ks(c),D=ss(v,S);D.tag=2,h!=null&&(D.callback=h),Gs(c,D),h=pr(c,S,v),h!==null&&Do(h,c,S)}};function Hl(c,h,v,S,D,F,J){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(S,F,J):h.prototype&&h.prototype.isPureReactComponent?!ur(v,S)||!ur(D,F):!0}function qa(c,h,v){var S=!1,D=ln,F=h.contextType;return typeof F=="object"&&F!==null?F=Ki(F):(D=bi(h)?ns:Qn.current,S=h.contextTypes,F=(S=S!=null)?Fs(c,D):ln),h=new h(v,F),c.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=ja,c.stateNode=h,h._reactInternals=c,S&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=D,c.__reactInternalMemoizedMaskedChildContext=F),h}function cr(c,h,v,S){c=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(v,S),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(v,S),h.state!==c&&ja.enqueueReplaceState(h,h.state,null)}function Gl(c,h,v,S){var D=c.stateNode;D.props=v,D.state=c.memoizedState,D.refs=$u,Ro(c);var F=h.contextType;typeof F=="object"&&F!==null?D.context=Ki(F):(F=bi(h)?ns:Qn.current,D.context=Fs(c,F)),D.state=c.memoizedState,F=h.getDerivedStateFromProps,typeof F=="function"&&(Vl(c,h,F,v),D.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(h=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),h!==D.state&&ja.enqueueReplaceState(D,D.state,null),Wa(c,v,D,S),D.state=c.memoizedState),typeof D.componentDidMount=="function"&&(c.flags|=4194308)}var Lo=[],Ar=0,g=null,L=0,U=[],j=0,fe=null,xe=1,We="";function fn(c,h){Lo[Ar++]=L,Lo[Ar++]=g,g=c,L=h}function vi(c,h,v){U[j++]=xe,U[j++]=We,U[j++]=fe,fe=c;var S=xe;c=We;var D=32-Qi(S)-1;S&=~(1<<D),v+=1;var F=32-Qi(h)+D;if(30<F){var J=D-D%5;F=(S&(1<<J)-1).toString(32),S>>=J,D-=J,xe=1<<32-Qi(h)+D|v<<D|S,We=F+c}else xe=1<<F|v<<D|S,We=c}function un(c){c.return!==null&&(fn(c,1),vi(c,1,0))}function yi(c){for(;c===g;)g=Lo[--Ar],Lo[Ar]=null,L=Lo[--Ar],Lo[Ar]=null;for(;c===fe;)fe=U[--j],U[j]=null,We=U[--j],U[j]=null,xe=U[--j],U[j]=null}var yn=null,Zn=null,cn=!1,Ws=!1,hr=null;function ud(c,h){var v=fs(5,null,null,0);v.elementType="DELETED",v.stateNode=h,v.return=c,h=c.deletions,h===null?(c.deletions=[v],c.flags|=16):h.push(v)}function cd(c,h){switch(c.tag){case 5:return h=vn(h,c.type,c.pendingProps),h!==null?(c.stateNode=h,yn=c,Zn=pe(h),!0):!1;case 6:return h=ca(h,c.pendingProps),h!==null?(c.stateNode=h,yn=c,Zn=null,!0):!1;case 13:if(h=Jr(h),h!==null){var v=fe!==null?{id:xe,overflow:We}:null;return c.memoizedState={dehydrated:h,treeContext:v,retryLane:1073741824},v=fs(18,null,null,0),v.stateNode=h,v.return=c,c.child=v,yn=c,Zn=null,!0}return!1;default:return!1}}function Eh(c){return(c.mode&1)!==0&&(c.flags&128)===0}function _a(c){if(cn){var h=Zn;if(h){var v=h;if(!cd(c,h)){if(Eh(c))throw Error(a(418));h=Ee(v);var S=yn;h&&cd(c,h)?ud(S,v):(c.flags=c.flags&-4097|2,cn=!1,yn=c)}}else{if(Eh(c))throw Error(a(418));c.flags=c.flags&-4097|2,cn=!1,yn=c}}}function Mm(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;yn=c}function Yu(c){if(!Le||c!==yn)return!1;if(!cn)return Mm(c),cn=!0,!1;if(c.tag!==3&&(c.tag!==5||Sr(c.type)&&!se(c.type,c.memoizedProps))){var h=Zn;if(h){if(Eh(c)){for(c=Zn;c;)c=Ee(c);throw Error(a(418))}for(;h;)ud(c,h),h=Ee(h)}}if(Mm(c),c.tag===13){if(!Le)throw Error(a(316));if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(a(317));Zn=Ht(c)}else Zn=yn?Ee(c.stateNode):null;return!0}function Wl(){Le&&(Zn=yn=null,Ws=cn=!1)}function Th(c){hr===null?hr=[c]:hr.push(c)}function jl(c,h,v){if(c=v.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(v._owner){if(v=v._owner,v){if(v.tag!==1)throw Error(a(309));var S=v.stateNode}if(!S)throw Error(a(147,c));var D=S,F=""+c;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===F?h.ref:(h=function(J){var ue=D.refs;ue===$u&&(ue=D.refs={}),J===null?delete ue[F]:ue[F]=J},h._stringRef=F,h)}if(typeof c!="string")throw Error(a(284));if(!v._owner)throw Error(a(290,c))}return c}function va(c,h){throw c=Object.prototype.toString.call(h),Error(a(31,c==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":c))}function ql(c){var h=c._init;return h(c._payload)}function Cm(c){function h(ve,ce){if(c){var Te=ve.deletions;Te===null?(ve.deletions=[ce],ve.flags|=16):Te.push(ce)}}function v(ve,ce){if(!c)return null;for(;ce!==null;)h(ve,ce),ce=ce.sibling;return null}function S(ve,ce){for(ve=new Map;ce!==null;)ce.key!==null?ve.set(ce.key,ce):ve.set(ce.index,ce),ce=ce.sibling;return ve}function D(ve,ce){return ve=Xo(ve,ce),ve.index=0,ve.sibling=null,ve}function F(ve,ce,Te){return ve.index=Te,c?(Te=ve.alternate,Te!==null?(Te=Te.index,Te<ce?(ve.flags|=2,ce):Te):(ve.flags|=2,ce)):(ve.flags|=1048576,ce)}function J(ve){return c&&ve.alternate===null&&(ve.flags|=2),ve}function ue(ve,ce,Te,it){return ce===null||ce.tag!==6?(ce=Kh(Te,ve.mode,it),ce.return=ve,ce):(ce=D(ce,Te),ce.return=ve,ce)}function Me(ve,ce,Te,it){var wt=Te.type;return wt===m?ft(ve,ce,Te.props.children,it,Te.key):ce!==null&&(ce.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===b&&ql(wt)===ce.type)?(it=D(ce,Te.props),it.ref=jl(ve,ce,Te),it.return=ve,it):(it=Qh(Te.type,Te.key,Te.props,null,ve.mode,it),it.ref=jl(ve,ce,Te),it.return=ve,it)}function Ye(ve,ce,Te,it){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==Te.containerInfo||ce.stateNode.implementation!==Te.implementation?(ce=Zh(Te,ve.mode,it),ce.return=ve,ce):(ce=D(ce,Te.children||[]),ce.return=ve,ce)}function ft(ve,ce,Te,it,wt){return ce===null||ce.tag!==7?(ce=pl(Te,ve.mode,it,wt),ce.return=ve,ce):(ce=D(ce,Te),ce.return=ve,ce)}function Gt(ve,ce,Te){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return ce=Kh(""+ce,ve.mode,Te),ce.return=ve,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case f:return Te=Qh(ce.type,ce.key,ce.props,null,ve.mode,Te),Te.ref=jl(ve,null,ce),Te.return=ve,Te;case d:return ce=Zh(ce,ve.mode,Te),ce.return=ve,ce;case b:var it=ce._init;return Gt(ve,it(ce._payload),Te)}if(de(ce)||B(ce))return ce=pl(ce,ve.mode,Te,null),ce.return=ve,ce;va(ve,ce)}return null}function Dt(ve,ce,Te,it){var wt=ce!==null?ce.key:null;if(typeof Te=="string"&&Te!==""||typeof Te=="number")return wt!==null?null:ue(ve,ce,""+Te,it);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case f:return Te.key===wt?Me(ve,ce,Te,it):null;case d:return Te.key===wt?Ye(ve,ce,Te,it):null;case b:return wt=Te._init,Dt(ve,ce,wt(Te._payload),it)}if(de(Te)||B(Te))return wt!==null?null:ft(ve,ce,Te,it,null);va(ve,Te)}return null}function Zt(ve,ce,Te,it,wt){if(typeof it=="string"&&it!==""||typeof it=="number")return ve=ve.get(Te)||null,ue(ce,ve,""+it,wt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case f:return ve=ve.get(it.key===null?Te:it.key)||null,Me(ce,ve,it,wt);case d:return ve=ve.get(it.key===null?Te:it.key)||null,Ye(ce,ve,it,wt);case b:var qt=it._init;return Zt(ve,ce,Te,qt(it._payload),wt)}if(de(it)||B(it))return ve=ve.get(Te)||null,ft(ce,ve,it,wt,null);va(ce,it)}return null}function ot(ve,ce,Te,it){for(var wt=null,qt=null,Wt=ce,gn=ce=0,wi=null;Wt!==null&&gn<Te.length;gn++){Wt.index>gn?(wi=Wt,Wt=null):wi=Wt.sibling;var pn=Dt(ve,Wt,Te[gn],it);if(pn===null){Wt===null&&(Wt=wi);break}c&&Wt&&pn.alternate===null&&h(ve,Wt),ce=F(pn,ce,gn),qt===null?wt=pn:qt.sibling=pn,qt=pn,Wt=wi}if(gn===Te.length)return v(ve,Wt),cn&&fn(ve,gn),wt;if(Wt===null){for(;gn<Te.length;gn++)Wt=Gt(ve,Te[gn],it),Wt!==null&&(ce=F(Wt,ce,gn),qt===null?wt=Wt:qt.sibling=Wt,qt=Wt);return cn&&fn(ve,gn),wt}for(Wt=S(ve,Wt);gn<Te.length;gn++)wi=Zt(Wt,ve,gn,Te[gn],it),wi!==null&&(c&&wi.alternate!==null&&Wt.delete(wi.key===null?gn:wi.key),ce=F(wi,ce,gn),qt===null?wt=wi:qt.sibling=wi,qt=wi);return c&&Wt.forEach(function($o){return h(ve,$o)}),cn&&fn(ve,gn),wt}function nr(ve,ce,Te,it){var wt=B(Te);if(typeof wt!="function")throw Error(a(150));if(Te=wt.call(Te),Te==null)throw Error(a(151));for(var qt=wt=null,Wt=ce,gn=ce=0,wi=null,pn=Te.next();Wt!==null&&!pn.done;gn++,pn=Te.next()){Wt.index>gn?(wi=Wt,Wt=null):wi=Wt.sibling;var $o=Dt(ve,Wt,pn.value,it);if($o===null){Wt===null&&(Wt=wi);break}c&&Wt&&$o.alternate===null&&h(ve,Wt),ce=F($o,ce,gn),qt===null?wt=$o:qt.sibling=$o,qt=$o,Wt=wi}if(pn.done)return v(ve,Wt),cn&&fn(ve,gn),wt;if(Wt===null){for(;!pn.done;gn++,pn=Te.next())pn=Gt(ve,pn.value,it),pn!==null&&(ce=F(pn,ce,gn),qt===null?wt=pn:qt.sibling=pn,qt=pn);return cn&&fn(ve,gn),wt}for(Wt=S(ve,Wt);!pn.done;gn++,pn=Te.next())pn=Zt(Wt,ve,gn,pn.value,it),pn!==null&&(c&&pn.alternate!==null&&Wt.delete(pn.key===null?gn:pn.key),ce=F(pn,ce,gn),qt===null?wt=pn:qt.sibling=pn,qt=pn);return c&&Wt.forEach(function(Vd){return h(ve,Vd)}),cn&&fn(ve,gn),wt}function ds(ve,ce,Te,it){if(typeof Te=="object"&&Te!==null&&Te.type===m&&Te.key===null&&(Te=Te.props.children),typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case f:e:{for(var wt=Te.key,qt=ce;qt!==null;){if(qt.key===wt){if(wt=Te.type,wt===m){if(qt.tag===7){v(ve,qt.sibling),ce=D(qt,Te.props.children),ce.return=ve,ve=ce;break e}}else if(qt.elementType===wt||typeof wt=="object"&&wt!==null&&wt.$$typeof===b&&ql(wt)===qt.type){v(ve,qt.sibling),ce=D(qt,Te.props),ce.ref=jl(ve,qt,Te),ce.return=ve,ve=ce;break e}v(ve,qt);break}else h(ve,qt);qt=qt.sibling}Te.type===m?(ce=pl(Te.props.children,ve.mode,it,Te.key),ce.return=ve,ve=ce):(it=Qh(Te.type,Te.key,Te.props,null,ve.mode,it),it.ref=jl(ve,ce,Te),it.return=ve,ve=it)}return J(ve);case d:e:{for(qt=Te.key;ce!==null;){if(ce.key===qt)if(ce.tag===4&&ce.stateNode.containerInfo===Te.containerInfo&&ce.stateNode.implementation===Te.implementation){v(ve,ce.sibling),ce=D(ce,Te.children||[]),ce.return=ve,ve=ce;break e}else{v(ve,ce);break}else h(ve,ce);ce=ce.sibling}ce=Zh(Te,ve.mode,it),ce.return=ve,ve=ce}return J(ve);case b:return qt=Te._init,ds(ve,ce,qt(Te._payload),it)}if(de(Te))return ot(ve,ce,Te,it);if(B(Te))return nr(ve,ce,Te,it);va(ve,Te)}return typeof Te=="string"&&Te!==""||typeof Te=="number"?(Te=""+Te,ce!==null&&ce.tag===6?(v(ve,ce.sibling),ce=D(ce,Te),ce.return=ve,ve=ce):(v(ve,ce),ce=Kh(Te,ve.mode,it),ce.return=ve,ve=ce),J(ve)):v(ve,ce)}return ds}var Oo=Cm(!0),Am=Cm(!1),Xl={},Br=An(Xl),Xa=An(Xl),$a=An(Xl);function js(c){if(c===Xl)throw Error(a(174));return c}function Mh(c,h){mn($a,h),mn(Xa,c),mn(Br,Xl),c=Ce(h),Ut(Br),mn(Br,c)}function $l(){Ut(Br),Ut(Xa),Ut($a)}function bm(c){var h=js($a.current),v=js(Br.current);h=K(v,c.type,h),v!==h&&(mn(Xa,c),mn(Br,h))}function hd(c){Xa.current===c&&(Ut(Br),Ut(Xa))}var si=An(0);function Ch(c){for(var h=c;h!==null;){if(h.tag===13){var v=h.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||oo(v)||Y(v)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var os=[];function Ya(){for(var c=0;c<os.length;c++){var h=os[c];Je?h._workInProgressVersionPrimary=null:h._workInProgressVersionSecondary=null}os.length=0}var Qu=u.ReactCurrentDispatcher,as=u.ReactCurrentBatchConfig,Qa=0,oi=null,Bi=null,Vi=null,Ah=!1,fo=!1,Ka=0,Ku=0;function Hi(){throw Error(a(321))}function bh(c,h){if(h===null)return!1;for(var v=0;v<h.length&&v<c.length;v++)if(!Fi(c[v],h[v]))return!1;return!0}function Yl(c,h,v,S,D,F){if(Qa=F,oi=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,Qu.current=c===null||c.memoizedState===null?_d:vd,c=v(S,D),fo){F=0;do{if(fo=!1,Ka=0,25<=F)throw Error(a(301));F+=1,Vi=Bi=null,h.updateQueue=null,Qu.current=yd,c=v(S,D)}while(fo)}if(Qu.current=Jl,h=Bi!==null&&Bi.next!==null,Qa=0,Vi=Bi=oi=null,Ah=!1,h)throw Error(a(300));return c}function ya(){var c=Ka!==0;return Ka=0,c}function qs(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vi===null?oi.memoizedState=Vi=c:Vi=Vi.next=c,Vi}function Xs(){if(Bi===null){var c=oi.alternate;c=c!==null?c.memoizedState:null}else c=Bi.next;var h=Vi===null?oi.memoizedState:Vi.next;if(h!==null)Vi=h,Bi=c;else{if(c===null)throw Error(a(310));Bi=c,c={memoizedState:Bi.memoizedState,baseState:Bi.baseState,baseQueue:Bi.baseQueue,queue:Bi.queue,next:null},Vi===null?oi.memoizedState=Vi=c:Vi=Vi.next=c}return Vi}function po(c,h){return typeof h=="function"?h(c):h}function Zu(c){var h=Xs(),v=h.queue;if(v===null)throw Error(a(311));v.lastRenderedReducer=c;var S=Bi,D=S.baseQueue,F=v.pending;if(F!==null){if(D!==null){var J=D.next;D.next=F.next,F.next=J}S.baseQueue=D=F,v.pending=null}if(D!==null){F=D.next,S=S.baseState;var ue=J=null,Me=null,Ye=F;do{var ft=Ye.lane;if((Qa&ft)===ft)Me!==null&&(Me=Me.next={lane:0,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),S=Ye.hasEagerState?Ye.eagerState:c(S,Ye.action);else{var Gt={lane:ft,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null};Me===null?(ue=Me=Gt,J=S):Me=Me.next=Gt,oi.lanes|=ft,go|=ft}Ye=Ye.next}while(Ye!==null&&Ye!==F);Me===null?J=S:Me.next=ue,Fi(S,h.memoizedState)||(Gi=!0),h.memoizedState=S,h.baseState=J,h.baseQueue=Me,v.lastRenderedState=S}if(c=v.interleaved,c!==null){D=c;do F=D.lane,oi.lanes|=F,go|=F,D=D.next;while(D!==c)}else D===null&&(v.lanes=0);return[h.memoizedState,v.dispatch]}function Ju(c){var h=Xs(),v=h.queue;if(v===null)throw Error(a(311));v.lastRenderedReducer=c;var S=v.dispatch,D=v.pending,F=h.memoizedState;if(D!==null){v.pending=null;var J=D=D.next;do F=c(F,J.action),J=J.next;while(J!==D);Fi(F,h.memoizedState)||(Gi=!0),h.memoizedState=F,h.baseQueue===null&&(h.baseState=F),v.lastRenderedState=F}return[F,S]}function fd(){}function dd(c,h){var v=oi,S=Xs(),D=h(),F=!Fi(S.memoizedState,D);if(F&&(S.memoizedState=D,Gi=!0),S=S.queue,Ql(No.bind(null,v,S,c),[c]),S.getSnapshot!==h||F||Vi!==null&&Vi.memoizedState.tag&1){if(v.flags|=2048,tc(9,md.bind(null,v,S,D,h),void 0,null),pi===null)throw Error(a(349));(Qa&30)!==0||pd(v,h,D)}return D}function pd(c,h,v){c.flags|=16384,c={getSnapshot:h,value:v},h=oi.updateQueue,h===null?(h={lastEffect:null,stores:null},oi.updateQueue=h,h.stores=[c]):(v=h.stores,v===null?h.stores=[c]:v.push(c))}function md(c,h,v,S){h.value=v,h.getSnapshot=S,Ph(h)&&pr(c,1,-1)}function No(c,h,v){return v(function(){Ph(h)&&pr(c,1,-1)})}function Ph(c){var h=c.getSnapshot;c=c.value;try{var v=h();return!Fi(c,v)}catch{return!0}}function ec(c){var h=qs();return typeof c=="function"&&(c=c()),h.memoizedState=h.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:po,lastRenderedState:c},h.queue=c,c=c.dispatch=E_.bind(null,oi,c),[h.memoizedState,c]}function tc(c,h,v,S){return c={tag:c,create:h,destroy:v,deps:S,next:null},h=oi.updateQueue,h===null?(h={lastEffect:null,stores:null},oi.updateQueue=h,h.lastEffect=c.next=c):(v=h.lastEffect,v===null?h.lastEffect=c.next=c:(S=v.next,v.next=c,c.next=S,h.lastEffect=c)),c}function Pm(){return Xs().memoizedState}function xa(c,h,v,S){var D=qs();oi.flags|=c,D.memoizedState=tc(1|h,v,void 0,S===void 0?null:S)}function Ih(c,h,v,S){var D=Xs();S=S===void 0?null:S;var F=void 0;if(Bi!==null){var J=Bi.memoizedState;if(F=J.destroy,S!==null&&bh(S,J.deps)){D.memoizedState=tc(h,v,F,S);return}}oi.flags|=c,D.memoizedState=tc(1|h,v,F,S)}function Rh(c,h){return xa(8390656,8,c,h)}function Ql(c,h){return Ih(2048,8,c,h)}function Vn(c,h){return Ih(4,2,c,h)}function Dh(c,h){return Ih(4,4,c,h)}function nc(c,h){if(typeof h=="function")return c=c(),h(c),function(){h(null)};if(h!=null)return c=c(),h.current=c,function(){h.current=null}}function Kl(c,h,v){return v=v!=null?v.concat([c]):null,Ih(4,4,nc.bind(null,h,c),v)}function Lh(){}function Oh(c,h){var v=Xs();h=h===void 0?null:h;var S=v.memoizedState;return S!==null&&h!==null&&bh(h,S[1])?S[0]:(v.memoizedState=[c,h],c)}function Zl(c,h){var v=Xs();h=h===void 0?null:h;var S=v.memoizedState;return S!==null&&h!==null&&bh(h,S[1])?S[0]:(c=c(),v.memoizedState=[c,h],c)}function Nh(c,h){var v=jt;jt=v!==0&&4>v?v:4,c(!0);var S=as.transition;as.transition={};try{c(!1),h()}finally{jt=v,as.transition=S}}function Za(){return Xs().memoizedState}function Im(c,h,v){var S=Ks(c);v={lane:S,action:v,hasEagerState:!1,eagerState:null,next:null},Rm(c)?gd(h,v):(ic(c,h,v),v=xn(),c=pr(c,S,v),c!==null&&rc(c,h,S))}function E_(c,h,v){var S=Ks(c),D={lane:S,action:v,hasEagerState:!1,eagerState:null,next:null};if(Rm(c))gd(h,D);else{ic(c,h,D);var F=c.alternate;if(c.lanes===0&&(F===null||F.lanes===0)&&(F=h.lastRenderedReducer,F!==null))try{var J=h.lastRenderedState,ue=F(J,v);if(D.hasEagerState=!0,D.eagerState=ue,Fi(ue,J))return}catch{}finally{}v=xn(),c=pr(c,S,v),c!==null&&rc(c,h,S)}}function Rm(c){var h=c.alternate;return c===oi||h!==null&&h===oi}function gd(c,h){fo=Ah=!0;var v=c.pending;v===null?h.next=h:(h.next=v.next,v.next=h),c.pending=h}function ic(c,h,v){pi!==null&&(c.mode&1)!==0&&($t&2)===0?(c=h.interleaved,c===null?(v.next=v,Ui===null?Ui=[h]:Ui.push(h)):(v.next=c.next,c.next=v),h.interleaved=v):(c=h.pending,c===null?v.next=v:(v.next=c.next,c.next=v),h.pending=v)}function rc(c,h,v){if((v&4194240)!==0){var S=h.lanes;S&=c.pendingLanes,v|=S,h.lanes=v,Pi(c,v)}}var Jl={readContext:Ki,useCallback:Hi,useContext:Hi,useEffect:Hi,useImperativeHandle:Hi,useInsertionEffect:Hi,useLayoutEffect:Hi,useMemo:Hi,useReducer:Hi,useRef:Hi,useState:Hi,useDebugValue:Hi,useDeferredValue:Hi,useTransition:Hi,useMutableSource:Hi,useSyncExternalStore:Hi,useId:Hi,unstable_isNewReconciler:!1},_d={readContext:Ki,useCallback:function(c,h){return qs().memoizedState=[c,h===void 0?null:h],c},useContext:Ki,useEffect:Rh,useImperativeHandle:function(c,h,v){return v=v!=null?v.concat([c]):null,xa(4194308,4,nc.bind(null,h,c),v)},useLayoutEffect:function(c,h){return xa(4194308,4,c,h)},useInsertionEffect:function(c,h){return xa(4,2,c,h)},useMemo:function(c,h){var v=qs();return h=h===void 0?null:h,c=c(),v.memoizedState=[c,h],c},useReducer:function(c,h,v){var S=qs();return h=v!==void 0?v(h):h,S.memoizedState=S.baseState=h,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:h},S.queue=c,c=c.dispatch=Im.bind(null,oi,c),[S.memoizedState,c]},useRef:function(c){var h=qs();return c={current:c},h.memoizedState=c},useState:ec,useDebugValue:Lh,useDeferredValue:function(c){var h=ec(c),v=h[0],S=h[1];return Rh(function(){var D=as.transition;as.transition={};try{S(c)}finally{as.transition=D}},[c]),v},useTransition:function(){var c=ec(!1),h=c[0];return c=Nh.bind(null,c[1]),qs().memoizedState=c,[h,c]},useMutableSource:function(){},useSyncExternalStore:function(c,h,v){var S=oi,D=qs();if(cn){if(v===void 0)throw Error(a(407));v=v()}else{if(v=h(),pi===null)throw Error(a(349));(Qa&30)!==0||pd(S,h,v)}D.memoizedState=v;var F={value:v,getSnapshot:h};return D.queue=F,Rh(No.bind(null,S,F,c),[c]),S.flags|=2048,tc(9,md.bind(null,S,F,v,h),void 0,null),v},useId:function(){var c=qs(),h=pi.identifierPrefix;if(cn){var v=We,S=xe;v=(S&~(1<<32-Qi(S)-1)).toString(32)+v,h=":"+h+"R"+v,v=Ka++,0<v&&(h+="H"+v.toString(32)),h+=":"}else v=Ku++,h=":"+h+"r"+v.toString(32)+":";return c.memoizedState=h},unstable_isNewReconciler:!1},vd={readContext:Ki,useCallback:Oh,useContext:Ki,useEffect:Ql,useImperativeHandle:Kl,useInsertionEffect:Vn,useLayoutEffect:Dh,useMemo:Zl,useReducer:Zu,useRef:Pm,useState:function(){return Zu(po)},useDebugValue:Lh,useDeferredValue:function(c){var h=Zu(po),v=h[0],S=h[1];return Ql(function(){var D=as.transition;as.transition={};try{S(c)}finally{as.transition=D}},[c]),v},useTransition:function(){var c=Zu(po)[0],h=Xs().memoizedState;return[c,h]},useMutableSource:fd,useSyncExternalStore:dd,useId:Za,unstable_isNewReconciler:!1},yd={readContext:Ki,useCallback:Oh,useContext:Ki,useEffect:Ql,useImperativeHandle:Kl,useInsertionEffect:Vn,useLayoutEffect:Dh,useMemo:Zl,useReducer:Ju,useRef:Pm,useState:function(){return Ju(po)},useDebugValue:Lh,useDeferredValue:function(c){var h=Ju(po),v=h[0],S=h[1];return Ql(function(){var D=as.transition;as.transition={};try{S(c)}finally{as.transition=D}},[c]),v},useTransition:function(){var c=Ju(po)[0],h=Xs().memoizedState;return[c,h]},useMutableSource:fd,useSyncExternalStore:dd,useId:Za,unstable_isNewReconciler:!1};function xd(c,h){try{var v="",S=h;do v+=Bl(S),S=S.return;while(S);var D=v}catch(F){D=`
Error generating stack: `+F.message+`
`+F.stack}return{value:c,source:h,stack:D}}function kh(c,h){try{console.error(h.value)}catch(v){setTimeout(function(){throw v})}}var T_=typeof WeakMap=="function"?WeakMap:Map;function Dm(c,h,v){v=ss(-1,v),v.tag=3,v.payload={element:null};var S=h.value;return v.callback=function(){su||(su=!0,qn=S),kh(c,h)},v}function zh(c,h,v){v=ss(-1,v),v.tag=3;var S=c.type.getDerivedStateFromError;if(typeof S=="function"){var D=h.value;v.payload=function(){return S(D)},v.callback=function(){kh(c,h)}}var F=c.stateNode;return F!==null&&typeof F.componentDidCatch=="function"&&(v.callback=function(){kh(c,h),typeof S!="function"&&(Qs===null?Qs=new Set([this]):Qs.add(this));var J=h.stack;this.componentDidCatch(h.value,{componentStack:J!==null?J:""})}),v}function ko(c,h,v){var S=c.pingCache;if(S===null){S=c.pingCache=new T_;var D=new Set;S.set(h,D)}else D=S.get(h),D===void 0&&(D=new Set,S.set(h,D));D.has(v)||(D.add(v),c=Fd.bind(null,c,h,v),h.then(c,c))}function wd(c){do{var h;if((h=c.tag===13)&&(h=c.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return c;c=c.return}while(c!==null);return null}function Ja(c,h,v,S,D){return(c.mode&1)===0?(c===h?c.flags|=65536:(c.flags|=128,v.flags|=131072,v.flags&=-52805,v.tag===1&&(v.alternate===null?v.tag=17:(h=ss(-1,1),h.tag=2,Gs(v,h))),v.lanes|=1),c):(c.flags|=65536,c.lanes=D,c)}function Ri(c){c.flags|=4}function eu(c,h){if(c!==null&&c.child===h.child)return!0;if((h.flags&16)!==0)return!1;for(c=h.child;c!==null;){if((c.flags&12854)!==0||(c.subtreeFlags&12854)!==0)return!1;c=c.sibling}return!0}var ls,el,Fh,Uh;if(ut)ls=function(c,h){for(var v=h.child;v!==null;){if(v.tag===5||v.tag===6)$(c,v.stateNode);else if(v.tag!==4&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===h)break;for(;v.sibling===null;){if(v.return===null||v.return===h)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},el=function(){},Fh=function(c,h,v,S,D){if(c=c.memoizedProps,c!==S){var F=h.stateNode,J=js(Br.current);v=Ae(F,v,c,S,D,J),(h.updateQueue=v)&&Ri(h)}},Uh=function(c,h,v,S){v!==S&&Ri(h)};else if(De){ls=function(c,h,v,S){for(var D=h.child;D!==null;){if(D.tag===5){var F=D.stateNode;v&&S&&(F=_n(F,D.type,D.memoizedProps,D)),$(c,F)}else if(D.tag===6)F=D.stateNode,v&&S&&(F=Ci(F,D.memoizedProps,D)),$(c,F);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)F=D.child,F!==null&&(F.return=D),ls(c,D,!0,!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===h)break;for(;D.sibling===null;){if(D.return===null||D.return===h)return;D=D.return}D.sibling.return=D.return,D=D.sibling}};var wa=function(c,h,v,S){for(var D=h.child;D!==null;){if(D.tag===5){var F=D.stateNode;v&&S&&(F=_n(F,D.type,D.memoizedProps,D)),Wn(c,F)}else if(D.tag===6)F=D.stateNode,v&&S&&(F=Ci(F,D.memoizedProps,D)),Wn(c,F);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)F=D.child,F!==null&&(F.return=D),wa(c,D,!0,!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===h)break;for(;D.sibling===null;){if(D.return===null||D.return===h)return;D=D.return}D.sibling.return=D.return,D=D.sibling}};el=function(c,h){var v=h.stateNode;if(!eu(c,h)){c=v.containerInfo;var S=an(c);wa(S,h,!1,!1),v.pendingChildren=S,Ri(h),ri(c,S)}},Fh=function(c,h,v,S,D){var F=c.stateNode,J=c.memoizedProps;if((c=eu(c,h))&&J===S)h.stateNode=F;else{var ue=h.stateNode,Me=js(Br.current),Ye=null;J!==S&&(Ye=Ae(ue,v,J,S,D,Me)),c&&Ye===null?h.stateNode=F:(F=ct(F,Ye,v,J,S,h,c,ue),he(F,v,S,D,Me)&&Ri(h),h.stateNode=F,c?Ri(h):ls(F,h,!1,!1))}},Uh=function(c,h,v,S){v!==S?(c=js($a.current),v=js(Br.current),h.stateNode=Ne(S,c,v,h),Ri(h)):h.stateNode=c.stateNode}}else el=function(){},Fh=function(){},Uh=function(){};function zo(c,h){if(!cn)switch(c.tailMode){case"hidden":h=c.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?c.tail=null:v.sibling=null;break;case"collapsed":v=c.tail;for(var S=null;v!==null;)v.alternate!==null&&(S=v),v=v.sibling;S===null?h||c.tail===null?c.tail=null:c.tail.sibling=null:S.sibling=null}}function di(c){var h=c.alternate!==null&&c.alternate.child===c.child,v=0,S=0;if(h)for(var D=c.child;D!==null;)v|=D.lanes|D.childLanes,S|=D.subtreeFlags&14680064,S|=D.flags&14680064,D.return=c,D=D.sibling;else for(D=c.child;D!==null;)v|=D.lanes|D.childLanes,S|=D.subtreeFlags,S|=D.flags,D.return=c,D=D.sibling;return c.subtreeFlags|=S,c.childLanes=v,h}function Bh(c,h,v){var S=h.pendingProps;switch(yi(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return di(h),null;case 1:return bi(h.type)&&Us(),di(h),null;case 3:return S=h.stateNode,$l(),Ut(Ai),Ut(Qn),Ya(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(c===null||c.child===null)&&(Yu(h)?Ri(h):c===null||c.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,hr!==null&&(_c(hr),hr=null))),el(c,h),di(h),null;case 5:hd(h),v=js($a.current);var D=h.type;if(c!==null&&h.stateNode!=null)Fh(c,h,D,S,v),c.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!S){if(h.stateNode===null)throw Error(a(166));return di(h),null}if(c=js(Br.current),Yu(h)){if(!Le)throw Error(a(175));c=kt(h.stateNode,h.type,h.memoizedProps,v,c,h,!Ws),h.updateQueue=c,c!==null&&Ri(h)}else{var F=Q(D,S,v,c,h);ls(F,h,!1,!1),h.stateNode=F,he(F,D,S,v,c)&&Ri(h)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return di(h),null;case 6:if(c&&h.stateNode!=null)Uh(c,h,c.memoizedProps,S);else{if(typeof S!="string"&&h.stateNode===null)throw Error(a(166));if(c=js($a.current),v=js(Br.current),Yu(h)){if(!Le)throw Error(a(176));if(c=h.stateNode,S=h.memoizedProps,(v=Lt(c,S,h,!Ws))&&(D=yn,D!==null))switch(F=(D.mode&1)!==0,D.tag){case 3:ys(D.stateNode.containerInfo,c,S,F);break;case 5:Yn(D.type,D.memoizedProps,D.stateNode,c,S,F)}v&&Ri(h)}else h.stateNode=Ne(S,c,v,h)}return di(h),null;case 13:if(Ut(si),S=h.memoizedState,cn&&Zn!==null&&(h.mode&1)!==0&&(h.flags&128)===0){for(c=Zn;c;)c=Ee(c);return Wl(),h.flags|=98560,h}if(S!==null&&S.dehydrated!==null){if(S=Yu(h),c===null){if(!S)throw Error(a(318));if(!Le)throw Error(a(344));if(c=h.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(a(317));Ft(c,h)}else Wl(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;return di(h),null}return hr!==null&&(_c(hr),hr=null),(h.flags&128)!==0?(h.lanes=v,h):(S=S!==null,v=!1,c===null?Yu(h):v=c.memoizedState!==null,S&&!v&&(h.child.flags|=8192,(h.mode&1)!==0&&(c===null||(si.current&1)!==0?ui===0&&(ui=3):Xh())),h.updateQueue!==null&&(h.flags|=4),di(h),null);case 4:return $l(),el(c,h),c===null&&gt(h.stateNode.containerInfo),di(h),null;case 10:return ma(h.type._context),di(h),null;case 17:return bi(h.type)&&Us(),di(h),null;case 19:if(Ut(si),D=h.memoizedState,D===null)return di(h),null;if(S=(h.flags&128)!==0,F=D.rendering,F===null)if(S)zo(D,!1);else{if(ui!==0||c!==null&&(c.flags&128)!==0)for(c=h.child;c!==null;){if(F=Ch(c),F!==null){for(h.flags|=128,zo(D,!1),c=F.updateQueue,c!==null&&(h.updateQueue=c,h.flags|=4),h.subtreeFlags=0,c=v,S=h.child;S!==null;)v=S,D=c,v.flags&=14680066,F=v.alternate,F===null?(v.childLanes=0,v.lanes=D,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=F.childLanes,v.lanes=F.lanes,v.child=F.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=F.memoizedProps,v.memoizedState=F.memoizedState,v.updateQueue=F.updateQueue,v.type=F.type,D=F.dependencies,v.dependencies=D===null?null:{lanes:D.lanes,firstContext:D.firstContext}),S=S.sibling;return mn(si,si.current&1|2),h.child}c=c.sibling}D.tail!==null&&fi()>Ta&&(h.flags|=128,S=!0,zo(D,!1),h.lanes=4194304)}else{if(!S)if(c=Ch(F),c!==null){if(h.flags|=128,S=!0,c=c.updateQueue,c!==null&&(h.updateQueue=c,h.flags|=4),zo(D,!0),D.tail===null&&D.tailMode==="hidden"&&!F.alternate&&!cn)return di(h),null}else 2*fi()-D.renderingStartTime>Ta&&v!==1073741824&&(h.flags|=128,S=!0,zo(D,!1),h.lanes=4194304);D.isBackwards?(F.sibling=h.child,h.child=F):(c=D.last,c!==null?c.sibling=F:h.child=F,D.last=F)}return D.tail!==null?(h=D.tail,D.rendering=h,D.tail=h.sibling,D.renderingStartTime=fi(),h.sibling=null,c=si.current,mn(si,S?c&1|2:c&1),h):(di(h),null);case 22:case 23:return vc(),S=h.memoizedState!==null,c!==null&&c.memoizedState!==null!==S&&(h.flags|=8192),S&&(h.mode&1)!==0?(dr&1073741824)!==0&&(di(h),ut&&h.subtreeFlags&6&&(h.flags|=8192)):di(h),null;case 24:return null;case 25:return null}throw Error(a(156,h.tag))}var Sd=u.ReactCurrentOwner,Gi=!1;function li(c,h,v,S){h.child=c===null?Am(h,null,v,S):Oo(h,c.child,v,S)}function Hn(c,h,v,S,D){v=v.render;var F=h.ref;return ga(h,D),S=Yl(c,h,v,S,F,D),v=ya(),c!==null&&!Gi?(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~D,Vr(c,h,D)):(cn&&v&&un(h),h.flags|=1,li(c,h,S,D),h.child)}function Fn(c,h,v,S,D){if(c===null){var F=v.type;return typeof F=="function"&&!Yh(F)&&F.defaultProps===void 0&&v.compare===null&&v.defaultProps===void 0?(h.tag=15,h.type=F,Fo(c,h,F,S,D)):(c=Qh(v.type,null,S,h,h.mode,D),c.ref=h.ref,c.return=h,h.child=c)}if(F=c.child,(c.lanes&D)===0){var J=F.memoizedProps;if(v=v.compare,v=v!==null?v:ur,v(J,S)&&c.ref===h.ref)return Vr(c,h,D)}return h.flags|=1,c=Xo(F,S),c.ref=h.ref,c.return=h,h.child=c}function Fo(c,h,v,S,D){if(c!==null&&ur(c.memoizedProps,S)&&c.ref===h.ref)if(Gi=!1,(c.lanes&D)!==0)(c.flags&131072)!==0&&(Gi=!0);else return h.lanes=c.lanes,Vr(c,h,D);return Uo(c,h,v,S,D)}function Zi(c,h,v){var S=h.pendingProps,D=S.children,F=c!==null?c.memoizedState:null;if(S.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null},mn(ul,dr),dr|=v;else if((v&1073741824)!==0)h.memoizedState={baseLanes:0,cachePool:null},S=F!==null?F.baseLanes:v,mn(ul,dr),dr|=S;else return c=F!==null?F.baseLanes|v:v,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:c,cachePool:null},h.updateQueue=null,mn(ul,dr),dr|=c,null;else F!==null?(S=F.baseLanes|v,h.memoizedState=null):S=v,mn(ul,dr),dr|=S;return li(c,h,D,v),h.child}function br(c,h){var v=h.ref;(c===null&&v!==null||c!==null&&c.ref!==v)&&(h.flags|=512,h.flags|=2097152)}function Uo(c,h,v,S,D){var F=bi(v)?ns:Qn.current;return F=Fs(h,F),ga(h,D),v=Yl(c,h,v,S,F,D),S=ya(),c!==null&&!Gi?(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~D,Vr(c,h,D)):(cn&&S&&un(h),h.flags|=1,li(c,h,v,D),h.child)}function tl(c,h,v,S,D){if(bi(v)){var F=!0;ws(h)}else F=!1;if(ga(h,D),h.stateNode===null)c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2),qa(h,v,S),Gl(h,v,S,D),S=!0;else if(c===null){var J=h.stateNode,ue=h.memoizedProps;J.props=ue;var Me=J.context,Ye=v.contextType;typeof Ye=="object"&&Ye!==null?Ye=Ki(Ye):(Ye=bi(v)?ns:Qn.current,Ye=Fs(h,Ye));var ft=v.getDerivedStateFromProps,Gt=typeof ft=="function"||typeof J.getSnapshotBeforeUpdate=="function";Gt||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(ue!==S||Me!==Ye)&&cr(h,J,S,Ye),Cr=!1;var Dt=h.memoizedState;J.state=Dt,Wa(h,S,J,D),Me=h.memoizedState,ue!==S||Dt!==Me||Ai.current||Cr?(typeof ft=="function"&&(Vl(h,v,ft,S),Me=h.memoizedState),(ue=Cr||Hl(h,v,ue,S,Dt,Me,Ye))?(Gt||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(h.flags|=4194308)):(typeof J.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=S,h.memoizedState=Me),J.props=S,J.state=Me,J.context=Ye,S=ue):(typeof J.componentDidMount=="function"&&(h.flags|=4194308),S=!1)}else{J=h.stateNode,Ha(c,h),ue=h.memoizedProps,Ye=h.type===h.elementType?ue:Kn(h.type,ue),J.props=Ye,Gt=h.pendingProps,Dt=J.context,Me=v.contextType,typeof Me=="object"&&Me!==null?Me=Ki(Me):(Me=bi(v)?ns:Qn.current,Me=Fs(h,Me));var Zt=v.getDerivedStateFromProps;(ft=typeof Zt=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(ue!==Gt||Dt!==Me)&&cr(h,J,S,Me),Cr=!1,Dt=h.memoizedState,J.state=Dt,Wa(h,S,J,D);var ot=h.memoizedState;ue!==Gt||Dt!==ot||Ai.current||Cr?(typeof Zt=="function"&&(Vl(h,v,Zt,S),ot=h.memoizedState),(Ye=Cr||Hl(h,v,Ye,S,Dt,ot,Me)||!1)?(ft||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(S,ot,Me),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(S,ot,Me)),typeof J.componentDidUpdate=="function"&&(h.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof J.componentDidUpdate!="function"||ue===c.memoizedProps&&Dt===c.memoizedState||(h.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||ue===c.memoizedProps&&Dt===c.memoizedState||(h.flags|=1024),h.memoizedProps=S,h.memoizedState=ot),J.props=S,J.state=ot,J.context=Me,S=Ye):(typeof J.componentDidUpdate!="function"||ue===c.memoizedProps&&Dt===c.memoizedState||(h.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||ue===c.memoizedProps&&Dt===c.memoizedState||(h.flags|=1024),S=!1)}return fr(c,h,v,S,F,D)}function fr(c,h,v,S,D,F){br(c,h);var J=(h.flags&128)!==0;if(!S&&!J)return D&&Ur(h,v,!1),Vr(c,h,F);S=h.stateNode,Sd.current=h;var ue=J&&typeof v.getDerivedStateFromError!="function"?null:S.render();return h.flags|=1,c!==null&&J?(h.child=Oo(h,c.child,null,F),h.child=Oo(h,null,ue,F)):li(c,h,ue,F),h.memoizedState=S.state,D&&Ur(h,v,!0),h.child}function sc(c){var h=c.stateNode;h.pendingContext?ha(c,h.pendingContext,h.pendingContext!==h.context):h.context&&ha(c,h.context,!1),Mh(c,h.containerInfo)}function Ed(c,h,v,S,D){return Wl(),Th(D),h.flags|=256,li(c,h,v,S),h.child}var oc={dehydrated:null,treeContext:null,retryLane:0};function nl(c){return{baseLanes:c,cachePool:null}}function Td(c,h,v){var S=h.pendingProps,D=si.current,F=!1,J=(h.flags&128)!==0,ue;if((ue=J)||(ue=c!==null&&c.memoizedState===null?!1:(D&2)!==0),ue?(F=!0,h.flags&=-129):(c===null||c.memoizedState!==null)&&(D|=1),mn(si,D&1),c===null)return _a(h),c=h.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((h.mode&1)===0?h.lanes=1:Y(c)?h.lanes=8:h.lanes=1073741824,null):(D=S.children,c=S.fallback,F?(S=h.mode,F=h.child,D={mode:"hidden",children:D},(S&1)===0&&F!==null?(F.childLanes=0,F.pendingProps=D):F=wc(D,S,0,null),c=pl(c,S,v,null),F.return=h,c.return=h,F.sibling=c,h.child=F,h.child.memoizedState=nl(v),h.memoizedState=oc,c):$s(h,D));if(D=c.memoizedState,D!==null){if(ue=D.dehydrated,ue!==null){if(J)return h.flags&256?(h.flags&=-257,lc(c,h,v,Error(a(422)))):h.memoizedState!==null?(h.child=c.child,h.flags|=128,null):(F=S.fallback,D=h.mode,S=wc({mode:"visible",children:S.children},D,0,null),F=pl(F,D,v,null),F.flags|=2,S.return=h,F.return=h,S.sibling=F,h.child=S,(h.mode&1)!==0&&Oo(h,c.child,null,v),h.child.memoizedState=nl(v),h.memoizedState=oc,F);if((h.mode&1)===0)h=lc(c,h,v,null);else if(Y(ue))h=lc(c,h,v,Error(a(419)));else if(S=(v&c.childLanes)!==0,Gi||S){if(S=pi,S!==null){switch(v&-v){case 4:F=2;break;case 16:F=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:F=32;break;case 536870912:F=268435456;break;default:F=0}S=(F&(S.suspendedLanes|v))!==0?0:F,S!==0&&S!==D.retryLane&&(D.retryLane=S,pr(c,S,-1))}Xh(),h=lc(c,h,v,Error(a(421)))}else oo(ue)?(h.flags|=128,h.child=c.child,h=zm.bind(null,c),ge(ue,h),h=null):(v=D.treeContext,Le&&(Zn=Mt(ue),yn=h,cn=!0,hr=null,Ws=!1,v!==null&&(U[j++]=xe,U[j++]=We,U[j++]=fe,xe=v.id,We=v.overflow,fe=h)),h=$s(h,h.pendingProps.children),h.flags|=4096);return h}return F?(S=Vh(c,h,S.children,S.fallback,v),F=h.child,D=c.child.memoizedState,F.memoizedState=D===null?nl(v):{baseLanes:D.baseLanes|v,cachePool:null},F.childLanes=c.childLanes&~v,h.memoizedState=oc,S):(v=ac(c,h,S.children,v),h.memoizedState=null,v)}return F?(S=Vh(c,h,S.children,S.fallback,v),F=h.child,D=c.child.memoizedState,F.memoizedState=D===null?nl(v):{baseLanes:D.baseLanes|v,cachePool:null},F.childLanes=c.childLanes&~v,h.memoizedState=oc,S):(v=ac(c,h,S.children,v),h.memoizedState=null,v)}function $s(c,h){return h=wc({mode:"visible",children:h},c.mode,0,null),h.return=c,c.child=h}function ac(c,h,v,S){var D=c.child;return c=D.sibling,v=Xo(D,{mode:"visible",children:v}),(h.mode&1)===0&&(v.lanes=S),v.return=h,v.sibling=null,c!==null&&(S=h.deletions,S===null?(h.deletions=[c],h.flags|=16):S.push(c)),h.child=v}function Vh(c,h,v,S,D){var F=h.mode;c=c.child;var J=c.sibling,ue={mode:"hidden",children:v};return(F&1)===0&&h.child!==c?(v=h.child,v.childLanes=0,v.pendingProps=ue,h.deletions=null):(v=Xo(c,ue),v.subtreeFlags=c.subtreeFlags&14680064),J!==null?S=Xo(J,S):(S=pl(S,F,D,null),S.flags|=2),S.return=h,v.return=h,v.sibling=S,h.child=v,S}function lc(c,h,v,S){return S!==null&&Th(S),Oo(h,c.child,null,v),c=$s(h,h.pendingProps.children),c.flags|=2,h.memoizedState=null,c}function Lm(c,h,v){c.lanes|=h;var S=c.alternate;S!==null&&(S.lanes|=h),Ms(c.return,h,v)}function mo(c,h,v,S,D){var F=c.memoizedState;F===null?c.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:S,tail:v,tailMode:D}:(F.isBackwards=h,F.rendering=null,F.renderingStartTime=0,F.last=S,F.tail=v,F.tailMode=D)}function il(c,h,v){var S=h.pendingProps,D=S.revealOrder,F=S.tail;if(li(c,h,S.children,v),S=si.current,(S&2)!==0)S=S&1|2,h.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=h.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&Lm(c,v,h);else if(c.tag===19)Lm(c,v,h);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===h)break e;for(;c.sibling===null;){if(c.return===null||c.return===h)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}S&=1}if(mn(si,S),(h.mode&1)===0)h.memoizedState=null;else switch(D){case"forwards":for(v=h.child,D=null;v!==null;)c=v.alternate,c!==null&&Ch(c)===null&&(D=v),v=v.sibling;v=D,v===null?(D=h.child,h.child=null):(D=v.sibling,v.sibling=null),mo(h,!1,D,v,F);break;case"backwards":for(v=null,D=h.child,h.child=null;D!==null;){if(c=D.alternate,c!==null&&Ch(c)===null){h.child=D;break}c=D.sibling,D.sibling=v,v=D,D=c}mo(h,!0,v,null,F);break;case"together":mo(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Vr(c,h,v){if(c!==null&&(h.dependencies=c.dependencies),go|=h.lanes,(v&h.childLanes)===0)return null;if(c!==null&&h.child!==c.child)throw Error(a(153));if(h.child!==null){for(c=h.child,v=Xo(c,c.pendingProps),h.child=v,v.return=h;c.sibling!==null;)c=c.sibling,v=v.sibling=Xo(c,c.pendingProps),v.return=h;v.sibling=null}return h.child}function Hh(c,h,v){switch(h.tag){case 3:sc(h),Wl();break;case 5:bm(h);break;case 1:bi(h.type)&&ws(h);break;case 4:Mh(h,h.stateNode.containerInfo);break;case 10:Ts(h,h.type._context,h.memoizedProps.value);break;case 13:var S=h.memoizedState;if(S!==null)return S.dehydrated!==null?(mn(si,si.current&1),h.flags|=128,null):(v&h.child.childLanes)!==0?Td(c,h,v):(mn(si,si.current&1),c=Vr(c,h,v),c!==null?c.sibling:null);mn(si,si.current&1);break;case 19:if(S=(v&h.childLanes)!==0,(c.flags&128)!==0){if(S)return il(c,h,v);h.flags|=128}var D=h.memoizedState;if(D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),mn(si,si.current),S)break;return null;case 22:case 23:return h.lanes=0,Zi(c,h,v)}return Vr(c,h,v)}function Gh(c,h){switch(yi(h),h.tag){case 1:return bi(h.type)&&Us(),c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 3:return $l(),Ut(Ai),Ut(Qn),Ya(),c=h.flags,(c&65536)!==0&&(c&128)===0?(h.flags=c&-65537|128,h):null;case 5:return hd(h),null;case 13:if(Ut(si),c=h.memoizedState,c!==null&&c.dehydrated!==null){if(h.alternate===null)throw Error(a(340));Wl()}return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 19:return Ut(si),null;case 4:return $l(),null;case 10:return ma(h.type._context),null;case 22:case 23:return vc(),null;case 24:return null;default:return null}}var Pr=!1,Wi=!1,rl=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function Cs(c,h){var v=c.ref;if(v!==null)if(typeof v=="function")try{v(null)}catch(S){Rr(c,h,S)}else v.current=null}function Bo(c,h,v){try{v()}catch(S){Rr(c,h,S)}}var Md=!1;function Cd(c,h){for(oe(c.containerInfo),Ze=h;Ze!==null;)if(c=Ze,h=c.child,(c.subtreeFlags&1028)!==0&&h!==null)h.return=c,Ze=h;else for(;Ze!==null;){c=Ze;try{var v=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var S=v.memoizedProps,D=v.memoizedState,F=c.stateNode,J=F.getSnapshotBeforeUpdate(c.elementType===c.type?S:Kn(c.type,S),D);F.__reactInternalSnapshotBeforeUpdate=J}break;case 3:ut&&tt(c.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(ue){Rr(c,c.return,ue)}if(h=c.sibling,h!==null){h.return=c.return,Ze=h;break}Ze=c.return}return v=Md,Md=!1,v}function Vo(c,h,v){var S=h.updateQueue;if(S=S!==null?S.lastEffect:null,S!==null){var D=S=S.next;do{if((D.tag&c)===c){var F=D.destroy;D.destroy=void 0,F!==void 0&&Bo(h,v,F)}D=D.next}while(D!==S)}}function Ji(c,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var v=h=h.next;do{if((v.tag&c)===c){var S=v.create;v.destroy=S()}v=v.next}while(v!==h)}}function Ir(c){var h=c.ref;if(h!==null){var v=c.stateNode;switch(c.tag){case 5:c=ye(v);break;default:c=v}typeof h=="function"?h(c):h.current=c}}function jn(c,h,v){if(rs&&typeof rs.onCommitFiberUnmount=="function")try{rs.onCommitFiberUnmount(co,h)}catch{}switch(h.tag){case 0:case 11:case 14:case 15:if(c=h.updateQueue,c!==null&&(c=c.lastEffect,c!==null)){var S=c=c.next;do{var D=S,F=D.destroy;D=D.tag,F!==void 0&&((D&2)!==0||(D&4)!==0)&&Bo(h,v,F),S=S.next}while(S!==c)}break;case 1:if(Cs(h,v),c=h.stateNode,typeof c.componentWillUnmount=="function")try{c.props=h.memoizedProps,c.state=h.memoizedState,c.componentWillUnmount()}catch(J){Rr(h,v,J)}break;case 5:Cs(h,v);break;case 4:ut?Pd(c,h,v):De&&De&&(h=h.stateNode.containerInfo,v=an(h),Yi(h,v))}}function As(c,h,v){for(var S=h;;)if(jn(c,S,v),S.child===null||ut&&S.tag===4){if(S===h)break;for(;S.sibling===null;){if(S.return===null||S.return===h)return;S=S.return}S.sibling.return=S.return,S=S.sibling}else S.child.return=S,S=S.child}function Ad(c){var h=c.alternate;h!==null&&(c.alternate=null,Ad(h)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(h=c.stateNode,h!==null&&It(h)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function bd(c){return c.tag===5||c.tag===3||c.tag===4}function Wh(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||bd(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function jh(c){if(ut){e:{for(var h=c.return;h!==null;){if(bd(h))break e;h=h.return}throw Error(a(160))}var v=h;switch(v.tag){case 5:h=v.stateNode,v.flags&32&&(Cn(h),v.flags&=-33),v=Wh(c),tu(c,v,h);break;case 3:case 4:h=v.stateNode.containerInfo,v=Wh(c),qh(c,v,h);break;default:throw Error(a(161))}}}function qh(c,h,v){var S=c.tag;if(S===5||S===6)c=c.stateNode,h?bt(v,c,h):st(v,c);else if(S!==4&&(c=c.child,c!==null))for(qh(c,h,v),c=c.sibling;c!==null;)qh(c,h,v),c=c.sibling}function tu(c,h,v){var S=c.tag;if(S===5||S===6)c=c.stateNode,h?Rt(v,c,h):_t(v,c);else if(S!==4&&(c=c.child,c!==null))for(tu(c,h,v),c=c.sibling;c!==null;)tu(c,h,v),c=c.sibling}function Pd(c,h,v){for(var S=h,D=!1,F,J;;){if(!D){D=S.return;e:for(;;){if(D===null)throw Error(a(160));switch(F=D.stateNode,D.tag){case 5:J=!1;break e;case 3:F=F.containerInfo,J=!0;break e;case 4:F=F.containerInfo,J=!0;break e}D=D.return}D=!0}if(S.tag===5||S.tag===6)As(c,S,v),J?rn(F,S.stateNode):Tt(F,S.stateNode);else if(S.tag===18)J?_i(F,S.stateNode):Nn(F,S.stateNode);else if(S.tag===4){if(S.child!==null){F=S.stateNode.containerInfo,J=!0,S.child.return=S,S=S.child;continue}}else if(jn(c,S,v),S.child!==null){S.child.return=S,S=S.child;continue}if(S===h)break;for(;S.sibling===null;){if(S.return===null||S.return===h)return;S=S.return,S.tag===4&&(D=!1)}S.sibling.return=S.return,S=S.sibling}}function Sa(c,h){if(ut){switch(h.tag){case 0:case 11:case 14:case 15:Vo(3,h,h.return),Ji(3,h),Vo(5,h,h.return);return;case 1:return;case 5:var v=h.stateNode;if(v!=null){var S=h.memoizedProps;c=c!==null?c.memoizedProps:S;var D=h.type,F=h.updateQueue;h.updateQueue=null,F!==null&&ht(v,F,D,c,S,h)}return;case 6:if(h.stateNode===null)throw Error(a(162));v=h.memoizedProps,Re(h.stateNode,c!==null?c.memoizedProps:v,v);return;case 3:Le&&c!==null&&c.memoizedState.isDehydrated&&Qt(h.stateNode.containerInfo);return;case 12:return;case 13:nu(h);return;case 19:nu(h);return;case 17:return}throw Error(a(163))}switch(h.tag){case 0:case 11:case 14:case 15:Vo(3,h,h.return),Ji(3,h),Vo(5,h,h.return);return;case 12:return;case 13:nu(h);return;case 19:nu(h);return;case 3:Le&&c!==null&&c.memoizedState.isDehydrated&&Qt(h.stateNode.containerInfo);break;case 22:case 23:return}e:if(De){switch(h.tag){case 1:case 5:case 6:break e;case 3:case 4:h=h.stateNode,Yi(h.containerInfo,h.pendingChildren);break e}throw Error(a(163))}}function nu(c){var h=c.updateQueue;if(h!==null){c.updateQueue=null;var v=c.stateNode;v===null&&(v=c.stateNode=new rl),h.forEach(function(S){var D=Fm.bind(null,c,S);v.has(S)||(v.add(S),S.then(D,D))})}}function M_(c,h){for(Ze=h;Ze!==null;){h=Ze;var v=h.deletions;if(v!==null)for(var S=0;S<v.length;S++){var D=v[S];try{var F=c;ut?Pd(F,D,h):As(F,D,h);var J=D.alternate;J!==null&&(J.return=null),D.return=null}catch(wt){Rr(D,h,wt)}}if(v=h.child,(h.subtreeFlags&12854)!==0&&v!==null)v.return=h,Ze=v;else for(;Ze!==null;){h=Ze;try{var ue=h.flags;if(ue&32&&ut&&Cn(h.stateNode),ue&512){var Me=h.alternate;if(Me!==null){var Ye=Me.ref;Ye!==null&&(typeof Ye=="function"?Ye(null):Ye.current=null)}}if(ue&8192)switch(h.tag){case 13:if(h.memoizedState!==null){var ft=h.alternate;(ft===null||ft.memoizedState===null)&&(mc=fi())}break;case 22:var Gt=h.memoizedState!==null,Dt=h.alternate,Zt=Dt!==null&&Dt.memoizedState!==null;if(v=h,ut){e:if(S=v,D=Gt,F=null,ut)for(var ot=S;;){if(ot.tag===5){if(F===null){F=ot;var nr=ot.stateNode;D?Bn(nr):be(ot.stateNode,ot.memoizedProps)}}else if(ot.tag===6){if(F===null){var ds=ot.stateNode;D?le(ds):Fe(ds,ot.memoizedProps)}}else if((ot.tag!==22&&ot.tag!==23||ot.memoizedState===null||ot===S)&&ot.child!==null){ot.child.return=ot,ot=ot.child;continue}if(ot===S)break;for(;ot.sibling===null;){if(ot.return===null||ot.return===S)break e;F===ot&&(F=null),ot=ot.return}F===ot&&(F=null),ot.sibling.return=ot.return,ot=ot.sibling}}if(Gt&&!Zt&&(v.mode&1)!==0){Ze=v;for(var ve=v.child;ve!==null;){for(v=Ze=ve;Ze!==null;){S=Ze;var ce=S.child;switch(S.tag){case 0:case 11:case 14:case 15:Vo(4,S,S.return);break;case 1:Cs(S,S.return);var Te=S.stateNode;if(typeof Te.componentWillUnmount=="function"){var it=S.return;try{Te.props=S.memoizedProps,Te.state=S.memoizedState,Te.componentWillUnmount()}catch(wt){Rr(S,it,wt)}}break;case 5:Cs(S,S.return);break;case 22:if(S.memoizedState!==null){Rd(v);continue}}ce!==null?(ce.return=S,Ze=ce):Rd(v)}ve=ve.sibling}}}switch(ue&4102){case 2:jh(h),h.flags&=-3;break;case 6:jh(h),h.flags&=-3,Sa(h.alternate,h);break;case 4096:h.flags&=-4097;break;case 4100:h.flags&=-4097,Sa(h.alternate,h);break;case 4:Sa(h.alternate,h)}}catch(wt){Rr(h,h.return,wt)}if(v=h.sibling,v!==null){v.return=h.return,Ze=v;break}Ze=h.return}}}function uc(c,h,v){Ze=c,cc(c)}function cc(c,h,v){for(var S=(c.mode&1)!==0;Ze!==null;){var D=Ze,F=D.child;if(D.tag===22&&S){var J=D.memoizedState!==null||Pr;if(!J){var ue=D.alternate,Me=ue!==null&&ue.memoizedState!==null||Wi;ue=Pr;var Ye=Wi;if(Pr=J,(Wi=Me)&&!Ye)for(Ze=D;Ze!==null;)J=Ze,Me=J.child,J.tag===22&&J.memoizedState!==null?sl(D):Me!==null?(Me.return=J,Ze=Me):sl(D);for(;F!==null;)Ze=F,cc(F),F=F.sibling;Ze=D,Pr=ue,Wi=Ye}Id(c)}else(D.subtreeFlags&8772)!==0&&F!==null?(F.return=D,Ze=F):Id(c)}}function Id(c){for(;Ze!==null;){var h=Ze;if((h.flags&8772)!==0){var v=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:Wi||Ji(5,h);break;case 1:var S=h.stateNode;if(h.flags&4&&!Wi)if(v===null)S.componentDidMount();else{var D=h.elementType===h.type?v.memoizedProps:Kn(h.type,v.memoizedProps);S.componentDidUpdate(D,v.memoizedState,S.__reactInternalSnapshotBeforeUpdate)}var F=h.updateQueue;F!==null&&ho(h,F,S);break;case 3:var J=h.updateQueue;if(J!==null){if(v=null,h.child!==null)switch(h.child.tag){case 5:v=ye(h.child.stateNode);break;case 1:v=h.child.stateNode}ho(h,J,v)}break;case 5:var ue=h.stateNode;v===null&&h.flags&4&&Et(ue,h.type,h.memoizedProps,h);break;case 6:break;case 4:break;case 12:break;case 13:if(Le&&h.memoizedState===null){var Me=h.alternate;if(Me!==null){var Ye=Me.memoizedState;if(Ye!==null){var ft=Ye.dehydrated;ft!==null&&Kt(ft)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(a(163))}Wi||h.flags&512&&Ir(h)}catch(Gt){Rr(h,h.return,Gt)}}if(h===c){Ze=null;break}if(v=h.sibling,v!==null){v.return=h.return,Ze=v;break}Ze=h.return}}function Rd(c){for(;Ze!==null;){var h=Ze;if(h===c){Ze=null;break}var v=h.sibling;if(v!==null){v.return=h.return,Ze=v;break}Ze=h.return}}function sl(c){for(;Ze!==null;){var h=Ze;try{switch(h.tag){case 0:case 11:case 15:var v=h.return;try{Ji(4,h)}catch(Me){Rr(h,v,Me)}break;case 1:var S=h.stateNode;if(typeof S.componentDidMount=="function"){var D=h.return;try{S.componentDidMount()}catch(Me){Rr(h,D,Me)}}var F=h.return;try{Ir(h)}catch(Me){Rr(h,F,Me)}break;case 5:var J=h.return;try{Ir(h)}catch(Me){Rr(h,J,Me)}}}catch(Me){Rr(h,h.return,Me)}if(h===c){Ze=null;break}var ue=h.sibling;if(ue!==null){ue.return=h.return,Ze=ue;break}Ze=h.return}}var hc=0,ol=1,al=2,Ho=3,iu=4;if(typeof Symbol=="function"&&Symbol.for){var ll=Symbol.for;hc=ll("selector.component"),ol=ll("selector.has_pseudo_class"),al=ll("selector.role"),Ho=ll("selector.test_id"),iu=ll("selector.text")}function fc(c){var h=Qe(c);if(h!=null){if(typeof h.memoizedProps["data-testname"]!="string")throw Error(a(364));return h}if(c=tn(c),c===null)throw Error(a(362));return c.stateNode.current}function dc(c,h){switch(h.$$typeof){case hc:if(c.type===h.value)return!0;break;case ol:e:{h=h.value,c=[c,0];for(var v=0;v<c.length;){var S=c[v++],D=c[v++],F=h[D];if(S.tag!==5||!Se(S)){for(;F!=null&&dc(S,F);)D++,F=h[D];if(D===h.length){h=!0;break e}else for(S=S.child;S!==null;)c.push(S,D),S=S.sibling}}h=!1}return h;case al:if(c.tag===5&&$e(c.stateNode,h.value))return!0;break;case iu:if((c.tag===5||c.tag===6)&&(c=X(c),c!==null&&0<=c.indexOf(h.value)))return!0;break;case Ho:if(c.tag===5&&(c=c.memoizedProps["data-testname"],typeof c=="string"&&c.toLowerCase()===h.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function Ea(c){switch(c.$$typeof){case hc:return"<"+(k(c.value)||"Unknown")+">";case ol:return":has("+(Ea(c)||"")+")";case al:return'[role="'+c.value+'"]';case iu:return'"'+c.value+'"';case Ho:return'[data-testname="'+c.value+'"]';default:throw Error(a(365))}}function us(c,h){var v=[];c=[c,0];for(var S=0;S<c.length;){var D=c[S++],F=c[S++],J=h[F];if(D.tag!==5||!Se(D)){for(;J!=null&&dc(D,J);)F++,J=h[F];if(F===h.length)v.push(D);else for(D=D.child;D!==null;)c.push(D,F),D=D.sibling}}return v}function Go(c,h){if(!Yt)throw Error(a(363));c=fc(c),c=us(c,h),h=[],c=Array.from(c);for(var v=0;v<c.length;){var S=c[v++];if(S.tag===5)Se(S)||h.push(S.stateNode);else for(S=S.child;S!==null;)c.push(S),S=S.sibling}return h}var Dd=Math.ceil,pc=u.ReactCurrentDispatcher,Ys=u.ReactCurrentOwner,Dn=u.ReactCurrentBatchConfig,$t=0,pi=null,Ln=null,Jn=0,dr=0,ul=An(0),ui=0,ru=null,go=0,cs=0,cl=0,Wo=null,xi=null,mc=0,Ta=1/0;function hl(){Ta=fi()+500}var su=!1,qn=null,Qs=null,ou=!1,_o=null,fl=0,dl=0,jo=null,Gn=-1,ci=0;function xn(){return($t&6)!==0?fi():Gn!==-1?Gn:Gn=fi()}function Ks(c){return(c.mode&1)===0?1:($t&2)!==0&&Jn!==0?Jn&-Jn:Xu.transition!==null?(ci===0&&(c=Bs,Bs<<=1,(Bs&4194240)===0&&(Bs=64),ci=c),ci):(c=jt,c!==0?c:et())}function pr(c,h,v){if(50<dl)throw dl=0,jo=null,Error(a(185));var S=Ma(c,h);return S===null?null:(bo(S,h,v),(($t&2)===0||S!==pi)&&(S===pi&&(($t&2)===0&&(cs|=h),ui===4&&tr(S,Jn)),Hr(S,v),h===1&&$t===0&&(c.mode&1)===0&&(hl(),zn&&Tr())),S)}function Ma(c,h){c.lanes|=h;var v=c.alternate;for(v!==null&&(v.lanes|=h),v=c,c=c.return;c!==null;)c.childLanes|=h,v=c.alternate,v!==null&&(v.childLanes|=h),v=c,c=c.return;return v.tag===3?v.stateNode:null}function Hr(c,h){var v=c.callbackNode;Sh(c,h);var S=Ua(c,c===pi?Jn:0);if(S===0)v!==null&&is(v),c.callbackNode=null,c.callbackPriority=0;else if(h=S&-S,c.callbackPriority!==h){if(v!=null&&is(v),h===1)c.tag===0?Ba(hs.bind(null,c)):Ul(hs.bind(null,c)),At?Pt(function(){$t===0&&Tr()}):lo(ar,Tr),v=null;else{switch(Es(S)){case 1:v=ar;break;case 4:v=ld;break;case 16:v=Fl;break;case 536870912:v=Po;break;default:v=Fl}v=$h(v,er.bind(null,c))}c.callbackPriority=h,c.callbackNode=v}}function er(c,h){if(Gn=-1,ci=0,($t&6)!==0)throw Error(a(327));var v=c.callbackNode;if(vo()&&c.callbackNode!==v)return null;var S=Ua(c,c===pi?Jn:0);if(S===0)return null;if((S&30)!==0||(S&c.expiredLanes)!==0||h)h=yc(c,S);else{h=S;var D=$t;$t|=2;var F=Nd();(pi!==c||Jn!==h)&&(hl(),qo(c,h));do try{Nm();break}catch(ue){Od(c,ue)}while(!0);Ii(),pc.current=F,$t=D,Ln!==null?h=0:(pi=null,Jn=0,h=ui)}if(h!==0){if(h===2&&(D=kl(c),D!==0&&(S=D,h=gc(c,D))),h===1)throw v=ru,qo(c,0),tr(c,S),Hr(c,fi()),v;if(h===6)tr(c,S);else{if(D=c.current.alternate,(S&30)===0&&!Ld(D)&&(h=yc(c,S),h===2&&(F=kl(c),F!==0&&(S=F,h=gc(c,F))),h===1))throw v=ru,qo(c,0),tr(c,S),Hr(c,fi()),v;switch(c.finishedWork=D,c.finishedLanes=S,h){case 0:case 1:throw Error(a(345));case 2:Zs(c,xi);break;case 3:if(tr(c,S),(S&130023424)===S&&(h=mc+500-fi(),10<h)){if(Ua(c,0)!==0)break;if(D=c.suspendedLanes,(D&S)!==S){xn(),c.pingedLanes|=c.suspendedLanes&D;break}c.timeoutHandle=Oe(Zs.bind(null,c,xi),h);break}Zs(c,xi);break;case 4:if(tr(c,S),(S&4194240)===S)break;for(h=c.eventTimes,D=-1;0<S;){var J=31-Qi(S);F=1<<J,J=h[J],J>D&&(D=J),S&=~F}if(S=D,S=fi()-S,S=(120>S?120:480>S?480:1080>S?1080:1920>S?1920:3e3>S?3e3:4320>S?4320:1960*Dd(S/1960))-S,10<S){c.timeoutHandle=Oe(Zs.bind(null,c,xi),S);break}Zs(c,xi);break;case 5:Zs(c,xi);break;default:throw Error(a(329))}}}return Hr(c,fi()),c.callbackNode===v?er.bind(null,c):null}function gc(c,h){var v=Wo;return c.current.memoizedState.isDehydrated&&(qo(c,h).flags|=256),c=yc(c,h),c!==2&&(h=xi,xi=v,h!==null&&_c(h)),c}function _c(c){xi===null?xi=c:xi.push.apply(xi,c)}function Ld(c){for(var h=c;;){if(h.flags&16384){var v=h.updateQueue;if(v!==null&&(v=v.stores,v!==null))for(var S=0;S<v.length;S++){var D=v[S],F=D.getSnapshot;D=D.value;try{if(!Fi(F(),D))return!1}catch{return!1}}}if(v=h.child,h.subtreeFlags&16384&&v!==null)v.return=h,h=v;else{if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function tr(c,h){for(h&=~cl,h&=~cs,c.suspendedLanes|=h,c.pingedLanes&=~h,c=c.expirationTimes;0<h;){var v=31-Qi(h),S=1<<v;c[v]=-1,h&=~S}}function hs(c){if(($t&6)!==0)throw Error(a(327));vo();var h=Ua(c,0);if((h&1)===0)return Hr(c,fi()),null;var v=yc(c,h);if(c.tag!==0&&v===2){var S=kl(c);S!==0&&(h=S,v=gc(c,S))}if(v===1)throw v=ru,qo(c,0),tr(c,h),Hr(c,fi()),v;if(v===6)throw Error(a(345));return c.finishedWork=c.current.alternate,c.finishedLanes=h,Zs(c,xi),Hr(c,fi()),null}function au(c){_o!==null&&_o.tag===0&&($t&6)===0&&vo();var h=$t;$t|=1;var v=Dn.transition,S=jt;try{if(Dn.transition=null,jt=1,c)return c()}finally{jt=S,Dn.transition=v,$t=h,($t&6)===0&&Tr()}}function vc(){dr=ul.current,Ut(ul)}function qo(c,h){c.finishedWork=null,c.finishedLanes=0;var v=c.timeoutHandle;if(v!==Xe&&(c.timeoutHandle=Xe,He(v)),Ln!==null)for(v=Ln.return;v!==null;){var S=v;switch(yi(S),S.tag){case 1:S=S.type.childContextTypes,S!=null&&Us();break;case 3:$l(),Ut(Ai),Ut(Qn),Ya();break;case 5:hd(S);break;case 4:$l();break;case 13:Ut(si);break;case 19:Ut(si);break;case 10:ma(S.type._context);break;case 22:case 23:vc()}v=v.return}if(pi=c,Ln=c=Xo(c.current,null),Jn=dr=h,ui=0,ru=null,cl=cs=go=0,xi=Wo=null,Ui!==null){for(h=0;h<Ui.length;h++)if(v=Ui[h],S=v.interleaved,S!==null){v.interleaved=null;var D=S.next,F=v.pending;if(F!==null){var J=F.next;F.next=D,S.next=J}v.pending=S}Ui=null}return c}function Od(c,h){do{var v=Ln;try{if(Ii(),Qu.current=Jl,Ah){for(var S=oi.memoizedState;S!==null;){var D=S.queue;D!==null&&(D.pending=null),S=S.next}Ah=!1}if(Qa=0,Vi=Bi=oi=null,fo=!1,Ka=0,Ys.current=null,v===null||v.return===null){ui=1,ru=h,Ln=null;break}e:{var F=c,J=v.return,ue=v,Me=h;if(h=Jn,ue.flags|=32768,Me!==null&&typeof Me=="object"&&typeof Me.then=="function"){var Ye=Me,ft=ue,Gt=ft.tag;if((ft.mode&1)===0&&(Gt===0||Gt===11||Gt===15)){var Dt=ft.alternate;Dt?(ft.updateQueue=Dt.updateQueue,ft.memoizedState=Dt.memoizedState,ft.lanes=Dt.lanes):(ft.updateQueue=null,ft.memoizedState=null)}var Zt=wd(J);if(Zt!==null){Zt.flags&=-257,Ja(Zt,J,ue,F,h),Zt.mode&1&&ko(F,Ye,h),h=Zt,Me=Ye;var ot=h.updateQueue;if(ot===null){var nr=new Set;nr.add(Me),h.updateQueue=nr}else ot.add(Me);break e}else{if((h&1)===0){ko(F,Ye,h),Xh();break e}Me=Error(a(426))}}else if(cn&&ue.mode&1){var ds=wd(J);if(ds!==null){(ds.flags&65536)===0&&(ds.flags|=256),Ja(ds,J,ue,F,h),Th(Me);break e}}F=Me,ui!==4&&(ui=2),Wo===null?Wo=[F]:Wo.push(F),Me=xd(Me,ue),ue=J;do{switch(ue.tag){case 3:ue.flags|=65536,h&=-h,ue.lanes|=h;var ve=Dm(ue,Me,h);Ga(ue,ve);break e;case 1:F=Me;var ce=ue.type,Te=ue.stateNode;if((ue.flags&128)===0&&(typeof ce.getDerivedStateFromError=="function"||Te!==null&&typeof Te.componentDidCatch=="function"&&(Qs===null||!Qs.has(Te)))){ue.flags|=65536,h&=-h,ue.lanes|=h;var it=zh(ue,F,h);Ga(ue,it);break e}}ue=ue.return}while(ue!==null)}zd(v)}catch(wt){h=wt,Ln===v&&v!==null&&(Ln=v=v.return);continue}break}while(!0)}function Nd(){var c=pc.current;return pc.current=Jl,c===null?Jl:c}function Xh(){(ui===0||ui===3||ui===2)&&(ui=4),pi===null||(go&268435455)===0&&(cs&268435455)===0||tr(pi,Jn)}function yc(c,h){var v=$t;$t|=2;var S=Nd();pi===c&&Jn===h||qo(c,h);do try{Om();break}catch(D){Od(c,D)}while(!0);if(Ii(),$t=v,pc.current=S,Ln!==null)throw Error(a(261));return pi=null,Jn=0,ui}function Om(){for(;Ln!==null;)kd(Ln)}function Nm(){for(;Ln!==null&&!uo();)kd(Ln)}function kd(c){var h=Bd(c.alternate,c,dr);c.memoizedProps=c.pendingProps,h===null?zd(c):Ln=h,Ys.current=null}function zd(c){var h=c;do{var v=h.alternate;if(c=h.return,(h.flags&32768)===0){if(v=Bh(v,h,dr),v!==null){Ln=v;return}}else{if(v=Gh(v,h),v!==null){v.flags&=32767,Ln=v;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{ui=6,Ln=null;return}}if(h=h.sibling,h!==null){Ln=h;return}Ln=h=c}while(h!==null);ui===0&&(ui=5)}function Zs(c,h){var v=jt,S=Dn.transition;try{Dn.transition=null,jt=1,km(c,h,v)}finally{Dn.transition=S,jt=v}return null}function km(c,h,v){do vo();while(_o!==null);if(($t&6)!==0)throw Error(a(327));var S=c.finishedWork,D=c.finishedLanes;if(S===null)return null;if(c.finishedWork=null,c.finishedLanes=0,S===c.current)throw Error(a(177));c.callbackNode=null,c.callbackPriority=0;var F=S.lanes|S.childLanes;if(ao(c,F),c===pi&&(Ln=pi=null,Jn=0),(S.subtreeFlags&2064)===0&&(S.flags&2064)===0||ou||(ou=!0,$h(Fl,function(){return vo(),null})),F=(S.flags&15990)!==0,(S.subtreeFlags&15990)!==0||F){F=Dn.transition,Dn.transition=null;var J=jt;jt=1;var ue=$t;$t|=4,Ys.current=null,Cd(c,S),M_(c,S),ne(c.containerInfo),c.current=S,uc(S),ad(),$t=ue,jt=J,Dn.transition=F}else c.current=S;if(ou&&(ou=!1,_o=c,fl=D),F=c.pendingLanes,F===0&&(Qs=null),Vs(S.stateNode),Hr(c,fi()),h!==null)for(v=c.onRecoverableError,S=0;S<h.length;S++)v(h[S]);if(su)throw su=!1,c=qn,qn=null,c;return(fl&1)!==0&&c.tag!==0&&vo(),F=c.pendingLanes,(F&1)!==0?c===jo?dl++:(dl=0,jo=c):dl=0,Tr(),null}function vo(){if(_o!==null){var c=Es(fl),h=Dn.transition,v=jt;try{if(Dn.transition=null,jt=16>c?16:c,_o===null)var S=!1;else{if(c=_o,_o=null,fl=0,($t&6)!==0)throw Error(a(331));var D=$t;for($t|=4,Ze=c.current;Ze!==null;){var F=Ze,J=F.child;if((Ze.flags&16)!==0){var ue=F.deletions;if(ue!==null){for(var Me=0;Me<ue.length;Me++){var Ye=ue[Me];for(Ze=Ye;Ze!==null;){var ft=Ze;switch(ft.tag){case 0:case 11:case 15:Vo(8,ft,F)}var Gt=ft.child;if(Gt!==null)Gt.return=ft,Ze=Gt;else for(;Ze!==null;){ft=Ze;var Dt=ft.sibling,Zt=ft.return;if(Ad(ft),ft===Ye){Ze=null;break}if(Dt!==null){Dt.return=Zt,Ze=Dt;break}Ze=Zt}}}var ot=F.alternate;if(ot!==null){var nr=ot.child;if(nr!==null){ot.child=null;do{var ds=nr.sibling;nr.sibling=null,nr=ds}while(nr!==null)}}Ze=F}}if((F.subtreeFlags&2064)!==0&&J!==null)J.return=F,Ze=J;else e:for(;Ze!==null;){if(F=Ze,(F.flags&2048)!==0)switch(F.tag){case 0:case 11:case 15:Vo(9,F,F.return)}var ve=F.sibling;if(ve!==null){ve.return=F.return,Ze=ve;break e}Ze=F.return}}var ce=c.current;for(Ze=ce;Ze!==null;){J=Ze;var Te=J.child;if((J.subtreeFlags&2064)!==0&&Te!==null)Te.return=J,Ze=Te;else e:for(J=ce;Ze!==null;){if(ue=Ze,(ue.flags&2048)!==0)try{switch(ue.tag){case 0:case 11:case 15:Ji(9,ue)}}catch(wt){Rr(ue,ue.return,wt)}if(ue===J){Ze=null;break e}var it=ue.sibling;if(it!==null){it.return=ue.return,Ze=it;break e}Ze=ue.return}}if($t=D,Tr(),rs&&typeof rs.onPostCommitFiberRoot=="function")try{rs.onPostCommitFiberRoot(co,c)}catch{}S=!0}return S}finally{jt=v,Dn.transition=h}}return!1}function xc(c,h,v){h=xd(v,h),h=Dm(c,h,1),Gs(c,h),h=xn(),c=Ma(c,1),c!==null&&(bo(c,1,h),Hr(c,h))}function Rr(c,h,v){if(c.tag===3)xc(c,c,v);else for(;h!==null;){if(h.tag===3){xc(h,c,v);break}else if(h.tag===1){var S=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(Qs===null||!Qs.has(S))){c=xd(v,c),c=zh(h,c,1),Gs(h,c),c=xn(),h=Ma(h,1),h!==null&&(bo(h,1,c),Hr(h,c));break}}h=h.return}}function Fd(c,h,v){var S=c.pingCache;S!==null&&S.delete(h),h=xn(),c.pingedLanes|=c.suspendedLanes&v,pi===c&&(Jn&v)===v&&(ui===4||ui===3&&(Jn&130023424)===Jn&&500>fi()-mc?qo(c,0):cl|=v),Hr(c,h)}function Ud(c,h){h===0&&((c.mode&1)===0?h=1:(h=sn,sn<<=1,(sn&130023424)===0&&(sn=4194304)));var v=xn();c=Ma(c,h),c!==null&&(bo(c,h,v),Hr(c,v))}function zm(c){var h=c.memoizedState,v=0;h!==null&&(v=h.retryLane),Ud(c,v)}function Fm(c,h){var v=0;switch(c.tag){case 13:var S=c.stateNode,D=c.memoizedState;D!==null&&(v=D.retryLane);break;case 19:S=c.stateNode;break;default:throw Error(a(314))}S!==null&&S.delete(h),Ud(c,v)}var Bd;Bd=function(c,h,v){if(c!==null)if(c.memoizedProps!==h.pendingProps||Ai.current)Gi=!0;else{if((c.lanes&v)===0&&(h.flags&128)===0)return Gi=!1,Hh(c,h,v);Gi=(c.flags&131072)!==0}else Gi=!1,cn&&(h.flags&1048576)!==0&&vi(h,L,h.index);switch(h.lanes=0,h.tag){case 2:var S=h.type;c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2),c=h.pendingProps;var D=Fs(h,Qn.current);ga(h,v),D=Yl(null,h,S,c,D,v);var F=ya();return h.flags|=1,typeof D=="object"&&D!==null&&typeof D.render=="function"&&D.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,bi(S)?(F=!0,ws(h)):F=!1,h.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,Ro(h),D.updater=ja,h.stateNode=D,D._reactInternals=h,Gl(h,S,c,v),h=fr(null,h,S,!0,F,v)):(h.tag=0,cn&&F&&un(h),li(null,h,D,v),h=h.child),h;case 16:S=h.elementType;e:{switch(c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2),c=h.pendingProps,D=S._init,S=D(S._payload),h.type=S,D=h.tag=C_(S),c=Kn(S,c),D){case 0:h=Uo(null,h,S,c,v);break e;case 1:h=tl(null,h,S,c,v);break e;case 11:h=Hn(null,h,S,c,v);break e;case 14:h=Fn(null,h,S,Kn(S.type,c),v);break e}throw Error(a(306,S,""))}return h;case 0:return S=h.type,D=h.pendingProps,D=h.elementType===S?D:Kn(S,D),Uo(c,h,S,D,v);case 1:return S=h.type,D=h.pendingProps,D=h.elementType===S?D:Kn(S,D),tl(c,h,S,D,v);case 3:e:{if(sc(h),c===null)throw Error(a(387));S=h.pendingProps,F=h.memoizedState,D=F.element,Ha(c,h),Wa(h,S,null,v);var J=h.memoizedState;if(S=J.element,Le&&F.isDehydrated)if(F={element:S,isDehydrated:!1,cache:J.cache,transitions:J.transitions},h.updateQueue.baseState=F,h.memoizedState=F,h.flags&256){D=Error(a(423)),h=Ed(c,h,S,v,D);break e}else if(S!==D){D=Error(a(424)),h=Ed(c,h,S,v,D);break e}else for(Le&&(Zn=Ie(h.stateNode.containerInfo),yn=h,cn=!0,hr=null,Ws=!1),v=Am(h,null,S,v),h.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(Wl(),S===D){h=Vr(c,h,v);break e}li(c,h,S,v)}h=h.child}return h;case 5:return bm(h),c===null&&_a(h),S=h.type,D=h.pendingProps,F=c!==null?c.memoizedProps:null,J=D.children,se(S,D)?J=null:F!==null&&se(S,F)&&(h.flags|=32),br(c,h),li(c,h,J,v),h.child;case 6:return c===null&&_a(h),null;case 13:return Td(c,h,v);case 4:return Mh(h,h.stateNode.containerInfo),S=h.pendingProps,c===null?h.child=Oo(h,null,S,v):li(c,h,S,v),h.child;case 11:return S=h.type,D=h.pendingProps,D=h.elementType===S?D:Kn(S,D),Hn(c,h,S,D,v);case 7:return li(c,h,h.pendingProps,v),h.child;case 8:return li(c,h,h.pendingProps.children,v),h.child;case 12:return li(c,h,h.pendingProps.children,v),h.child;case 10:e:{if(S=h.type._context,D=h.pendingProps,F=h.memoizedProps,J=D.value,Ts(h,S,J),F!==null)if(Fi(F.value,J)){if(F.children===D.children&&!Ai.current){h=Vr(c,h,v);break e}}else for(F=h.child,F!==null&&(F.return=h);F!==null;){var ue=F.dependencies;if(ue!==null){J=F.child;for(var Me=ue.firstContext;Me!==null;){if(Me.context===S){if(F.tag===1){Me=ss(-1,v&-v),Me.tag=2;var Ye=F.updateQueue;if(Ye!==null){Ye=Ye.shared;var ft=Ye.pending;ft===null?Me.next=Me:(Me.next=ft.next,ft.next=Me),Ye.pending=Me}}F.lanes|=v,Me=F.alternate,Me!==null&&(Me.lanes|=v),Ms(F.return,v,h),ue.lanes|=v;break}Me=Me.next}}else if(F.tag===10)J=F.type===h.type?null:F.child;else if(F.tag===18){if(J=F.return,J===null)throw Error(a(341));J.lanes|=v,ue=J.alternate,ue!==null&&(ue.lanes|=v),Ms(J,v,h),J=F.sibling}else J=F.child;if(J!==null)J.return=F;else for(J=F;J!==null;){if(J===h){J=null;break}if(F=J.sibling,F!==null){F.return=J.return,J=F;break}J=J.return}F=J}li(c,h,D.children,v),h=h.child}return h;case 9:return D=h.type,S=h.pendingProps.children,ga(h,v),D=Ki(D),S=S(D),h.flags|=1,li(c,h,S,v),h.child;case 14:return S=h.type,D=Kn(S,h.pendingProps),D=Kn(S.type,D),Fn(c,h,S,D,v);case 15:return Fo(c,h,h.type,h.pendingProps,v);case 17:return S=h.type,D=h.pendingProps,D=h.elementType===S?D:Kn(S,D),c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2),h.tag=1,bi(S)?(c=!0,ws(h)):c=!1,ga(h,v),qa(h,S,D),Gl(h,S,D,v),fr(null,h,S,!0,c,v);case 19:return il(c,h,v);case 22:return Zi(c,h,v)}throw Error(a(156,h.tag))};function $h(c,h){return lo(c,h)}function Um(c,h,v,S){this.tag=c,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fs(c,h,v,S){return new Um(c,h,v,S)}function Yh(c){return c=c.prototype,!(!c||!c.isReactComponent)}function C_(c){if(typeof c=="function")return Yh(c)?1:0;if(c!=null){if(c=c.$$typeof,c===E)return 11;if(c===C)return 14}return 2}function Xo(c,h){var v=c.alternate;return v===null?(v=fs(c.tag,h,c.key,c.mode),v.elementType=c.elementType,v.type=c.type,v.stateNode=c.stateNode,v.alternate=c,c.alternate=v):(v.pendingProps=h,v.type=c.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=c.flags&14680064,v.childLanes=c.childLanes,v.lanes=c.lanes,v.child=c.child,v.memoizedProps=c.memoizedProps,v.memoizedState=c.memoizedState,v.updateQueue=c.updateQueue,h=c.dependencies,v.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},v.sibling=c.sibling,v.index=c.index,v.ref=c.ref,v}function Qh(c,h,v,S,D,F){var J=2;if(S=c,typeof c=="function")Yh(c)&&(J=1);else if(typeof c=="string")J=5;else e:switch(c){case m:return pl(v.children,D,F,h);case _:J=8,D|=8;break;case y:return c=fs(12,v,h,D|2),c.elementType=y,c.lanes=F,c;case M:return c=fs(13,v,h,D),c.elementType=M,c.lanes=F,c;case P:return c=fs(19,v,h,D),c.elementType=P,c.lanes=F,c;case R:return wc(v,D,F,h);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case w:J=10;break e;case T:J=9;break e;case E:J=11;break e;case C:J=14;break e;case b:J=16,S=null;break e}throw Error(a(130,c==null?c:typeof c,""))}return h=fs(J,v,h,D),h.elementType=c,h.type=S,h.lanes=F,h}function pl(c,h,v,S){return c=fs(7,c,S,h),c.lanes=v,c}function wc(c,h,v,S){return c=fs(22,c,S,h),c.elementType=R,c.lanes=v,c.stateNode={},c}function Kh(c,h,v){return c=fs(6,c,null,h),c.lanes=v,c}function Zh(c,h,v){return h=fs(4,c.children!==null?c.children:[],c.key,h),h.lanes=v,h.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},h}function Jh(c,h,v,S,D){this.tag=h,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Xe,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zl(0),this.expirationTimes=zl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zl(0),this.identifierPrefix=S,this.onRecoverableError=D,Le&&(this.mutableSourceEagerHydrationData=null)}function Bm(c,h,v,S,D,F,J,ue,Me){return c=new Jh(c,h,v,ue,Me),h===1?(h=1,F===!0&&(h|=8)):h=0,F=fs(3,null,null,h),c.current=F,F.stateNode=c,F.memoizedState={element:S,isDehydrated:v,cache:null,transitions:null},Ro(F),c}function Vm(c){if(!c)return ln;c=c._reactInternals;e:{if(N(c)!==c||c.tag!==1)throw Error(a(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(bi(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(a(171))}if(c.tag===1){var v=c.type;if(bi(v))return wh(c,v,h)}return h}function Hm(c){var h=c._reactInternals;if(h===void 0)throw typeof c.render=="function"?Error(a(188)):(c=Object.keys(c).join(","),Error(a(268,c)));return c=q(h),c===null?null:c.stateNode}function bs(c,h){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var v=c.retryLane;c.retryLane=v!==0&&v<h?v:h}}function Sc(c,h){bs(c,h),(c=c.alternate)&&bs(c,h)}function ef(c){return c=q(c),c===null?null:c.stateNode}function Gm(){return null}return t.attemptContinuousHydration=function(c){if(c.tag===13){var h=xn();pr(c,134217728,h),Sc(c,134217728)}},t.attemptHydrationAtCurrentPriority=function(c){if(c.tag===13){var h=xn(),v=Ks(c);pr(c,v,h),Sc(c,v)}},t.attemptSynchronousHydration=function(c){switch(c.tag){case 3:var h=c.stateNode;if(h.current.memoizedState.isDehydrated){var v=Ss(h.pendingLanes);v!==0&&(Pi(h,v|1),Hr(h,fi()),($t&6)===0&&(hl(),Tr()))}break;case 13:var S=xn();au(function(){return pr(c,1,S)}),Sc(c,1)}},t.batchedUpdates=function(c,h){var v=$t;$t|=1;try{return c(h)}finally{$t=v,$t===0&&(hl(),zn&&Tr())}},t.createComponentSelector=function(c){return{$$typeof:hc,value:c}},t.createContainer=function(c,h,v,S,D,F,J){return Bm(c,h,!1,null,v,S,D,F,J)},t.createHasPseudoClassSelector=function(c){return{$$typeof:ol,value:c}},t.createHydrationContainer=function(c,h,v,S,D,F,J,ue,Me){return c=Bm(v,S,!0,c,D,F,J,ue,Me),c.context=Vm(null),v=c.current,S=xn(),D=Ks(v),F=ss(S,D),F.callback=h??null,Gs(v,F),c.current.lanes=D,bo(c,D,S),Hr(c,S),c},t.createPortal=function(c,h,v){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:S==null?null:""+S,children:c,containerInfo:h,implementation:v}},t.createRoleSelector=function(c){return{$$typeof:al,value:c}},t.createTestNameSelector=function(c){return{$$typeof:Ho,value:c}},t.createTextSelector=function(c){return{$$typeof:iu,value:c}},t.deferredUpdates=function(c){var h=jt,v=Dn.transition;try{return Dn.transition=null,jt=16,c()}finally{jt=h,Dn.transition=v}},t.discreteUpdates=function(c,h,v,S,D){var F=jt,J=Dn.transition;try{return Dn.transition=null,jt=1,c(h,v,S,D)}finally{jt=F,Dn.transition=J,$t===0&&hl()}},t.findAllNodes=Go,t.findBoundingRects=function(c,h){if(!Yt)throw Error(a(363));h=Go(c,h),c=[];for(var v=0;v<h.length;v++)c.push(ee(h[v]));for(h=c.length-1;0<h;h--){v=c[h];for(var S=v.x,D=S+v.width,F=v.y,J=F+v.height,ue=h-1;0<=ue;ue--)if(h!==ue){var Me=c[ue],Ye=Me.x,ft=Ye+Me.width,Gt=Me.y,Dt=Gt+Me.height;if(S>=Ye&&F>=Gt&&D<=ft&&J<=Dt){c.splice(h,1);break}else if(S!==Ye||v.width!==Me.width||Dt<F||Gt>J){if(!(F!==Gt||v.height!==Me.height||ft<S||Ye>D)){Ye>S&&(Me.width+=Ye-S,Me.x=S),ft<D&&(Me.width=D-Ye),c.splice(h,1);break}}else{Gt>F&&(Me.height+=Gt-F,Me.y=F),Dt<J&&(Me.height=J-Gt),c.splice(h,1);break}}}return c},t.findHostInstance=Hm,t.findHostInstanceWithNoPortals=function(c){return c=W(c),c=c!==null?re(c):null,c===null?null:c.stateNode},t.findHostInstanceWithWarning=function(c){return Hm(c)},t.flushControlled=function(c){var h=$t;$t|=1;var v=Dn.transition,S=jt;try{Dn.transition=null,jt=1,c()}finally{jt=S,Dn.transition=v,$t=h,$t===0&&(hl(),Tr())}},t.flushPassiveEffects=vo,t.flushSync=au,t.focusWithin=function(c,h){if(!Yt)throw Error(a(363));for(c=fc(c),h=us(c,h),h=Array.from(h),c=0;c<h.length;){var v=h[c++];if(!Se(v)){if(v.tag===5&&Ue(v.stateNode))return!0;for(v=v.child;v!==null;)h.push(v),v=v.sibling}}return!1},t.getCurrentUpdatePriority=function(){return jt},t.getFindAllNodesFailureDescription=function(c,h){if(!Yt)throw Error(a(363));var v=0,S=[];c=[fc(c),0];for(var D=0;D<c.length;){var F=c[D++],J=c[D++],ue=h[J];if((F.tag!==5||!Se(F))&&(dc(F,ue)&&(S.push(Ea(ue)),J++,J>v&&(v=J)),J<h.length))for(F=F.child;F!==null;)c.push(F,J),F=F.sibling}if(v<h.length){for(c=[];v<h.length;v++)c.push(Ea(h[v]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+c.join(" > ")}return null},t.getPublicRootInstance=function(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return ye(c.child.stateNode);default:return c.child.stateNode}},t.injectIntoDevTools=function(c){if(c={bundleType:c.bundleType,version:c.version,rendererPackageName:c.rendererPackageName,rendererConfig:c.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:u.ReactCurrentDispatcher,findHostInstanceByFiber:ef,findFiberByHostInstance:c.findFiberByHostInstance||Gm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")c=!1;else{var h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(h.isDisabled||!h.supportsFiber)c=!0;else{try{co=h.inject(c),rs=h}catch{}c=!!h.checkDCE}}return c},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(c,h,v,S){if(!Yt)throw Error(a(363));c=Go(c,h);var D=je(c,v,S).disconnect;return{disconnect:function(){D()}}},t.registerMutableSourceForHydration=function(c,h){var v=h._getVersion;v=v(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,v]:c.mutableSourceEagerHydrationData.push(h,v)},t.runWithPriority=function(c,h){var v=jt;try{return jt=c,h()}finally{jt=v}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(c,h,v,S){var D=h.current,F=xn(),J=Ks(D);return v=Vm(v),h.context===null?h.context=v:h.pendingContext=v,h=ss(F,J),h.payload={element:c},S=S===void 0?null:S,S!==null&&(h.callback=S),Gs(D,h),c=pr(D,J,F),c!==null&&Do(c,D,J),J},t}),Fv}var nE;function kN(){return nE||(nE=1,Nv.exports=NN()),Nv.exports}var zN=kN();const FN=BT(zN);var iE=XC();const s1={},$C=r=>void Object.assign(s1,r);function UN(r,e){function t(m,{args:_=[],attach:y,...w},T){let E=`${m[0].toUpperCase()}${m.slice(1)}`,M;if(m==="primitive"){if(w.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const P=w.object;M=If(P,{type:m,root:T,attach:y,primitive:!0})}else{const P=s1[E];if(!P)throw new Error(`R3F: ${E} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(_))throw new Error("R3F: The args prop must be an array!");M=If(new P(..._),{type:m,root:T,attach:y,memoizedProps:{args:_}})}return M.__r3f.attach===void 0&&(M.isBufferGeometry?M.__r3f.attach="geometry":M.isMaterial&&(M.__r3f.attach="material")),E!=="inject"&&Vv(M,w),M}function n(m,_){let y=!1;if(_){var w,T;(w=_.__r3f)!=null&&w.attach?Bv(m,_,_.__r3f.attach):_.isObject3D&&m.isObject3D&&(m.add(_),y=!0),y||(T=m.__r3f)==null||T.objects.push(_),_.__r3f||If(_,{}),_.__r3f.parent=m,Zy(_),Rf(_)}}function i(m,_,y){let w=!1;if(_){var T,E;if((T=_.__r3f)!=null&&T.attach)Bv(m,_,_.__r3f.attach);else if(_.isObject3D&&m.isObject3D){_.parent=m,_.dispatchEvent({type:"added"}),m.dispatchEvent({type:"childadded",child:_});const M=m.children.filter(C=>C!==_),P=M.indexOf(y);m.children=[...M.slice(0,P),_,...M.slice(P)],w=!0}w||(E=m.__r3f)==null||E.objects.push(_),_.__r3f||If(_,{}),_.__r3f.parent=m,Zy(_),Rf(_)}}function s(m,_,y=!1){m&&[...m].forEach(w=>a(_,w,y))}function a(m,_,y){if(_){var w,T,E;if(_.__r3f&&(_.__r3f.parent=null),(w=m.__r3f)!=null&&w.objects&&(m.__r3f.objects=m.__r3f.objects.filter(R=>R!==_)),(T=_.__r3f)!=null&&T.attach)lE(m,_,_.__r3f.attach);else if(_.isObject3D&&m.isObject3D){var M;m.remove(_),(M=_.__r3f)!=null&&M.root&&XN(m0(_),_)}const C=(E=_.__r3f)==null?void 0:E.primitive,b=!C&&(y===void 0?_.dispose!==null:y);if(!C){var P;s((P=_.__r3f)==null?void 0:P.objects,_,b),s(_.children,_,b)}if(delete _.__r3f,b&&_.dispose&&_.type!=="Scene"){const R=()=>{try{_.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?iE.unstable_scheduleCallback(iE.unstable_IdlePriority,R):R()}Rf(m)}}function u(m,_,y,w){var T;const E=(T=m.__r3f)==null?void 0:T.parent;if(!E)return;const M=t(_,y,m.__r3f.root);if(m.children){for(const P of m.children)P.__r3f&&n(M,P);m.children=m.children.filter(P=>!P.__r3f)}m.__r3f.objects.forEach(P=>n(M,P)),m.__r3f.objects=[],m.__r3f.autoRemovedBeforeAppend||a(E,m),M.parent&&(M.__r3f.autoRemovedBeforeAppend=!0),n(E,M),M.raycast&&M.__r3f.eventCount&&m0(M).getState().internal.interaction.push(M),[w,w.alternate].forEach(P=>{P!==null&&(P.stateNode=M,P.ref&&(typeof P.ref=="function"?P.ref(M):P.ref.current=M))})}const f=()=>{};return{reconciler:FN({createInstance:t,removeChild:a,appendChild:n,appendInitialChild:n,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(m,_)=>{if(!_)return;const y=m.getState().scene;y.__r3f&&(y.__r3f.root=m,n(y,_))},removeChildFromContainer:(m,_)=>{_&&a(m.getState().scene,_)},insertInContainerBefore:(m,_,y)=>{if(!_||!y)return;const w=m.getState().scene;w.__r3f&&i(w,_,y)},getRootHostContext:()=>null,getChildHostContext:m=>m,finalizeInitialChildren(m){var _;return!!((_=m==null?void 0:m.__r3f)!=null?_:{}).handlers},prepareUpdate(m,_,y,w){var T;if(((T=m==null?void 0:m.__r3f)!=null?T:{}).primitive&&w.object&&w.object!==m)return[!0];{const{args:M=[],children:P,...C}=w,{args:b=[],children:R,...z}=y;if(!Array.isArray(M))throw new Error("R3F: the args prop must be an array!");if(M.some((k,I)=>k!==b[I]))return[!0];const B=t2(m,C,z,!0);return B.changes.length?[!1,B]:null}},commitUpdate(m,[_,y],w,T,E,M){_?u(m,w,E,M):Vv(m,y)},commitMount(m,_,y,w){var T;const E=(T=m.__r3f)!=null?T:{};m.raycast&&E.handlers&&E.eventCount&&m0(m).getState().internal.interaction.push(m)},getPublicInstance:m=>m,prepareForCommit:()=>null,preparePortalMount:m=>If(m.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(m){var _;const{attach:y,parent:w}=(_=m.__r3f)!=null?_:{};y&&w&&lE(w,m,y),m.isObject3D&&(m.visible=!1),Rf(m)},unhideInstance(m,_){var y;const{attach:w,parent:T}=(y=m.__r3f)!=null?y:{};w&&T&&Bv(T,m,w),(m.isObject3D&&_.visible==null||_.visible)&&(m.visible=!0),Rf(m)},createTextInstance:f,hideTextInstance:f,unhideTextInstance:f,getCurrentEventPriority:()=>e?e():Ff.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&ni.fun(performance.now)?performance.now:ni.fun(Date.now)?Date.now:()=>0,scheduleTimeout:ni.fun(setTimeout)?setTimeout:void 0,cancelTimeout:ni.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Vv}}var rE,sE;const Uv=r=>"colorSpace"in r||"outputColorSpace"in r,YC=()=>{var r;return(r=s1.ColorManagement)!=null?r:null},QC=r=>r&&r.isOrthographicCamera,BN=r=>r&&r.hasOwnProperty("current"),_m=typeof window<"u"&&((rE=window.document)!=null&&rE.createElement||((sE=window.navigator)==null?void 0:sE.product)==="ReactNative")?at.useLayoutEffect:at.useEffect;function KC(r){const e=at.useRef(r);return _m(()=>void(e.current=r),[r]),e}function VN({set:r}){return _m(()=>(r(new Promise(()=>null)),()=>r(!1)),[r]),null}class ZC extends at.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}ZC.getDerivedStateFromError=()=>({error:!0});const JC="__default",oE=new Map,HN=r=>r&&!!r.memoized&&!!r.changes;function e2(r){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(r)?Math.min(Math.max(r[0],t),r[1]):r}const ap=r=>{var e;return(e=r.__r3f)==null?void 0:e.root.getState()};function m0(r){let e=r.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const ni={obj:r=>r===Object(r)&&!ni.arr(r)&&typeof r!="function",fun:r=>typeof r=="function",str:r=>typeof r=="string",num:r=>typeof r=="number",boo:r=>typeof r=="boolean",und:r=>r===void 0,arr:r=>Array.isArray(r),equ(r,e,{arrays:t="shallow",objects:n="reference",strict:i=!0}={}){if(typeof r!=typeof e||!!r!=!!e)return!1;if(ni.str(r)||ni.num(r)||ni.boo(r))return r===e;const s=ni.obj(r);if(s&&n==="reference")return r===e;const a=ni.arr(r);if(a&&t==="reference")return r===e;if((a||s)&&r===e)return!0;let u;for(u in r)if(!(u in e))return!1;if(s&&t==="shallow"&&n==="shallow"){for(u in i?e:r)if(!ni.equ(r[u],e[u],{strict:i,objects:"reference"}))return!1}else for(u in i?e:r)if(r[u]!==e[u])return!1;if(ni.und(u)){if(a&&r.length===0&&e.length===0||s&&Object.keys(r).length===0&&Object.keys(e).length===0)return!0;if(r!==e)return!1}return!0}};function GN(r){const e={nodes:{},materials:{}};return r&&r.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function WN(r){r.dispose&&r.type!=="Scene"&&r.dispose();for(const e in r)e.dispose==null||e.dispose(),delete r[e]}function If(r,e){const t=r;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},r}function Ky(r,e){let t=r;if(e.includes("-")){const n=e.split("-"),i=n.pop();return t=n.reduce((s,a)=>s[a],r),{target:t,key:i}}else return{target:t,key:e}}const aE=/-\d+$/;function Bv(r,e,t){if(ni.str(t)){if(aE.test(t)){const s=t.replace(aE,""),{target:a,key:u}=Ky(r,s);Array.isArray(a[u])||(a[u]=[])}const{target:n,key:i}=Ky(r,t);e.__r3f.previousAttach=n[i],n[i]=e}else e.__r3f.previousAttach=t(r,e)}function lE(r,e,t){var n,i;if(ni.str(t)){const{target:s,key:a}=Ky(r,t),u=e.__r3f.previousAttach;u===void 0?delete s[a]:s[a]=u}else(n=e.__r3f)==null||n.previousAttach==null||n.previousAttach(r,e);(i=e.__r3f)==null||delete i.previousAttach}function t2(r,{children:e,key:t,ref:n,...i},{children:s,key:a,ref:u,...f}={},d=!1){const m=r.__r3f,_=Object.entries(i),y=[];if(d){const T=Object.keys(f);for(let E=0;E<T.length;E++)i.hasOwnProperty(T[E])||_.unshift([T[E],JC+"remove"])}_.forEach(([T,E])=>{var M;if((M=r.__r3f)!=null&&M.primitive&&T==="object"||ni.equ(E,f[T]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(T))return y.push([T,E,!0,[]]);let P=[];T.includes("-")&&(P=T.split("-")),y.push([T,E,!1,P]);for(const C in i){const b=i[C];C.startsWith(`${T}-`)&&y.push([C,b,!1,C.split("-")])}});const w={...i};return m!=null&&m.memoizedProps&&m!=null&&m.memoizedProps.args&&(w.args=m.memoizedProps.args),m!=null&&m.memoizedProps&&m!=null&&m.memoizedProps.attach&&(w.attach=m.memoizedProps.attach),{memoized:w,changes:y}}function Vv(r,e){var t;const n=r.__r3f,i=n==null?void 0:n.root,s=i==null||i.getState==null?void 0:i.getState(),{memoized:a,changes:u}=HN(e)?e:t2(r,e),f=n==null?void 0:n.eventCount;r.__r3f&&(r.__r3f.memoizedProps=a);for(let y=0;y<u.length;y++){let[w,T,E,M]=u[y];if(Uv(r)){const R="srgb",z="srgb-linear";w==="encoding"?(w="colorSpace",T=T===3001?R:z):w==="outputEncoding"&&(w="outputColorSpace",T=T===3001?R:z)}let P=r,C=P[w];if(M.length&&(C=M.reduce((b,R)=>b[R],r),!(C&&C.set))){const[b,...R]=M.reverse();P=R.reverse().reduce((z,B)=>z[B],r),w=b}if(T===JC+"remove")if(P.constructor){let b=oE.get(P.constructor);b||(b=new P.constructor,oE.set(P.constructor,b)),T=b[w]}else T=0;if(E&&n)T?n.handlers[w]=T:delete n.handlers[w],n.eventCount=Object.keys(n.handlers).length;else if(C&&C.set&&(C.copy||C instanceof Jc)){if(Array.isArray(T))C.fromArray?C.fromArray(T):C.set(...T);else if(C.copy&&T&&T.constructor&&C.constructor===T.constructor)C.copy(T);else if(T!==void 0){var d;const b=(d=C)==null?void 0:d.isColor;!b&&C.setScalar?C.setScalar(T):C instanceof Jc&&T instanceof Jc?C.mask=T.mask:C.set(T),!YC()&&s&&!s.linear&&b&&C.convertSRGBToLinear()}}else{var m;if(P[w]=T,(m=P[w])!=null&&m.isTexture&&P[w].format===_s&&P[w].type===Il&&s){const b=P[w];Uv(b)&&Uv(s.gl)?b.colorSpace=s.gl.outputColorSpace:b.encoding=s.gl.outputEncoding}}Rf(r)}if(n&&n.parent&&r.raycast&&f!==n.eventCount){const y=m0(r).getState().internal,w=y.interaction.indexOf(r);w>-1&&y.interaction.splice(w,1),n.eventCount&&y.interaction.push(r)}return!(u.length===1&&u[0][0]==="onUpdate")&&u.length&&(t=r.__r3f)!=null&&t.parent&&Zy(r),r}function Rf(r){var e,t;const n=(e=r.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function Zy(r){r.onUpdate==null||r.onUpdate(r)}function jN(r,e){r.manual||(QC(r)?(r.left=e.width/-2,r.right=e.width/2,r.top=e.height/2,r.bottom=e.height/-2):r.aspect=e.width/e.height,r.updateProjectionMatrix(),r.updateMatrixWorld())}function Qg(r){return(r.eventObject||r.object).uuid+"/"+r.index+r.instanceId}function qN(){var r;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return Ff.DefaultEventPriority;switch((r=e.event)==null?void 0:r.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Ff.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Ff.ContinuousEventPriority;default:return Ff.DefaultEventPriority}}function n2(r,e,t,n){const i=t.get(e);i&&(t.delete(e),t.size===0&&(r.delete(n),i.target.releasePointerCapture(n)))}function XN(r,e){const{internal:t}=r.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,i)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((n,i)=>{n2(t.capturedMap,e,n,i)})}function $N(r){function e(f){const{internal:d}=r.getState(),m=f.offsetX-d.initialClick[0],_=f.offsetY-d.initialClick[1];return Math.round(Math.sqrt(m*m+_*_))}function t(f){return f.filter(d=>["Move","Over","Enter","Out","Leave"].some(m=>{var _;return(_=d.__r3f)==null?void 0:_.handlers["onPointer"+m]}))}function n(f,d){const m=r.getState(),_=new Set,y=[],w=d?d(m.internal.interaction):m.internal.interaction;for(let P=0;P<w.length;P++){const C=ap(w[P]);C&&(C.raycaster.camera=void 0)}m.previousRoot||m.events.compute==null||m.events.compute(f,m);function T(P){const C=ap(P);if(!C||!C.events.enabled||C.raycaster.camera===null)return[];if(C.raycaster.camera===void 0){var b;C.events.compute==null||C.events.compute(f,C,(b=C.previousRoot)==null?void 0:b.getState()),C.raycaster.camera===void 0&&(C.raycaster.camera=null)}return C.raycaster.camera?C.raycaster.intersectObject(P,!0):[]}let E=w.flatMap(T).sort((P,C)=>{const b=ap(P.object),R=ap(C.object);return!b||!R?P.distance-C.distance:R.events.priority-b.events.priority||P.distance-C.distance}).filter(P=>{const C=Qg(P);return _.has(C)?!1:(_.add(C),!0)});m.events.filter&&(E=m.events.filter(E,m));for(const P of E){let C=P.object;for(;C;){var M;(M=C.__r3f)!=null&&M.eventCount&&y.push({...P,eventObject:C}),C=C.parent}}if("pointerId"in f&&m.internal.capturedMap.has(f.pointerId))for(let P of m.internal.capturedMap.get(f.pointerId).values())_.has(Qg(P.intersection))||y.push(P.intersection);return y}function i(f,d,m,_){const y=r.getState();if(f.length){const w={stopped:!1};for(const T of f){const E=ap(T.object)||y,{raycaster:M,pointer:P,camera:C,internal:b}=E,R=new Z(P.x,P.y,0).unproject(C),z=V=>{var W,q;return(W=(q=b.capturedMap.get(V))==null?void 0:q.has(T.eventObject))!=null?W:!1},B=V=>{const W={intersection:T,target:d.target};b.capturedMap.has(V)?b.capturedMap.get(V).set(T.eventObject,W):b.capturedMap.set(V,new Map([[T.eventObject,W]])),d.target.setPointerCapture(V)},k=V=>{const W=b.capturedMap.get(V);W&&n2(b.capturedMap,T.eventObject,W,V)};let I={};for(let V in d){let W=d[V];typeof W!="function"&&(I[V]=W)}let N={...T,...I,pointer:P,intersections:f,stopped:w.stopped,delta:m,unprojectedPoint:R,ray:M.ray,camera:C,stopPropagation(){const V="pointerId"in d&&b.capturedMap.get(d.pointerId);if((!V||V.has(T.eventObject))&&(N.stopped=w.stopped=!0,b.hovered.size&&Array.from(b.hovered.values()).find(W=>W.eventObject===T.eventObject))){const W=f.slice(0,f.indexOf(T));s([...W,T])}},target:{hasPointerCapture:z,setPointerCapture:B,releasePointerCapture:k},currentTarget:{hasPointerCapture:z,setPointerCapture:B,releasePointerCapture:k},nativeEvent:d};if(_(N),w.stopped===!0)break}}return f}function s(f){const{internal:d}=r.getState();for(const m of d.hovered.values())if(!f.length||!f.find(_=>_.object===m.object&&_.index===m.index&&_.instanceId===m.instanceId)){const y=m.eventObject.__r3f,w=y==null?void 0:y.handlers;if(d.hovered.delete(Qg(m)),y!=null&&y.eventCount){const T={...m,intersections:f};w.onPointerOut==null||w.onPointerOut(T),w.onPointerLeave==null||w.onPointerLeave(T)}}}function a(f,d){for(let m=0;m<d.length;m++){const _=d[m].__r3f;_==null||_.handlers.onPointerMissed==null||_.handlers.onPointerMissed(f)}}function u(f){switch(f){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return d=>{const{internal:m}=r.getState();"pointerId"in d&&m.capturedMap.has(d.pointerId)&&requestAnimationFrame(()=>{m.capturedMap.has(d.pointerId)&&(m.capturedMap.delete(d.pointerId),s([]))})}}return function(m){const{onPointerMissed:_,internal:y}=r.getState();y.lastEvent.current=m;const w=f==="onPointerMove",T=f==="onClick"||f==="onContextMenu"||f==="onDoubleClick",M=n(m,w?t:void 0),P=T?e(m):0;f==="onPointerDown"&&(y.initialClick=[m.offsetX,m.offsetY],y.initialHits=M.map(b=>b.eventObject)),T&&!M.length&&P<=2&&(a(m,y.interaction),_&&_(m)),w&&s(M);function C(b){const R=b.eventObject,z=R.__r3f,B=z==null?void 0:z.handlers;if(z!=null&&z.eventCount)if(w){if(B.onPointerOver||B.onPointerEnter||B.onPointerOut||B.onPointerLeave){const k=Qg(b),I=y.hovered.get(k);I?I.stopped&&b.stopPropagation():(y.hovered.set(k,b),B.onPointerOver==null||B.onPointerOver(b),B.onPointerEnter==null||B.onPointerEnter(b))}B.onPointerMove==null||B.onPointerMove(b)}else{const k=B[f];k?(!T||y.initialHits.includes(R))&&(a(m,y.interaction.filter(I=>!y.initialHits.includes(I))),k(b)):T&&y.initialHits.includes(R)&&a(m,y.interaction.filter(I=>!y.initialHits.includes(I)))}}i(M,m,P,C)}}return{handlePointer:u}}const i2=r=>!!(r!=null&&r.render),r2=at.createContext(null),YN=(r,e)=>{const t=PN((u,f)=>{const d=new Z,m=new Z,_=new Z;function y(P=f().camera,C=m,b=f().size){const{width:R,height:z,top:B,left:k}=b,I=R/z;C.isVector3?_.copy(C):_.set(...C);const N=P.getWorldPosition(d).distanceTo(_);if(QC(P))return{width:R/P.zoom,height:z/P.zoom,top:B,left:k,factor:1,distance:N,aspect:I};{const V=P.fov*Math.PI/180,W=2*Math.tan(V/2)*N,q=W*(R/z);return{width:q,height:W,top:B,left:k,factor:R/q,distance:N,aspect:I}}}let w;const T=P=>u(C=>({performance:{...C.performance,current:P}})),E=new ze;return{set:u,get:f,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(P=1)=>r(f(),P),advance:(P,C)=>e(P,C,f()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new l_,pointer:E,mouse:E,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const P=f();w&&clearTimeout(w),P.performance.current!==P.performance.min&&T(P.performance.min),w=setTimeout(()=>T(f().performance.max),P.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:y},setEvents:P=>u(C=>({...C,events:{...C.events,...P}})),setSize:(P,C,b,R,z)=>{const B=f().camera,k={width:P,height:C,top:R||0,left:z||0,updateStyle:b};u(I=>({size:k,viewport:{...I.viewport,...y(B,m,k)}}))},setDpr:P=>u(C=>{const b=e2(P);return{viewport:{...C.viewport,dpr:b,initialDpr:C.viewport.initialDpr||b}}}),setFrameloop:(P="always")=>{const C=f().clock;C.stop(),C.elapsedTime=0,P!=="never"&&(C.start(),C.elapsedTime=0),u(()=>({frameloop:P}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:at.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(P,C,b)=>{const R=f().internal;return R.priority=R.priority+(C>0?1:0),R.subscribers.push({ref:P,priority:C,store:b}),R.subscribers=R.subscribers.sort((z,B)=>z.priority-B.priority),()=>{const z=f().internal;z!=null&&z.subscribers&&(z.priority=z.priority-(C>0?1:0),z.subscribers=z.subscribers.filter(B=>B.ref!==P))}}}}}),n=t.getState();let i=n.size,s=n.viewport.dpr,a=n.camera;return t.subscribe(()=>{const{camera:u,size:f,viewport:d,gl:m,set:_}=t.getState();if(f.width!==i.width||f.height!==i.height||d.dpr!==s){var y;i=f,s=d.dpr,jN(u,f),m.setPixelRatio(d.dpr);const w=(y=f.updateStyle)!=null?y:typeof HTMLCanvasElement<"u"&&m.domElement instanceof HTMLCanvasElement;m.setSize(f.width,f.height,w)}u!==a&&(a=u,_(w=>({viewport:{...w.viewport,...w.viewport.getCurrentViewport(u)}})))}),t.subscribe(u=>r(u)),t};let Kg,QN=new Set,KN=new Set,ZN=new Set;function Hv(r,e){if(r.size)for(const{callback:t}of r.values())t(e)}function lp(r,e){switch(r){case"before":return Hv(QN,e);case"after":return Hv(KN,e);case"tail":return Hv(ZN,e)}}let Gv,Wv;function jv(r,e,t){let n=e.clock.getDelta();for(e.frameloop==="never"&&typeof r=="number"&&(n=r-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=r),Gv=e.internal.subscribers,Kg=0;Kg<Gv.length;Kg++)Wv=Gv[Kg],Wv.ref.current(Wv.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function JN(r){let e=!1,t=!1,n,i,s;function a(d){i=requestAnimationFrame(a),e=!0,n=0,lp("before",d),t=!0;for(const _ of r.values()){var m;s=_.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((m=s.gl.xr)!=null&&m.isPresenting)&&(n+=jv(d,s))}if(t=!1,lp("after",d),n===0)return lp("tail",d),e=!1,cancelAnimationFrame(i)}function u(d,m=1){var _;if(!d)return r.forEach(y=>u(y.store.getState(),m));(_=d.gl.xr)!=null&&_.isPresenting||!d.internal.active||d.frameloop==="never"||(m>1?d.internal.frames=Math.min(60,d.internal.frames+m):t?d.internal.frames=2:d.internal.frames=1,e||(e=!0,requestAnimationFrame(a)))}function f(d,m=!0,_,y){if(m&&lp("before",d),_)jv(d,_,y);else for(const w of r.values())jv(d,w.store.getState());m&&lp("after",d)}return{loop:a,invalidate:u,advance:f}}function s2(){const r=at.useContext(r2);if(!r)throw new Error("R3F: Hooks can only be used within the Canvas component!");return r}function E0(r=t=>t,e){return s2()(r,e)}function o1(r,e=0){const t=s2(),n=t.getState().internal.subscribe,i=KC(r);return _m(()=>n(i,e,t),[e,n,t]),null}const uE=new WeakMap;function o2(r,e){return function(t,...n){let i=uE.get(t);return i||(i=new t,uE.set(t,i)),r&&r(i),Promise.all(n.map(s=>new Promise((a,u)=>i.load(s,f=>{f.scene&&Object.assign(f,GN(f.scene)),a(f)},e,f=>u(new Error(`Could not load ${s}: ${f==null?void 0:f.message}`))))))}}function a1(r,e,t,n){const i=Array.isArray(e)?e:[e],s=RN(o2(t,n),[r,...i],{equal:ni.equ});return Array.isArray(e)?s:s[0]}a1.preload=function(r,e,t){const n=Array.isArray(e)?e:[e];return DN(o2(t),[r,...n])};a1.clear=function(r,e){const t=Array.isArray(e)?e:[e];return LN([r,...t])};const qf=new Map,{invalidate:cE,advance:hE}=JN(qf),{reconciler:T0,applyProps:Tf}=UN(qf,qN),Mf={objects:"shallow",strict:!1},ek=(r,e)=>{const t=typeof r=="function"?r(e):r;return i2(t)?t:new Z0({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...r})};function tk(r,e){const t=typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement;if(e){const{width:n,height:i,top:s,left:a,updateStyle:u=t}=e;return{width:n,height:i,top:s,left:a,updateStyle:u}}else if(typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement&&r.parentElement){const{width:n,height:i,top:s,left:a}=r.parentElement.getBoundingClientRect();return{width:n,height:i,top:s,left:a,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas)return{width:r.width,height:r.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function nk(r){const e=qf.get(r),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=n||YN(cE,hE),a=t||T0.createContainer(s,Ff.ConcurrentRoot,null,!1,null,"",i,null);e||qf.set(r,{fiber:a,store:s});let u,f=!1,d;return{configure(m={}){let{gl:_,size:y,scene:w,events:T,onCreated:E,shadows:M=!1,linear:P=!1,flat:C=!1,legacy:b=!1,orthographic:R=!1,frameloop:z="always",dpr:B=[1,2],performance:k,raycaster:I,camera:N,onPointerMissed:V}=m,W=s.getState(),q=W.gl;W.gl||W.set({gl:q=ek(_,r)});let H=W.raycaster;H||W.set({raycaster:H=new VC});const{params:re,...de}=I||{};if(ni.equ(de,H,Mf)||Tf(H,{...de}),ni.equ(re,H.params,Mf)||Tf(H,{params:{...H.params,...re}}),!W.camera||W.camera===d&&!ni.equ(d,N,Mf)){d=N;const ne=N instanceof nm,Q=ne?N:R?new Gu(0,0,0,0,.1,1e3):new yr(75,0,.1,1e3);ne||(Q.position.z=5,N&&(Tf(Q,N),("aspect"in N||"left"in N||"right"in N||"bottom"in N||"top"in N)&&(Q.manual=!0,Q.updateProjectionMatrix())),!W.camera&&!(N!=null&&N.rotation)&&Q.lookAt(0,0,0)),W.set({camera:Q}),H.camera=Q}if(!W.scene){let ne;w!=null&&w.isScene?ne=w:(ne=new Nx,w&&Tf(ne,w)),W.set({scene:If(ne)})}if(!W.xr){var ye;const ne=(he,Ae)=>{const se=s.getState();se.frameloop!=="never"&&hE(he,!0,se,Ae)},Q=()=>{const he=s.getState();he.gl.xr.enabled=he.gl.xr.isPresenting,he.gl.xr.setAnimationLoop(he.gl.xr.isPresenting?ne:null),he.gl.xr.isPresenting||cE(he)},$={connect(){const he=s.getState().gl;he.xr.addEventListener("sessionstart",Q),he.xr.addEventListener("sessionend",Q)},disconnect(){const he=s.getState().gl;he.xr.removeEventListener("sessionstart",Q),he.xr.removeEventListener("sessionend",Q)}};typeof((ye=q.xr)==null?void 0:ye.addEventListener)=="function"&&$.connect(),W.set({xr:$})}if(q.shadowMap){const ne=q.shadowMap.enabled,Q=q.shadowMap.type;if(q.shadowMap.enabled=!!M,ni.boo(M))q.shadowMap.type=vp;else if(ni.str(M)){var Ce;const $={basic:GT,percentage:q0,soft:vp,variance:Hc};q.shadowMap.type=(Ce=$[M])!=null?Ce:vp}else ni.obj(M)&&Object.assign(q.shadowMap,M);(ne!==q.shadowMap.enabled||Q!==q.shadowMap.type)&&(q.shadowMap.needsUpdate=!0)}const K=YC();K&&("enabled"in K?K.enabled=!b:"legacyMode"in K&&(K.legacyMode=b)),f||Tf(q,{outputEncoding:P?3e3:3001,toneMapping:C?aa:Sx}),W.legacy!==b&&W.set(()=>({legacy:b})),W.linear!==P&&W.set(()=>({linear:P})),W.flat!==C&&W.set(()=>({flat:C})),_&&!ni.fun(_)&&!i2(_)&&!ni.equ(_,q,Mf)&&Tf(q,_),T&&!W.events.handlers&&W.set({events:T(s)});const oe=tk(r,y);return ni.equ(oe,W.size,Mf)||W.setSize(oe.width,oe.height,oe.updateStyle,oe.top,oe.left),B&&W.viewport.dpr!==e2(B)&&W.setDpr(B),W.frameloop!==z&&W.setFrameloop(z),W.onPointerMissed||W.set({onPointerMissed:V}),k&&!ni.equ(k,W.performance,Mf)&&W.set(ne=>({performance:{...ne.performance,...k}})),u=E,f=!0,this},render(m){return f||this.configure(),T0.updateContainer(rt.jsx(ik,{store:s,children:m,onCreated:u,rootElement:r}),a,null,()=>{}),s},unmount(){a2(r)}}}function ik({store:r,children:e,onCreated:t,rootElement:n}){return _m(()=>{const i=r.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),r.getState().events.connected||i.events.connect==null||i.events.connect(n)},[]),rt.jsx(r2.Provider,{value:r,children:e})}function a2(r,e){const t=qf.get(r),n=t==null?void 0:t.fiber;if(n){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),T0.updateContainer(null,n,null,()=>{i&&setTimeout(()=>{try{var s,a,u,f;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(u=i.gl)==null||u.forceContextLoss==null||u.forceContextLoss(),(f=i.gl)!=null&&f.xr&&i.xr.disconnect(),WN(i),qf.delete(r)}catch{}},500)})}}T0.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:at.version});const qv={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function rk(r){const{handlePointer:e}=$N(r);return{priority:1,enabled:!0,compute(t,n,i){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(qv).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:i}=r.getState();(t=i.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var n;const{set:i,events:s}=r.getState();s.disconnect==null||s.disconnect(),i(a=>({events:{...a.events,connected:t}})),Object.entries((n=s.handlers)!=null?n:[]).forEach(([a,u])=>{const[f,d]=qv[a];t.addEventListener(f,u,{passive:d})})},disconnect:()=>{const{set:t,events:n}=r.getState();if(n.connected){var i;Object.entries((i=n.handlers)!=null?i:[]).forEach(([s,a])=>{if(n&&n.connected instanceof HTMLElement){const[u]=qv[s];n.connected.removeEventListener(u,a)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}function fE(r,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>r(...n),e)}}function sk({debounce:r,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=at.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),u=at.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),f=r?typeof r=="number"?r:r.scroll:null,d=r?typeof r=="number"?r:r.resize:null,m=at.useRef(!1);at.useEffect(()=>(m.current=!0,()=>void(m.current=!1)));const[_,y,w]=at.useMemo(()=>{const P=()=>{if(!u.current.element)return;const{left:C,top:b,width:R,height:z,bottom:B,right:k,x:I,y:N}=u.current.element.getBoundingClientRect(),V={left:C,top:b,width:R,height:z,bottom:B,right:k,x:I,y:N};u.current.element instanceof HTMLElement&&n&&(V.height=u.current.element.offsetHeight,V.width=u.current.element.offsetWidth),Object.freeze(V),m.current&&!uk(u.current.lastBounds,V)&&a(u.current.lastBounds=V)};return[P,d?fE(P,d):P,f?fE(P,f):P]},[a,n,f,d]);function T(){u.current.scrollContainers&&(u.current.scrollContainers.forEach(P=>P.removeEventListener("scroll",w,!0)),u.current.scrollContainers=null),u.current.resizeObserver&&(u.current.resizeObserver.disconnect(),u.current.resizeObserver=null),u.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",u.current.orientationHandler))}function E(){u.current.element&&(u.current.resizeObserver=new i(w),u.current.resizeObserver.observe(u.current.element),e&&u.current.scrollContainers&&u.current.scrollContainers.forEach(P=>P.addEventListener("scroll",w,{capture:!0,passive:!0})),u.current.orientationHandler=()=>{w()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",u.current.orientationHandler))}const M=P=>{!P||P===u.current.element||(T(),u.current.element=P,u.current.scrollContainers=l2(P),E())};return ak(w,!!e),ok(y),at.useEffect(()=>{T(),E()},[e,w,y]),at.useEffect(()=>T,[]),[M,s,_]}function ok(r){at.useEffect(()=>{const e=r;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[r])}function ak(r,e){at.useEffect(()=>{if(e){const t=r;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[r,e])}function l2(r){const e=[];if(!r||r===document.body)return e;const{overflow:t,overflowX:n,overflowY:i}=window.getComputedStyle(r);return[t,n,i].some(s=>s==="auto"||s==="scroll")&&e.push(r),[...e,...l2(r.parentElement)]}const lk=["x","y","top","bottom","left","right","width","height"],uk=(r,e)=>lk.every(t=>r[t]===e[t]);var ck=Object.defineProperty,hk=Object.defineProperties,fk=Object.getOwnPropertyDescriptors,dE=Object.getOwnPropertySymbols,dk=Object.prototype.hasOwnProperty,pk=Object.prototype.propertyIsEnumerable,pE=(r,e,t)=>e in r?ck(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,mE=(r,e)=>{for(var t in e||(e={}))dk.call(e,t)&&pE(r,t,e[t]);if(dE)for(var t of dE(e))pk.call(e,t)&&pE(r,t,e[t]);return r},mk=(r,e)=>hk(r,fk(e)),gE,_E;typeof window<"u"&&((gE=window.document)!=null&&gE.createElement||((_E=window.navigator)==null?void 0:_E.product)==="ReactNative")?at.useLayoutEffect:at.useEffect;function u2(r,e,t){if(!r)return;if(t(r)===!0)return r;let n=r.child;for(;n;){const i=u2(n,e,t);if(i)return i;n=n.sibling}}function c2(r){try{return Object.defineProperties(r,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return r}}const vE=console.error;console.error=function(){const r=[...arguments].join("");if(r!=null&&r.startsWith("Warning:")&&r.includes("useContext")){console.error=vE;return}return vE.apply(this,arguments)};const l1=c2(at.createContext(null));class h2 extends at.Component{render(){return at.createElement(l1.Provider,{value:this._reactInternals},this.props.children)}}function gk(){const r=at.useContext(l1);if(r===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=at.useId();return at.useMemo(()=>{for(const n of[r,r==null?void 0:r.alternate]){if(!n)continue;const i=u2(n,!1,s=>{let a=s.memoizedState;for(;a;){if(a.memoizedState===e)return!0;a=a.next}});if(i)return i}},[r,e])}function _k(){const r=gk(),[e]=at.useState(()=>new Map);e.clear();let t=r;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==l1&&!e.has(i)&&e.set(i,at.useContext(c2(i)))}t=t.return}return e}function vk(){const r=_k();return at.useMemo(()=>Array.from(r.keys()).reduce((e,t)=>n=>at.createElement(e,null,at.createElement(t.Provider,mk(mE({},n),{value:r.get(t)}))),e=>at.createElement(h2,mE({},e))),[r])}const yk=at.forwardRef(function({children:e,fallback:t,resize:n,style:i,gl:s,events:a=rk,eventSource:u,eventPrefix:f,shadows:d,linear:m,flat:_,legacy:y,orthographic:w,frameloop:T,dpr:E,performance:M,raycaster:P,camera:C,scene:b,onPointerMissed:R,onCreated:z,...B},k){at.useMemo(()=>$C(GC),[]);const I=vk(),[N,V]=sk({scroll:!0,debounce:{scroll:50,resize:0},...n}),W=at.useRef(null),q=at.useRef(null);at.useImperativeHandle(k,()=>W.current);const H=KC(R),[re,de]=at.useState(!1),[ye,Ce]=at.useState(!1);if(re)throw re;if(ye)throw ye;const K=at.useRef(null);_m(()=>{const ne=W.current;V.width>0&&V.height>0&&ne&&(K.current||(K.current=nk(ne)),K.current.configure({gl:s,events:a,shadows:d,linear:m,flat:_,legacy:y,orthographic:w,frameloop:T,dpr:E,performance:M,raycaster:P,camera:C,scene:b,size:V,onPointerMissed:(...Q)=>H.current==null?void 0:H.current(...Q),onCreated:Q=>{Q.events.connect==null||Q.events.connect(u?BN(u)?u.current:u:q.current),f&&Q.setEvents({compute:($,he)=>{const Ae=$[f+"X"],se=$[f+"Y"];he.pointer.set(Ae/he.size.width*2-1,-(se/he.size.height)*2+1),he.raycaster.setFromCamera(he.pointer,he.camera)}}),z==null||z(Q)}}),K.current.render(rt.jsx(I,{children:rt.jsx(ZC,{set:Ce,children:rt.jsx(at.Suspense,{fallback:rt.jsx(VN,{set:de}),children:e??null})})})))}),at.useEffect(()=>{const ne=W.current;if(ne)return()=>a2(ne)},[]);const oe=u?"none":"auto";return rt.jsx("div",{ref:q,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:oe,...i},...B,children:rt.jsx("div",{ref:N,style:{width:"100%",height:"100%"},children:rt.jsx("canvas",{ref:W,style:{display:"block"},children:t})})})}),xk=at.forwardRef(function(e,t){return rt.jsx(h2,{children:rt.jsx(yk,{...e,ref:t})})});function wk({disable:r=!1}){let{gl:e,scene:t,camera:n,size:i}=E0(),s=at.useMemo(()=>{let a=new JO(e);a.addPass(new eN(t,n));let u={shape:1,radius:2,rotateR:Math.PI/12,rotateB:Math.PI/12*2,rotateG:Math.PI/12*3,scatter:1,blending:1,blendingMode:1,greyscale:!1,disable:r},f=new TN(i.width,i.height,u);return a.addPass(f),a},[e,t,n,i,r]);return at.useEffect(()=>s==null?void 0:s.setSize(i.width,i.height),[s,i]),o1((a,u)=>(e.autoClear=!0,void s.render(u)),1),rt.jsx(rt.Fragment,{})}var Sk=`// #pragma glslify: cnoise3 = require(glsl-noise/classic/3d) 

// noise source from https://github.com/hughsk/glsl-noise/blob/master/periodic/3d.glsl

vec3 mod289(vec3 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 mod289(vec4 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 permute(vec4 x)
{
  return mod289(((x*34.0)+1.0)*x);
}

vec4 taylorInvSqrt(vec4 r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}

vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

float cnoise(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
  return 2.2 * n_xyz;
}

//-------- start here ------------

mat3 rotation3dY(float angle) {
  float s = sin(angle);
  float c = cos(angle);

  return mat3(c, 0.0, -s, 0.0, 1.0, 0.0, s, 0.0, c);
}

vec3 rotateY(vec3 v, float angle) { return rotation3dY(angle) * v; }

varying vec3 vNormal;
varying float displacement;
varying vec3 vPos;
varying float vDistort;

varying vec2 vUv;

uniform float uTime;
uniform float uSpeed;

uniform float uLoadingTime;

uniform float uNoiseDensity;
uniform float uNoiseStrength;

#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;
varying vec3 vBitangent;
#endif
#endif
#include <clipping_planes_pars_vertex>
#include <color_pars_vertex>
#include <common>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <morphtarget_pars_vertex>
#include <shadowmap_pars_vertex>
#include <skinning_pars_vertex>
#include <uv2_pars_vertex>
#include <uv_pars_vertex>

void main() {

  #include <beginnormal_vertex>
  #include <color_vertex>
  #include <defaultnormal_vertex>
  #include <morphnormal_vertex>
  #include <skinbase_vertex>
  #include <skinnormal_vertex>
  #include <uv2_vertex>
  #include <uv_vertex>
  #ifndef FLAT_SHADED
    vNormal = normalize(transformedNormal);
  #ifdef USE_TANGENT
    vTangent = normalize(transformedTangent);
    vBitangent = normalize(cross(vNormal, vTangent) * tangent.w);
  #endif
  #endif
  #include <begin_vertex>

  #include <clipping_planes_vertex>
  #include <displacementmap_vertex>
  #include <logdepthbuf_vertex>
  #include <morphtarget_vertex>
  #include <project_vertex>
  #include <skinning_vertex>
    vViewPosition = -mvPosition.xyz;
  #include <fog_vertex>
  #include <shadowmap_vertex>
  #include <worldpos_vertex>

  //-------- start vertex ------------
  vUv = uv;

  float t = uTime * uSpeed;
  // Create a sine wave from top to bottom of the sphere
  float distortion = 0.75 * cnoise(0.43 * position * uNoiseDensity + t);

  vec3 pos = position + normal * distortion * uNoiseStrength * uLoadingTime;
  vPos = pos;

  gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.);
}
`,Ek=`
#define STANDARD
#ifdef PHYSICAL
#define REFLECTIVITY
#define CLEARCOAT
#define TRANSMISSION
#endif

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;

#ifdef TRANSMISSION
uniform float transmission;
#endif
#ifdef REFLECTIVITY
uniform float reflectivity;
#endif
#ifdef CLEARCOAT
uniform float clearcoat;
uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;
varying vec3 vBitangent;
#endif
#endif
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <color_pars_fragment>
#include <common>
#include <dithering_pars_fragment>
#include <emissivemap_pars_fragment>
#include <lightmap_pars_fragment>
#include <map_pars_fragment>
#include <packing>
#include <uv2_pars_fragment>
#include <uv_pars_fragment>
// #include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <bumpmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <clipping_planes_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <shadowmap_pars_fragment>
// include를 통해 가져온 값은 대부분 환경, 빛 등을 계산하기 위해서 기본 fragment
// shader의 값들을 받아왔습니다. 일단은 무시하셔도 됩니다.

varying vec3 vNormal;
varying float displacement;
varying vec3 vPos;
varying float vDistort;

uniform float uC1r;
uniform float uC1g;
uniform float uC1b;
uniform float uC2r;
uniform float uC2g;
uniform float uC2b;
uniform float uC3r;
uniform float uC3g;
uniform float uC3b;

varying vec3 color1;
varying vec3 color2;
varying vec3 color3;

// for npm package, need to add this manually
float linearToRelativeLuminance2( const in vec3 color ) {
    vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
    return dot( weights, color.rgb );
}

void main() {

  //-------- basic gradient ------------
  vec3 color1 = vec3(uC1r, uC1g, uC1b);
  vec3 color2 = vec3(uC2r, uC2g, uC2b);
  vec3 color3 = vec3(uC3r, uC3g, uC3b);
  float clearcoat = 1.0;
  float clearcoatRoughness = 0.5;

  #include <clipping_planes_fragment>

  vec4 diffuseColor = vec4(
      mix(mix(color1, color2, smoothstep(-3.0, 3.0, vPos.x)), color3, vPos.z),
      1);
  // diffuseColor는 오브젝트의 베이스 색상 (환경이나 빛이 고려되지 않은 본연의
  // 색)

  // mix(x, y, a): a를 축으로 했을 때 가장 낮은 값에서 x값의 영향력을 100%, 가장
  // 높은 값에서 y값의 영향력을 100%로 만든다. smoothstep(x, y, a): a축을
  // 기준으로 x를 최소값, y를 최대값으로 그 사이의 값을 쪼갠다. x와 y 사이를
  // 0-100 사이의 그라디언트처럼 단계별로 표현하고, x 미만의 값은 0, y 이상의
  // 값은 100으로 처리

  // 1. smoothstep(-3.0, 3.0,vPos.x)로 x축의 그라디언트가 표현 될 범위를 -3,
  // 3으로 정한다.
  // 2. mix(color1, color3, smoothstep(-3.0, 3.0,vPos.x))로 color1과 color3을
  // 위의 범위 안에서 그라디언트로 표현한다.
  // 예를 들어 color1이 노랑, color3이 파랑이라고 치면, x축 기준 -3부터 3까지
  // 노랑과 파랑 사이의 그라디언트가 나타나고, -3보다 작은 값에서는 계속 노랑,
  // 3보다 큰 값에서는 계속 파랑이 나타난다.
  // 3. mix()를 한 번 더 사용해서 위의 그라디언트와 color2를 z축 기준으로
  // 분배한다.

  //-------- materiality ------------
  ReflectedLight reflectedLight =
      ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));
  vec3 totalEmissiveRadiance = emissive;

  #ifdef TRANSMISSION
    float totalTransmission = transmission;
  #endif
  #include <logdepthbuf_fragment>
  #include <map_fragment>
  #include <color_fragment>
  #include <alphamap_fragment>
  #include <alphatest_fragment>
  #include <roughnessmap_fragment>
  #include <metalnessmap_fragment>
  #include <normal_fragment_begin>
  #include <normal_fragment_maps>
  #include <clearcoat_normal_fragment_begin>
  #include <clearcoat_normal_fragment_maps>
  #include <emissivemap_fragment>
  // #include <transmissionmap_fragment>
  #include <lights_physical_fragment>
  #include <lights_fragment_begin>
  #include <lights_fragment_maps>
  #include <lights_fragment_end>
  #include <aomap_fragment>
    vec3 outgoingLight =
        reflectedLight.directDiffuse + reflectedLight.indirectDiffuse +
        reflectedLight.directSpecular + reflectedLight.indirectSpecular;
    //위에서 정의한 diffuseColor에 환경이나 반사값들을 반영한 값.
  #ifdef TRANSMISSION
    diffuseColor.a *=
        mix(saturate(1. - totalTransmission +
                    linearToRelativeLuminance2(reflectedLight.directSpecular +
                                              reflectedLight.indirectSpecular)),
            1.0, metalness);
  #endif


  #include <tonemapping_fragment>
  #include <encodings_fragment>
  #include <fog_fragment>
  #include <premultiplied_alpha_fragment>
  #include <dithering_fragment>


  gl_FragColor = vec4(outgoingLight, diffuseColor.a);
  // gl_FragColor가 fragment shader를 통해 나타나는 최종값으로, diffuseColor에서
  // 정의한 그라디언트 색상 위에 반사나 빛을 계산한 값을 최종값으로 정의.
  // gl_FragColor = vec4(mix(mix(color1, color3, smoothstep(-3.0, 3.0,vPos.x)),
  // color2, vNormal.z), 1.0); 위처럼 최종값을 그라디언트 값 자체를 넣으면 환경
  // 영향없는 그라디언트만 표현됨.
}
`,Tk=`// #pragma glslify: pnoise = require(glsl-noise/periodic/3d)

vec3 mod289(vec3 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 mod289(vec4 x)
{
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec4 permute(vec4 x)
{
  return mod289(((x*34.0)+1.0)*x);
}

vec4 taylorInvSqrt(vec4 r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}

vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
  vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
  vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
  return 2.2 * n_xyz;
}


//-------- start here ------------

varying vec3 vNormal;
uniform float uTime;
uniform float uSpeed;
uniform float uNoiseDensity;
uniform float uNoiseStrength;
uniform float uFrequency;
uniform float uAmplitude;
varying vec3 vPos;
varying float vDistort;
varying vec2 vUv;
varying vec3 vViewPosition;

#define STANDARD
#ifndef FLAT_SHADED
  #ifdef USE_TANGENT
    varying vec3 vTangent;
    varying vec3 vBitangent;
  #endif
#endif

#include <clipping_planes_pars_vertex>
#include <color_pars_vertex>
#include <common>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <morphtarget_pars_vertex>
#include <shadowmap_pars_vertex>
#include <skinning_pars_vertex>
#include <uv2_pars_vertex>
#include <uv_pars_vertex>


// rotation
mat3 rotation3dY(float angle) {
  float s = sin(angle);
  float c = cos(angle);
  return mat3(c, 0.0, -s, 0.0, 1.0, 0.0, s, 0.0, c);
}

vec3 rotateY(vec3 v, float angle) { return rotation3dY(angle) * v; }

void main() {
  #include <beginnormal_vertex>
  #include <color_vertex>
  #include <defaultnormal_vertex>
  #include <morphnormal_vertex>
  #include <skinbase_vertex>
  #include <skinnormal_vertex>
  #include <uv2_vertex>
  #include <uv_vertex>
  #ifndef FLAT_SHADED
    vNormal = normalize(transformedNormal);
  #ifdef USE_TANGENT
    vTangent = normalize(transformedTangent);
    vBitangent = normalize(cross(vNormal, vTangent) * tangent.w);
  #endif
  #endif
  #include <begin_vertex>

  #include <clipping_planes_vertex>
  #include <displacementmap_vertex>
  #include <logdepthbuf_vertex>
  #include <morphtarget_vertex>
  #include <project_vertex>
  #include <skinning_vertex>
    vViewPosition = -mvPosition.xyz;
  #include <fog_vertex>
  #include <shadowmap_vertex>
  #include <worldpos_vertex>

  //-------- start vertex ------------
  float t = uTime * uSpeed;
  float distortion =
      pnoise((normal + t) * uNoiseDensity, vec3(10.0)) * uNoiseStrength;
  vec3 pos = position + (normal * distortion);
  float angle = sin(uv.y * uFrequency + t) * uAmplitude;
  pos = rotateY(pos, angle);

  vPos = pos;
  vDistort = distortion;
  vNormal = normal;
  vUv = uv;

  gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.);
}
`,Mk=`
#define STANDARD
#ifdef PHYSICAL
#define REFLECTIVITY
#define CLEARCOAT
#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
uniform float transmission;
#endif
#ifdef REFLECTIVITY
uniform float reflectivity;
#endif
#ifdef CLEARCOAT
uniform float clearcoat;
uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
#ifdef USE_TANGENT
varying vec3 vTangent;
varying vec3 vBitangent;
#endif
#endif
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <color_pars_fragment>
#include <common>
#include <dithering_pars_fragment>
#include <emissivemap_pars_fragment>
#include <lightmap_pars_fragment>
#include <map_pars_fragment>
#include <packing>
#include <uv2_pars_fragment>
#include <uv_pars_fragment>
// #include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <bumpmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <clipping_planes_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <shadowmap_pars_fragment>
// include를 통해 가져온 값은 대부분 환경, 빛 등을 계산하기 위해서 기본 fragment
// shader의 값들을 받아왔습니다. 일단은 무시하셔도 됩니다.
varying vec3 vNormal;
varying float displacement;
varying vec3 vPos;
varying float vDistort;
uniform float uC1r;
uniform float uC1g;
uniform float uC1b;
uniform float uC2r;
uniform float uC2g;
uniform float uC2b;
uniform float uC3r;
uniform float uC3g;
uniform float uC3b;
varying vec3 color1;
varying vec3 color2;
varying vec3 color3;
varying float distanceToCenter;


// for npm package, need to add this manually
// 'linearToRelativeLuminance' : function already has a body
float linearToRelativeLuminance2( const in vec3 color ) {
    vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
    return dot( weights, color.rgb );
}

void main() {
  //-------- basic gradient ------------
  vec3 color1 = vec3(uC1r, uC1g, uC1b);
  vec3 color2 = vec3(uC2r, uC2g, uC2b);
  vec3 color3 = vec3(uC3r, uC3g, uC3b);
  float clearcoat = 1.0;
  float clearcoatRoughness = 0.5;
#include <clipping_planes_fragment>

  float distanceToCenter = distance(vPos, vec3(0, 0, 0));
  // distanceToCenter로 중심점과의 거리를 구함.

  vec4 diffuseColor =
      vec4(mix(color3, mix(color2, color1, smoothstep(-1.0, 1.0, vPos.y)),
               distanceToCenter),
           1);

  //-------- materiality ------------
  ReflectedLight reflectedLight =
      ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));
  vec3 totalEmissiveRadiance = emissive;
#ifdef TRANSMISSION
  float totalTransmission = transmission;
#endif
#include <logdepthbuf_fragment>
#include <map_fragment>
#include <color_fragment>
#include <alphamap_fragment>
#include <alphatest_fragment>
#include <roughnessmap_fragment>
#include <metalnessmap_fragment>
#include <normal_fragment_begin>
#include <normal_fragment_maps>
#include <clearcoat_normal_fragment_begin>
#include <clearcoat_normal_fragment_maps>
#include <emissivemap_fragment>
// #include <transmissionmap_fragment>
#include <lights_physical_fragment>
#include <lights_fragment_begin>
#include <lights_fragment_maps>
#include <lights_fragment_end>
#include <aomap_fragment>
  vec3 outgoingLight =
      reflectedLight.directDiffuse + reflectedLight.indirectDiffuse +
      reflectedLight.directSpecular + reflectedLight.indirectSpecular;
//위에서 정의한 diffuseColor에 환경이나 반사값들을 반영한 값.
#ifdef TRANSMISSION
  diffuseColor.a *=
      mix(saturate(1. - totalTransmission +
                   linearToRelativeLuminance2(reflectedLight.directSpecular +
                                             reflectedLight.indirectSpecular)),
          1.0, metalness);
#endif
  gl_FragColor = vec4(outgoingLight, diffuseColor.a);
  // gl_FragColor가 fragment shader를 통해 나타나는 최종값으로, diffuseColor에서
  // 정의한 그라디언트 색상 위에 반사나 빛을 계산한 값을 최종값으로 정의.
  // gl_FragColor = vec4(mix(mix(color1, color3, smoothstep(-3.0, 3.0,vPos.x)),
  // color2, vNormal.z), 1.0); 위처럼 최종값을 그라디언트 값 자체를 넣으면 환경
  // 영향없는 그라디언트만 표현됨.

#include <tonemapping_fragment>
#include <encodings_fragment>
#include <fog_fragment>
#include <premultiplied_alpha_fragment>
#include <dithering_fragment>
}
`;function Ck({type:r}){return rt.jsxs(rt.Fragment,{children:[r==="plane"&&rt.jsx("planeGeometry",{args:[10,10,1,192]}),r==="sphere"&&rt.jsx("icosahedronGeometry",{args:[1,192/3]}),r==="waterPlane"&&rt.jsx("planeGeometry",{args:[10,10,192,192]})]})}function Ak(r){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function bk(r){let e=r.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return e?{r:parseInt(e[1]),g:parseInt(e[2]),b:parseInt(e[3])}:null}function Xv(r){if(r.startsWith("#"))return Ak(r);if(r.startsWith("rgb"))return bk(r);throw new Error("Invalid color format")}function El(r=0){return r/255}var Pk=Object.create,u1=Object.defineProperty,Ik=Object.defineProperties,Rk=Object.getOwnPropertyDescriptor,Dk=Object.getOwnPropertyDescriptors,Lk=Object.getOwnPropertyNames,M0=Object.getOwnPropertySymbols,Ok=Object.getPrototypeOf,c1=Object.prototype.hasOwnProperty,f2=Object.prototype.propertyIsEnumerable,yE=(r,e,t)=>e in r?u1(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Mo=(r,e)=>{for(var t in e||(e={}))c1.call(e,t)&&yE(r,t,e[t]);if(M0)for(var t of M0(e))f2.call(e,t)&&yE(r,t,e[t]);return r},Nk=(r,e)=>Ik(r,Dk(e)),Jy=(r,e)=>{var t={};for(var n in r)c1.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&M0)for(var n of M0(r))e.indexOf(n)<0&&f2.call(r,n)&&(t[n]=r[n]);return t},vm=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),kk=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Lk(e))!c1.call(r,i)&&i!==t&&u1(r,i,{get:()=>e[i],enumerable:!(n=Rk(e,i))||n.enumerable});return r},zk=(r,e,t)=>(t=r!=null?Pk(Ok(r)):{},kk(!r||!r.__esModule?u1(t,"default",{value:r,enumerable:!0}):t,r)),Fk=({animate:r,uniforms:e,vertexShader:t,fragmentShader:n,onInit:i})=>{let s=at.useMemo(()=>{let a=Object.entries(e),u=e.colors,f=Xv(u[0]),d=Xv(u[1]),m=Xv(u[2]),_={uC1r:{value:El(f==null?void 0:f.r)},uC1g:{value:El(f==null?void 0:f.g)},uC1b:{value:El(f==null?void 0:f.b)},uC2r:{value:El(d==null?void 0:d.r)},uC2g:{value:El(d==null?void 0:d.g)},uC2b:{value:El(d==null?void 0:d.b)},uC3r:{value:El(m==null?void 0:m.r)},uC3g:{value:El(m==null?void 0:m.g)},uC3b:{value:El(m==null?void 0:m.b)}},y=a.reduce((T,[E,M])=>{let P=tm.clone({[E]:{value:M}});return Mo(Mo({},T),P)},{}),w=new Xx({userData:y,metalness:.2,side:Ra,onBeforeCompile:T=>{T.uniforms=Mo(Mo(Mo({},T.uniforms),y),_),T.vertexShader=t,T.fragmentShader=n}});return a.forEach(([T])=>Object.defineProperty(w,T,{get:()=>w.uniforms[T].value,set:E=>w.uniforms[T].value=E})),i&&i(w),w},[e,t,n,i]);return at.useEffect(()=>()=>{s.dispose()},[s]),o1(({clock:a})=>{r==="on"&&s.userData.uTime&&(s.userData.uTime.value=a.getElapsedTime())}),rt.jsx("primitive",{attach:"material",object:s})};function ex(r){return r/180*Math.PI}function Uk(r){return r.map(e=>ex(e))}function Bk(r){return r.replace("http://localhost:3001/customize","").replace("https://shadergradient.co/customize","").replace("https://www.shadergradient.co/customize","")}function Vk({animate:r,positionX:e,positionY:t,positionZ:n,rotationX:i,rotationY:s,rotationZ:a,type:u,color1:f,color2:d,color3:m,uTime:_,uSpeed:y,uDensity:w,uStrength:T,uFrequency:E,uAmplitude:M}){return rt.jsxs("mesh",{name:"shadergradient-mesh",position:[e,t,n],rotation:Uk([i,s,a]),children:[rt.jsx(Ck,{type:u}),rt.jsx(Fk,{animate:r,uniforms:{colors:[f,d,m],uTime:_,uSpeed:y,uLoadingTime:1,uNoiseDensity:w,uNoiseStrength:T,uFrequency:E,uAmplitude:M,uIntensity:.5},vertexShader:u==="sphere"?Tk:Sk,fragmentShader:u==="sphere"?Mk:Ek,onInit:P=>{console.log("material (onInit)",P)}})]})}var Hk=class extends PC{constructor(e){super(e),this.type=Da}parse(e){let t=function(P,C){switch(P){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(C||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(C||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(C||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(C||""))}},n=`
`,i=function(P,C,b){C=C||1024;let R=P.pos,z=-1,B=0,k="",I=String.fromCharCode.apply(null,new Uint16Array(P.subarray(R,R+128)));for(;0>(z=I.indexOf(n))&&B<C&&R<P.byteLength;)k+=I,B+=I.length,R+=128,I+=String.fromCharCode.apply(null,new Uint16Array(P.subarray(R,R+128)));return-1<z?(P.pos+=B+z+1,k+I.slice(0,z)):!1},s=function(P){let C=/^#\?(\S+)/,b=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,R=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,z=/^\s*FORMAT=(\S+)\s*$/,B=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,k={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0},I,N;for((P.pos>=P.byteLength||!(I=i(P)))&&t(1,"no header found"),(N=I.match(C))||t(3,"bad initial token"),k.valid|=1,k.programtype=N[1],k.string+=I+`
`;I=i(P),I!==!1;){if(k.string+=I+`
`,I.charAt(0)==="#"){k.comments+=I+`
`;continue}if((N=I.match(b))&&(k.gamma=parseFloat(N[1])),(N=I.match(R))&&(k.exposure=parseFloat(N[1])),(N=I.match(z))&&(k.valid|=2,k.format=N[1]),(N=I.match(B))&&(k.valid|=4,k.height=parseInt(N[1],10),k.width=parseInt(N[2],10)),k.valid&2&&k.valid&4)break}return k.valid&2||t(3,"missing format specifier"),k.valid&4||t(3,"missing image size specifier"),k},a=function(P,C,b){let R=C;if(R<8||R>32767||P[0]!==2||P[1]!==2||P[2]&128)return new Uint8Array(P);R!==(P[2]<<8|P[3])&&t(3,"wrong scanline width");let z=new Uint8Array(4*C*b);z.length||t(4,"unable to allocate buffer space");let B=0,k=0,I=4*R,N=new Uint8Array(4),V=new Uint8Array(I),W=b;for(;W>0&&k<P.byteLength;){k+4>P.byteLength&&t(1),N[0]=P[k++],N[1]=P[k++],N[2]=P[k++],N[3]=P[k++],(N[0]!=2||N[1]!=2||(N[2]<<8|N[3])!=R)&&t(3,"bad rgbe scanline format");let q=0,H;for(;q<I&&k<P.byteLength;){H=P[k++];let de=H>128;if(de&&(H-=128),(H===0||q+H>I)&&t(3,"bad scanline data"),de){let ye=P[k++];for(let Ce=0;Ce<H;Ce++)V[q++]=ye}else V.set(P.subarray(k,k+H),q),q+=H,k+=H}let re=R;for(let de=0;de<re;de++){let ye=0;z[B]=V[de+ye],ye+=R,z[B+1]=V[de+ye],ye+=R,z[B+2]=V[de+ye],ye+=R,z[B+3]=V[de+ye],B+=4}W--}return z},u=function(P,C,b,R){let z=P[C+3],B=Math.pow(2,z-128)/255;b[R+0]=P[C+0]*B,b[R+1]=P[C+1]*B,b[R+2]=P[C+2]*B,b[R+3]=1},f=function(P,C,b,R){let z=P[C+3],B=Math.pow(2,z-128)/255;b[R+0]=gp.toHalfFloat(Math.min(P[C+0]*B,65504)),b[R+1]=gp.toHalfFloat(Math.min(P[C+1]*B,65504)),b[R+2]=gp.toHalfFloat(Math.min(P[C+2]*B,65504)),b[R+3]=gp.toHalfFloat(1)},d=new Uint8Array(e);d.pos=0;let m=s(d),_=m.width,y=m.height,w=a(d.subarray(d.pos),_,y),T,E,M;switch(this.type){case Co:M=w.length/4;let P=new Float32Array(M*4);for(let b=0;b<M;b++)u(w,b*4,P,b*4);T=P,E=Co;break;case Da:M=w.length/4;let C=new Uint16Array(M*4);for(let b=0;b<M;b++)f(w,b*4,C,b*4);T=C,E=Da;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:_,height:y,data:T,header:m.string,gamma:m.gamma,exposure:m.exposure,type:E}}setDataType(e){return this.type=e,this}load(e,t,n,i){function s(a,u){switch(a.type){case Co:case Da:"colorSpace"in a?a.colorSpace="srgb-linear":a.encoding=3e3,a.minFilter=ai,a.magFilter=ai,a.generateMipmaps=!1,a.flipY=!0;break}t&&t(a,u)}return super.load(e,s,n,i)}};function $v(r,{path:e}){return a1(Hk,r,t=>t.setPath(e))}function Gk(r=!0,e=.1){let[t,n]=at.useState(!0),i=at.useRef(null);return at.useEffect(()=>{if(!r)return;let s=new IntersectionObserver(([a])=>{n(a.isIntersecting)},{threshold:e});return i.current&&s.observe(i.current),()=>s.disconnect()},[r,e]),{isInView:t,containerRef:i}}var Wk=(r,e)=>({dpr:r,camera:{fov:e},linear:!0,flat:!0,gl:{preserveDrawingBuffer:!0}}),jk=1,qk=14,xE={zoom:1,distance:14},wE={zoom:5,distance:14},Xk="https://ruucm.github.io/shadergradient/shadergradient@1.0.0/hdr/",d2=at.createContext({}),$k=()=>at.useContext(d2);function Yk({children:r,style:e={},pixelDensity:t=1,fov:n=45,pointerEvents:i,className:s,envBasePath:a,lazyLoad:u=!0,threshold:f=.1}){let{isInView:d,containerRef:m}=Gk(u,f),_=at.useMemo(()=>({envBasePath:a||Xk}),[a]);return Qk(),rt.jsx("div",{ref:m,style:Mo({width:"100%",height:"100%"},e),children:(!u||d)&&rt.jsx(d2.Provider,{value:_,children:rt.jsx(xk,Nk(Mo({style:{pointerEvents:i},resize:{offsetSize:!0},className:s},Wk(t,n)),{children:r}))})})}function Qk(){at.useEffect(()=>{Xt.uv2_pars_vertex="",Xt.uv2_vertex="",Xt.uv2_pars_fragment="",Xt.encodings_fragment=""},[])}var Kk=r=>r.current&&r.current.isScene,Zk=r=>Kk(r)?r.current:r;function Jk({background:r=!1,envPreset:e}){let{envBasePath:t}=$k(),n=$v("city.hdr",{path:t}),i=$v("dawn.hdr",{path:t}),s=$v("lobby.hdr",{path:t}),a={city:n,dawn:i,lobby:s}[e],u=E0(d=>d.scene);Mu.useLayoutEffect(()=>{if(a){let d=Zk(u);d.background;let m=d.environment;return r!=="only"&&(d.environment=a),r&&(d.background=a),()=>{r!=="only"&&(d.environment=m),r&&(d.background="black")}}},[u,a,r]);let f=a;return f.mapping=Hf,null}function e5({lightType:r,brightness:e,envPreset:t}){return rt.jsxs(rt.Fragment,{children:[r==="3d"&&rt.jsx("ambientLight",{intensity:(e||1)*Math.PI}),r==="env"&&rt.jsx(at.Suspense,{fallback:rt.jsx(t5,{}),children:rt.jsx(Jk,{envPreset:t,background:!1,loadingCallback:()=>{}})})]})}function t5(){return rt.jsx("ambientLight",{intensity:.4})}function n5({type:r,cAzimuthAngle:e,cPolarAngle:t,cDistance:n,cameraZoom:i,zoomOut:s,enableTransition:a=!0}){let u=at.useRef();return o1((f,d)=>u.current.update(d)),at.useEffect(()=>{let f=u.current;f==null||f.rotateTo(ex(e),ex(t),a)},[u,e,t]),at.useEffect(()=>{let f=u.current;s?r==="sphere"?(f==null||f.dollyTo(wE.distance,a),f==null||f.zoomTo(wE.zoom,a)):(f==null||f.dollyTo(xE.distance,a),f==null||f.zoomTo(xE.zoom,a)):r==="sphere"?(f==null||f.zoomTo(i,a),f==null||f.dollyTo(qk,a)):(f==null||f.dollyTo(n,a),f==null||f.zoomTo(jk,a))},[u,s,r,i,n]),u}var mi={LEFT:1,RIGHT:2,MIDDLE:4},Pe=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),Cf={NONE:0,IN:1,OUT:-1};function kc(r){return r.isPerspectiveCamera}function wu(r){return r.isOrthographicCamera}var Af=Math.PI*2,SE=Math.PI/2,p2=1e-5,up=Math.PI/180;function ta(r,e,t){return Math.max(e,Math.min(t,r))}function ei(r,e=p2){return Math.abs(r)<e}function On(r,e,t=p2){return ei(r-e,t)}function EE(r,e){return Math.round(r/e)*e}function cp(r){return isFinite(r)?r:r<0?-Number.MAX_VALUE:Number.MAX_VALUE}function hp(r){return Math.abs(r)<Number.MAX_VALUE?r:r*(1/0)}function Zg(r,e,t,n,i=1/0,s){n=Math.max(1e-4,n);let a=2/n,u=a*s,f=1/(1+u+.48*u*u+.235*u*u*u),d=r-e,m=e,_=i*n;d=ta(d,-_,_),e=r-d;let y=(t.value+a*d)*s;t.value=(t.value-a*y)*f;let w=e+(d+y)*f;return m-r>0==w>m&&(w=m,t.value=(w-m)/s),w}function TE(r,e,t,n,i=1/0,s,a){n=Math.max(1e-4,n);let u=2/n,f=u*s,d=1/(1+f+.48*f*f+.235*f*f*f),m=e.x,_=e.y,y=e.z,w=r.x-m,T=r.y-_,E=r.z-y,M=m,P=_,C=y,b=i*n,R=b*b,z=w*w+T*T+E*E;if(z>R){let de=Math.sqrt(z);w=w/de*b,T=T/de*b,E=E/de*b}m=r.x-w,_=r.y-T,y=r.z-E;let B=(t.x+u*w)*s,k=(t.y+u*T)*s,I=(t.z+u*E)*s;t.x=(t.x-u*B)*d,t.y=(t.y-u*k)*d,t.z=(t.z-u*I)*d,a.x=m+(w+B)*d,a.y=_+(T+k)*d,a.z=y+(E+I)*d;let N=M-r.x,V=P-r.y,W=C-r.z,q=a.x-M,H=a.y-P,re=a.z-C;return N*q+V*H+W*re>0&&(a.x=M,a.y=P,a.z=C,t.x=(a.x-M)/s,t.y=(a.y-P)/s,t.z=(a.z-C)/s),a}function Yv(r,e){e.set(0,0),r.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=r.length,e.y/=r.length}function Qv(r,e){return wu(r)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}var i5=class{constructor(){this._listeners={}}addEventListener(r,e){let t=this._listeners;t[r]===void 0&&(t[r]=[]),t[r].indexOf(e)===-1&&t[r].push(e)}hasEventListener(r,e){let t=this._listeners;return t[r]!==void 0&&t[r].indexOf(e)!==-1}removeEventListener(r,e){let t=this._listeners[r];if(t!==void 0){let n=t.indexOf(e);n!==-1&&t.splice(n,1)}}removeAllEventListeners(r){if(!r){this._listeners={};return}Array.isArray(this._listeners[r])&&(this._listeners[r].length=0)}dispatchEvent(r){let e=this._listeners[r.type];if(e!==void 0){r.target=this;let t=e.slice(0);for(let n=0,i=t.length;n<i;n++)t[n].call(this,r)}}},Kv,r5="2.9.0",Jg=1/8,s5=/Mac/.test((Kv=globalThis==null?void 0:globalThis.navigator)===null||Kv===void 0?void 0:Kv.platform),Vt,ME,e0,Zv,Ds,nn,Pn,bf,fp,ba,Pa,zc,CE,AE,So,dp,Pf,bE,Jv,PE,ey,ty,t0,IE=class tx extends i5{static install(e){Vt=e.THREE,ME=Object.freeze(new Vt.Vector3(0,0,0)),e0=Object.freeze(new Vt.Vector3(0,1,0)),Zv=Object.freeze(new Vt.Vector3(0,0,1)),Ds=new Vt.Vector2,nn=new Vt.Vector3,Pn=new Vt.Vector3,bf=new Vt.Vector3,fp=new Vt.Vector3,ba=new Vt.Vector3,Pa=new Vt.Vector3,zc=new Vt.Vector3,CE=new Vt.Vector3,AE=new Vt.Vector3,So=new Vt.Spherical,dp=new Vt.Spherical,Pf=new Vt.Box3,bE=new Vt.Box3,Jv=new Vt.Sphere,PE=new Vt.Quaternion,ey=new Vt.Quaternion,ty=new Vt.Matrix4,t0=new Vt.Raycaster}static get ACTION(){return Pe}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=Pe.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=Cf.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new Vt.Vector3,this._focalOffsetVelocity=new Vt.Vector3,this._zoomVelocity={value:0},this._truckInternal=(P,C,b)=>{let R,z;if(kc(this._camera)){let B=nn.copy(this._camera.position).sub(this._target),k=this._camera.getEffectiveFOV()*up,I=B.length()*Math.tan(k*.5);R=this.truckSpeed*P*I/this._elementRect.height,z=this.truckSpeed*C*I/this._elementRect.height}else if(wu(this._camera)){let B=this._camera;R=P*(B.right-B.left)/B.zoom/this._elementRect.width,z=C*(B.top-B.bottom)/B.zoom/this._elementRect.height}else return;this.verticalDragToForward?(b?this.setFocalOffset(this._focalOffsetEnd.x+R,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(R,0,!0),this.forward(-z,!0)):b?this.setFocalOffset(this._focalOffsetEnd.x+R,this._focalOffsetEnd.y+z,this._focalOffsetEnd.z,!0):this.truck(R,z,!0)},this._rotateInternal=(P,C)=>{let b=Af*this.azimuthRotateSpeed*P/this._elementRect.height,R=Af*this.polarRotateSpeed*C/this._elementRect.height;this.rotate(b,R,!0)},this._dollyInternal=(P,C,b)=>{let R=Math.pow(.95,-P*this.dollySpeed),z=this._sphericalEnd.radius,B=this._sphericalEnd.radius*R,k=ta(B,this.minDistance,this.maxDistance),I=k-B;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(B,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(I,!0),this._dollyToNoClamp(k,!0)):this._dollyToNoClamp(k,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?B:k)-z,this._dollyControlCoord.set(C,b)),this._lastDollyDirection=Math.sign(-P)},this._zoomInternal=(P,C,b)=>{let R=Math.pow(.95,P*this.dollySpeed),z=this._zoom,B=this._zoom*R;this.zoomTo(B,!0),this.dollyToCursor&&(this._changedZoom+=B-z,this._dollyControlCoord.set(C,b))},typeof Vt>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new Vt.Quaternion().setFromUnitVectors(this._camera.up,e0),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=Pe.NONE,this._target=new Vt.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new Vt.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new Vt.Spherical().setFromVector3(nn.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new Vt.Vector3,new Vt.Vector3,new Vt.Vector3,new Vt.Vector3],this._updateNearPlaneCorners(),this._boundary=new Vt.Box3(new Vt.Vector3(-1/0,-1/0,-1/0),new Vt.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new Vt.Vector2,this.mouseButtons={left:Pe.ROTATE,middle:Pe.DOLLY,right:Pe.TRUCK,wheel:kc(this._camera)?Pe.DOLLY:wu(this._camera)?Pe.ZOOM:Pe.NONE},this.touches={one:Pe.TOUCH_ROTATE,two:kc(this._camera)?Pe.TOUCH_DOLLY_TRUCK:wu(this._camera)?Pe.TOUCH_ZOOM_TRUCK:Pe.NONE,three:Pe.TOUCH_TRUCK};let n=new Vt.Vector2,i=new Vt.Vector2,s=new Vt.Vector2,a=P=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){let R=this._domElement.getBoundingClientRect(),z=P.clientX/R.width,B=P.clientY/R.height;if(z<this._interactiveArea.left||z>this._interactiveArea.right||B<this._interactiveArea.top||B>this._interactiveArea.bottom)return}let C=P.pointerType!=="mouse"?null:(P.buttons&mi.LEFT)===mi.LEFT?mi.LEFT:(P.buttons&mi.MIDDLE)===mi.MIDDLE?mi.MIDDLE:(P.buttons&mi.RIGHT)===mi.RIGHT?mi.RIGHT:null;if(C!==null){let R=this._findPointerByMouseButton(C);R&&this._disposePointer(R)}if((P.buttons&mi.LEFT)===mi.LEFT&&this._lockedPointer)return;let b={pointerId:P.pointerId,clientX:P.clientX,clientY:P.clientY,deltaX:0,deltaY:0,mouseButton:C};this._activePointers.push(b),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",f),this._domElement.ownerDocument.addEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",f),this._isDragging=!0,y(P)},u=P=>{P.cancelable&&P.preventDefault();let C=P.pointerId,b=this._lockedPointer||this._findPointerById(C);if(b){if(b.clientX=P.clientX,b.clientY=P.clientY,b.deltaX=P.movementX,b.deltaY=P.movementY,this._state=0,P.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(P.buttons&mi.LEFT)===mi.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(P.buttons&mi.MIDDLE)===mi.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(P.buttons&mi.RIGHT)===mi.RIGHT&&(this._state=this._state|this.mouseButtons.right);w()}},f=P=>{let C=this._findPointerById(P.pointerId);if(!(C&&C===this._lockedPointer)){if(C&&this._disposePointer(C),P.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=Pe.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=Pe.NONE;T()}},d=-1,m=P=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===Pe.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){let B=this._domElement.getBoundingClientRect(),k=P.clientX/B.width,I=P.clientY/B.height;if(k<this._interactiveArea.left||k>this._interactiveArea.right||I<this._interactiveArea.top||I>this._interactiveArea.bottom)return}if(P.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===Pe.ROTATE||this.mouseButtons.wheel===Pe.TRUCK){let B=performance.now();d-B<1e3&&this._getClientRect(this._elementRect),d=B}let C=s5?-1:-3,b=P.deltaMode===1?P.deltaY/C:P.deltaY/(C*10),R=this.dollyToCursor?(P.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,z=this.dollyToCursor?(P.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case Pe.ROTATE:{this._rotateInternal(P.deltaX,P.deltaY),this._isUserControllingRotate=!0;break}case Pe.TRUCK:{this._truckInternal(P.deltaX,P.deltaY,!1),this._isUserControllingTruck=!0;break}case Pe.OFFSET:{this._truckInternal(P.deltaX,P.deltaY,!0),this._isUserControllingOffset=!0;break}case Pe.DOLLY:{this._dollyInternal(-b,R,z),this._isUserControllingDolly=!0;break}case Pe.ZOOM:{this._zoomInternal(-b,R,z),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},_=P=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===tx.ACTION.NONE){let C=P instanceof PointerEvent?P.pointerId:0,b=this._findPointerById(C);b&&this._disposePointer(b),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",f);return}P.preventDefault()}},y=P=>{if(this._enabled){if(Yv(this._activePointers,Ds),this._getClientRect(this._elementRect),n.copy(Ds),i.copy(Ds),this._activePointers.length>=2){let C=Ds.x-this._activePointers[1].clientX,b=Ds.y-this._activePointers[1].clientY,R=Math.sqrt(C*C+b*b);s.set(0,R);let z=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,B=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;i.set(z,B)}if(this._state=0,!P)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in P&&P.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(P.buttons&mi.LEFT)===mi.LEFT&&(this._state=this._state|this.mouseButtons.left),(P.buttons&mi.MIDDLE)===mi.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(P.buttons&mi.RIGHT)===mi.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&Pe.ROTATE)===Pe.ROTATE||(this._state&Pe.TOUCH_ROTATE)===Pe.TOUCH_ROTATE||(this._state&Pe.TOUCH_DOLLY_ROTATE)===Pe.TOUCH_DOLLY_ROTATE||(this._state&Pe.TOUCH_ZOOM_ROTATE)===Pe.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&Pe.TRUCK)===Pe.TRUCK||(this._state&Pe.TOUCH_TRUCK)===Pe.TOUCH_TRUCK||(this._state&Pe.TOUCH_DOLLY_TRUCK)===Pe.TOUCH_DOLLY_TRUCK||(this._state&Pe.TOUCH_ZOOM_TRUCK)===Pe.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&Pe.DOLLY)===Pe.DOLLY||(this._state&Pe.TOUCH_DOLLY)===Pe.TOUCH_DOLLY||(this._state&Pe.TOUCH_DOLLY_TRUCK)===Pe.TOUCH_DOLLY_TRUCK||(this._state&Pe.TOUCH_DOLLY_OFFSET)===Pe.TOUCH_DOLLY_OFFSET||(this._state&Pe.TOUCH_DOLLY_ROTATE)===Pe.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&Pe.ZOOM)===Pe.ZOOM||(this._state&Pe.TOUCH_ZOOM)===Pe.TOUCH_ZOOM||(this._state&Pe.TOUCH_ZOOM_TRUCK)===Pe.TOUCH_ZOOM_TRUCK||(this._state&Pe.TOUCH_ZOOM_OFFSET)===Pe.TOUCH_ZOOM_OFFSET||(this._state&Pe.TOUCH_ZOOM_ROTATE)===Pe.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&Pe.OFFSET)===Pe.OFFSET||(this._state&Pe.TOUCH_OFFSET)===Pe.TOUCH_OFFSET||(this._state&Pe.TOUCH_DOLLY_OFFSET)===Pe.TOUCH_DOLLY_OFFSET||(this._state&Pe.TOUCH_ZOOM_OFFSET)===Pe.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},w=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,Yv(this._activePointers,Ds);let P=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,C=P?-P.deltaX:i.x-Ds.x,b=P?-P.deltaY:i.y-Ds.y;if(i.copy(Ds),((this._state&Pe.ROTATE)===Pe.ROTATE||(this._state&Pe.TOUCH_ROTATE)===Pe.TOUCH_ROTATE||(this._state&Pe.TOUCH_DOLLY_ROTATE)===Pe.TOUCH_DOLLY_ROTATE||(this._state&Pe.TOUCH_ZOOM_ROTATE)===Pe.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(C,b),this._isUserControllingRotate=!0),(this._state&Pe.DOLLY)===Pe.DOLLY||(this._state&Pe.ZOOM)===Pe.ZOOM){let R=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,z=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0,B=this.dollyDragInverted?-1:1;(this._state&Pe.DOLLY)===Pe.DOLLY?(this._dollyInternal(B*b*Jg,R,z),this._isUserControllingDolly=!0):(this._zoomInternal(B*b*Jg,R,z),this._isUserControllingZoom=!0)}if((this._state&Pe.TOUCH_DOLLY)===Pe.TOUCH_DOLLY||(this._state&Pe.TOUCH_ZOOM)===Pe.TOUCH_ZOOM||(this._state&Pe.TOUCH_DOLLY_TRUCK)===Pe.TOUCH_DOLLY_TRUCK||(this._state&Pe.TOUCH_ZOOM_TRUCK)===Pe.TOUCH_ZOOM_TRUCK||(this._state&Pe.TOUCH_DOLLY_OFFSET)===Pe.TOUCH_DOLLY_OFFSET||(this._state&Pe.TOUCH_ZOOM_OFFSET)===Pe.TOUCH_ZOOM_OFFSET||(this._state&Pe.TOUCH_DOLLY_ROTATE)===Pe.TOUCH_DOLLY_ROTATE||(this._state&Pe.TOUCH_ZOOM_ROTATE)===Pe.TOUCH_ZOOM_ROTATE){let R=Ds.x-this._activePointers[1].clientX,z=Ds.y-this._activePointers[1].clientY,B=Math.sqrt(R*R+z*z),k=s.y-B;s.set(0,B);let I=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,N=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&Pe.TOUCH_DOLLY)===Pe.TOUCH_DOLLY||(this._state&Pe.TOUCH_DOLLY_ROTATE)===Pe.TOUCH_DOLLY_ROTATE||(this._state&Pe.TOUCH_DOLLY_TRUCK)===Pe.TOUCH_DOLLY_TRUCK||(this._state&Pe.TOUCH_DOLLY_OFFSET)===Pe.TOUCH_DOLLY_OFFSET?(this._dollyInternal(k*Jg,I,N),this._isUserControllingDolly=!0):(this._zoomInternal(k*Jg,I,N),this._isUserControllingZoom=!0)}((this._state&Pe.TRUCK)===Pe.TRUCK||(this._state&Pe.TOUCH_TRUCK)===Pe.TOUCH_TRUCK||(this._state&Pe.TOUCH_DOLLY_TRUCK)===Pe.TOUCH_DOLLY_TRUCK||(this._state&Pe.TOUCH_ZOOM_TRUCK)===Pe.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(C,b,!1),this._isUserControllingTruck=!0),((this._state&Pe.OFFSET)===Pe.OFFSET||(this._state&Pe.TOUCH_OFFSET)===Pe.TOUCH_OFFSET||(this._state&Pe.TOUCH_DOLLY_OFFSET)===Pe.TOUCH_DOLLY_OFFSET||(this._state&Pe.TOUCH_ZOOM_OFFSET)===Pe.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(C,b,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},T=()=>{Yv(this._activePointers,Ds),i.copy(Ds),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",f),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",f),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",E),this._domElement.ownerDocument.addEventListener("pointerlockerror",M),this._domElement.ownerDocument.addEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",f),y())},this.unlockPointer=()=>{var P,C,b;this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),(P=this._domElement)===null||P===void 0||P.ownerDocument.exitPointerLock(),(C=this._domElement)===null||C===void 0||C.ownerDocument.removeEventListener("pointerlockchange",E),(b=this._domElement)===null||b===void 0||b.ownerDocument.removeEventListener("pointerlockerror",M),this.cancel()};let E=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},M=()=>{this.unlockPointer()};this._addAllEventListeners=P=>{this._domElement=P,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",a),this._domElement.addEventListener("pointercancel",f),this._domElement.addEventListener("wheel",m,{passive:!1}),this._domElement.addEventListener("contextmenu",_)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",a),this._domElement.removeEventListener("pointercancel",f),this._domElement.removeEventListener("wheel",m,{passive:!1}),this._domElement.removeEventListener("contextmenu",_),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",f),this._domElement.ownerDocument.removeEventListener("pointerlockchange",E),this._domElement.ownerDocument.removeEventListener("pointerlockerror",M))},this.cancel=()=>{this._state!==Pe.NONE&&(this._state=Pe.NONE,this._activePointers.length=0,T())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=ta(e.width,0,1),this._interactiveArea.height=ta(e.height,0,1),this._interactiveArea.x=ta(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=ta(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,n=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,n=!1){this._isUserControllingRotate=!1;let i=ta(e,this.minAzimuthAngle,this.maxAzimuthAngle),s=ta(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=i,this._sphericalEnd.phi=s,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);let a=!n||On(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&On(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(a)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=Cf.NONE,this._changedDolly=0,this._dollyToNoClamp(ta(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){let n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){let s=this._collisionTest(),a=On(s,this._spherical.radius);if(!(n>e)&&a)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,s)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);let i=!t||On(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(i)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(fp).multiplyScalar(e)),t||this._target.copy(this._targetEnd);let n=!t||On(this._target.x,this._targetEnd.x,this.restThreshold)&&On(this._target.y,this._targetEnd.y,this.restThreshold)&&On(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=ta(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);let n=!t||On(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t,n=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t,n=!1){this._camera.updateMatrix(),ba.setFromMatrixColumn(this._camera.matrix,0),Pa.setFromMatrixColumn(this._camera.matrix,1),ba.multiplyScalar(e),Pa.multiplyScalar(-t);let i=nn.copy(ba).add(Pa),s=Pn.copy(this._targetEnd).add(i);return this.moveTo(s.x,s.y,s.z,n)}forward(e,t=!1){nn.setFromMatrixColumn(this._camera.matrix,0),nn.crossVectors(this._camera.up,nn),nn.multiplyScalar(e);let n=Pn.copy(this._targetEnd).add(nn);return this.moveTo(n.x,n.y,n.z,t)}elevate(e,t=!1){return nn.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+nn.x,this._targetEnd.y+nn.y,this._targetEnd.z+nn.z,t)}moveTo(e,t,n,i=!1){this._isUserControllingTruck=!1;let s=nn.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,s,this.boundaryFriction),this._needsUpdate=!0,i||this._target.copy(this._targetEnd);let a=!i||On(this._target.x,this._targetEnd.x,this.restThreshold)&&On(this._target.y,this._targetEnd.y,this.restThreshold)&&On(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(a)}lookInDirectionOf(e,t,n,i=!1){let s=nn.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(s.x,s.y,s.z,i)}fitToBox(e,t,{cover:n=!1,paddingLeft:i=0,paddingRight:s=0,paddingBottom:a=0,paddingTop:u=0}={}){let f=[],d=e.isBox3?Pf.copy(e):Pf.setFromObject(e);d.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());let m=EE(this._sphericalEnd.theta,SE),_=EE(this._sphericalEnd.phi,SE);f.push(this.rotateTo(m,_,t));let y=nn.setFromSpherical(this._sphericalEnd).normalize(),w=PE.setFromUnitVectors(y,Zv),T=On(Math.abs(y.y),1);T&&w.multiply(ey.setFromAxisAngle(e0,m)),w.multiply(this._yAxisUpSpaceInverse);let E=bE.makeEmpty();Pn.copy(d.min).applyQuaternion(w),E.expandByPoint(Pn),Pn.copy(d.min).setX(d.max.x).applyQuaternion(w),E.expandByPoint(Pn),Pn.copy(d.min).setY(d.max.y).applyQuaternion(w),E.expandByPoint(Pn),Pn.copy(d.max).setZ(d.min.z).applyQuaternion(w),E.expandByPoint(Pn),Pn.copy(d.min).setZ(d.max.z).applyQuaternion(w),E.expandByPoint(Pn),Pn.copy(d.max).setY(d.min.y).applyQuaternion(w),E.expandByPoint(Pn),Pn.copy(d.max).setX(d.min.x).applyQuaternion(w),E.expandByPoint(Pn),Pn.copy(d.max).applyQuaternion(w),E.expandByPoint(Pn),E.min.x-=i,E.min.y-=a,E.max.x+=s,E.max.y+=u,w.setFromUnitVectors(Zv,y),T&&w.premultiply(ey.invert()),w.premultiply(this._yAxisUpSpace);let M=E.getSize(nn),P=E.getCenter(Pn).applyQuaternion(w);if(kc(this._camera)){let C=this.getDistanceToFitBox(M.x,M.y,M.z,n);f.push(this.moveTo(P.x,P.y,P.z,t)),f.push(this.dollyTo(C,t)),f.push(this.setFocalOffset(0,0,0,t))}else if(wu(this._camera)){let C=this._camera,b=C.right-C.left,R=C.top-C.bottom,z=n?Math.max(b/M.x,R/M.y):Math.min(b/M.x,R/M.y);f.push(this.moveTo(P.x,P.y,P.z,t)),f.push(this.zoomTo(z,t)),f.push(this.setFocalOffset(0,0,0,t))}return Promise.all(f)}fitToSphere(e,t){let n=[],i="isObject3D"in e?tx.createBoundingSphere(e,Jv):Jv.copy(e);if(n.push(this.moveTo(i.center.x,i.center.y,i.center.z,t)),kc(this._camera)){let s=this.getDistanceToFitSphere(i.radius);n.push(this.dollyTo(s,t))}else if(wu(this._camera)){let s=this._camera.right-this._camera.left,a=this._camera.top-this._camera.bottom,u=2*i.radius,f=Math.min(s/u,a/u);n.push(this.zoomTo(f,t))}return n.push(this.setFocalOffset(0,0,0,t)),Promise.all(n)}setLookAt(e,t,n,i,s,a,u=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Cf.NONE,this._changedDolly=0;let f=Pn.set(i,s,a),d=nn.set(e,t,n);this._targetEnd.copy(f),this._sphericalEnd.setFromVector3(d.sub(f).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,u||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let m=!u||On(this._target.x,this._targetEnd.x,this.restThreshold)&&On(this._target.y,this._targetEnd.y,this.restThreshold)&&On(this._target.z,this._targetEnd.z,this.restThreshold)&&On(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&On(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&On(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(m)}lerpLookAt(e,t,n,i,s,a,u,f,d,m,_,y,w,T=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Cf.NONE,this._changedDolly=0;let E=nn.set(i,s,a),M=Pn.set(e,t,n);So.setFromVector3(M.sub(E).applyQuaternion(this._yAxisUpSpace));let P=bf.set(m,_,y),C=Pn.set(u,f,d);dp.setFromVector3(C.sub(P).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(E.lerp(P,w));let b=dp.theta-So.theta,R=dp.phi-So.phi,z=dp.radius-So.radius;this._sphericalEnd.set(So.radius+z*w,So.phi+R*w,So.theta+b*w),this.normalizeRotations(),this._needsUpdate=!0,T||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let B=!T||On(this._target.x,this._targetEnd.x,this.restThreshold)&&On(this._target.y,this._targetEnd.y,this.restThreshold)&&On(this._target.z,this._targetEnd.z,this.restThreshold)&&On(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&On(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&On(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(B)}setPosition(e,t,n,i=!1){return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,i)}setTarget(e,t,n,i=!1){let s=this.getPosition(nn),a=this.setLookAt(s.x,s.y,s.z,e,t,n,i);return this._sphericalEnd.phi=ta(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),a}setFocalOffset(e,t,n,i=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,i||this._focalOffset.copy(this._focalOffsetEnd);let s=!i||On(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&On(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&On(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),ba.setFromMatrixColumn(this._camera.matrixWorldInverse,0),Pa.setFromMatrixColumn(this._camera.matrixWorldInverse,1),zc.setFromMatrixColumn(this._camera.matrixWorldInverse,2);let i=nn.set(e,t,n),s=i.distanceTo(this._camera.position),a=i.sub(this._camera.position);ba.multiplyScalar(a.x),Pa.multiplyScalar(a.y),zc.multiplyScalar(a.z),nn.copy(ba).add(Pa).add(zc),nn.z=nn.z+s,this.dollyTo(s,!1),this.setFocalOffset(-nn.x,nn.y,-nn.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,i){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new Vt.Vector4,typeof e=="number"?this._viewport.set(e,t,n,i):this._viewport.copy(e)}getDistanceToFitBox(e,t,n,i=!1){if(Qv(this._camera,"getDistanceToFitBox"))return this._spherical.radius;let s=e/t,a=this._camera.getEffectiveFOV()*up,u=this._camera.aspect;return((i?s>u:s<u)?t:e/u)*.5/Math.tan(a*.5)+n*.5}getDistanceToFitSphere(e){if(Qv(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;let t=this._camera.getEffectiveFOV()*up,n=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,i=1<this._camera.aspect?t:n;return e/Math.sin(i*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new Vt.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new Vt.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e||new Vt.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new Vt.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%Af,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=Af),this._spherical.theta+=Af*Math.round((this._sphericalEnd.theta-this._spherical.theta)/Af)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(e=!1){if(!On(this._camera.up.x,this._cameraUp0.x)||!On(this._camera.up.y,this._cameraUp0.y)||!On(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);let n=this.getPosition(nn);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}let t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,e0),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){let e=nn.subVectors(this._target,this._camera.position).normalize(),t=Pn.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();let n=this.getPosition(nn);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){let t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,i=this._sphericalEnd.radius-this._spherical.radius,s=CE.subVectors(this._targetEnd,this._target),a=AE.subVectors(this._focalOffsetEnd,this._focalOffset),u=this._zoomEnd-this._zoom;if(ei(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{let m=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=Zg(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,m,1/0,e),this._needsUpdate=!0}if(ei(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{let m=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=Zg(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,m,1/0,e),this._needsUpdate=!0}if(ei(i))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{let m=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=Zg(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,m,this.maxSpeed,e),this._needsUpdate=!0}if(ei(s.x)&&ei(s.y)&&ei(s.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{let m=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;TE(this._target,this._targetEnd,this._targetVelocity,m,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(ei(a.x)&&ei(a.y)&&ei(a.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{let m=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;TE(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,m,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(ei(u))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{let m=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=Zg(this._zoom,this._zoomEnd,this._zoomVelocity,m,1/0,e)}if(this.dollyToCursor){if(kc(this._camera)&&this._changedDolly!==0){let m=this._spherical.radius-this._lastDistance,_=this._camera,y=this._getCameraDirection(fp),w=nn.copy(y).cross(_.up).normalize();w.lengthSq()===0&&(w.x=1);let T=Pn.crossVectors(w,y),E=this._sphericalEnd.radius*Math.tan(_.getEffectiveFOV()*up*.5),M=(this._sphericalEnd.radius-m-this._sphericalEnd.radius)/this._sphericalEnd.radius,P=bf.copy(this._targetEnd).add(w.multiplyScalar(this._dollyControlCoord.x*E*_.aspect)).add(T.multiplyScalar(this._dollyControlCoord.y*E)),C=nn.copy(this._targetEnd).lerp(P,M),b=this._lastDollyDirection===Cf.IN&&this._spherical.radius<=this.minDistance,R=this._lastDollyDirection===Cf.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(b||R)){this._sphericalEnd.radius-=m,this._spherical.radius-=m;let B=Pn.copy(y).multiplyScalar(-m);C.add(B)}this._boundary.clampPoint(C,C);let z=Pn.subVectors(C,this._targetEnd);this._targetEnd.copy(C),this._target.add(z),this._changedDolly-=m,ei(this._changedDolly)&&(this._changedDolly=0)}else if(wu(this._camera)&&this._changedZoom!==0){let m=this._zoom-this._lastZoom,_=this._camera,y=nn.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(_.near+_.far)/(_.near-_.far)).unproject(_),w=Pn.set(0,0,-1).applyQuaternion(_.quaternion),T=bf.copy(y).add(w.multiplyScalar(-y.dot(_.up))),E=-(this._zoom-m-this._zoom)/this._zoom,M=this._getCameraDirection(fp),P=this._targetEnd.dot(M),C=nn.copy(this._targetEnd).lerp(T,E),b=C.dot(M),R=M.multiplyScalar(b-P);C.sub(R),this._boundary.clampPoint(C,C);let z=Pn.subVectors(C,this._targetEnd);this._targetEnd.copy(C),this._target.add(z),this._changedZoom-=m,ei(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;let f=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,f),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!ei(this._focalOffset.x)||!ei(this._focalOffset.y)||!ei(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),ba.setFromMatrixColumn(this._camera.matrix,0),Pa.setFromMatrixColumn(this._camera.matrix,1),zc.setFromMatrixColumn(this._camera.matrix,2),ba.multiplyScalar(this._focalOffset.x),Pa.multiplyScalar(-this._focalOffset.y),zc.multiplyScalar(this._focalOffset.z),nn.copy(ba).add(Pa).add(zc),this._camera.position.add(nn)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),nn.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);let d=this._needsUpdate;return d&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):d?(this.dispatchEvent({type:"update"}),ei(t,this.restThreshold)&&ei(n,this.restThreshold)&&ei(i,this.restThreshold)&&ei(s.x,this.restThreshold)&&ei(s.y,this.restThreshold)&&ei(s.z,this.restThreshold)&&ei(a.x,this.restThreshold)&&ei(a.y,this.restThreshold)&&ei(a.z,this.restThreshold)&&ei(u,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!d&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=d,this._needsUpdate=!1,d}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:cp(this.maxDistance),minZoom:this.minZoom,maxZoom:cp(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:cp(this.maxPolarAngle),minAzimuthAngle:cp(this.minAzimuthAngle),maxAzimuthAngle:cp(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:nn.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){let n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=hp(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=hp(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=hp(n.maxPolarAngle),this.minAzimuthAngle=hp(n.minAzimuthAngle),this.maxAzimuthAngle=hp(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this.verticalDragToForward=n.verticalDragToForward,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),So.setFromVector3(nn.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(So.theta,So.phi,t),this.dollyTo(So.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",r5),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){let i=t.lengthSq();if(i===0)return e;let s=Pn.copy(t).add(e),a=this._boundary.clampPoint(s,bf).sub(s),u=a.lengthSq();if(u===0)return e.add(t);if(u===i)return e;if(n===0)return e.add(t).add(a);{let f=1+n*u/t.dot(a);return e.add(Pn.copy(t).multiplyScalar(f)).add(a.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(kc(this._camera)){let e=this._camera,t=e.near,n=e.getEffectiveFOV()*up,i=Math.tan(n*.5)*t,s=i*e.aspect;this._nearPlaneCorners[0].set(-s,-i,0),this._nearPlaneCorners[1].set(s,-i,0),this._nearPlaneCorners[2].set(s,i,0),this._nearPlaneCorners[3].set(-s,i,0)}else if(wu(this._camera)){let e=this._camera,t=1/e.zoom,n=e.left*t,i=e.right*t,s=e.top*t,a=e.bottom*t;this._nearPlaneCorners[0].set(n,s,0),this._nearPlaneCorners[1].set(i,s,0),this._nearPlaneCorners[2].set(i,a,0),this._nearPlaneCorners[3].set(n,a,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||Qv(this._camera,"_collisionTest"))return e;let t=this._getTargetDirection(fp);ty.lookAt(ME,t,this._camera.up);for(let n=0;n<4;n++){let i=Pn.copy(this._nearPlaneCorners[n]);i.applyMatrix4(ty);let s=bf.addVectors(this._target,i);t0.set(s,t),t0.far=this._spherical.radius+1;let a=t0.intersectObjects(this.colliderMeshes);a.length!==0&&a[0].distance<e&&(e=a[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;let t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{let n=()=>{this.removeEventListener("rest",n),t()};this.addEventListener("rest",n)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new Vt.Sphere){let n=t,i=n.center;Pf.makeEmpty(),e.traverseVisible(a=>{a.isMesh&&Pf.expandByObject(a)}),Pf.getCenter(i);let s=0;return e.traverseVisible(a=>{if(!a.isMesh)return;let u=a,f=u.geometry.clone();f.applyMatrix4(u.matrixWorld);let d=f.attributes.position;for(let m=0,_=d.count;m<_;m++)nn.fromBufferAttribute(d,m),s=Math.max(s,i.distanceToSquared(nn))}),n.radius=Math.sqrt(s),n}};function o5(r){var e=r,{smoothTime:t=.05}=e,n=Jy(e,["smoothTime"]);IE.install({THREE:GC}),$C({CameraControls:IE});let i=E0(u=>u.camera),s=E0(u=>u.gl),a=n5(n);return rt.jsx("cameraControls",{ref:a,args:[i,s.domElement],enableDamping:!0,smoothTime:t,zoomSpeed:10,dollySpeed:10,restThreshold:0})}/*! Bundled license information:

camera-controls/dist/camera-controls.module.js:
  (*!
   * camera-controls
   * https://github.com/yomotsu/camera-controls
   * (c) 2017 @yomotsu
   * Released under the MIT License.
   *)
*/function a5(r){return rt.jsx(rt.Fragment,{children:rt.jsx(o5,Mo({},r))})}var l5=vm((r,e)=>{e.exports=t=>encodeURIComponent(t).replace(/[!'()*]/g,n=>`%${n.charCodeAt(0).toString(16).toUpperCase()}`)}),u5=vm((r,e)=>{var t="%[a-f0-9]{2}",n=new RegExp("("+t+")|([^%]+?)","gi"),i=new RegExp("("+t+")+","gi");function s(f,d){try{return[decodeURIComponent(f.join(""))]}catch{}if(f.length===1)return f;d=d||1;var m=f.slice(0,d),_=f.slice(d);return Array.prototype.concat.call([],s(m),s(_))}function a(f){try{return decodeURIComponent(f)}catch{for(var d=f.match(n)||[],m=1;m<d.length;m++)f=s(d,m).join(""),d=f.match(n)||[];return f}}function u(f){for(var d={"%FE%FF":"��","%FF%FE":"��"},m=i.exec(f);m;){try{d[m[0]]=decodeURIComponent(m[0])}catch{var _=a(m[0]);_!==m[0]&&(d[m[0]]=_)}m=i.exec(f)}d["%C2"]="�";for(var y=Object.keys(d),w=0;w<y.length;w++){var T=y[w];f=f.replace(new RegExp(T,"g"),d[T])}return f}e.exports=function(f){if(typeof f!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof f+"`");try{return f=f.replace(/\+/g," "),decodeURIComponent(f)}catch{return u(f)}}}),c5=vm((r,e)=>{e.exports=(t,n)=>{if(!(typeof t=="string"&&typeof n=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(n==="")return[t];let i=t.indexOf(n);return i===-1?[t]:[t.slice(0,i),t.slice(i+n.length)]}}),h5=vm((r,e)=>{e.exports=function(t,n){for(var i={},s=Object.keys(t),a=Array.isArray(n),u=0;u<s.length;u++){var f=s[u],d=t[f];(a?n.indexOf(f)!==-1:n(f,d,t))&&(i[f]=d)}return i}}),f5=vm(r=>{var e=l5(),t=u5(),n=c5(),i=h5(),s=C=>C==null,a=Symbol("encodeFragmentIdentifier");function u(C){switch(C.arrayFormat){case"index":return b=>(R,z)=>{let B=R.length;return z===void 0||C.skipNull&&z===null||C.skipEmptyString&&z===""?R:z===null?[...R,[m(b,C),"[",B,"]"].join("")]:[...R,[m(b,C),"[",m(B,C),"]=",m(z,C)].join("")]};case"bracket":return b=>(R,z)=>z===void 0||C.skipNull&&z===null||C.skipEmptyString&&z===""?R:z===null?[...R,[m(b,C),"[]"].join("")]:[...R,[m(b,C),"[]=",m(z,C)].join("")];case"colon-list-separator":return b=>(R,z)=>z===void 0||C.skipNull&&z===null||C.skipEmptyString&&z===""?R:z===null?[...R,[m(b,C),":list="].join("")]:[...R,[m(b,C),":list=",m(z,C)].join("")];case"comma":case"separator":case"bracket-separator":{let b=C.arrayFormat==="bracket-separator"?"[]=":"=";return R=>(z,B)=>B===void 0||C.skipNull&&B===null||C.skipEmptyString&&B===""?z:(B=B===null?"":B,z.length===0?[[m(R,C),b,m(B,C)].join("")]:[[z,m(B,C)].join(C.arrayFormatSeparator)])}default:return b=>(R,z)=>z===void 0||C.skipNull&&z===null||C.skipEmptyString&&z===""?R:z===null?[...R,m(b,C)]:[...R,[m(b,C),"=",m(z,C)].join("")]}}function f(C){let b;switch(C.arrayFormat){case"index":return(R,z,B)=>{if(b=/\[(\d*)\]$/.exec(R),R=R.replace(/\[\d*\]$/,""),!b){B[R]=z;return}B[R]===void 0&&(B[R]={}),B[R][b[1]]=z};case"bracket":return(R,z,B)=>{if(b=/(\[\])$/.exec(R),R=R.replace(/\[\]$/,""),!b){B[R]=z;return}if(B[R]===void 0){B[R]=[z];return}B[R]=[].concat(B[R],z)};case"colon-list-separator":return(R,z,B)=>{if(b=/(:list)$/.exec(R),R=R.replace(/:list$/,""),!b){B[R]=z;return}if(B[R]===void 0){B[R]=[z];return}B[R]=[].concat(B[R],z)};case"comma":case"separator":return(R,z,B)=>{let k=typeof z=="string"&&z.includes(C.arrayFormatSeparator),I=typeof z=="string"&&!k&&_(z,C).includes(C.arrayFormatSeparator);z=I?_(z,C):z;let N=k||I?z.split(C.arrayFormatSeparator).map(V=>_(V,C)):z===null?z:_(z,C);B[R]=N};case"bracket-separator":return(R,z,B)=>{let k=/(\[\])$/.test(R);if(R=R.replace(/\[\]$/,""),!k){B[R]=z&&_(z,C);return}let I=z===null?[]:z.split(C.arrayFormatSeparator).map(N=>_(N,C));if(B[R]===void 0){B[R]=I;return}B[R]=[].concat(B[R],I)};default:return(R,z,B)=>{if(B[R]===void 0){B[R]=z;return}B[R]=[].concat(B[R],z)}}}function d(C){if(typeof C!="string"||C.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function m(C,b){return b.encode?b.strict?e(C):encodeURIComponent(C):C}function _(C,b){return b.decode?t(C):C}function y(C){return Array.isArray(C)?C.sort():typeof C=="object"?y(Object.keys(C)).sort((b,R)=>Number(b)-Number(R)).map(b=>C[b]):C}function w(C){let b=C.indexOf("#");return b!==-1&&(C=C.slice(0,b)),C}function T(C){let b="",R=C.indexOf("#");return R!==-1&&(b=C.slice(R)),b}function E(C){C=w(C);let b=C.indexOf("?");return b===-1?"":C.slice(b+1)}function M(C,b){return b.parseNumbers&&!Number.isNaN(Number(C))&&typeof C=="string"&&C.trim()!==""?C=Number(C):b.parseBooleans&&C!==null&&(C.toLowerCase()==="true"||C.toLowerCase()==="false")&&(C=C.toLowerCase()==="true"),C}function P(C,b){b=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},b),d(b.arrayFormatSeparator);let R=f(b),z=Object.create(null);if(typeof C!="string"||(C=C.trim().replace(/^[?#&]/,""),!C))return z;for(let B of C.split("&")){if(B==="")continue;let[k,I]=n(b.decode?B.replace(/\+/g," "):B,"=");I=I===void 0?null:["comma","separator","bracket-separator"].includes(b.arrayFormat)?I:_(I,b),R(_(k,b),I,z)}for(let B of Object.keys(z)){let k=z[B];if(typeof k=="object"&&k!==null)for(let I of Object.keys(k))k[I]=M(k[I],b);else z[B]=M(k,b)}return b.sort===!1?z:(b.sort===!0?Object.keys(z).sort():Object.keys(z).sort(b.sort)).reduce((B,k)=>{let I=z[k];return I&&typeof I=="object"&&!Array.isArray(I)?B[k]=y(I):B[k]=I,B},Object.create(null))}r.extract=E,r.parse=P,r.stringify=(C,b)=>{if(!C)return"";b=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},b),d(b.arrayFormatSeparator);let R=I=>b.skipNull&&s(C[I])||b.skipEmptyString&&C[I]==="",z=u(b),B={};for(let I of Object.keys(C))R(I)||(B[I]=C[I]);let k=Object.keys(B);return b.sort!==!1&&k.sort(b.sort),k.map(I=>{let N=C[I];return N===void 0?"":N===null?m(I,b):Array.isArray(N)?N.length===0&&b.arrayFormat==="bracket-separator"?m(I,b)+"[]":N.reduce(z(I),[]).join("&"):m(I,b)+"="+m(N,b)}).filter(I=>I.length>0).join("&")},r.parseUrl=(C,b)=>{b=Object.assign({decode:!0},b);let[R,z]=n(C,"#");return Object.assign({url:R.split("?")[0]||"",query:P(E(C),b)},b&&b.parseFragmentIdentifier&&z?{fragmentIdentifier:_(z,b)}:{})},r.stringifyUrl=(C,b)=>{b=Object.assign({encode:!0,strict:!0,[a]:!0},b);let R=w(C.url).split("?")[0]||"",z=r.extract(C.url),B=r.parse(z,{sort:!1}),k=Object.assign(B,C.query),I=r.stringify(k,b);I&&(I=`?${I}`);let N=T(C.url);return C.fragmentIdentifier&&(N=`#${b[a]?m(C.fragmentIdentifier,b):C.fragmentIdentifier}`),`${R}${I}${N}`},r.pick=(C,b,R)=>{R=Object.assign({parseFragmentIdentifier:!0,[a]:!1},R);let{url:z,query:B,fragmentIdentifier:k}=r.parseUrl(C,R);return r.stringifyUrl({url:z,query:i(B,b),fragmentIdentifier:k},R)},r.exclude=(C,b,R)=>{let z=Array.isArray(b)?B=>!b.includes(B):(B,k)=>!b(B,k);return r.pick(C,z,R)}}),d5={halo:{props:{type:"plane",uAmplitude:1,uDensity:1.3,uSpeed:.4,uStrength:4,uTime:0,uFrequency:5.5,range:"enabled",rangeStart:0,rangeEnd:40,frameRate:10,destination:"onCanvas",format:"gif",axesHelper:"off",brightness:1.2,cAzimuthAngle:180,cDistance:3.6,cPolarAngle:90,cameraZoom:1,color1:"#ff5005",color2:"#dbba95",color3:"#d0bce1",embedMode:"off",envPreset:"city",gizmoHelper:"hide",grain:"on",lightType:"3d",pixelDensity:1,fov:45,positionX:-1.4,positionY:0,positionZ:0,reflection:.1,rotationX:0,rotationY:10,rotationZ:50,shader:"defaults",animate:"on",wireframe:!1}}},p5=zk(f5());function m5(r){let e=Mo(Mo({},d5.halo.props),r),{control:t,urlString:n}=e,i=Jy(e,["control","urlString"]);t==="query"&&(i=p5.parse(Bk(n),{parseNumbers:!0,parseBooleans:!0,arrayFormat:"index"}));let s=i,{lightType:a,envPreset:u,brightness:f,grain:d,toggleAxis:m}=s;return Jy(s,["lightType","envPreset","brightness","grain","toggleAxis"]),rt.jsxs(rt.Fragment,{children:[rt.jsx(Vk,Mo({},i)),rt.jsx(e5,{lightType:a,brightness:f,envPreset:u}),d!=="off"&&rt.jsx(wk,{}),rt.jsx(a5,Mo({},i))]})}var m2={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},RE=Mu.createContext&&Mu.createContext(m2),g5=["attr","size","title"];function _5(r,e){if(r==null)return{};var t=v5(r,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}function v5(r,e){if(r==null)return{};var t={};for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){if(e.indexOf(n)>=0)continue;t[n]=r[n]}return t}function C0(){return C0=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},C0.apply(this,arguments)}function DE(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function A0(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?DE(Object(t),!0).forEach(function(n){y5(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):DE(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function y5(r,e,t){return e=x5(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function x5(r){var e=w5(r,"string");return typeof e=="symbol"?e:e+""}function w5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function g2(r){return r&&r.map((e,t)=>Mu.createElement(e.tag,A0({key:t},e.attr),g2(e.child)))}function _2(r){return e=>Mu.createElement(S5,C0({attr:A0({},r.attr)},e),g2(r.child))}function S5(r){var e=t=>{var{attr:n,size:i,title:s}=r,a=_5(r,g5),u=i||t.size||"1em",f;return t.className&&(f=t.className),r.className&&(f=(f?f+" ":"")+r.className),Mu.createElement("svg",C0({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,a,{className:f,style:A0(A0({color:r.color||t.color},t.style),r.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),s&&Mu.createElement("title",null,s),r.children)};return RE!==void 0?Mu.createElement(RE.Consumer,null,t=>e(t)):e(m2)}function E5(r){return _2({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M17.3183118,0.0772036939 C18.5358869,0.132773211 19.3775594,0.311686093 20.156489,0.614412318 C20.9357539,0.917263935 21.5259307,1.30117806 22.1124276,1.88767349 C22.6988355,2.47414659 23.0827129,3.06422396 23.3856819,3.84361655 C23.688357,4.62263666 23.8672302,5.46418415 23.9227984,6.68172489 C23.9916356,8.19170553 24,8.72394829 24,11.9999742 C24,15.2760524 23.9916355,15.808302 23.9227954,17.3182896 C23.8672306,18.5358038 23.6883589,19.3773584 23.3855877,20.1566258 C23.0826716,20.9358162 22.6987642,21.5259396 22.1124276,22.1122749 C21.5259871,22.6987804 20.9357958,23.0827198 20.1563742,23.3856323 C19.3772192,23.6883583 18.5357324,23.8672318 17.3183209,23.9227442 C15.8086874,23.9916325 15.2765626,24 12,24 C8.72343739,24 8.19131258,23.9916325 6.68172382,23.9227463 C5.46426077,23.8672314 4.62270711,23.6883498 3.84342369,23.3855738 C3.0641689,23.0827004 2.47399369,22.6987612 1.88762592,22.1123283 C1.30117312,21.525877 0.91721975,20.9357071 0.614318116,20.1563835 C0.311643016,19.3773633 0.132769821,18.5358159 0.0772038909,17.3183251 C0.0083529426,15.8092887 0,15.2774634 0,11.9999742 C0,8.7225328 0.00835296697,8.19071076 0.0772047368,6.68165632 C0.132769821,5.46418415 0.311643016,4.62263666 0.614362729,3.84350174 C0.91719061,3.06430165 1.30113536,2.4741608 1.88757245,1.88772514 C2.47399369,1.30123879 3.0641689,0.917299613 3.84345255,0.614414972 C4.62236201,0.311696581 5.46409415,0.132773979 6.68163888,0.0772035898 C8.19074867,0.00835221992 8.72252573,0 12,0 C15.2774788,0 15.8092594,0.00835235053 17.3183118,0.0772036939 Z M12,2.66666667 C8.75959504,2.66666667 8.26400713,2.67445049 6.80319929,2.74109814 C5.87614637,2.78341009 5.31952221,2.90172878 4.80947575,3.09995521 C4.37397765,3.26922052 4.09725505,3.44924273 3.77324172,3.77329203 C3.44916209,4.09737087 3.26913181,4.37408574 3.09996253,4.80937168 C2.90169965,5.31965737 2.78340891,5.87618164 2.74109927,6.80321713 C2.67445122,8.26397158 2.66666667,8.75960374 2.66666667,11.9999742 C2.66666667,15.2403924 2.67445121,15.7360281 2.74109842,17.1967643 C2.78340891,18.1238184 2.90169965,18.6803426 3.09990404,19.1904778 C3.26914133,19.6259017 3.44919889,19.9026659 3.77329519,20.2267614 C4.09725505,20.5507573 4.37397765,20.7307795 4.80932525,20.8999863 C5.31971515,21.0982887 5.87621193,21.2165784 6.80323907,21.2588497 C8.26460439,21.3255353 8.76051223,21.3333333 12,21.3333333 C15.2394878,21.3333333 15.7353956,21.3255353 17.1968056,21.2588476 C18.123775,21.216579 18.6802056,21.0982995 19.1905083,20.9000309 C19.6260288,20.7307713 19.9027426,20.5507596 20.2267583,20.226708 C20.5507492,19.9027179 20.7308046,19.6259456 20.9000375,19.1906283 C21.0983009,18.6803412 21.2165908,18.1238118 21.2588986,17.196779 C21.3255376,15.7350718 21.3333333,15.2390126 21.3333333,11.9999742 C21.3333333,8.76098665 21.3255376,8.26493375 21.2589016,6.80323567 C21.2165911,5.87618164 21.0983004,5.31965737 20.9001178,4.80957831 C20.7308131,4.37403932 20.550774,4.09729207 20.2267583,3.77324038 C19.9027658,3.44924868 19.6260264,3.26922777 19.1905015,3.09996643 C18.6803988,2.90171817 18.1238378,2.78341062 17.1967608,2.74109868 C15.7359966,2.67445057 15.2404012,2.66666667 12,2.66666667 Z M12,18.2222222 C8.56356156,18.2222222 5.77777778,15.4364384 5.77777778,12 C5.77777778,8.56356156 8.56356156,5.77777778 12,5.77777778 C15.4364384,5.77777778 18.2222222,8.56356156 18.2222222,12 C18.2222222,15.4364384 15.4364384,18.2222222 12,18.2222222 Z M12,15.5555556 C13.9636791,15.5555556 15.5555556,13.9636791 15.5555556,12 C15.5555556,10.0363209 13.9636791,8.44444444 12,8.44444444 C10.0363209,8.44444444 8.44444444,10.0363209 8.44444444,12 C8.44444444,13.9636791 10.0363209,15.5555556 12,15.5555556 Z M18.2222222,7.11111111 C17.4858426,7.11111111 16.8888889,6.51415744 16.8888889,5.77777778 C16.8888889,5.04139811 17.4858426,4.44444444 18.2222222,4.44444444 C18.9586019,4.44444444 19.5555556,5.04139811 19.5555556,5.77777778 C19.5555556,6.51415744 18.9586019,7.11111111 18.2222222,7.11111111 Z"},child:[]}]})(r)}function T5(r){return _2({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448,209.91a210.06,210.06,0,0,1-122.77-39.25V349.38A162.55,162.55,0,1,1,185,188.31V278.2a74.62,74.62,0,1,0,52.23,71.18V0l88,0a121.18,121.18,0,0,0,1.86,22.17h0A122.18,122.18,0,0,0,381,102.39a121.43,121.43,0,0,0,67,20.14Z"},child:[]}]})(r)}const M5=()=>{};var LE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},C5=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=r[t++],a=r[t++],u=r[t++],f=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const s=r[t++],a=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},y2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],a=i+1<r.length,u=a?r[i+1]:0,f=i+2<r.length,d=f?r[i+2]:0,m=s>>2,_=(s&3)<<4|u>>4;let y=(u&15)<<2|d>>6,w=d&63;f||(w=64,a||(y=64)),n.push(t[m],t[_],t[y],t[w])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(v2(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):C5(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],u=i<r.length?t[r.charAt(i)]:0;++i;const d=i<r.length?t[r.charAt(i)]:64;++i;const _=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||u==null||d==null||_==null)throw new A5;const y=s<<2|u>>4;if(n.push(y),d!==64){const w=u<<4&240|d>>2;if(n.push(w),_!==64){const T=d<<6&192|_;n.push(T)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class A5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const b5=function(r){const e=v2(r);return y2.encodeByteArray(e,!0)},b0=function(r){return b5(r).replace(/\./g,"")},P5=function(r){try{return y2.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R5=()=>I5().__FIREBASE_DEFAULTS__,D5=()=>{if(typeof process>"u"||typeof LE>"u")return;const r=LE.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},L5=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&P5(r[1]);return e&&JSON.parse(e)},h1=()=>{try{return M5()||R5()||D5()||L5()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},O5=r=>{var e,t;return(t=(e=h1())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},N5=r=>{const e=O5(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},x2=()=>{var r;return(r=h1())===null||r===void 0?void 0:r.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z5(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[b0(JSON.stringify(t)),b0(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F5(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function U5(){var r;const e=(r=h1())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function B5(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function V5(){return!U5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function w2(){try{return typeof indexedDB=="object"}catch{return!1}}function S2(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}function H5(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G5="FirebaseError";class ju extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=G5,Object.setPrototypeOf(this,ju.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,h_.prototype.create)}}class h_{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?W5(s,n):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new ju(i,u,n)}}function W5(r,e){return r.replace(j5,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const j5=/\{\$([^}]+)}/g;function jp(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],a=e[i];if(OE(s)&&OE(a)){if(!jp(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function OE(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q5=1e3,X5=2,$5=4*60*60*1e3,Y5=.5;function NE(r,e=q5,t=X5){const n=e*Math.pow(t,r),i=Math.round(Y5*n*(Math.random()-.5)*2);return Math.min($5,n+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ah(r){return r&&r._delegate?r._delegate:r}class Dl{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new k5;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Z5(e))try{this.getOrInitializeService({instanceIdentifier:Uc})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Uc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Uc){return this.instances.has(e)}getOptions(e=Uc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);n===u&&a.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:K5(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Uc){return this.component?this.component.multipleInstances?e:Uc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function K5(r){return r===Uc?void 0:r}function Z5(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Q5(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sn;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Sn||(Sn={}));const ez={debug:Sn.DEBUG,verbose:Sn.VERBOSE,info:Sn.INFO,warn:Sn.WARN,error:Sn.ERROR,silent:Sn.SILENT},tz=Sn.INFO,nz={[Sn.DEBUG]:"log",[Sn.VERBOSE]:"log",[Sn.INFO]:"info",[Sn.WARN]:"warn",[Sn.ERROR]:"error"},iz=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=nz[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class f1{constructor(e){this.name=e,this._logLevel=tz,this._logHandler=iz,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Sn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ez[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Sn.DEBUG,...e),this._logHandler(this,Sn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Sn.VERBOSE,...e),this._logHandler(this,Sn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Sn.INFO,...e),this._logHandler(this,Sn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Sn.WARN,...e),this._logHandler(this,Sn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Sn.ERROR,...e),this._logHandler(this,Sn.ERROR,...e)}}const rz=(r,e)=>e.some(t=>r instanceof t);let kE,zE;function sz(){return kE||(kE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oz(){return zE||(zE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const E2=new WeakMap,nx=new WeakMap,T2=new WeakMap,ny=new WeakMap,d1=new WeakMap;function az(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",a)},s=()=>{t(Au(r.result)),i()},a=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&E2.set(t,r)}).catch(()=>{}),d1.set(e,r),e}function lz(r){if(nx.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",a),r.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",a),r.addEventListener("abort",a)});nx.set(r,e)}let ix={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return nx.get(r);if(e==="objectStoreNames")return r.objectStoreNames||T2.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Au(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function uz(r){ix=r(ix)}function cz(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(iy(this),e,...t);return T2.set(n,e.sort?e.sort():[e]),Au(n)}:oz().includes(r)?function(...e){return r.apply(iy(this),e),Au(E2.get(this))}:function(...e){return Au(r.apply(iy(this),e))}}function hz(r){return typeof r=="function"?cz(r):(r instanceof IDBTransaction&&lz(r),rz(r,sz())?new Proxy(r,ix):r)}function Au(r){if(r instanceof IDBRequest)return az(r);if(ny.has(r))return ny.get(r);const e=hz(r);return e!==r&&(ny.set(r,e),d1.set(e,r)),e}const iy=r=>d1.get(r);function M2(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(r,e),u=Au(a);return n&&a.addEventListener("upgradeneeded",f=>{n(Au(a.result),f.oldVersion,f.newVersion,Au(a.transaction),f)}),t&&a.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),u.then(f=>{s&&f.addEventListener("close",()=>s()),i&&f.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const fz=["get","getKey","getAll","getAllKeys","count"],dz=["put","add","delete","clear"],ry=new Map;function FE(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(ry.get(e))return ry.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=dz.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||fz.includes(t)))return;const s=async function(a,...u){const f=this.transaction(a,i?"readwrite":"readonly");let d=f.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[t](...u),i&&f.done]))[0]};return ry.set(e,s),s}uz(r=>({...r,get:(e,t,n)=>FE(e,t)||r.get(e,t,n),has:(e,t)=>!!FE(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pz{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(mz(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function mz(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const rx="@firebase/app",UE="0.11.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=new f1("@firebase/app"),gz="@firebase/app-compat",_z="@firebase/analytics-compat",vz="@firebase/analytics",yz="@firebase/app-check-compat",xz="@firebase/app-check",wz="@firebase/auth",Sz="@firebase/auth-compat",Ez="@firebase/database",Tz="@firebase/data-connect",Mz="@firebase/database-compat",Cz="@firebase/functions",Az="@firebase/functions-compat",bz="@firebase/installations",Pz="@firebase/installations-compat",Iz="@firebase/messaging",Rz="@firebase/messaging-compat",Dz="@firebase/performance",Lz="@firebase/performance-compat",Oz="@firebase/remote-config",Nz="@firebase/remote-config-compat",kz="@firebase/storage",zz="@firebase/storage-compat",Fz="@firebase/firestore",Uz="@firebase/vertexai",Bz="@firebase/firestore-compat",Vz="firebase",Hz="11.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sx="[DEFAULT]",Gz={[rx]:"fire-core",[gz]:"fire-core-compat",[vz]:"fire-analytics",[_z]:"fire-analytics-compat",[xz]:"fire-app-check",[yz]:"fire-app-check-compat",[wz]:"fire-auth",[Sz]:"fire-auth-compat",[Ez]:"fire-rtdb",[Tz]:"fire-data-connect",[Mz]:"fire-rtdb-compat",[Cz]:"fire-fn",[Az]:"fire-fn-compat",[bz]:"fire-iid",[Pz]:"fire-iid-compat",[Iz]:"fire-fcm",[Rz]:"fire-fcm-compat",[Dz]:"fire-perf",[Lz]:"fire-perf-compat",[Oz]:"fire-rc",[Nz]:"fire-rc-compat",[kz]:"fire-gcs",[zz]:"fire-gcs-compat",[Fz]:"fire-fst",[Bz]:"fire-fst-compat",[Uz]:"fire-vertex","fire-js":"fire-js",[Vz]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0=new Map,Wz=new Map,ox=new Map;function BE(r,e){try{r.container.addComponent(e)}catch(t){Ll.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function Nu(r){const e=r.name;if(ox.has(e))return Ll.debug(`There were multiple attempts to register component ${e}.`),!1;ox.set(e,r);for(const t of P0.values())BE(t,r);for(const t of Wz.values())BE(t,r);return!0}function ym(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function jz(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qz={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bu=new h_("app","Firebase",qz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xz{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Dl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bu.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $z=Hz;function C2(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:sx,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw bu.create("bad-app-name",{appName:String(i)});if(t||(t=x2()),!t)throw bu.create("no-options");const s=P0.get(i);if(s){if(jp(t,s.options)&&jp(n,s.config))return s;throw bu.create("duplicate-app",{appName:i})}const a=new J5(i);for(const f of ox.values())a.addComponent(f);const u=new Xz(t,n,a);return P0.set(i,u),u}function A2(r=sx){const e=P0.get(r);if(!e&&r===sx&&x2())return C2();if(!e)throw bu.create("no-app",{appName:r});return e}function Oa(r,e,t){var n;let i=(n=Gz[r])!==null&&n!==void 0?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ll.warn(u.join(" "));return}Nu(new Dl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yz="firebase-heartbeat-database",Qz=1,qp="firebase-heartbeat-store";let sy=null;function b2(){return sy||(sy=M2(Yz,Qz,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(qp)}catch(t){console.warn(t)}}}}).catch(r=>{throw bu.create("idb-open",{originalErrorMessage:r.message})})),sy}async function Kz(r){try{const t=(await b2()).transaction(qp),n=await t.objectStore(qp).get(P2(r));return await t.done,n}catch(e){if(e instanceof ju)Ll.warn(e.message);else{const t=bu.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ll.warn(t.message)}}}async function VE(r,e){try{const n=(await b2()).transaction(qp,"readwrite");await n.objectStore(qp).put(e,P2(r)),await n.done}catch(t){if(t instanceof ju)Ll.warn(t.message);else{const n=bu.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ll.warn(n.message)}}}function P2(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zz=1024,Jz=30;class eF{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new nF(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=HE();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>Jz){const a=iF(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ll.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=HE(),{heartbeatsToSend:n,unsentEntries:i}=tF(this._heartbeatsCache.heartbeats),s=b0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Ll.warn(t),""}}}function HE(){return new Date().toISOString().substring(0,10)}function tF(r,e=Zz){const t=[];let n=r.slice();for(const i of r){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),GE(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),GE(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class nF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return w2()?S2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Kz(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return VE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return VE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function GE(r){return b0(JSON.stringify({version:2,heartbeats:r})).length}function iF(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rF(r){Nu(new Dl("platform-logger",e=>new pz(e),"PRIVATE")),Nu(new Dl("heartbeat",e=>new eF(e),"PRIVATE")),Oa(rx,UE,r),Oa(rx,UE,"esm2017"),Oa("fire-js","")}rF("");var sF="firebase",oF="11.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Oa(sF,oF,"app");var WE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var p1;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,I){function N(){}N.prototype=I.prototype,k.D=I.prototype,k.prototype=new N,k.prototype.constructor=k,k.C=function(V,W,q){for(var H=Array(arguments.length-2),re=2;re<arguments.length;re++)H[re-2]=arguments[re];return I.prototype[W].apply(V,H)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(k,I,N){N||(N=0);var V=Array(16);if(typeof I=="string")for(var W=0;16>W;++W)V[W]=I.charCodeAt(N++)|I.charCodeAt(N++)<<8|I.charCodeAt(N++)<<16|I.charCodeAt(N++)<<24;else for(W=0;16>W;++W)V[W]=I[N++]|I[N++]<<8|I[N++]<<16|I[N++]<<24;I=k.g[0],N=k.g[1],W=k.g[2];var q=k.g[3],H=I+(q^N&(W^q))+V[0]+3614090360&4294967295;I=N+(H<<7&4294967295|H>>>25),H=q+(W^I&(N^W))+V[1]+3905402710&4294967295,q=I+(H<<12&4294967295|H>>>20),H=W+(N^q&(I^N))+V[2]+606105819&4294967295,W=q+(H<<17&4294967295|H>>>15),H=N+(I^W&(q^I))+V[3]+3250441966&4294967295,N=W+(H<<22&4294967295|H>>>10),H=I+(q^N&(W^q))+V[4]+4118548399&4294967295,I=N+(H<<7&4294967295|H>>>25),H=q+(W^I&(N^W))+V[5]+1200080426&4294967295,q=I+(H<<12&4294967295|H>>>20),H=W+(N^q&(I^N))+V[6]+2821735955&4294967295,W=q+(H<<17&4294967295|H>>>15),H=N+(I^W&(q^I))+V[7]+4249261313&4294967295,N=W+(H<<22&4294967295|H>>>10),H=I+(q^N&(W^q))+V[8]+1770035416&4294967295,I=N+(H<<7&4294967295|H>>>25),H=q+(W^I&(N^W))+V[9]+2336552879&4294967295,q=I+(H<<12&4294967295|H>>>20),H=W+(N^q&(I^N))+V[10]+4294925233&4294967295,W=q+(H<<17&4294967295|H>>>15),H=N+(I^W&(q^I))+V[11]+2304563134&4294967295,N=W+(H<<22&4294967295|H>>>10),H=I+(q^N&(W^q))+V[12]+1804603682&4294967295,I=N+(H<<7&4294967295|H>>>25),H=q+(W^I&(N^W))+V[13]+4254626195&4294967295,q=I+(H<<12&4294967295|H>>>20),H=W+(N^q&(I^N))+V[14]+2792965006&4294967295,W=q+(H<<17&4294967295|H>>>15),H=N+(I^W&(q^I))+V[15]+1236535329&4294967295,N=W+(H<<22&4294967295|H>>>10),H=I+(W^q&(N^W))+V[1]+4129170786&4294967295,I=N+(H<<5&4294967295|H>>>27),H=q+(N^W&(I^N))+V[6]+3225465664&4294967295,q=I+(H<<9&4294967295|H>>>23),H=W+(I^N&(q^I))+V[11]+643717713&4294967295,W=q+(H<<14&4294967295|H>>>18),H=N+(q^I&(W^q))+V[0]+3921069994&4294967295,N=W+(H<<20&4294967295|H>>>12),H=I+(W^q&(N^W))+V[5]+3593408605&4294967295,I=N+(H<<5&4294967295|H>>>27),H=q+(N^W&(I^N))+V[10]+38016083&4294967295,q=I+(H<<9&4294967295|H>>>23),H=W+(I^N&(q^I))+V[15]+3634488961&4294967295,W=q+(H<<14&4294967295|H>>>18),H=N+(q^I&(W^q))+V[4]+3889429448&4294967295,N=W+(H<<20&4294967295|H>>>12),H=I+(W^q&(N^W))+V[9]+568446438&4294967295,I=N+(H<<5&4294967295|H>>>27),H=q+(N^W&(I^N))+V[14]+3275163606&4294967295,q=I+(H<<9&4294967295|H>>>23),H=W+(I^N&(q^I))+V[3]+4107603335&4294967295,W=q+(H<<14&4294967295|H>>>18),H=N+(q^I&(W^q))+V[8]+1163531501&4294967295,N=W+(H<<20&4294967295|H>>>12),H=I+(W^q&(N^W))+V[13]+2850285829&4294967295,I=N+(H<<5&4294967295|H>>>27),H=q+(N^W&(I^N))+V[2]+4243563512&4294967295,q=I+(H<<9&4294967295|H>>>23),H=W+(I^N&(q^I))+V[7]+1735328473&4294967295,W=q+(H<<14&4294967295|H>>>18),H=N+(q^I&(W^q))+V[12]+2368359562&4294967295,N=W+(H<<20&4294967295|H>>>12),H=I+(N^W^q)+V[5]+4294588738&4294967295,I=N+(H<<4&4294967295|H>>>28),H=q+(I^N^W)+V[8]+2272392833&4294967295,q=I+(H<<11&4294967295|H>>>21),H=W+(q^I^N)+V[11]+1839030562&4294967295,W=q+(H<<16&4294967295|H>>>16),H=N+(W^q^I)+V[14]+4259657740&4294967295,N=W+(H<<23&4294967295|H>>>9),H=I+(N^W^q)+V[1]+2763975236&4294967295,I=N+(H<<4&4294967295|H>>>28),H=q+(I^N^W)+V[4]+1272893353&4294967295,q=I+(H<<11&4294967295|H>>>21),H=W+(q^I^N)+V[7]+4139469664&4294967295,W=q+(H<<16&4294967295|H>>>16),H=N+(W^q^I)+V[10]+3200236656&4294967295,N=W+(H<<23&4294967295|H>>>9),H=I+(N^W^q)+V[13]+681279174&4294967295,I=N+(H<<4&4294967295|H>>>28),H=q+(I^N^W)+V[0]+3936430074&4294967295,q=I+(H<<11&4294967295|H>>>21),H=W+(q^I^N)+V[3]+3572445317&4294967295,W=q+(H<<16&4294967295|H>>>16),H=N+(W^q^I)+V[6]+76029189&4294967295,N=W+(H<<23&4294967295|H>>>9),H=I+(N^W^q)+V[9]+3654602809&4294967295,I=N+(H<<4&4294967295|H>>>28),H=q+(I^N^W)+V[12]+3873151461&4294967295,q=I+(H<<11&4294967295|H>>>21),H=W+(q^I^N)+V[15]+530742520&4294967295,W=q+(H<<16&4294967295|H>>>16),H=N+(W^q^I)+V[2]+3299628645&4294967295,N=W+(H<<23&4294967295|H>>>9),H=I+(W^(N|~q))+V[0]+4096336452&4294967295,I=N+(H<<6&4294967295|H>>>26),H=q+(N^(I|~W))+V[7]+1126891415&4294967295,q=I+(H<<10&4294967295|H>>>22),H=W+(I^(q|~N))+V[14]+2878612391&4294967295,W=q+(H<<15&4294967295|H>>>17),H=N+(q^(W|~I))+V[5]+4237533241&4294967295,N=W+(H<<21&4294967295|H>>>11),H=I+(W^(N|~q))+V[12]+1700485571&4294967295,I=N+(H<<6&4294967295|H>>>26),H=q+(N^(I|~W))+V[3]+2399980690&4294967295,q=I+(H<<10&4294967295|H>>>22),H=W+(I^(q|~N))+V[10]+4293915773&4294967295,W=q+(H<<15&4294967295|H>>>17),H=N+(q^(W|~I))+V[1]+2240044497&4294967295,N=W+(H<<21&4294967295|H>>>11),H=I+(W^(N|~q))+V[8]+1873313359&4294967295,I=N+(H<<6&4294967295|H>>>26),H=q+(N^(I|~W))+V[15]+4264355552&4294967295,q=I+(H<<10&4294967295|H>>>22),H=W+(I^(q|~N))+V[6]+2734768916&4294967295,W=q+(H<<15&4294967295|H>>>17),H=N+(q^(W|~I))+V[13]+1309151649&4294967295,N=W+(H<<21&4294967295|H>>>11),H=I+(W^(N|~q))+V[4]+4149444226&4294967295,I=N+(H<<6&4294967295|H>>>26),H=q+(N^(I|~W))+V[11]+3174756917&4294967295,q=I+(H<<10&4294967295|H>>>22),H=W+(I^(q|~N))+V[2]+718787259&4294967295,W=q+(H<<15&4294967295|H>>>17),H=N+(q^(W|~I))+V[9]+3951481745&4294967295,k.g[0]=k.g[0]+I&4294967295,k.g[1]=k.g[1]+(W+(H<<21&4294967295|H>>>11))&4294967295,k.g[2]=k.g[2]+W&4294967295,k.g[3]=k.g[3]+q&4294967295}n.prototype.u=function(k,I){I===void 0&&(I=k.length);for(var N=I-this.blockSize,V=this.B,W=this.h,q=0;q<I;){if(W==0)for(;q<=N;)i(this,k,q),q+=this.blockSize;if(typeof k=="string"){for(;q<I;)if(V[W++]=k.charCodeAt(q++),W==this.blockSize){i(this,V),W=0;break}}else for(;q<I;)if(V[W++]=k[q++],W==this.blockSize){i(this,V),W=0;break}}this.h=W,this.o+=I},n.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var I=1;I<k.length-8;++I)k[I]=0;var N=8*this.o;for(I=k.length-8;I<k.length;++I)k[I]=N&255,N/=256;for(this.u(k),k=Array(16),I=N=0;4>I;++I)for(var V=0;32>V;V+=8)k[N++]=this.g[I]>>>V&255;return k};function s(k,I){var N=u;return Object.prototype.hasOwnProperty.call(N,k)?N[k]:N[k]=I(k)}function a(k,I){this.h=I;for(var N=[],V=!0,W=k.length-1;0<=W;W--){var q=k[W]|0;V&&q==I||(N[W]=q,V=!1)}this.g=N}var u={};function f(k){return-128<=k&&128>k?s(k,function(I){return new a([I|0],0>I?-1:0)}):new a([k|0],0>k?-1:0)}function d(k){if(isNaN(k)||!isFinite(k))return _;if(0>k)return M(d(-k));for(var I=[],N=1,V=0;k>=N;V++)I[V]=k/N|0,N*=4294967296;return new a(I,0)}function m(k,I){if(k.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(k.charAt(0)=="-")return M(m(k.substring(1),I));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=d(Math.pow(I,8)),V=_,W=0;W<k.length;W+=8){var q=Math.min(8,k.length-W),H=parseInt(k.substring(W,W+q),I);8>q?(q=d(Math.pow(I,q)),V=V.j(q).add(d(H))):(V=V.j(N),V=V.add(d(H)))}return V}var _=f(0),y=f(1),w=f(16777216);r=a.prototype,r.m=function(){if(E(this))return-M(this).m();for(var k=0,I=1,N=0;N<this.g.length;N++){var V=this.i(N);k+=(0<=V?V:4294967296+V)*I,I*=4294967296}return k},r.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(T(this))return"0";if(E(this))return"-"+M(this).toString(k);for(var I=d(Math.pow(k,6)),N=this,V="";;){var W=R(N,I).g;N=P(N,W.j(I));var q=((0<N.g.length?N.g[0]:N.h)>>>0).toString(k);if(N=W,T(N))return q+V;for(;6>q.length;)q="0"+q;V=q+V}},r.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function T(k){if(k.h!=0)return!1;for(var I=0;I<k.g.length;I++)if(k.g[I]!=0)return!1;return!0}function E(k){return k.h==-1}r.l=function(k){return k=P(this,k),E(k)?-1:T(k)?0:1};function M(k){for(var I=k.g.length,N=[],V=0;V<I;V++)N[V]=~k.g[V];return new a(N,~k.h).add(y)}r.abs=function(){return E(this)?M(this):this},r.add=function(k){for(var I=Math.max(this.g.length,k.g.length),N=[],V=0,W=0;W<=I;W++){var q=V+(this.i(W)&65535)+(k.i(W)&65535),H=(q>>>16)+(this.i(W)>>>16)+(k.i(W)>>>16);V=H>>>16,q&=65535,H&=65535,N[W]=H<<16|q}return new a(N,N[N.length-1]&-2147483648?-1:0)};function P(k,I){return k.add(M(I))}r.j=function(k){if(T(this)||T(k))return _;if(E(this))return E(k)?M(this).j(M(k)):M(M(this).j(k));if(E(k))return M(this.j(M(k)));if(0>this.l(w)&&0>k.l(w))return d(this.m()*k.m());for(var I=this.g.length+k.g.length,N=[],V=0;V<2*I;V++)N[V]=0;for(V=0;V<this.g.length;V++)for(var W=0;W<k.g.length;W++){var q=this.i(V)>>>16,H=this.i(V)&65535,re=k.i(W)>>>16,de=k.i(W)&65535;N[2*V+2*W]+=H*de,C(N,2*V+2*W),N[2*V+2*W+1]+=q*de,C(N,2*V+2*W+1),N[2*V+2*W+1]+=H*re,C(N,2*V+2*W+1),N[2*V+2*W+2]+=q*re,C(N,2*V+2*W+2)}for(V=0;V<I;V++)N[V]=N[2*V+1]<<16|N[2*V];for(V=I;V<2*I;V++)N[V]=0;return new a(N,0)};function C(k,I){for(;(k[I]&65535)!=k[I];)k[I+1]+=k[I]>>>16,k[I]&=65535,I++}function b(k,I){this.g=k,this.h=I}function R(k,I){if(T(I))throw Error("division by zero");if(T(k))return new b(_,_);if(E(k))return I=R(M(k),I),new b(M(I.g),M(I.h));if(E(I))return I=R(k,M(I)),new b(M(I.g),I.h);if(30<k.g.length){if(E(k)||E(I))throw Error("slowDivide_ only works with positive integers.");for(var N=y,V=I;0>=V.l(k);)N=z(N),V=z(V);var W=B(N,1),q=B(V,1);for(V=B(V,2),N=B(N,2);!T(V);){var H=q.add(V);0>=H.l(k)&&(W=W.add(N),q=H),V=B(V,1),N=B(N,1)}return I=P(k,W.j(I)),new b(W,I)}for(W=_;0<=k.l(I);){for(N=Math.max(1,Math.floor(k.m()/I.m())),V=Math.ceil(Math.log(N)/Math.LN2),V=48>=V?1:Math.pow(2,V-48),q=d(N),H=q.j(I);E(H)||0<H.l(k);)N-=V,q=d(N),H=q.j(I);T(q)&&(q=y),W=W.add(q),k=P(k,H)}return new b(W,k)}r.A=function(k){return R(this,k).h},r.and=function(k){for(var I=Math.max(this.g.length,k.g.length),N=[],V=0;V<I;V++)N[V]=this.i(V)&k.i(V);return new a(N,this.h&k.h)},r.or=function(k){for(var I=Math.max(this.g.length,k.g.length),N=[],V=0;V<I;V++)N[V]=this.i(V)|k.i(V);return new a(N,this.h|k.h)},r.xor=function(k){for(var I=Math.max(this.g.length,k.g.length),N=[],V=0;V<I;V++)N[V]=this.i(V)^k.i(V);return new a(N,this.h^k.h)};function z(k){for(var I=k.g.length+1,N=[],V=0;V<I;V++)N[V]=k.i(V)<<1|k.i(V-1)>>>31;return new a(N,k.h)}function B(k,I){var N=I>>5;I%=32;for(var V=k.g.length-N,W=[],q=0;q<V;q++)W[q]=0<I?k.i(q+N)>>>I|k.i(q+N+1)<<32-I:k.i(q+N);return new a(W,k.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=m,p1=a}).apply(typeof WE<"u"?WE:typeof self<"u"?self:typeof window<"u"?window:{});var n0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var I2,_p,R2,g0,ax,D2,L2,O2;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(g,L,U){return g==Array.prototype||g==Object.prototype||(g[L]=U.value),g};function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof n0=="object"&&n0];for(var L=0;L<g.length;++L){var U=g[L];if(U&&U.Math==Math)return U}throw Error("Cannot find global object")}var n=t(this);function i(g,L){if(L)e:{var U=n;g=g.split(".");for(var j=0;j<g.length-1;j++){var fe=g[j];if(!(fe in U))break e;U=U[fe]}g=g[g.length-1],j=U[g],L=L(j),L!=j&&L!=null&&e(U,g,{configurable:!0,writable:!0,value:L})}}function s(g,L){g instanceof String&&(g+="");var U=0,j=!1,fe={next:function(){if(!j&&U<g.length){var xe=U++;return{value:L(xe,g[xe]),done:!1}}return j=!0,{done:!0,value:void 0}}};return fe[Symbol.iterator]=function(){return fe},fe}i("Array.prototype.values",function(g){return g||function(){return s(this,function(L,U){return U})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},u=this||self;function f(g){var L=typeof g;return L=L!="object"?L:g?Array.isArray(g)?"array":L:"null",L=="array"||L=="object"&&typeof g.length=="number"}function d(g){var L=typeof g;return L=="object"&&g!=null||L=="function"}function m(g,L,U){return g.call.apply(g.bind,arguments)}function _(g,L,U){if(!g)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(fe,j),g.apply(L,fe)}}return function(){return g.apply(L,arguments)}}function y(g,L,U){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:_,y.apply(null,arguments)}function w(g,L){var U=Array.prototype.slice.call(arguments,1);return function(){var j=U.slice();return j.push.apply(j,arguments),g.apply(this,j)}}function T(g,L){function U(){}U.prototype=L.prototype,g.aa=L.prototype,g.prototype=new U,g.prototype.constructor=g,g.Qb=function(j,fe,xe){for(var We=Array(arguments.length-2),fn=2;fn<arguments.length;fn++)We[fn-2]=arguments[fn];return L.prototype[fe].apply(j,We)}}function E(g){const L=g.length;if(0<L){const U=Array(L);for(let j=0;j<L;j++)U[j]=g[j];return U}return[]}function M(g,L){for(let U=1;U<arguments.length;U++){const j=arguments[U];if(f(j)){const fe=g.length||0,xe=j.length||0;g.length=fe+xe;for(let We=0;We<xe;We++)g[fe+We]=j[We]}else g.push(j)}}class P{constructor(L,U){this.i=L,this.j=U,this.h=0,this.g=null}get(){let L;return 0<this.h?(this.h--,L=this.g,this.g=L.next,L.next=null):L=this.i(),L}}function C(g){return/^[\s\xa0]*$/.test(g)}function b(){var g=u.navigator;return g&&(g=g.userAgent)?g:""}function R(g){return R[" "](g),g}R[" "]=function(){};var z=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function B(g,L,U){for(const j in g)L.call(U,g[j],j,g)}function k(g,L){for(const U in g)L.call(void 0,g[U],U,g)}function I(g){const L={};for(const U in g)L[U]=g[U];return L}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(g,L){let U,j;for(let fe=1;fe<arguments.length;fe++){j=arguments[fe];for(U in j)g[U]=j[U];for(let xe=0;xe<N.length;xe++)U=N[xe],Object.prototype.hasOwnProperty.call(j,U)&&(g[U]=j[U])}}function W(g){var L=1;g=g.split(":");const U=[];for(;0<L&&g.length;)U.push(g.shift()),L--;return g.length&&U.push(g.join(":")),U}function q(g){u.setTimeout(()=>{throw g},0)}function H(){var g=oe;let L=null;return g.g&&(L=g.g,g.g=g.g.next,g.g||(g.h=null),L.next=null),L}class re{constructor(){this.h=this.g=null}add(L,U){const j=de.get();j.set(L,U),this.h?this.h.next=j:this.g=j,this.h=j}}var de=new P(()=>new ye,g=>g.reset());class ye{constructor(){this.next=this.g=this.h=null}set(L,U){this.h=L,this.g=U,this.next=null}reset(){this.next=this.g=this.h=null}}let Ce,K=!1,oe=new re,ne=()=>{const g=u.Promise.resolve(void 0);Ce=()=>{g.then(Q)}};var Q=()=>{for(var g;g=H();){try{g.h.call(g.g)}catch(U){q(U)}var L=de;L.j(g),100>L.h&&(L.h++,g.next=L.g,L.g=g)}K=!1};function $(){this.s=this.s,this.C=this.C}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function he(g,L){this.type=g,this.g=this.target=L,this.defaultPrevented=!1}he.prototype.h=function(){this.defaultPrevented=!0};var Ae=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var g=!1,L=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const U=()=>{};u.addEventListener("test",U,L),u.removeEventListener("test",U,L)}catch{}return g}();function se(g,L){if(he.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g){var U=this.type=g.type,j=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;if(this.target=g.target||g.srcElement,this.g=L,L=g.relatedTarget){if(z){e:{try{R(L.nodeName);var fe=!0;break e}catch{}fe=!1}fe||(L=null)}}else U=="mouseover"?L=g.fromElement:U=="mouseout"&&(L=g.toElement);this.relatedTarget=L,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=typeof g.pointerType=="string"?g.pointerType:Ne[g.pointerType]||"",this.state=g.state,this.i=g,g.defaultPrevented&&se.aa.h.call(this)}}T(se,he);var Ne={2:"touch",3:"pen",4:"mouse"};se.prototype.h=function(){se.aa.h.call(this);var g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var Oe="closure_listenable_"+(1e6*Math.random()|0),He=0;function Xe(g,L,U,j,fe){this.listener=g,this.proxy=null,this.src=L,this.type=U,this.capture=!!j,this.ha=fe,this.key=++He,this.da=this.fa=!1}function Je(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function ut(g){this.src=g,this.g={},this.h=0}ut.prototype.add=function(g,L,U,j,fe){var xe=g.toString();g=this.g[xe],g||(g=this.g[xe]=[],this.h++);var We=Le(g,L,j,fe);return-1<We?(L=g[We],U||(L.fa=!1)):(L=new Xe(L,this.src,xe,!!j,fe),L.fa=U,g.push(L)),L};function De(g,L){var U=L.type;if(U in g.g){var j=g.g[U],fe=Array.prototype.indexOf.call(j,L,void 0),xe;(xe=0<=fe)&&Array.prototype.splice.call(j,fe,1),xe&&(Je(L),g.g[U].length==0&&(delete g.g[U],g.h--))}}function Le(g,L,U,j){for(var fe=0;fe<g.length;++fe){var xe=g[fe];if(!xe.da&&xe.listener==L&&xe.capture==!!U&&xe.ha==j)return fe}return-1}var Qe="closure_lm_"+(1e6*Math.random()|0),gt={};function et(g,L,U,j,fe){if(Array.isArray(L)){for(var xe=0;xe<L.length;xe++)et(g,L[xe],U,j,fe);return null}return U=$e(U),g&&g[Oe]?g.K(L,U,d(j)?!!j.capture:!1,fe):It(g,L,U,!1,j,fe)}function It(g,L,U,j,fe,xe){if(!L)throw Error("Invalid event type");var We=d(fe)?!!fe.capture:!!fe,fn=X(g);if(fn||(g[Qe]=fn=new ut(g)),U=fn.add(L,U,j,We,xe),U.proxy)return U;if(j=At(),U.proxy=j,j.src=g,j.listener=U,g.addEventListener)Ae||(fe=We),fe===void 0&&(fe=!1),g.addEventListener(L.toString(),j,fe);else if(g.attachEvent)g.attachEvent(tn(L.toString()),j);else if(g.addListener&&g.removeListener)g.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return U}function At(){function g(U){return L.call(g.src,g.listener,U)}const L=ee;return g}function Pt(g,L,U,j,fe){if(Array.isArray(L))for(var xe=0;xe<L.length;xe++)Pt(g,L[xe],U,j,fe);else j=d(j)?!!j.capture:!!j,U=$e(U),g&&g[Oe]?(g=g.i,L=String(L).toString(),L in g.g&&(xe=g.g[L],U=Le(xe,U,j,fe),-1<U&&(Je(xe[U]),Array.prototype.splice.call(xe,U,1),xe.length==0&&(delete g.g[L],g.h--)))):g&&(g=X(g))&&(L=g.g[L.toString()],g=-1,L&&(g=Le(L,U,j,fe)),(U=-1<g?L[g]:null)&&Yt(U))}function Yt(g){if(typeof g!="number"&&g&&!g.da){var L=g.src;if(L&&L[Oe])De(L.i,g);else{var U=g.type,j=g.proxy;L.removeEventListener?L.removeEventListener(U,j,g.capture):L.detachEvent?L.detachEvent(tn(U),j):L.addListener&&L.removeListener&&L.removeListener(j),(U=X(L))?(De(U,g),U.h==0&&(U.src=null,L[Qe]=null)):Je(g)}}}function tn(g){return g in gt?gt[g]:gt[g]="on"+g}function ee(g,L){if(g.da)g=!0;else{L=new se(L,this);var U=g.listener,j=g.ha||g.src;g.fa&&Yt(g),g=U.call(j,L)}return g}function X(g){return g=g[Qe],g instanceof ut?g:null}var Se="__closure_events_fn_"+(1e9*Math.random()>>>0);function $e(g){return typeof g=="function"?g:(g[Se]||(g[Se]=function(L){return g.handleEvent(L)}),g[Se])}function Ue(){$.call(this),this.i=new ut(this),this.M=this,this.F=null}T(Ue,$),Ue.prototype[Oe]=!0,Ue.prototype.removeEventListener=function(g,L,U,j){Pt(this,g,L,U,j)};function je(g,L){var U,j=g.F;if(j)for(U=[];j;j=j.F)U.push(j);if(g=g.M,j=L.type||L,typeof L=="string")L=new he(L,g);else if(L instanceof he)L.target=L.target||g;else{var fe=L;L=new he(j,g),V(L,fe)}if(fe=!0,U)for(var xe=U.length-1;0<=xe;xe--){var We=L.g=U[xe];fe=_t(We,j,!0,L)&&fe}if(We=L.g=g,fe=_t(We,j,!0,L)&&fe,fe=_t(We,j,!1,L)&&fe,U)for(xe=0;xe<U.length;xe++)We=L.g=U[xe],fe=_t(We,j,!1,L)&&fe}Ue.prototype.N=function(){if(Ue.aa.N.call(this),this.i){var g=this.i,L;for(L in g.g){for(var U=g.g[L],j=0;j<U.length;j++)Je(U[j]);delete g.g[L],g.h--}}this.F=null},Ue.prototype.K=function(g,L,U,j){return this.i.add(String(g),L,!1,U,j)},Ue.prototype.L=function(g,L,U,j){return this.i.add(String(g),L,!0,U,j)};function _t(g,L,U,j){if(L=g.i.g[String(L)],!L)return!0;L=L.concat();for(var fe=!0,xe=0;xe<L.length;++xe){var We=L[xe];if(We&&!We.da&&We.capture==U){var fn=We.listener,vi=We.ha||We.src;We.fa&&De(g.i,We),fe=fn.call(vi,j)!==!1&&fe}}return fe&&!j.defaultPrevented}function st(g,L,U){if(typeof g=="function")U&&(g=y(g,U));else if(g&&typeof g.handleEvent=="function")g=y(g.handleEvent,g);else throw Error("Invalid listener argument");return 2147483647<Number(L)?-1:u.setTimeout(g,L||0)}function Re(g){g.g=st(()=>{g.g=null,g.i&&(g.i=!1,Re(g))},g.l);const L=g.h;g.h=null,g.m.apply(null,L)}class Et extends ${constructor(L,U){super(),this.m=L,this.l=U,this.h=null,this.i=!1,this.g=null}j(L){this.h=arguments,this.g?this.i=!0:Re(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ht(g){$.call(this),this.h=g,this.g={}}T(ht,$);var Rt=[];function bt(g){B(g.g,function(L,U){this.g.hasOwnProperty(U)&&Yt(L)},g),g.g={}}ht.prototype.N=function(){ht.aa.N.call(this),bt(this)},ht.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Tt=u.JSON.stringify,rn=u.JSON.parse,Cn=class{stringify(g){return u.JSON.stringify(g,void 0)}parse(g){return u.JSON.parse(g,void 0)}};function Bn(){}Bn.prototype.h=null;function le(g){return g.h||(g.h=g.i())}function be(){}var Fe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function tt(){he.call(this,"d")}T(tt,he);function ct(){he.call(this,"c")}T(ct,he);var an={},Wn=null;function ri(){return Wn=Wn||new Ue}an.La="serverreachability";function Yi(g){he.call(this,an.La,g)}T(Yi,he);function _n(g){const L=ri();je(L,new Yi(L))}an.STAT_EVENT="statevent";function Ci(g,L){he.call(this,an.STAT_EVENT,g),this.stat=L}T(Ci,he);function vn(g){const L=ri();je(L,new Ci(L,g))}an.Ma="timingevent";function ca(g,L){he.call(this,an.Ma,g),this.size=L}T(ca,he);function Jr(g,L){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){g()},L)}function oo(){this.g=!0}oo.prototype.xa=function(){this.g=!1};function Y(g,L,U,j,fe,xe){g.info(function(){if(g.g)if(xe)for(var We="",fn=xe.split("&"),vi=0;vi<fn.length;vi++){var un=fn[vi].split("=");if(1<un.length){var yi=un[0];un=un[1];var yn=yi.split("_");We=2<=yn.length&&yn[1]=="type"?We+(yi+"="+un+"&"):We+(yi+"=redacted&")}}else We=null;else We=xe;return"XMLHTTP REQ ("+j+") [attempt "+fe+"]: "+L+`
`+U+`
`+We})}function ge(g,L,U,j,fe,xe,We){g.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+fe+"]: "+L+`
`+U+`
`+xe+" "+We})}function Ee(g,L,U,j){g.info(function(){return"XMLHTTP TEXT ("+L+"): "+Ie(g,U)+(j?" "+j:"")})}function pe(g,L){g.info(function(){return"TIMEOUT: "+L})}oo.prototype.info=function(){};function Ie(g,L){if(!g.g)return L;if(!L)return null;try{var U=JSON.parse(L);if(U){for(g=0;g<U.length;g++)if(Array.isArray(U[g])){var j=U[g];if(!(2>j.length)){var fe=j[1];if(Array.isArray(fe)&&!(1>fe.length)){var xe=fe[0];if(xe!="noop"&&xe!="stop"&&xe!="close")for(var We=1;We<fe.length;We++)fe[We]=""}}}}return Tt(U)}catch{return L}}var Mt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},kt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Lt;function Ft(){}T(Ft,Bn),Ft.prototype.g=function(){return new XMLHttpRequest},Ft.prototype.i=function(){return{}},Lt=new Ft;function Ht(g,L,U,j){this.j=g,this.i=L,this.l=U,this.R=j||1,this.U=new ht(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qt}function Qt(){this.i=null,this.g="",this.h=!1}var Kt={},Nn={};function _i(g,L,U){g.L=1,g.v=Bs(Ur(L)),g.m=U,g.P=!0,Sr(g,null)}function Sr(g,L){g.F=Date.now(),vt(g),g.A=Ur(g.v);var U=g.A,j=g.R;Array.isArray(j)||(j=[String(j)]),lo(U.i,"t",j),g.C=0,U=g.j.J,g.h=new Qt,g.g=ja(g.j,U?L:null,!g.m),0<g.O&&(g.M=new Et(y(g.Y,g,g.g),g.O)),L=g.U,U=g.g,j=g.ca;var fe="readystatechange";Array.isArray(fe)||(fe&&(Rt[0]=fe.toString()),fe=Rt);for(var xe=0;xe<fe.length;xe++){var We=et(U,fe[xe],j||L.handleEvent,!1,L.h||L);if(!We)break;L.g[We.key]=We}L=g.H?I(g.H):{},g.m?(g.u||(g.u="POST"),L["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.A,g.u,g.m,L)):(g.u="GET",g.g.ea(g.A,g.u,null,L)),_n(),Y(g.i,g.u,g.A,g.l,g.R,g.m)}Ht.prototype.ca=function(g){g=g.target;const L=this.M;L&&Kn(g)==3?L.j():this.Y(g)},Ht.prototype.Y=function(g){try{if(g==this.g)e:{const yn=Kn(this.g);var L=this.g.Ba();const Zn=this.g.Z();if(!(3>yn)&&(yn!=3||this.g&&(this.h.h||this.g.oa()||pa(this.g)))){this.J||yn!=4||L==7||(L==8||0>=Zn?_n(3):_n(2)),Rn(this);var U=this.g.Z();this.X=U;t:if(ys(this)){var j=pa(this.g);g="";var fe=j.length,xe=Kn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Er(this),zi(this);var We="";break t}this.h.i=new u.TextDecoder}for(L=0;L<fe;L++)this.h.h=!0,g+=this.h.i.decode(j[L],{stream:!(xe&&L==fe-1)});j.length=0,this.h.g+=g,this.C=0,We=this.h.g}else We=this.g.oa();if(this.o=U==200,ge(this.i,this.u,this.A,this.l,this.R,yn,U),this.o){if(this.T&&!this.K){t:{if(this.g){var fn,vi=this.g;if((fn=vi.g?vi.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(fn)){var un=fn;break t}}un=null}if(U=un)Ee(this.i,this.l,U,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,es(this,U);else{this.o=!1,this.s=3,vn(12),Er(this),zi(this);break e}}if(this.P){U=!0;let cn;for(;!this.J&&this.C<We.length;)if(cn=Yn(this,We),cn==Nn){yn==4&&(this.s=4,vn(14),U=!1),Ee(this.i,this.l,null,"[Incomplete Response]");break}else if(cn==Kt){this.s=4,vn(15),Ee(this.i,this.l,We,"[Invalid Chunk]"),U=!1;break}else Ee(this.i,this.l,cn,null),es(this,cn);if(ys(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),yn!=4||We.length!=0||this.h.h||(this.s=1,vn(16),U=!1),this.o=this.o&&U,!U)Ee(this.i,this.l,We,"[Invalid Chunked Response]"),Er(this),zi(this);else if(0<We.length&&!this.W){this.W=!0;var yi=this.j;yi.g==this&&yi.ba&&!yi.M&&(yi.j.info("Great, no buffering proxy detected. Bytes received: "+We.length),ss(yi),yi.M=!0,vn(11))}}else Ee(this.i,this.l,We,null),es(this,We);yn==4&&Er(this),this.o&&!this.J&&(yn==4?Ga(this.j,this):(this.o=!1,vt(this)))}else Io(this.g),U==400&&0<We.indexOf("Unknown SID")?(this.s=3,vn(12)):(this.s=0,vn(13)),Er(this),zi(this)}}}catch{}finally{}};function ys(g){return g.g?g.u=="GET"&&g.L!=2&&g.j.Ca:!1}function Yn(g,L){var U=g.C,j=L.indexOf(`
`,U);return j==-1?Nn:(U=Number(L.substring(U,j)),isNaN(U)?Kt:(j+=1,j+U>L.length?Nn:(L=L.slice(j,j+U),g.C=j+U,L)))}Ht.prototype.cancel=function(){this.J=!0,Er(this)};function vt(g){g.S=Date.now()+g.I,xs(g,g.I)}function xs(g,L){if(g.B!=null)throw Error("WatchDog timer not null");g.B=Jr(y(g.ba,g),L)}function Rn(g){g.B&&(u.clearTimeout(g.B),g.B=null)}Ht.prototype.ba=function(){this.B=null;const g=Date.now();0<=g-this.S?(pe(this.i,this.A),this.L!=2&&(_n(),vn(17)),Er(this),this.s=2,zi(this)):xs(this,this.S-g)};function zi(g){g.j.G==0||g.J||Ga(g.j,g)}function Er(g){Rn(g);var L=g.M;L&&typeof L.ma=="function"&&L.ma(),g.M=null,bt(g.U),g.g&&(L=g.g,g.g=null,L.abort(),L.ma())}function es(g,L){try{var U=g.j;if(U.G!=0&&(U.g==g||ln(U.h,g))){if(!g.K&&ln(U.h,g)&&U.G==3){try{var j=U.Da.g.parse(L)}catch{j=null}if(Array.isArray(j)&&j.length==3){var fe=j;if(fe[0]==0){e:if(!U.u){if(U.g)if(U.g.F+3e3<g.F)Do(U),Ts(U);else break e;Ha(U),vn(18)}}else U.za=fe[1],0<U.za-U.T&&37500>fe[2]&&U.F&&U.v==0&&!U.C&&(U.C=Jr(y(U.Za,U),6e3));if(1>=mn(U.h)&&U.ca){try{U.ca()}catch{}U.ca=void 0}}else ho(U,11)}else if((g.K||U.g==g)&&Do(U),!C(L))for(fe=U.Da.g.parse(L),L=0;L<fe.length;L++){let un=fe[L];if(U.T=un[0],un=un[1],U.G==2)if(un[0]=="c"){U.K=un[1],U.ia=un[2];const yi=un[3];yi!=null&&(U.la=yi,U.j.info("VER="+U.la));const yn=un[4];yn!=null&&(U.Aa=yn,U.j.info("SVER="+U.Aa));const Zn=un[5];Zn!=null&&typeof Zn=="number"&&0<Zn&&(j=1.5*Zn,U.L=j,U.j.info("backChannelRequestTimeoutMs_="+j)),j=U;const cn=g.g;if(cn){const Ws=cn.g?cn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ws){var xe=j.h;xe.g||Ws.indexOf("spdy")==-1&&Ws.indexOf("quic")==-1&&Ws.indexOf("h2")==-1||(xe.j=xe.l,xe.g=new Set,xe.h&&(Qn(xe,xe.h),xe.h=null))}if(j.D){const hr=cn.g?cn.g.getResponseHeader("X-HTTP-Session-Id"):null;hr&&(j.ya=hr,kn(j.I,j.D,hr))}}U.G=3,U.l&&U.l.ua(),U.ba&&(U.R=Date.now()-g.F,U.j.info("Handshake RTT: "+U.R+"ms")),j=U;var We=g;if(j.qa=Vl(j,j.J?j.ia:null,j.W),We.K){Ai(j.h,We);var fn=We,vi=j.L;vi&&(fn.I=vi),fn.B&&(Rn(fn),vt(fn)),j.g=We}else Ro(j);0<U.i.length&&Ms(U)}else un[0]!="stop"&&un[0]!="close"||ho(U,7);else U.G==3&&(un[0]=="stop"||un[0]=="close"?un[0]=="stop"?ho(U,7):Ii(U):un[0]!="noop"&&U.l&&U.l.ta(un),U.v=0)}}_n(4)}catch{}}var ts=class{constructor(g,L){this.g=g,this.map=L}};function An(g){this.l=g||10,u.PerformanceNavigationTiming?(g=u.performance.getEntriesByType("navigation"),g=0<g.length&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ut(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function mn(g){return g.h?1:g.g?g.g.size:0}function ln(g,L){return g.h?g.h==L:g.g?g.g.has(L):!1}function Qn(g,L){g.g?g.g.add(L):g.h=L}function Ai(g,L){g.h&&g.h==L?g.h=null:g.g&&g.g.has(L)&&g.g.delete(L)}An.prototype.cancel=function(){if(this.i=ns(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function ns(g){if(g.h!=null)return g.i.concat(g.h.D);if(g.g!=null&&g.g.size!==0){let L=g.i;for(const U of g.g.values())L=L.concat(U.D);return L}return E(g.i)}function Fs(g){if(g.V&&typeof g.V=="function")return g.V();if(typeof Map<"u"&&g instanceof Map||typeof Set<"u"&&g instanceof Set)return Array.from(g.values());if(typeof g=="string")return g.split("");if(f(g)){for(var L=[],U=g.length,j=0;j<U;j++)L.push(g[j]);return L}L=[],U=0;for(j in g)L[U++]=g[j];return L}function bi(g){if(g.na&&typeof g.na=="function")return g.na();if(!g.V||typeof g.V!="function"){if(typeof Map<"u"&&g instanceof Map)return Array.from(g.keys());if(!(typeof Set<"u"&&g instanceof Set)){if(f(g)||typeof g=="string"){var L=[];g=g.length;for(var U=0;U<g;U++)L.push(U);return L}L=[],U=0;for(const j in g)L[U++]=j;return L}}}function Us(g,L){if(g.forEach&&typeof g.forEach=="function")g.forEach(L,void 0);else if(f(g)||typeof g=="string")Array.prototype.forEach.call(g,L,void 0);else for(var U=bi(g),j=Fs(g),fe=j.length,xe=0;xe<fe;xe++)L.call(void 0,j[xe],U&&U[xe],g)}var ha=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wh(g,L){if(g){g=g.split("&");for(var U=0;U<g.length;U++){var j=g[U].indexOf("="),fe=null;if(0<=j){var xe=g[U].substring(0,j);fe=g[U].substring(j+1)}else xe=g[U];L(xe,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function ws(g){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,g instanceof ws){this.h=g.h,Qi(this,g.j),this.o=g.o,this.g=g.g,fa(this,g.s),this.l=g.l;var L=g.i,U=new ao;U.i=L.i,L.g&&(U.g=new Map(L.g),U.h=L.h),da(this,U),this.m=g.m}else g&&(L=String(g).match(ha))?(this.h=!1,Qi(this,L[1]||"",!0),this.o=sn(L[2]||""),this.g=sn(L[3]||"",!0),fa(this,L[4]),this.l=sn(L[5]||"",!0),da(this,L[6]||"",!0),this.m=sn(L[7]||"")):(this.h=!1,this.i=new ao(null,this.h))}ws.prototype.toString=function(){var g=[],L=this.j;L&&g.push(Ss(L,Nl,!0),":");var U=this.g;return(U||L=="file")&&(g.push("//"),(L=this.o)&&g.push(Ss(L,Nl,!0),"@"),g.push(encodeURIComponent(String(U)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),U=this.s,U!=null&&g.push(":",String(U))),(U=this.l)&&(this.g&&U.charAt(0)!="/"&&g.push("/"),g.push(Ss(U,U.charAt(0)=="/"?kl:Sh,!0))),(U=this.i.toString())&&g.push("?",U),(U=this.m)&&g.push("#",Ss(U,bo)),g.join("")};function Ur(g){return new ws(g)}function Qi(g,L,U){g.j=U?sn(L,!0):L,g.j&&(g.j=g.j.replace(/:$/,""))}function fa(g,L){if(L){if(L=Number(L),isNaN(L)||0>L)throw Error("Bad port number "+L);g.s=L}else g.s=null}function da(g,L,U){L instanceof ao?(g.i=L,uo(g.i,g.h)):(U||(L=Ss(L,zl)),g.i=new ao(L,g.h))}function kn(g,L,U){g.i.set(L,U)}function Bs(g){return kn(g,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),g}function sn(g,L){return g?L?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Ss(g,L,U){return typeof g=="string"?(g=encodeURI(g).replace(L,Ua),U&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Ua(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var Nl=/[#\/\?@]/g,Sh=/[#\?:]/g,kl=/[#\?]/g,zl=/[#\?@]/g,bo=/#/g;function ao(g,L){this.h=this.g=null,this.i=g||null,this.j=!!L}function Pi(g){g.g||(g.g=new Map,g.h=0,g.i&&wh(g.i,function(L,U){g.add(decodeURIComponent(L.replace(/\+/g," ")),U)}))}r=ao.prototype,r.add=function(g,L){Pi(this),this.i=null,g=is(this,g);var U=this.g.get(g);return U||this.g.set(g,U=[]),U.push(L),this.h+=1,this};function jt(g,L){Pi(g),L=is(g,L),g.g.has(L)&&(g.i=null,g.h-=g.g.get(L).length,g.g.delete(L))}function Es(g,L){return Pi(g),L=is(g,L),g.g.has(L)}r.forEach=function(g,L){Pi(this),this.g.forEach(function(U,j){U.forEach(function(fe){g.call(L,fe,j,this)},this)},this)},r.na=function(){Pi(this);const g=Array.from(this.g.values()),L=Array.from(this.g.keys()),U=[];for(let j=0;j<L.length;j++){const fe=g[j];for(let xe=0;xe<fe.length;xe++)U.push(L[j])}return U},r.V=function(g){Pi(this);let L=[];if(typeof g=="string")Es(this,g)&&(L=L.concat(this.g.get(is(this,g))));else{g=Array.from(this.g.values());for(let U=0;U<g.length;U++)L=L.concat(g[U])}return L},r.set=function(g,L){return Pi(this),this.i=null,g=is(this,g),Es(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[L]),this.h+=1,this},r.get=function(g,L){return g?(g=this.V(g),0<g.length?String(g[0]):L):L};function lo(g,L,U){jt(g,L),0<U.length&&(g.i=null,g.g.set(is(g,L),E(U)),g.h+=U.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],L=Array.from(this.g.keys());for(var U=0;U<L.length;U++){var j=L[U];const xe=encodeURIComponent(String(j)),We=this.V(j);for(j=0;j<We.length;j++){var fe=xe;We[j]!==""&&(fe+="="+encodeURIComponent(String(We[j]))),g.push(fe)}}return this.i=g.join("&")};function is(g,L){return L=String(L),g.j&&(L=L.toLowerCase()),L}function uo(g,L){L&&!g.j&&(Pi(g),g.i=null,g.g.forEach(function(U,j){var fe=j.toLowerCase();j!=fe&&(jt(this,j),lo(this,fe,U))},g)),g.j=L}function ad(g,L){const U=new oo;if(u.Image){const j=new Image;j.onload=w(ar,U,"TestLoadImage: loaded",!0,L,j),j.onerror=w(ar,U,"TestLoadImage: error",!1,L,j),j.onabort=w(ar,U,"TestLoadImage: abort",!1,L,j),j.ontimeout=w(ar,U,"TestLoadImage: timeout",!1,L,j),u.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=g}else L(!1)}function fi(g,L){const U=new oo,j=new AbortController,fe=setTimeout(()=>{j.abort(),ar(U,"TestPingServer: timeout",!1,L)},1e4);fetch(g,{signal:j.signal}).then(xe=>{clearTimeout(fe),xe.ok?ar(U,"TestPingServer: ok",!0,L):ar(U,"TestPingServer: server error",!1,L)}).catch(()=>{clearTimeout(fe),ar(U,"TestPingServer: error",!1,L)})}function ar(g,L,U,j,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),j(U)}catch{}}function ld(){this.g=new Cn}function Fl(g,L,U){const j=U||"";try{Us(g,function(fe,xe){let We=fe;d(fe)&&(We=Tt(fe)),L.push(j+xe+"="+encodeURIComponent(We))})}catch(fe){throw L.push(j+"type="+encodeURIComponent("_badmap")),fe}}function Po(g){this.l=g.Ub||null,this.j=g.eb||!1}T(Po,Bn),Po.prototype.g=function(){return new co(this.l,this.j)},Po.prototype.i=function(g){return function(){return g}}({});function co(g,L){Ue.call(this),this.D=g,this.o=L,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(co,Ue),r=co.prototype,r.open=function(g,L){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=g,this.A=L,this.readyState=1,Hs(this)},r.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const L={headers:this.u,method:this.B,credentials:this.m,cache:void 0};g&&(L.body=g),(this.D||u).fetch(new Request(this.A,L)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vs(this)),this.readyState=0},r.Sa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,Hs(this)),this.g&&(this.readyState=3,Hs(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;rs(this)}else g.text().then(this.Ra.bind(this),this.ga.bind(this))};function rs(g){g.j.read().then(g.Pa.bind(g)).catch(g.ga.bind(g))}r.Pa=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var L=g.value?g.value:new Uint8Array(0);(L=this.v.decode(L,{stream:!g.done}))&&(this.response=this.responseText+=L)}g.done?Vs(this):Hs(this),this.readyState==3&&rs(this)}},r.Ra=function(g){this.g&&(this.response=this.responseText=g,Vs(this))},r.Qa=function(g){this.g&&(this.response=g,Vs(this))},r.ga=function(){this.g&&Vs(this)};function Vs(g){g.readyState=4,g.l=null,g.j=null,g.v=null,Hs(g)}r.setRequestHeader=function(g,L){this.u.append(g,L)},r.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],L=this.h.entries();for(var U=L.next();!U.done;)U=U.value,g.push(U[0]+": "+U[1]),U=L.next();return g.join(`\r
`)};function Hs(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(co.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Fi(g){let L="";return B(g,function(U,j){L+=j,L+=":",L+=U,L+=`\r
`}),L}function lr(g,L,U){e:{for(j in U){var j=!1;break e}j=!0}j||(U=Fi(U),typeof g=="string"?U!=null&&encodeURIComponent(String(U)):kn(g,L,U))}function zn(g){Ue.call(this),this.headers=new Map,this.o=g||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(zn,Ue);var qu=/^https?$/i,Ul=["POST","PUT"];r=zn.prototype,r.Ha=function(g){this.J=g},r.ea=function(g,L,U,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);L=L?L.toUpperCase():"GET",this.D=g,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Lt.g(),this.v=this.o?le(this.o):le(Lt),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(L,String(g),!0),this.B=!1}catch(xe){Ba(this,xe);return}if(g=U||"",U=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var fe in j)U.set(fe,j[fe]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const xe of j.keys())U.set(xe,j.get(xe));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(U.keys()).find(xe=>xe.toLowerCase()=="content-type"),fe=u.FormData&&g instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Ul,L,void 0))||j||fe||U.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[xe,We]of U)this.g.setRequestHeader(xe,We);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Bl(this),this.u=!0,this.g.send(g),this.u=!1}catch(xe){Ba(this,xe)}};function Ba(g,L){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=L,g.m=5,Tr(g),ur(g)}function Tr(g){g.A||(g.A=!0,je(g,"complete"),je(g,"error"))}r.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=g||7,je(this,"complete"),je(this,"abort"),ur(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ur(this,!0)),zn.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Xu(this):this.bb())},r.bb=function(){Xu(this)};function Xu(g){if(g.h&&typeof a<"u"&&(!g.v[1]||Kn(g)!=4||g.Z()!=2)){if(g.u&&Kn(g)==4)st(g.Ea,0,g);else if(je(g,"readystatechange"),Kn(g)==4){g.h=!1;try{const We=g.Z();e:switch(We){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var L=!0;break e;default:L=!1}var U;if(!(U=L)){var j;if(j=We===0){var fe=String(g.D).match(ha)[1]||null;!fe&&u.self&&u.self.location&&(fe=u.self.location.protocol.slice(0,-1)),j=!qu.test(fe?fe.toLowerCase():"")}U=j}if(U)je(g,"complete"),je(g,"success");else{g.m=6;try{var xe=2<Kn(g)?g.g.statusText:""}catch{xe=""}g.l=xe+" ["+g.Z()+"]",Tr(g)}}finally{ur(g)}}}}function ur(g,L){if(g.g){Bl(g);const U=g.g,j=g.v[0]?()=>{}:null;g.g=null,g.v=null,L||je(g,"ready");try{U.onreadystatechange=j}catch{}}}function Bl(g){g.I&&(u.clearTimeout(g.I),g.I=null)}r.isActive=function(){return!!this.g};function Kn(g){return g.g?g.g.readyState:0}r.Z=function(){try{return 2<Kn(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(g){if(this.g){var L=this.g.responseText;return g&&L.indexOf(g)==0&&(L=L.substring(g.length)),rn(L)}};function pa(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.H){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Io(g){const L={};g=(g.g&&2<=Kn(g)&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<g.length;j++){if(C(g[j]))continue;var U=W(g[j]);const fe=U[0];if(U=U[1],typeof U!="string")continue;U=U.trim();const xe=L[fe]||[];L[fe]=xe,xe.push(U)}k(L,function(j){return j.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mr(g,L,U){return U&&U.internalChannelParams&&U.internalChannelParams[g]||L}function Va(g){this.Aa=0,this.i=[],this.j=new oo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Mr("failFast",!1,g),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Mr("baseRetryDelayMs",5e3,g),this.cb=Mr("retryDelaySeedMs",1e4,g),this.Wa=Mr("forwardChannelMaxRetries",2,g),this.wa=Mr("forwardChannelRequestTimeoutMs",2e4,g),this.pa=g&&g.xmlHttpFactory||void 0,this.Xa=g&&g.Tb||void 0,this.Ca=g&&g.useFetchStreams||!1,this.L=void 0,this.J=g&&g.supportsCrossDomainXhr||!1,this.K="",this.h=new An(g&&g.concurrentRequestLimit),this.Da=new ld,this.P=g&&g.fastHandshake||!1,this.O=g&&g.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=g&&g.Rb||!1,g&&g.xa&&this.j.xa(),g&&g.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&g&&g.detectBufferingProxy||!1,this.ja=void 0,g&&g.longPollingTimeout&&0<g.longPollingTimeout&&(this.ja=g.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Va.prototype,r.la=8,r.G=1,r.connect=function(g,L,U,j){vn(0),this.W=g,this.H=L||{},U&&j!==void 0&&(this.H.OSID=U,this.H.OAID=j),this.F=this.X,this.I=Vl(this,null,this.W),Ms(this)};function Ii(g){if(ma(g),g.G==3){var L=g.U++,U=Ur(g.I);if(kn(U,"SID",g.K),kn(U,"RID",L),kn(U,"TYPE","terminate"),Ui(g,U),L=new Ht(g,g.j,L),L.L=2,L.v=Bs(Ur(U)),U=!1,u.navigator&&u.navigator.sendBeacon)try{U=u.navigator.sendBeacon(L.v.toString(),"")}catch{}!U&&u.Image&&(new Image().src=L.v,U=!0),U||(L.g=ja(L.j,null),L.g.ea(L.v)),L.F=Date.now(),vt(L)}$u(g)}function Ts(g){g.g&&(ss(g),g.g.cancel(),g.g=null)}function ma(g){Ts(g),g.u&&(u.clearTimeout(g.u),g.u=null),Do(g),g.h.cancel(),g.s&&(typeof g.s=="number"&&u.clearTimeout(g.s),g.s=null)}function Ms(g){if(!Ut(g.h)&&!g.s){g.s=!0;var L=g.Ga;Ce||ne(),K||(Ce(),K=!0),oe.add(L,g),g.B=0}}function ga(g,L){return mn(g.h)>=g.h.j-(g.s?1:0)?!1:g.s?(g.i=L.D.concat(g.i),!0):g.G==1||g.G==2||g.B>=(g.Va?0:g.Wa)?!1:(g.s=Jr(y(g.Ga,g,L),Wa(g,g.B)),g.B++,!0)}r.Ga=function(g){if(this.s)if(this.s=null,this.G==1){if(!g){this.U=Math.floor(1e5*Math.random()),g=this.U++;const fe=new Ht(this,this.j,g);let xe=this.o;if(this.S&&(xe?(xe=I(xe),V(xe,this.S)):xe=this.S),this.m!==null||this.O||(fe.H=xe,xe=null),this.P)e:{for(var L=0,U=0;U<this.i.length;U++){t:{var j=this.i[U];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(L+=j,4096<L){L=U;break e}if(L===4096||U===this.i.length-1){L=U+1;break e}}L=1e3}else L=1e3;L=Cr(this,fe,L),U=Ur(this.I),kn(U,"RID",g),kn(U,"CVER",22),this.D&&kn(U,"X-HTTP-Session-Id",this.D),Ui(this,U),xe&&(this.O?L="headers="+encodeURIComponent(String(Fi(xe)))+"&"+L:this.m&&lr(U,this.m,xe)),Qn(this.h,fe),this.Ua&&kn(U,"TYPE","init"),this.P?(kn(U,"$req",L),kn(U,"SID","null"),fe.T=!0,_i(fe,U,null)):_i(fe,U,L),this.G=2}}else this.G==3&&(g?Ki(this,g):this.i.length==0||Ut(this.h)||Ki(this))};function Ki(g,L){var U;L?U=L.l:U=g.U++;const j=Ur(g.I);kn(j,"SID",g.K),kn(j,"RID",U),kn(j,"AID",g.T),Ui(g,j),g.m&&g.o&&lr(j,g.m,g.o),U=new Ht(g,g.j,U,g.B+1),g.m===null&&(U.H=g.o),L&&(g.i=L.D.concat(g.i)),L=Cr(g,U,1e3),U.I=Math.round(.5*g.wa)+Math.round(.5*g.wa*Math.random()),Qn(g.h,U),_i(U,j,L)}function Ui(g,L){g.H&&B(g.H,function(U,j){kn(L,j,U)}),g.l&&Us({},function(U,j){kn(L,j,U)})}function Cr(g,L,U){U=Math.min(g.i.length,U);var j=g.l?y(g.l.Na,g.l,g):null;e:{var fe=g.i;let xe=-1;for(;;){const We=["count="+U];xe==-1?0<U?(xe=fe[0].g,We.push("ofs="+xe)):xe=0:We.push("ofs="+xe);let fn=!0;for(let vi=0;vi<U;vi++){let un=fe[vi].g;const yi=fe[vi].map;if(un-=xe,0>un)xe=Math.max(0,fe[vi].g-100),fn=!1;else try{Fl(yi,We,"req"+un+"_")}catch{j&&j(yi)}}if(fn){j=We.join("&");break e}}}return g=g.i.splice(0,U),L.D=g,j}function Ro(g){if(!g.g&&!g.u){g.Y=1;var L=g.Fa;Ce||ne(),K||(Ce(),K=!0),oe.add(L,g),g.v=0}}function Ha(g){return g.g||g.u||3<=g.v?!1:(g.Y++,g.u=Jr(y(g.Fa,g),Wa(g,g.v)),g.v++,!0)}r.Fa=function(){if(this.u=null,Gs(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var g=2*this.R;this.j.info("BP detection timer enabled: "+g),this.A=Jr(y(this.ab,this),g)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,vn(10),Ts(this),Gs(this))};function ss(g){g.A!=null&&(u.clearTimeout(g.A),g.A=null)}function Gs(g){g.g=new Ht(g,g.j,"rpc",g.Y),g.m===null&&(g.g.H=g.o),g.g.O=0;var L=Ur(g.qa);kn(L,"RID","rpc"),kn(L,"SID",g.K),kn(L,"AID",g.T),kn(L,"CI",g.F?"0":"1"),!g.F&&g.ja&&kn(L,"TO",g.ja),kn(L,"TYPE","xmlhttp"),Ui(g,L),g.m&&g.o&&lr(L,g.m,g.o),g.L&&(g.g.I=g.L);var U=g.g;g=g.ia,U.L=1,U.v=Bs(Ur(L)),U.m=null,U.P=!0,Sr(U,g)}r.Za=function(){this.C!=null&&(this.C=null,Ts(this),Ha(this),vn(19))};function Do(g){g.C!=null&&(u.clearTimeout(g.C),g.C=null)}function Ga(g,L){var U=null;if(g.g==L){Do(g),ss(g),g.g=null;var j=2}else if(ln(g.h,L))U=L.D,Ai(g.h,L),j=1;else return;if(g.G!=0){if(L.o)if(j==1){U=L.m?L.m.length:0,L=Date.now()-L.F;var fe=g.B;j=ri(),je(j,new ca(j,U)),Ms(g)}else Ro(g);else if(fe=L.s,fe==3||fe==0&&0<L.X||!(j==1&&ga(g,L)||j==2&&Ha(g)))switch(U&&0<U.length&&(L=g.h,L.i=L.i.concat(U)),fe){case 1:ho(g,5);break;case 4:ho(g,10);break;case 3:ho(g,6);break;default:ho(g,2)}}}function Wa(g,L){let U=g.Ta+Math.floor(Math.random()*g.cb);return g.isActive()||(U*=2),U*L}function ho(g,L){if(g.j.info("Error code "+L),L==2){var U=y(g.fb,g),j=g.Xa;const fe=!j;j=new ws(j||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Qi(j,"https"),Bs(j),fe?ad(j.toString(),U):fi(j.toString(),U)}else vn(2);g.G=0,g.l&&g.l.sa(L),$u(g),ma(g)}r.fb=function(g){g?(this.j.info("Successfully pinged google.com"),vn(2)):(this.j.info("Failed to ping google.com"),vn(1))};function $u(g){if(g.G=0,g.ka=[],g.l){const L=ns(g.h);(L.length!=0||g.i.length!=0)&&(M(g.ka,L),M(g.ka,g.i),g.h.i.length=0,E(g.i),g.i.length=0),g.l.ra()}}function Vl(g,L,U){var j=U instanceof ws?Ur(U):new ws(U);if(j.g!="")L&&(j.g=L+"."+j.g),fa(j,j.s);else{var fe=u.location;j=fe.protocol,L=L?L+"."+fe.hostname:fe.hostname,fe=+fe.port;var xe=new ws(null);j&&Qi(xe,j),L&&(xe.g=L),fe&&fa(xe,fe),U&&(xe.l=U),j=xe}return U=g.D,L=g.ya,U&&L&&kn(j,U,L),kn(j,"VER",g.la),Ui(g,j),j}function ja(g,L,U){if(L&&!g.J)throw Error("Can't create secondary domain capable XhrIo object.");return L=g.Ca&&!g.pa?new zn(new Po({eb:U})):new zn(g.pa),L.Ha(g.J),L}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hl(){}r=Hl.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function qa(){}qa.prototype.g=function(g,L){return new cr(g,L)};function cr(g,L){Ue.call(this),this.g=new Va(L),this.l=g,this.h=L&&L.messageUrlParams||null,g=L&&L.messageHeaders||null,L&&L.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=L&&L.initMessageHeaders||null,L&&L.messageContentType&&(g?g["X-WebChannel-Content-Type"]=L.messageContentType:g={"X-WebChannel-Content-Type":L.messageContentType}),L&&L.va&&(g?g["X-WebChannel-Client-Profile"]=L.va:g={"X-WebChannel-Client-Profile":L.va}),this.g.S=g,(g=L&&L.Sb)&&!C(g)&&(this.g.m=g),this.v=L&&L.supportsCrossDomainXhr||!1,this.u=L&&L.sendRawJson||!1,(L=L&&L.httpSessionIdParam)&&!C(L)&&(this.g.D=L,g=this.h,g!==null&&L in g&&(g=this.h,L in g&&delete g[L])),this.j=new Ar(this)}T(cr,Ue),cr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},cr.prototype.close=function(){Ii(this.g)},cr.prototype.o=function(g){var L=this.g;if(typeof g=="string"){var U={};U.__data__=g,g=U}else this.u&&(U={},U.__data__=Tt(g),g=U);L.i.push(new ts(L.Ya++,g)),L.G==3&&Ms(L)},cr.prototype.N=function(){this.g.l=null,delete this.j,Ii(this.g),delete this.g,cr.aa.N.call(this)};function Gl(g){tt.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var L=g.__sm__;if(L){e:{for(const U in L){g=U;break e}g=void 0}(this.i=g)&&(g=this.i,L=L!==null&&g in L?L[g]:void 0),this.data=L}else this.data=g}T(Gl,tt);function Lo(){ct.call(this),this.status=1}T(Lo,ct);function Ar(g){this.g=g}T(Ar,Hl),Ar.prototype.ua=function(){je(this.g,"a")},Ar.prototype.ta=function(g){je(this.g,new Gl(g))},Ar.prototype.sa=function(g){je(this.g,new Lo)},Ar.prototype.ra=function(){je(this.g,"b")},qa.prototype.createWebChannel=qa.prototype.g,cr.prototype.send=cr.prototype.o,cr.prototype.open=cr.prototype.m,cr.prototype.close=cr.prototype.close,O2=function(){return new qa},L2=function(){return ri()},D2=an,ax={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Mt.NO_ERROR=0,Mt.TIMEOUT=8,Mt.HTTP_ERROR=6,g0=Mt,kt.COMPLETE="complete",R2=kt,be.EventType=Fe,Fe.OPEN="a",Fe.CLOSE="b",Fe.ERROR="c",Fe.MESSAGE="d",Ue.prototype.listen=Ue.prototype.K,_p=be,zn.prototype.listenOnce=zn.prototype.L,zn.prototype.getLastError=zn.prototype.Ka,zn.prototype.getLastErrorCode=zn.prototype.Ba,zn.prototype.getStatus=zn.prototype.Z,zn.prototype.getResponseJson=zn.prototype.Oa,zn.prototype.getResponseText=zn.prototype.oa,zn.prototype.send=zn.prototype.ea,zn.prototype.setWithCredentials=zn.prototype.Ha,I2=zn}).apply(typeof n0<"u"?n0:typeof self<"u"?self:typeof window<"u"?window:{});const jE="@firebase/firestore",qE="4.7.10";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Yr.UNAUTHENTICATED=new Yr(null),Yr.GOOGLE_CREDENTIALS=new Yr("google-credentials-uid"),Yr.FIRST_PARTY=new Yr("first-party-uid"),Yr.MOCK_USER=new Yr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sd="11.5.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh=new f1("@firebase/firestore");function Df(){return lh.logLevel}function St(r,...e){if(lh.logLevel<=Sn.DEBUG){const t=e.map(m1);lh.debug(`Firestore (${sd}): ${r}`,...t)}}function uh(r,...e){if(lh.logLevel<=Sn.ERROR){const t=e.map(m1);lh.error(`Firestore (${sd}): ${r}`,...t)}}function f_(r,...e){if(lh.logLevel<=Sn.WARN){const t=e.map(m1);lh.warn(`Firestore (${sd}): ${r}`,...t)}}function m1(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(r="Unexpected state"){const e=`FIRESTORE (${sd}) INTERNAL ASSERTION FAILED: `+r;throw uh(e),new Error(e)}function Mi(r,e){r||dn()}function ii(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class zt extends ju{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class aF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Yr.UNAUTHENTICATED))}shutdown(){}}class lF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class uF{constructor(e){this.t=e,this.currentUser=Yr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Mi(this.o===void 0);let n=this.i;const i=f=>this.i!==n?(n=this.i,t(f)):Promise.resolve();let s=new th;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new th,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const f=s;e.enqueueRetryable(async()=>{await f.promise,await i(this.currentUser)})},u=f=>{St("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(f=>u(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(St("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new th)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(St("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Mi(typeof n.accessToken=="string"),new N2(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Mi(e===null||typeof e=="string"),new Yr(e)}}class cF{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Yr.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class hF{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new cF(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Yr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class XE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fF{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,jz(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){Mi(this.o===void 0);const n=s=>{s.error!=null&&St("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,St("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{St("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):St("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new XE(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Mi(typeof t.token=="string"),this.R=t.token,new XE(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dF(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pF(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=dF(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}}function Mn(r,e){return r<e?-1:r>e?1:0}function lx(r,e){let t=0;for(;t<r.length&&t<e.length;){const n=r.codePointAt(t),i=e.codePointAt(t);if(n!==i){if(n<128&&i<128)return Mn(n,i);{const s=pF(),a=mF(s.encode($E(r,t)),s.encode($E(e,t)));return a!==0?a:Mn(n,i)}}t+=n>65535?2:1}return Mn(r.length,e.length)}function $E(r,e){return r.codePointAt(e)>65535?r.substring(e,e+2):r.substring(e,e+1)}function mF(r,e){for(let t=0;t<r.length&&t<e.length;++t)if(r[t]!==e[t])return Mn(r[t],e[t]);return Mn(r.length,e.length)}function Xf(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE=-62135596800,QE=1e6;class wr{static now(){return wr.fromMillis(Date.now())}static fromDate(e){return wr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*QE);return new wr(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new zt(qe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new zt(qe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<YE)throw new zt(qe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new zt(qe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/QE}_compareTo(e){return this.seconds===e.seconds?Mn(this.nanoseconds,e.nanoseconds):Mn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-YE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{static fromTimestamp(e){return new hi(e)}static min(){return new hi(new wr(0,0))}static max(){return new hi(new wr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE="__name__";class Ia{constructor(e,t,n){t===void 0?t=0:t>e.length&&dn(),n===void 0?n=e.length-t:n>e.length-t&&dn(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Ia.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ia?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=Ia.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Mn(e.length,t.length)}static compareSegments(e,t){const n=Ia.isNumericId(e),i=Ia.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?Ia.extractNumericId(e).compare(Ia.extractNumericId(t)):lx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return p1.fromString(e.substring(4,e.length-2))}}class Ti extends Ia{construct(e,t,n){return new Ti(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new zt(qe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Ti(t)}static emptyPath(){return new Ti([])}}const gF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kr extends Ia{construct(e,t,n){return new kr(e,t,n)}static isValidIdentifier(e){return gF.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===KE}static keyField(){return new kr([KE])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new zt(qe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new zt(qe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new zt(qe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(n+=u,i++):(s(),i++)}if(s(),a)throw new zt(qe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kr(t)}static emptyPath(){return new kr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.path=e}static fromPath(e){return new on(Ti.fromString(e))}static fromName(e){return new on(Ti.fromString(e).popFirst(5))}static empty(){return new on(Ti.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ti.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ti.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new on(new Ti(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp=-1;function _F(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=hi.fromTimestamp(n===1e9?new wr(t+1,0):new wr(t,n));return new ku(i,on.empty(),e)}function vF(r){return new ku(r.readTime,r.key,Xp)}class ku{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ku(hi.min(),on.empty(),Xp)}static max(){return new ku(hi.max(),on.empty(),Xp)}}function yF(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=on.comparator(r.documentKey,e.documentKey),t!==0?t:Mn(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wF{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g1(r){if(r.code!==qe.FAILED_PRECONDITION||r.message!==xF)throw r;St("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&dn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ke((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ke?t:ke.resolve(t)}catch(t){return ke.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ke.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ke.reject(t)}static resolve(e){return new ke((t,n)=>{t(e)})}static reject(e){return new ke((t,n)=>{n(e)})}static waitFor(e){return new ke((t,n)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&t()},f=>n(f))}),a=!0,s===i&&t()})}static or(e){let t=ke.resolve(!1);for(const n of e)t=t.next(i=>i?ke.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new ke((n,i)=>{const s=e.length,a=new Array(s);let u=0;for(let f=0;f<s;f++){const d=f;t(e[d]).next(m=>{a[d]=m,++u,u===s&&n(a)},m=>i(m))}})}static doWhile(e,t){return new ke((n,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}}function SF(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function xm(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.oe(n),this._e=n=>t.writeSequenceNumber(n))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}_1.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1=-1;function y1(r){return r==null}function I0(r){return r===0&&1/r==-1/0}function EF(r){return typeof r=="number"&&Number.isInteger(r)&&!I0(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2="";function TF(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=ZE(e)),e=MF(r.get(t),e);return ZE(e)}function MF(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case z2:t+="";break;default:t+=s}}return t}function ZE(r){return r+z2+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function od(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function F2(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,t){this.comparator=e,this.root=t||Or.EMPTY}insert(e,t){return new zs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Or.BLACK,null,null))}remove(e){return new zs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Or.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new i0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new i0(this.root,e,this.comparator,!1)}getReverseIterator(){return new i0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new i0(this.root,e,this.comparator,!0)}}class i0{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Or{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??Or.RED,this.left=i??Or.EMPTY,this.right=s??Or.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new Or(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Or.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Or.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Or.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Or.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw dn();const e=this.left.check();if(e!==this.right.check())throw dn();return e+(this.isRed()?0:1)}}Or.EMPTY=null,Or.RED=!0,Or.BLACK=!1;Or.EMPTY=new class{constructor(){this.size=0}get key(){throw dn()}get value(){throw dn()}get color(){throw dn()}get left(){throw dn()}get right(){throw dn()}copy(e,t,n,i,s){return this}insert(e,t,n){return new Or(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.comparator=e,this.data=new zs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new eT(this.data.getIterator())}getIteratorFrom(e){return new eT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Fr)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Fr(this.comparator);return t.data=e,t}}class eT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e){this.fields=e,e.sort(kr.comparator)}static empty(){return new oa([])}unionWith(e){let t=new Fr(kr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new oa(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xf(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new CF("Invalid base64 string: "+s):s}}(e);return new Na(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Na(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Mn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Na.EMPTY_BYTE_STRING=new Na("");const AF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ch(r){if(Mi(!!r),typeof r=="string"){let e=0;const t=AF.exec(r);if(Mi(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Nr(r.seconds),nanos:Nr(r.nanos)}}function Nr(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function $f(r){return typeof r=="string"?Na.fromBase64String(r):Na.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2="server_timestamp",B2="__type__",V2="__previous_value__",H2="__local_write_time__";function x1(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[B2])===null||t===void 0?void 0:t.stringValue)===U2}function w1(r){const e=r.mapValue.fields[V2];return x1(e)?w1(e):e}function R0(r){const e=ch(r.mapValue.fields[H2].timestampValue);return new wr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF{constructor(e,t,n,i,s,a,u,f,d){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=d}}const D0="(default)";class L0{constructor(e,t){this.projectId=e,this.database=t||D0}static empty(){return new L0("","")}get isDefaultDatabase(){return this.database===D0}isEqual(e){return e instanceof L0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G2="__type__",PF="__max__",r0={mapValue:{}},W2="__vector__",ux="value";function hh(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?x1(r)?4:RF(r)?9007199254740991:IF(r)?10:11:dn()}function ka(r,e){if(r===e)return!0;const t=hh(r);if(t!==hh(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return R0(r).isEqual(R0(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=ch(i.timestampValue),u=ch(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return $f(i.bytesValue).isEqual($f(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return Nr(i.geoPointValue.latitude)===Nr(s.geoPointValue.latitude)&&Nr(i.geoPointValue.longitude)===Nr(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Nr(i.integerValue)===Nr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Nr(i.doubleValue),u=Nr(s.doubleValue);return a===u?I0(a)===I0(u):isNaN(a)&&isNaN(u)}return!1}(r,e);case 9:return Xf(r.arrayValue.values||[],e.arrayValue.values||[],ka);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(JE(a)!==JE(u))return!1;for(const f in a)if(a.hasOwnProperty(f)&&(u[f]===void 0||!ka(a[f],u[f])))return!1;return!0}(r,e);default:return dn()}}function $p(r,e){return(r.values||[]).find(t=>ka(t,e))!==void 0}function Yf(r,e){if(r===e)return 0;const t=hh(r),n=hh(e);if(t!==n)return Mn(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Mn(r.booleanValue,e.booleanValue);case 2:return function(s,a){const u=Nr(s.integerValue||s.doubleValue),f=Nr(a.integerValue||a.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1}(r,e);case 3:return tT(r.timestampValue,e.timestampValue);case 4:return tT(R0(r),R0(e));case 5:return lx(r.stringValue,e.stringValue);case 6:return function(s,a){const u=$f(s),f=$f(a);return u.compareTo(f)}(r.bytesValue,e.bytesValue);case 7:return function(s,a){const u=s.split("/"),f=a.split("/");for(let d=0;d<u.length&&d<f.length;d++){const m=Mn(u[d],f[d]);if(m!==0)return m}return Mn(u.length,f.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,a){const u=Mn(Nr(s.latitude),Nr(a.latitude));return u!==0?u:Mn(Nr(s.longitude),Nr(a.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return nT(r.arrayValue,e.arrayValue);case 10:return function(s,a){var u,f,d,m;const _=s.fields||{},y=a.fields||{},w=(u=_[ux])===null||u===void 0?void 0:u.arrayValue,T=(f=y[ux])===null||f===void 0?void 0:f.arrayValue,E=Mn(((d=w==null?void 0:w.values)===null||d===void 0?void 0:d.length)||0,((m=T==null?void 0:T.values)===null||m===void 0?void 0:m.length)||0);return E!==0?E:nT(w,T)}(r.mapValue,e.mapValue);case 11:return function(s,a){if(s===r0.mapValue&&a===r0.mapValue)return 0;if(s===r0.mapValue)return 1;if(a===r0.mapValue)return-1;const u=s.fields||{},f=Object.keys(u),d=a.fields||{},m=Object.keys(d);f.sort(),m.sort();for(let _=0;_<f.length&&_<m.length;++_){const y=lx(f[_],m[_]);if(y!==0)return y;const w=Yf(u[f[_]],d[m[_]]);if(w!==0)return w}return Mn(f.length,m.length)}(r.mapValue,e.mapValue);default:throw dn()}}function tT(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Mn(r,e);const t=ch(r),n=ch(e),i=Mn(t.seconds,n.seconds);return i!==0?i:Mn(t.nanos,n.nanos)}function nT(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=Yf(t[i],n[i]);if(s)return s}return Mn(t.length,n.length)}function Qf(r){return cx(r)}function cx(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=ch(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return $f(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return on.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=cx(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${cx(t.fields[a])}`;return i+"}"}(r.mapValue):dn()}function _0(r){switch(hh(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=w1(r);return e?16+_0(e):16;case 5:return 2*r.stringValue.length;case 6:return $f(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+_0(s),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return od(n.fields,(s,a)=>{i+=s.length+_0(a)}),i}(r.mapValue);default:throw dn()}}function hx(r){return!!r&&"integerValue"in r}function S1(r){return!!r&&"arrayValue"in r}function v0(r){return!!r&&"mapValue"in r}function IF(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[G2])===null||t===void 0?void 0:t.stringValue)===W2}function Ep(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return od(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Ep(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ep(r.arrayValue.values[t]);return e}return Object.assign({},r)}function RF(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===PF}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e){this.value=e}static empty(){return new sa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!v0(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ep(t)}setAll(e){let t=kr.emptyPath(),n={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){const f=this.getFieldsMap(t);this.applyChanges(f,n,i),n={},i=[],t=u.popLast()}a?n[u.lastSegment()]=Ep(a):i.push(u.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());v0(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ka(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];v0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){od(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new sa(Ep(this.value))}}function j2(r){const e=[];return od(r.fields,(t,n)=>{const i=new kr([t]);if(v0(n)){const s=j2(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new oa(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e,t,n,i,s,a,u){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new ra(e,0,hi.min(),hi.min(),hi.min(),sa.empty(),0)}static newFoundDocument(e,t,n,i){return new ra(e,1,t,hi.min(),n,i,0)}static newNoDocument(e,t){return new ra(e,2,t,hi.min(),hi.min(),sa.empty(),0)}static newUnknownDocument(e,t){return new ra(e,3,t,hi.min(),hi.min(),sa.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(hi.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=sa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=sa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=hi.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ra&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ra(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(e,t){this.position=e,this.inclusive=t}}function iT(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],a=r.position[i];if(s.field.isKeyField()?n=on.comparator(on.fromName(a.referenceValue),t.key):n=Yf(a,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function rT(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!ka(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,t="asc"){this.field=e,this.dir=t}}function DF(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{}class xr extends q2{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new OF(e,t,n):t==="array-contains"?new zF(e,n):t==="in"?new FF(e,n):t==="not-in"?new UF(e,n):t==="array-contains-any"?new BF(e,n):new xr(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new NF(e,n):new kF(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Yf(t,this.value)):t!==null&&hh(this.value)===hh(t)&&this.matchesComparison(Yf(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zu extends q2{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new zu(e,t)}matches(e){return X2(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function X2(r){return r.op==="and"}function $2(r){return LF(r)&&X2(r)}function LF(r){for(const e of r.filters)if(e instanceof zu)return!1;return!0}function fx(r){if(r instanceof xr)return r.field.canonicalString()+r.op.toString()+Qf(r.value);if($2(r))return r.filters.map(e=>fx(e)).join(",");{const e=r.filters.map(t=>fx(t)).join(",");return`${r.op}(${e})`}}function Y2(r,e){return r instanceof xr?function(n,i){return i instanceof xr&&n.op===i.op&&n.field.isEqual(i.field)&&ka(n.value,i.value)}(r,e):r instanceof zu?function(n,i){return i instanceof zu&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,u)=>s&&Y2(a,i.filters[u]),!0):!1}(r,e):void dn()}function Q2(r){return r instanceof xr?function(t){return`${t.field.canonicalString()} ${t.op} ${Qf(t.value)}`}(r):r instanceof zu?function(t){return t.op.toString()+" {"+t.getFilters().map(Q2).join(" ,")+"}"}(r):"Filter"}class OF extends xr{constructor(e,t,n){super(e,t,n),this.key=on.fromName(n.referenceValue)}matches(e){const t=on.comparator(e.key,this.key);return this.matchesComparison(t)}}class NF extends xr{constructor(e,t){super(e,"in",t),this.keys=K2("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class kF extends xr{constructor(e,t){super(e,"not-in",t),this.keys=K2("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function K2(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>on.fromName(n.referenceValue))}class zF extends xr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return S1(t)&&$p(t.arrayValue,this.value)}}class FF extends xr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&$p(this.value.arrayValue,t)}}class UF extends xr{constructor(e,t){super(e,"not-in",t)}matches(e){if($p(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!$p(this.value.arrayValue,t)}}class BF extends xr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!S1(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>$p(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e,t=null,n=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.le=null}}function sT(r,e=null,t=[],n=[],i=null,s=null,a=null){return new VF(r,e,t,n,i,s,a)}function E1(r){const e=ii(r);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>fx(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),y1(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Qf(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Qf(n)).join(",")),e.le=t}return e.le}function T1(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!DF(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!Y2(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!rT(r.startAt,e.startAt)&&rT(r.endAt,e.endAt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(e,t=null,n=[],i=[],s=null,a="F",u=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=f,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function HF(r,e,t,n,i,s,a,u){return new d_(r,e,t,n,i,s,a,u)}function GF(r){return new d_(r)}function oT(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function WF(r){return r.collectionGroup!==null}function Tp(r){const e=ii(r);if(e.he===null){e.he=[];const t=new Set;for(const s of e.explicitOrderBy)e.he.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Fr(kr.comparator);return a.filters.forEach(f=>{f.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.he.push(new N0(s,n))}),t.has(kr.keyField().canonicalString())||e.he.push(new N0(kr.keyField(),n))}return e.he}function nh(r){const e=ii(r);return e.Pe||(e.Pe=jF(e,Tp(r))),e.Pe}function jF(r,e){if(r.limitType==="F")return sT(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new N0(i.field,s)});const t=r.endAt?new O0(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new O0(r.startAt.position,r.startAt.inclusive):null;return sT(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function dx(r,e,t){return new d_(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Z2(r,e){return T1(nh(r),nh(e))&&r.limitType===e.limitType}function J2(r){return`${E1(nh(r))}|lt:${r.limitType}`}function pp(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>Q2(i)).join(", ")}]`),y1(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Qf(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Qf(i)).join(",")),`Target(${n})`}(nh(r))}; limitType=${r.limitType})`}function M1(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):on.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of Tp(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(a,u,f){const d=iT(a,u,f);return a.inclusive?d<=0:d<0}(n.startAt,Tp(n),i)||n.endAt&&!function(a,u,f){const d=iT(a,u,f);return a.inclusive?d>=0:d>0}(n.endAt,Tp(n),i))}(r,e)}function qF(r){return(e,t)=>{let n=!1;for(const i of Tp(r)){const s=XF(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function XF(r,e,t){const n=r.field.isKeyField()?on.comparator(e.key,t.key):function(s,a,u){const f=a.data.field(s),d=u.data.field(s);return f!==null&&d!==null?Yf(f,d):dn()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return dn()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){od(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return F2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $F=new zs(on.comparator);function k0(){return $F}const eA=new zs(on.comparator);function s0(...r){let e=eA;for(const t of r)e=e.insert(t.key,t);return e}function tA(r){let e=eA;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function $c(){return Mp()}function nA(){return Mp()}function Mp(){return new yh(r=>r.toString(),(r,e)=>r.isEqual(e))}const YF=new zs(on.comparator),QF=new Fr(on.comparator);function Qr(...r){let e=QF;for(const t of r)e=e.add(t);return e}const KF=new Fr(Mn);function ZF(){return KF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:I0(e)?"-0":e}}function iA(r){return{integerValue:""+r}}function JF(r,e){return EF(e)?iA(e):C1(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(){this._=void 0}}function eU(r,e,t){return r instanceof z0?function(i,s){const a={fields:{[B2]:{stringValue:U2},[H2]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&x1(s)&&(s=w1(s)),s&&(a.fields[V2]=s),{mapValue:a}}(t,e):r instanceof Yp?sA(r,e):r instanceof Qp?oA(r,e):function(i,s){const a=rA(i,s),u=aT(a)+aT(i.Ie);return hx(a)&&hx(i.Ie)?iA(u):C1(i.serializer,u)}(r,e)}function tU(r,e,t){return r instanceof Yp?sA(r,e):r instanceof Qp?oA(r,e):t}function rA(r,e){return r instanceof F0?function(n){return hx(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class z0 extends p_{}class Yp extends p_{constructor(e){super(),this.elements=e}}function sA(r,e){const t=aA(e);for(const n of r.elements)t.some(i=>ka(i,n))||t.push(n);return{arrayValue:{values:t}}}class Qp extends p_{constructor(e){super(),this.elements=e}}function oA(r,e){let t=aA(e);for(const n of r.elements)t=t.filter(i=>!ka(i,n));return{arrayValue:{values:t}}}class F0 extends p_{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function aT(r){return Nr(r.integerValue||r.doubleValue)}function aA(r){return S1(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function nU(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof Yp&&i instanceof Yp||n instanceof Qp&&i instanceof Qp?Xf(n.elements,i.elements,ka):n instanceof F0&&i instanceof F0?ka(n.Ie,i.Ie):n instanceof z0&&i instanceof z0}(r.transform,e.transform)}class iU{constructor(e,t){this.version=e,this.transformResults=t}}class Al{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Al}static exists(e){return new Al(void 0,e)}static updateTime(e){return new Al(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function y0(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class m_{}function lA(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new cA(r.key,Al.none()):new wm(r.key,r.data,Al.none());{const t=r.data,n=sa.empty();let i=new Fr(kr.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new xh(r.key,n,new oa(i.toArray()),Al.none())}}function rU(r,e,t){r instanceof wm?function(i,s,a){const u=i.value.clone(),f=uT(i.fieldTransforms,s,a.transformResults);u.setAll(f),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(r,e,t):r instanceof xh?function(i,s,a){if(!y0(i.precondition,s))return void s.convertToUnknownDocument(a.version);const u=uT(i.fieldTransforms,s,a.transformResults),f=s.data;f.setAll(uA(i)),f.setAll(u),s.convertToFoundDocument(a.version,f).setHasCommittedMutations()}(r,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Cp(r,e,t,n){return r instanceof wm?function(s,a,u,f){if(!y0(s.precondition,a))return u;const d=s.value.clone(),m=cT(s.fieldTransforms,f,a);return d.setAll(m),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(r,e,t,n):r instanceof xh?function(s,a,u,f){if(!y0(s.precondition,a))return u;const d=cT(s.fieldTransforms,f,a),m=a.data;return m.setAll(uA(s)),m.setAll(d),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(_=>_.field))}(r,e,t,n):function(s,a,u){return y0(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(r,e,t)}function sU(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=rA(n.transform,i||null);s!=null&&(t===null&&(t=sa.empty()),t.set(n.field,s))}return t||null}function lT(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Xf(n,i,(s,a)=>nU(s,a))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class wm extends m_{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class xh extends m_{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function uA(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function uT(r,e,t){const n=new Map;Mi(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],a=s.transform,u=e.data.field(s.field);n.set(s.field,tU(a,u,t[i]))}return n}function cT(r,e,t){const n=new Map;for(const i of r){const s=i.transform,a=t.data.field(i.field);n.set(i.field,eU(s,a,e))}return n}class cA extends m_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oU extends m_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aU{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&rU(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Cp(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Cp(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=nA();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let u=this.applyToLocalView(a,s.mutatedFields);u=t.has(i.key)?null:u;const f=lA(a,u);f!==null&&n.set(i.key,f),a.isValidDocument()||a.convertToNoDocument(hi.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Qr())}isEqual(e){return this.batchId===e.batchId&&Xf(this.mutations,e.mutations,(t,n)=>lT(t,n))&&Xf(this.baseMutations,e.baseMutations,(t,n)=>lT(t,n))}}class A1{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){Mi(e.mutations.length===n.length);let i=function(){return YF}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new A1(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $i,wn;function uU(r){switch(r){case qe.OK:return dn();case qe.CANCELLED:case qe.UNKNOWN:case qe.DEADLINE_EXCEEDED:case qe.RESOURCE_EXHAUSTED:case qe.INTERNAL:case qe.UNAVAILABLE:case qe.UNAUTHENTICATED:return!1;case qe.INVALID_ARGUMENT:case qe.NOT_FOUND:case qe.ALREADY_EXISTS:case qe.PERMISSION_DENIED:case qe.FAILED_PRECONDITION:case qe.ABORTED:case qe.OUT_OF_RANGE:case qe.UNIMPLEMENTED:case qe.DATA_LOSS:return!0;default:return dn()}}function cU(r){if(r===void 0)return uh("GRPC error has no .code"),qe.UNKNOWN;switch(r){case $i.OK:return qe.OK;case $i.CANCELLED:return qe.CANCELLED;case $i.UNKNOWN:return qe.UNKNOWN;case $i.DEADLINE_EXCEEDED:return qe.DEADLINE_EXCEEDED;case $i.RESOURCE_EXHAUSTED:return qe.RESOURCE_EXHAUSTED;case $i.INTERNAL:return qe.INTERNAL;case $i.UNAVAILABLE:return qe.UNAVAILABLE;case $i.UNAUTHENTICATED:return qe.UNAUTHENTICATED;case $i.INVALID_ARGUMENT:return qe.INVALID_ARGUMENT;case $i.NOT_FOUND:return qe.NOT_FOUND;case $i.ALREADY_EXISTS:return qe.ALREADY_EXISTS;case $i.PERMISSION_DENIED:return qe.PERMISSION_DENIED;case $i.FAILED_PRECONDITION:return qe.FAILED_PRECONDITION;case $i.ABORTED:return qe.ABORTED;case $i.OUT_OF_RANGE:return qe.OUT_OF_RANGE;case $i.UNIMPLEMENTED:return qe.UNIMPLEMENTED;case $i.DATA_LOSS:return qe.DATA_LOSS;default:return dn()}}(wn=$i||($i={}))[wn.OK=0]="OK",wn[wn.CANCELLED=1]="CANCELLED",wn[wn.UNKNOWN=2]="UNKNOWN",wn[wn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wn[wn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wn[wn.NOT_FOUND=5]="NOT_FOUND",wn[wn.ALREADY_EXISTS=6]="ALREADY_EXISTS",wn[wn.PERMISSION_DENIED=7]="PERMISSION_DENIED",wn[wn.UNAUTHENTICATED=16]="UNAUTHENTICATED",wn[wn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wn[wn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wn[wn.ABORTED=10]="ABORTED",wn[wn.OUT_OF_RANGE=11]="OUT_OF_RANGE",wn[wn.UNIMPLEMENTED=12]="UNIMPLEMENTED",wn[wn.INTERNAL=13]="INTERNAL",wn[wn.UNAVAILABLE=14]="UNAVAILABLE",wn[wn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new p1([4294967295,4294967295],0);class hU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function px(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fU(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function dU(r,e){return px(r,e.toTimestamp())}function Vf(r){return Mi(!!r),hi.fromTimestamp(function(t){const n=ch(t);return new wr(n.seconds,n.nanos)}(r))}function hA(r,e){return mx(r,e).canonicalString()}function mx(r,e){const t=function(i){return new Ti(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function pU(r){const e=Ti.fromString(r);return Mi(SU(e)),e}function gx(r,e){return hA(r.databaseId,e.path)}function mU(r){const e=pU(r);return e.length===4?Ti.emptyPath():_U(e)}function gU(r){return new Ti(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function _U(r){return Mi(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function hT(r,e,t){return{name:gx(r,e),fields:t.value.mapValue.fields}}function vU(r,e){let t;if(e instanceof wm)t={update:hT(r,e.key,e.value)};else if(e instanceof cA)t={delete:gx(r,e.key)};else if(e instanceof xh)t={update:hT(r,e.key,e.data),updateMask:wU(e.fieldMask)};else{if(!(e instanceof oU))return dn();t={verify:gx(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const u=a.transform;if(u instanceof z0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Yp)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Qp)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof F0)return{fieldPath:a.field.canonicalString(),increment:u.Ie};throw dn()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:dU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:dn()}(r,e.precondition)),t}function yU(r,e){return r&&r.length>0?(Mi(e!==void 0),r.map(t=>function(i,s){let a=i.updateTime?Vf(i.updateTime):Vf(s);return a.isEqual(hi.min())&&(a=Vf(s)),new iU(a,i.transformResults||[])}(t,e))):[]}function xU(r){let e=mU(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){Mi(n===1);const m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=function(_){const y=fA(_);return y instanceof zu&&$2(y)?y.getFilters():[y]}(t.where));let a=[];t.orderBy&&(a=function(_){return _.map(y=>function(T){return new N0(Lf(T.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(y))}(t.orderBy));let u=null;t.limit&&(u=function(_){let y;return y=typeof _=="object"?_.value:_,y1(y)?null:y}(t.limit));let f=null;t.startAt&&(f=function(_){const y=!!_.before,w=_.values||[];return new O0(w,y)}(t.startAt));let d=null;return t.endAt&&(d=function(_){const y=!_.before,w=_.values||[];return new O0(w,y)}(t.endAt)),HF(e,i,a,s,u,"F",f,d)}function fA(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Lf(t.unaryFilter.field);return xr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Lf(t.unaryFilter.field);return xr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Lf(t.unaryFilter.field);return xr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Lf(t.unaryFilter.field);return xr.create(a,"!=",{nullValue:"NULL_VALUE"});default:return dn()}}(r):r.fieldFilter!==void 0?function(t){return xr.create(Lf(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return dn()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return zu.create(t.compositeFilter.filters.map(n=>fA(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return dn()}}(t.compositeFilter.op))}(r):dn()}function Lf(r){return kr.fromServerFormat(r.fieldPath)}function wU(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function SU(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(e){this.Tt=e}}function TU(r){const e=xU({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?dx(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MU{constructor(){this.Tn=new CU}addToCollectionParentIndex(e,t){return this.Tn.add(t),ke.resolve()}getCollectionParents(e,t){return ke.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return ke.resolve()}deleteFieldIndex(e,t){return ke.resolve()}deleteAllFieldIndexes(e){return ke.resolve()}createTargetIndexes(e,t){return ke.resolve()}getDocumentsMatchingTarget(e,t){return ke.resolve(null)}getIndexType(e,t){return ke.resolve(0)}getFieldIndexes(e,t){return ke.resolve([])}getNextCollectionGroupToUpdate(e){return ke.resolve(null)}getMinOffset(e,t){return ke.resolve(ku.min())}getMinOffsetFromCollectionGroup(e,t){return ke.resolve(ku.min())}updateCollectionGroup(e,t,n){return ke.resolve()}updateIndexEntries(e,t){return ke.resolve()}}class CU{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new Fr(Ti.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Fr(Ti.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},dA=41943040;class Ls{static withCacheSize(e){return new Ls(e,Ls.DEFAULT_COLLECTION_PERCENTILE,Ls.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ls.DEFAULT_COLLECTION_PERCENTILE=10,Ls.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ls.DEFAULT=new Ls(dA,Ls.DEFAULT_COLLECTION_PERCENTILE,Ls.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ls.DISABLED=new Ls(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new Kf(0)}static Kn(){return new Kf(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dT="LruGarbageCollector",AU=1048576;function pT([r,e],[t,n]){const i=Mn(r,t);return i===0?Mn(e,n):i}class bU{constructor(e){this.Hn=e,this.buffer=new Fr(pT),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();pT(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class PU{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){St(dT,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){xm(t)?St(dT,"Ignoring IndexedDB error during garbage collection: ",t):await g1(t)}await this.er(3e5)})}}class IU{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return ke.resolve(_1.ae);const n=new bU(t);return this.tr.forEachTarget(e,i=>n.Zn(i.sequenceNumber)).next(()=>this.tr.rr(e,i=>n.Zn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(St("LruGarbageCollector","Garbage collection skipped; disabled"),ke.resolve(fT)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(St("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fT):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,i,s,a,u,f,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_=>(_>this.params.maximumSequenceNumbersToCollect?(St("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),i=this.params.maximumSequenceNumbersToCollect):i=_,a=Date.now(),this.nthSequenceNumber(e,i))).next(_=>(n=_,u=Date.now(),this.removeTargets(e,n,t))).next(_=>(s=_,f=Date.now(),this.removeOrphanedDocuments(e,n))).next(_=>(d=Date.now(),Df()<=Sn.DEBUG&&St("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${s} targets in `+(f-u)+`ms
	Removed ${_} documents in `+(d-f)+`ms
Total Duration: ${d-m}ms`),ke.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:_})))}}function RU(r,e){return new IU(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{constructor(){this.changes=new yh(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ra.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ke.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&Cp(n.mutation,i,oa.empty(),wr.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Qr()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Qr()){const i=$c();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let a=s0();return s.forEach((u,f)=>{a=a.insert(u,f.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const n=$c();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Qr()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,n,i){let s=k0();const a=Mp(),u=function(){return Mp()}();return t.forEach((f,d)=>{const m=n.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof xh)?s=s.insert(d.key,d):m!==void 0?(a.set(d.key,m.mutation.getFieldMask()),Cp(m.mutation,d,m.mutation.getFieldMask(),wr.now())):a.set(d.key,oa.empty())}),this.recalculateAndSaveOverlays(e,s).next(f=>(f.forEach((d,m)=>a.set(d,m)),t.forEach((d,m)=>{var _;return u.set(d,new LU(m,(_=a.get(d))!==null&&_!==void 0?_:null))}),u))}recalculateAndSaveOverlays(e,t){const n=Mp();let i=new zs((a,u)=>a-u),s=Qr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const u of a)u.keys().forEach(f=>{const d=t.get(f);if(d===null)return;let m=n.get(f)||oa.empty();m=u.applyToLocalView(d,m),n.set(f,m);const _=(i.get(u.batchId)||Qr()).add(f);i=i.insert(u.batchId,_)})}).next(()=>{const a=[],u=i.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),d=f.key,m=f.value,_=nA();m.forEach(y=>{if(!s.has(y)){const w=lA(t.get(y),n.get(y));w!==null&&_.set(y,w),s=s.add(y)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,_))}return ke.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(a){return on.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):WF(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ke.resolve($c());let u=Xp,f=s;return a.next(d=>ke.forEach(d,(m,_)=>(u<_.largestBatchId&&(u=_.largestBatchId),s.get(m)?ke.resolve():this.remoteDocumentCache.getEntry(e,m).next(y=>{f=f.insert(m,y)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,f,d,Qr())).next(m=>({batchId:u,changes:tA(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new on(t)).next(n=>{let i=s0();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let a=s0();return this.indexManager.getCollectionParents(e,s).next(u=>ke.forEach(u,f=>{const d=function(_,y){return new d_(y,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(t,f.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next(m=>{m.forEach((_,y)=>{a=a.insert(_,y)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(a=>{s.forEach((f,d)=>{const m=d.getKey();a.get(m)===null&&(a=a.insert(m,ra.newInvalidDocument(m)))});let u=s0();return a.forEach((f,d)=>{const m=s.get(f);m!==void 0&&Cp(m.mutation,d,oa.empty(),wr.now()),M1(t,d)&&(u=u.insert(f,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NU{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return ke.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Vf(i.createTime)}}(t)),ke.resolve()}getNamedQuery(e,t){return ke.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(i){return{name:i.name,query:TU(i.bundledQuery),readTime:Vf(i.readTime)}}(t)),ke.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(){this.overlays=new zs(on.comparator),this.Rr=new Map}getOverlay(e,t){return ke.resolve(this.overlays.get(t))}getOverlays(e,t){const n=$c();return ke.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.Et(e,t,s)}),ke.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Rr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Rr.delete(n)),ke.resolve()}getOverlaysForCollection(e,t,n){const i=$c(),s=t.length+1,a=new on(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const f=u.getNext().value,d=f.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&f.largestBatchId>n&&i.set(f.getKey(),f)}return ke.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new zs((d,m)=>d-m);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>n){let m=s.get(d.largestBatchId);m===null&&(m=$c(),s=s.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const u=$c(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((d,m)=>u.set(d,m)),!(u.size()>=i)););return ke.resolve(u)}Et(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Rr.get(i.largestBatchId).delete(n.key);this.Rr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new lU(t,n));let s=this.Rr.get(t);s===void 0&&(s=Qr(),this.Rr.set(t,s)),this.Rr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(){this.sessionToken=Na.EMPTY_BYTE_STRING}getSessionToken(e){return ke.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ke.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(){this.Vr=new Fr(vr.mr),this.gr=new Fr(vr.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new vr(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.wr(new vr(e,t))}Sr(e,t){e.forEach(n=>this.removeReference(n,t))}br(e){const t=new on(new Ti([])),n=new vr(t,e),i=new vr(t,e+1),s=[];return this.gr.forEachInRange([n,i],a=>{this.wr(a),s.push(a.key)}),s}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new on(new Ti([])),n=new vr(t,e),i=new vr(t,e+1);let s=Qr();return this.gr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new vr(e,0),n=this.Vr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class vr{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return on.comparator(e.key,t.key)||Mn(e.Cr,t.Cr)}static pr(e,t){return Mn(e.Cr,t.Cr)||on.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new Fr(vr.mr)}checkEmpty(e){return ke.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new aU(s,t,n,i);this.mutationQueue.push(a);for(const u of i)this.Mr=this.Mr.add(new vr(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ke.resolve(a)}lookupMutationBatch(e,t){return ke.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.Nr(n),s=i<0?0:i;return ke.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ke.resolve(this.mutationQueue.length===0?v1:this.Fr-1)}getAllMutationBatches(e){return ke.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new vr(t,0),i=new vr(t,Number.POSITIVE_INFINITY),s=[];return this.Mr.forEachInRange([n,i],a=>{const u=this.Or(a.Cr);s.push(u)}),ke.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Fr(Mn);return t.forEach(i=>{const s=new vr(i,0),a=new vr(i,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([s,a],u=>{n=n.add(u.Cr)})}),ke.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;on.isDocumentKey(s)||(s=s.child(""));const a=new vr(new on(s),0);let u=new Fr(Mn);return this.Mr.forEachWhile(f=>{const d=f.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(u=u.add(f.Cr)),!0)},a),ke.resolve(this.Br(u))}Br(e){const t=[];return e.forEach(n=>{const i=this.Or(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Mi(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Mr;return ke.forEach(t.mutations,i=>{const s=new vr(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Mr=n})}qn(e){}containsKey(e,t){const n=new vr(t,0),i=this.Mr.firstAfterOrEqual(n);return ke.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ke.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UU{constructor(e){this.kr=e,this.docs=function(){return new zs(on.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,a=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ke.resolve(n?n.document.mutableCopy():ra.newInvalidDocument(t))}getEntries(e,t){let n=k0();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():ra.newInvalidDocument(i))}),ke.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=k0();const a=t.path,u=new on(a.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:d,value:{document:m}}=f.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||yF(vF(m),n)<=0||(i.has(m.key)||M1(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return ke.resolve(s)}getAllFromCollectionGroup(e,t,n,i){dn()}qr(e,t){return ke.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new BU(this)}getSize(e){return ke.resolve(this.size)}}class BU extends DU{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Ir.addEntry(e,i)):this.Ir.removeEntry(n)}),ke.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{constructor(e){this.persistence=e,this.Qr=new yh(t=>E1(t),T1),this.lastRemoteSnapshotVersion=hi.min(),this.highestTargetId=0,this.$r=0,this.Ur=new b1,this.targetCount=0,this.Kr=Kf.Un()}forEachTarget(e,t){return this.Qr.forEach((n,i)=>t(i)),ke.resolve()}getLastRemoteSnapshotVersion(e){return ke.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ke.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),ke.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),ke.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new Kf(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,ke.resolve()}updateTargetData(e,t){return this.zn(t),ke.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,ke.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.Qr.forEach((a,u)=>{u.sequenceNumber<=t&&n.get(u.targetId)===null&&(this.Qr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),ke.waitFor(s).next(()=>i)}getTargetCount(e){return ke.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return ke.resolve(n)}addMatchingKeys(e,t,n){return this.Ur.yr(t,n),ke.resolve()}removeMatchingKeys(e,t,n){this.Ur.Sr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),ke.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),ke.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ur.vr(t);return ke.resolve(n)}containsKey(e,t){return ke.resolve(this.Ur.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new _1(0),this.zr=!1,this.zr=!0,this.jr=new zU,this.referenceDelegate=e(this),this.Hr=new VU(this),this.indexManager=new MU,this.remoteDocumentCache=function(i){return new UU(i)}(n=>this.referenceDelegate.Jr(n)),this.serializer=new EU(t),this.Yr=new NU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new FU(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){St("MemoryPersistence","Starting transaction:",e);const i=new HU(this.Gr.next());return this.referenceDelegate.Zr(),n(i).next(s=>this.referenceDelegate.Xr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}ei(e,t){return ke.or(Object.values(this.Wr).map(n=>()=>n.containsKey(e,t)))}}class HU extends wF{constructor(e){super(),this.currentSequenceNumber=e}}class P1{constructor(e){this.persistence=e,this.ti=new b1,this.ni=null}static ri(e){return new P1(e)}get ii(){if(this.ni)return this.ni;throw dn()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),ke.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),ke.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),ke.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach(i=>this.ii.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.ii.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ke.forEach(this.ii,n=>{const i=on.fromPath(n);return this.si(e,i).next(s=>{s||t.removeEntry(i,hi.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(n=>{n?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return ke.or([()=>ke.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class U0{constructor(e,t){this.persistence=e,this.oi=new yh(n=>TF(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=RU(this,t)}static ri(e,t){return new U0(e,t)}Zr(){}Xr(e){return ke.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}rr(e,t){return ke.forEach(this.oi,(n,i)=>this.ar(e,n,i).next(s=>s?ke.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.qr(e,a=>this.ar(e,a,t).next(u=>{u||(n++,s.removeEntry(a,hi.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),ke.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),ke.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),ke.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),ke.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_0(e.data.value)),t}ar(e,t,n){return ke.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.oi.get(t);return ke.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=i}static Yi(e,t){let n=Qr(),i=Qr();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new I1(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return V5()?8:SF(F5())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.rs(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ss(e,t,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new GU;return this._s(e,t,a).next(u=>{if(s.result=u,this.Xi)return this.us(e,t,a,u.size)})}).next(()=>s.result)}us(e,t,n,i){return n.documentReadCount<this.es?(Df()<=Sn.DEBUG&&St("QueryEngine","SDK will not create cache indexes for query:",pp(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),ke.resolve()):(Df()<=Sn.DEBUG&&St("QueryEngine","Query:",pp(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ts*i?(Df()<=Sn.DEBUG&&St("QueryEngine","The SDK decides to create cache indexes for query:",pp(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,nh(t))):ke.resolve())}rs(e,t){if(oT(t))return ke.resolve(null);let n=nh(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=dx(t,null,"F"),n=nh(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Qr(...s);return this.ns.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,n).next(f=>{const d=this.cs(t,u);return this.ls(t,d,a,f.readTime)?this.rs(e,dx(t,null,"F")):this.hs(e,d,t,f)}))})))}ss(e,t,n,i){return oT(t)||i.isEqual(hi.min())?ke.resolve(null):this.ns.getDocuments(e,n).next(s=>{const a=this.cs(t,s);return this.ls(t,a,n,i)?ke.resolve(null):(Df()<=Sn.DEBUG&&St("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),pp(t)),this.hs(e,a,t,_F(i,Xp)).next(u=>u))})}cs(e,t){let n=new Fr(qF(e));return t.forEach((i,s)=>{M1(e,s)&&(n=n.add(s))}),n}ls(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}_s(e,t,n){return Df()<=Sn.DEBUG&&St("QueryEngine","Using full collection scan to execute query:",pp(t)),this.ns.getDocumentsMatchingQuery(e,t,ku.min(),n)}hs(e,t,n,i){return this.ns.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jU="LocalStore";class qU{constructor(e,t,n,i){this.persistence=e,this.Ps=t,this.serializer=i,this.Ts=new zs(Mn),this.Is=new yh(s=>E1(s),T1),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new OU(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}}function XU(r,e,t,n){return new qU(r,e,t,n)}async function mA(r,e){const t=ii(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.As(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],u=[];let f=Qr();for(const d of i){a.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}for(const d of s){u.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}return t.localDocuments.getDocuments(n,f).next(d=>({Rs:d,removedBatchIds:a,addedBatchIds:u}))})})}function $U(r,e){const t=ii(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.ds.newChangeBuffer({trackRemovals:!0});return function(u,f,d,m){const _=d.batch,y=_.keys();let w=ke.resolve();return y.forEach(T=>{w=w.next(()=>m.getEntry(f,T)).next(E=>{const M=d.docVersions.get(T);Mi(M!==null),E.version.compareTo(M)<0&&(_.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),m.addEntry(E)))})}),w.next(()=>u.mutationQueue.removeMutationBatch(f,_))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let f=Qr();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(f=f.add(u.batch.mutations[d].key));return f}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function YU(r){const e=ii(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function QU(r,e){const t=ii(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=v1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}class mT{constructor(){this.activeTargetIds=ZF()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class KU{constructor(){this.ho=new mT,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new mT,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT="ConnectivityMonitor";class _T{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){St(gT,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){St(gT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let o0=null;function _x(){return o0===null?o0=function(){return 268435456+Math.round(2147483648*Math.random())}():o0++,"0x"+o0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oy="RestConnection",JU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class eB{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${i}`,this.wo=this.databaseId.database===D0?`project_id=${n}`:`project_id=${n}&database_id=${i}`}So(e,t,n,i,s){const a=_x(),u=this.bo(e,t.toUriEncodedString());St(oy,`Sending RPC '${e}' ${a}:`,u,n);const f={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(f,i,s),this.vo(e,u,f,n).then(d=>(St(oy,`Received RPC '${e}' ${a}: `,d),d),d=>{throw f_(oy,`RPC '${e}' ${a} failed with error: `,d,"url: ",u,"request:",n),d})}Co(e,t,n,i,s,a){return this.So(e,t,n,i,s)}Do(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+sd}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}bo(e,t){const n=JU[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tB{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr="WebChannelConnection";class nB extends eB{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,i){const s=_x();return new Promise((a,u)=>{const f=new I2;f.setWithCredentials(!0),f.listenOnce(R2.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case g0.NO_ERROR:const m=f.getResponseJson();St(Xr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(m)),a(m);break;case g0.TIMEOUT:St(Xr,`RPC '${e}' ${s} timed out`),u(new zt(qe.DEADLINE_EXCEEDED,"Request time out"));break;case g0.HTTP_ERROR:const _=f.getStatus();if(St(Xr,`RPC '${e}' ${s} failed with status:`,_,"response text:",f.getResponseText()),_>0){let y=f.getResponseJson();Array.isArray(y)&&(y=y[0]);const w=y==null?void 0:y.error;if(w&&w.status&&w.message){const T=function(M){const P=M.toLowerCase().replace(/_/g,"-");return Object.values(qe).indexOf(P)>=0?P:qe.UNKNOWN}(w.status);u(new zt(T,w.message))}else u(new zt(qe.UNKNOWN,"Server responded with status "+f.getStatus()))}else u(new zt(qe.UNAVAILABLE,"Connection failed."));break;default:dn()}}finally{St(Xr,`RPC '${e}' ${s} completed.`)}});const d=JSON.stringify(i);St(Xr,`RPC '${e}' ${s} sending request:`,i),f.send(t,"POST",d,n,15)})}Wo(e,t,n){const i=_x(),s=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=O2(),u=L2(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.Do(f.initMessageHeaders,t,n),f.encodeInitMessageHeaders=!0;const m=s.join("");St(Xr,`Creating RPC '${e}' stream ${i}: ${m}`,f);const _=a.createWebChannel(m,f);let y=!1,w=!1;const T=new tB({Fo:M=>{w?St(Xr,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(y||(St(Xr,`Opening RPC '${e}' stream ${i} transport.`),_.open(),y=!0),St(Xr,`RPC '${e}' stream ${i} sending:`,M),_.send(M))},Mo:()=>_.close()}),E=(M,P,C)=>{M.listen(P,b=>{try{C(b)}catch(R){setTimeout(()=>{throw R},0)}})};return E(_,_p.EventType.OPEN,()=>{w||(St(Xr,`RPC '${e}' stream ${i} transport opened.`),T.Qo())}),E(_,_p.EventType.CLOSE,()=>{w||(w=!0,St(Xr,`RPC '${e}' stream ${i} transport closed`),T.Uo())}),E(_,_p.EventType.ERROR,M=>{w||(w=!0,f_(Xr,`RPC '${e}' stream ${i} transport errored:`,M),T.Uo(new zt(qe.UNAVAILABLE,"The operation could not be completed")))}),E(_,_p.EventType.MESSAGE,M=>{var P;if(!w){const C=M.data[0];Mi(!!C);const b=C,R=(b==null?void 0:b.error)||((P=b[0])===null||P===void 0?void 0:P.error);if(R){St(Xr,`RPC '${e}' stream ${i} received error:`,R);const z=R.status;let B=function(N){const V=$i[N];if(V!==void 0)return cU(V)}(z),k=R.message;B===void 0&&(B=qe.INTERNAL,k="Unknown error status: "+z+" with message "+R.message),w=!0,T.Uo(new zt(B,k)),_.close()}else St(Xr,`RPC '${e}' stream ${i} received:`,C),T.Ko(C)}}),E(u,D2.STAT_EVENT,M=>{M.stat===ax.PROXY?St(Xr,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===ax.NOPROXY&&St(Xr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.$o()},0),T}}function ay(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(r){return new hU(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e,t,n=1e3,i=1.5,s=6e4){this.Ti=e,this.timerId=t,this.Go=n,this.zo=i,this.jo=s,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),i=Math.max(0,t-n);i>0&&St("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT="PersistentStream";class iB{constructor(e,t,n,i,s,a,u,f){this.Ti=e,this.n_=n,this.r_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new gA(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===qe.RESOURCE_EXHAUSTED?(uh(t.toString()),uh("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===qe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.i_===t&&this.V_(n,i)},n=>{e(()=>{const i=new zt(qe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.m_(i)})})}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{n(()=>this.listener.xo())}),this.stream.No(()=>{n(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(i=>{n(()=>this.m_(i))}),this.stream.onMessage(i=>{n(()=>++this.__==1?this.g_(i):this.onNext(i))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return St(vT,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(St(vT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class rB extends iB{constructor(e,t,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return Mi(!!e.streamToken),this.lastStreamToken=e.streamToken,Mi(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){Mi(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=yU(e.writeResults,e.commitTime),n=Vf(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=gU(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>vU(this.serializer,n))};this.I_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sB{}class oB extends sB{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.F_=!1}M_(){if(this.F_)throw new zt(qe.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.So(e,mx(t,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===qe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new zt(qe.UNKNOWN,s.toString())})}Co(e,t,n,i,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Co(e,mx(t,n),i,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===qe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new zt(qe.UNKNOWN,a.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class aB{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(uh(t),this.N_=!1):St("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm="RemoteStore";class lB{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=s,this.z_.To(a=>{n.enqueueAndForget(async()=>{Tm(this)&&(St(Sm,"Restarting streams for network reachability change."),await async function(f){const d=ii(f);d.W_.add(4),await Em(d),d.j_.set("Unknown"),d.W_.delete(4),await __(d)}(this))})}),this.j_=new aB(n,i)}}async function __(r){if(Tm(r))for(const e of r.G_)await e(!0)}async function Em(r){for(const e of r.G_)await e(!1)}function Tm(r){return ii(r).W_.size===0}async function _A(r,e,t){if(!xm(e))throw e;r.W_.add(1),await Em(r),r.j_.set("Offline"),t||(t=()=>YU(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{St(Sm,"Retrying IndexedDB access"),await t(),r.W_.delete(1),await __(r)})}function vA(r,e){return e().catch(t=>_A(r,t,e))}async function v_(r){const e=ii(r),t=Fu(e);let n=e.U_.length>0?e.U_[e.U_.length-1].batchId:v1;for(;uB(e);)try{const i=await QU(e.localStore,n);if(i===null){e.U_.length===0&&t.P_();break}n=i.batchId,cB(e,i)}catch(i){await _A(e,i)}yA(e)&&xA(e)}function uB(r){return Tm(r)&&r.U_.length<10}function cB(r,e){r.U_.push(e);const t=Fu(r);t.c_()&&t.S_&&t.b_(e.mutations)}function yA(r){return Tm(r)&&!Fu(r).u_()&&r.U_.length>0}function xA(r){Fu(r).start()}async function hB(r){Fu(r).C_()}async function fB(r){const e=Fu(r);for(const t of r.U_)e.b_(t.mutations)}async function dB(r,e,t){const n=r.U_.shift(),i=A1.from(n,e,t);await vA(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await v_(r)}async function pB(r,e){e&&Fu(r).S_&&await async function(n,i){if(function(a){return uU(a)&&a!==qe.ABORTED}(i.code)){const s=n.U_.shift();Fu(n).h_(),await vA(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await v_(n)}}(r,e),yA(r)&&xA(r)}async function yT(r,e){const t=ii(r);t.asyncQueue.verifyOperationInProgress(),St(Sm,"RemoteStore received new credentials");const n=Tm(t);t.W_.add(3),await Em(t),n&&t.j_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),await __(t)}async function mB(r,e){const t=ii(r);e?(t.W_.delete(2),await __(t)):e||(t.W_.add(2),await Em(t),t.j_.set("Unknown"))}function Fu(r){return r.Y_||(r.Y_=function(t,n,i){const s=ii(t);return s.M_(),new rB(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{xo:()=>Promise.resolve(),No:hB.bind(null,r),Lo:pB.bind(null,r),D_:fB.bind(null,r),v_:dB.bind(null,r)}),r.G_.push(async e=>{e?(r.Y_.h_(),await v_(r)):(await r.Y_.stop(),r.U_.length>0&&(St(Sm,`Stopping write stream with ${r.U_.length} pending writes`),r.U_=[]))})),r.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new th,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const a=Date.now()+n,u=new R1(e,t,a,i,s);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new zt(qe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function wA(r,e){if(uh("AsyncQueue",`${e}: ${r}`),xm(r))return new zt(qe.UNAVAILABLE,`${e}: ${r}`);throw r}class gB{constructor(){this.queries=xT(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,n){const i=ii(t),s=i.queries;i.queries=xT(),s.forEach((a,u)=>{for(const f of u.ta)f.onError(n)})})(this,new zt(qe.ABORTED,"Firestore shutting down"))}}function xT(){return new yh(r=>J2(r),Z2)}function _B(r){r.ia.forEach(e=>{e.next()})}var wT,ST;(ST=wT||(wT={}))._a="default",ST.Cache="cache";const vB="SyncEngine";class yB{constructor(e,t,n,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.La={},this.ka=new yh(u=>J2(u),Z2),this.qa=new Map,this.Qa=new Set,this.$a=new zs(on.comparator),this.Ua=new Map,this.Ka=new b1,this.Wa={},this.Ga=new Map,this.za=Kf.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function xB(r,e,t){const n=TB(r);try{const i=await function(a,u){const f=ii(a),d=wr.now(),m=u.reduce((w,T)=>w.add(T.key),Qr());let _,y;return f.persistence.runTransaction("Locally write mutations","readwrite",w=>{let T=k0(),E=Qr();return f.ds.getEntries(w,m).next(M=>{T=M,T.forEach((P,C)=>{C.isValidDocument()||(E=E.add(P))})}).next(()=>f.localDocuments.getOverlayedDocuments(w,T)).next(M=>{_=M;const P=[];for(const C of u){const b=sU(C,_.get(C.key).overlayedDocument);b!=null&&P.push(new xh(C.key,b,j2(b.value.mapValue),Al.exists(!0)))}return f.mutationQueue.addMutationBatch(w,d,P,u)}).next(M=>{y=M;const P=M.applyToLocalDocumentSet(_,E);return f.documentOverlayCache.saveOverlays(w,M.batchId,P)})}).then(()=>({batchId:y.batchId,changes:tA(_)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,u,f){let d=a.Wa[a.currentUser.toKey()];d||(d=new zs(Mn)),d=d.insert(u,f),a.Wa[a.currentUser.toKey()]=d}(n,i.batchId,t),await y_(n,i.changes),await v_(n.remoteStore)}catch(i){const s=wA(i,"Failed to persist write");t.reject(s)}}function ET(r,e,t){const n=ii(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.ka.forEach((s,a)=>{const u=a.view.sa(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){const f=ii(a);f.onlineState=u;let d=!1;f.queries.forEach((m,_)=>{for(const y of _.ta)y.sa(u)&&(d=!0)}),d&&_B(f)}(n.eventManager,e),i.length&&n.La.p_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function wB(r,e){const t=ii(r),n=e.batch.batchId;try{const i=await $U(t.localStore,e);EA(t,n,null),SA(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await y_(t,i)}catch(i){await g1(i)}}async function SB(r,e,t){const n=ii(r);try{const i=await function(a,u){const f=ii(a);return f.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return f.mutationQueue.lookupMutationBatch(d,u).next(_=>(Mi(_!==null),m=_.keys(),f.mutationQueue.removeMutationBatch(d,_))).next(()=>f.mutationQueue.performConsistencyCheck(d)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(d,m,u)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>f.localDocuments.getDocuments(d,m))})}(n.localStore,e);EA(n,e,t),SA(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await y_(n,i)}catch(i){await g1(i)}}function SA(r,e){(r.Ga.get(e)||[]).forEach(t=>{t.resolve()}),r.Ga.delete(e)}function EA(r,e,t){const n=ii(r);let i=n.Wa[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Wa[n.currentUser.toKey()]=i}}async function y_(r,e,t){const n=ii(r),i=[],s=[],a=[];n.ka.isEmpty()||(n.ka.forEach((u,f)=>{a.push(n.Ha(f,e,t).then(d=>{var m;if((d||t)&&n.isPrimaryClient){const _=d?!d.fromCache:(m=void 0)===null||m===void 0?void 0:m.current;n.sharedClientState.updateQueryState(f.targetId,_?"current":"not-current")}if(d){i.push(d);const _=I1.Yi(f.targetId,d);s.push(_)}}))}),await Promise.all(a),n.La.p_(i),await async function(f,d){const m=ii(f);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>ke.forEach(d,y=>ke.forEach(y.Hi,w=>m.persistence.referenceDelegate.addReference(_,y.targetId,w)).next(()=>ke.forEach(y.Ji,w=>m.persistence.referenceDelegate.removeReference(_,y.targetId,w)))))}catch(_){if(!xm(_))throw _;St(jU,"Failed to update sequence numbers: "+_)}for(const _ of d){const y=_.targetId;if(!_.fromCache){const w=m.Ts.get(y),T=w.snapshotVersion,E=w.withLastLimboFreeSnapshotVersion(T);m.Ts=m.Ts.insert(y,E)}}}(n.localStore,s))}async function EB(r,e){const t=ii(r);if(!t.currentUser.isEqual(e)){St(vB,"User change. New user:",e.toKey());const n=await mA(t.localStore,e);t.currentUser=e,function(s,a){s.Ga.forEach(u=>{u.forEach(f=>{f.reject(new zt(qe.CANCELLED,a))})}),s.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await y_(t,n.Rs)}}function TB(r){const e=ii(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=SB.bind(null,e),e}class B0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=g_(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return XU(this.persistence,new WU,e.initialUser,this.serializer)}Xa(e){return new pA(P1.ri,this.serializer)}Za(e){return new KU}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}B0.provider={build:()=>new B0};class MB extends B0{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){Mi(this.persistence.referenceDelegate instanceof U0);const n=this.persistence.referenceDelegate.garbageCollector;return new PU(n,e.asyncQueue,t)}Xa(e){const t=this.cacheSizeBytes!==void 0?Ls.withCacheSize(this.cacheSizeBytes):Ls.DEFAULT;return new pA(n=>U0.ri(n,t),this.serializer)}}class vx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>ET(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=EB.bind(null,this.syncEngine),await mB(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new gB}()}createDatastore(e){const t=g_(e.databaseInfo.databaseId),n=function(s){return new nB(s)}(e.databaseInfo);return function(s,a,u,f){return new oB(s,a,u,f)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,a,u){return new lB(n,i,s,a,u)}(this.localStore,this.datastore,e.asyncQueue,t=>ET(this.syncEngine,t,0),function(){return _T.D()?new _T:new ZU}())}createSyncEngine(e,t){return function(i,s,a,u,f,d,m){const _=new yB(i,s,a,u,f,d);return m&&(_.ja=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=ii(i);St(Sm,"RemoteStore shutting down."),s.W_.add(5),await Em(s),s.z_.shutdown(),s.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}vx.provider={build:()=>new vx};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uu="FirestoreClient";class CB{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Yr.UNAUTHENTICATED,this.clientId=k2.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{St(Uu,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(St(Uu,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new th;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=wA(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function ly(r,e){r.asyncQueue.verifyOperationInProgress(),St(Uu,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await mA(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function TT(r,e){r.asyncQueue.verifyOperationInProgress();const t=await AB(r);St(Uu,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>yT(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>yT(e.remoteStore,i)),r._onlineComponents=e}async function AB(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){St(Uu,"Using user provided OfflineComponentProvider");try{await ly(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===qe.FAILED_PRECONDITION||i.code===qe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;f_("Error using user provided cache. Falling back to memory cache: "+t),await ly(r,new B0)}}else St(Uu,"Using default OfflineComponentProvider"),await ly(r,new MB(void 0));return r._offlineComponents}async function bB(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(St(Uu,"Using user provided OnlineComponentProvider"),await TT(r,r._uninitializedComponentsProvider._online)):(St(Uu,"Using default OnlineComponentProvider"),await TT(r,new vx))),r._onlineComponents}function PB(r){return bB(r).then(e=>e.syncEngine)}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TA(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MA(r,e,t){if(!t)throw new zt(qe.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function IB(r,e,t,n){if(e===!0&&n===!0)throw new zt(qe.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function CT(r){if(!on.isDocumentKey(r))throw new zt(qe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function AT(r){if(on.isDocumentKey(r))throw new zt(qe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function D1(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":dn()}function CA(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new zt(qe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=D1(r);throw new zt(qe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA="firestore.googleapis.com",bT=!0;class PT{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new zt(qe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=AA,this.ssl=bT}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:bT;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=dA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<AU)throw new zt(qe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IB("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=TA((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new zt(qe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new zt(qe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new zt(qe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class x_{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new PT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new zt(qe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new zt(qe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new PT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new aF;switch(n.type){case"firstParty":return new hF(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new zt(qe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=MT.get(t);n&&(St("ComponentProvider","Removing Datastore"),MT.delete(t),n.terminate())}(this),Promise.resolve()}}function RB(r,e,t,n={}){var i;const s=(r=CA(r,x_))._getSettings(),a=Object.assign(Object.assign({},s),{emulatorOptions:r._getEmulatorOptions()}),u=`${e}:${t}`;s.host!==AA&&s.host!==u&&f_("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f=Object.assign(Object.assign({},s),{host:u,ssl:!1,emulatorOptions:n});if(!jp(f,a)&&(r._setSettings(f),n.mockUserToken)){let d,m;if(typeof n.mockUserToken=="string")d=n.mockUserToken,m=Yr.MOCK_USER;else{d=z5(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new zt(qe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Yr(_)}r._authCredentials=new lF(new N2(d,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new L1(this.firestore,e,this._query)}}class bl{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bl(this.firestore,e,this._key)}}class Pu extends L1{constructor(e,t,n){super(e,t,GF(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bl(this.firestore,null,new on(e))}withConverter(e){return new Pu(this.firestore,e,this._path)}}function DB(r,e,...t){if(r=ah(r),MA("collection","path",e),r instanceof x_){const n=Ti.fromString(e,...t);return AT(n),new Pu(r,null,n)}{if(!(r instanceof bl||r instanceof Pu))throw new zt(qe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Ti.fromString(e,...t));return AT(n),new Pu(r.firestore,null,n)}}function LB(r,e,...t){if(r=ah(r),arguments.length===1&&(e=k2.newId()),MA("doc","path",e),r instanceof x_){const n=Ti.fromString(e,...t);return CT(n),new bl(r,null,new on(n))}{if(!(r instanceof bl||r instanceof Pu))throw new zt(qe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Ti.fromString(e,...t));return CT(n),new bl(r.firestore,r instanceof Pu?r.converter:null,new on(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT="AsyncQueue";class RT{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new gA(this,"async_queue_retry"),this.Su=()=>{const n=ay();n&&St(IT,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.bu=e;const t=ay();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=ay();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const t=new th;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!xm(e))throw e;St(IT,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const t=this.bu.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;const i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(n);throw uh("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.pu=!1,n))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const i=R1.createAndSchedule(this,e,t,n,s=>this.Fu(s));return this.fu.push(i),i}Du(){this.gu&&dn()}verifyOperationInProgress(){}async Mu(){let e;do e=this.bu,await e;while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}class bA extends x_{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new RT,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new RT(e),this._firestoreClient=void 0,await e}}}function OB(r,e){const t=typeof r=="object"?r:A2(),n=typeof r=="string"?r:D0,i=ym(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=N5("firestore");s&&RB(i,...s)}return i}function NB(r){if(r._terminated)throw new zt(qe.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||kB(r),r._firestoreClient}function kB(r){var e,t,n;const i=r._freezeSettings(),s=function(u,f,d,m){return new bF(u,f,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,TA(m.experimentalLongPollingOptions),m.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new CB(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(u){const f=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(f),_online:f}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Kp(Na.fromBase64String(e))}catch(t){throw new zt(qe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Kp(Na.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new zt(qe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new zt(qe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new zt(qe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Mn(this._lat,e._lat)||Mn(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zB=/^__.*__$/;class FB{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new xh(e,this.data,this.fieldMask,t,this.fieldTransforms):new wm(e,this.data,t,this.fieldTransforms)}}function LA(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dn()}}class O1{constructor(e,t,n,i,s,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Bu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new O1(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.$u(e),i}Uu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.Bu(),i}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return V0(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(LA(this.Lu)&&zB.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class UB{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||g_(e)}ju(e,t,n,i=!1){return new O1({Lu:e,methodName:t,zu:n,path:kr.emptyPath(),Qu:!1,Gu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function BB(r){const e=r._freezeSettings(),t=g_(r._databaseId);return new UB(r._databaseId,!!e.ignoreUndefinedProperties,t)}function VB(r,e,t,n,i,s={}){const a=r.ju(s.merge||s.mergeFields?2:0,e,t,i);zA("Data must be an object, but it was:",a,n);const u=NA(n,a);let f,d;if(s.merge)f=new oa(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){const m=[];for(const _ of s.mergeFields){const y=HB(e,_,t);if(!a.contains(y))throw new zt(qe.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);jB(m,y)||m.push(y)}f=new oa(m),d=a.fieldTransforms.filter(_=>f.covers(_.field))}else f=null,d=a.fieldTransforms;return new FB(new sa(u),f,d)}function OA(r,e){if(kA(r=ah(r)))return zA("Unsupported field value:",e,r),NA(r,e);if(r instanceof IA)return function(n,i){if(!LA(i.Lu))throw i.Wu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Wu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const u of n){let f=OA(u,i.Ku(a));f==null&&(f={nullValue:"NULL_VALUE"}),s.push(f),a++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=ah(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return JF(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=wr.fromDate(n);return{timestampValue:px(i.serializer,s)}}if(n instanceof wr){const s=new wr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:px(i.serializer,s)}}if(n instanceof RA)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Kp)return{bytesValue:fU(i.serializer,n._byteString)};if(n instanceof bl){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Wu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:hA(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof DA)return function(a,u){return{mapValue:{fields:{[G2]:{stringValue:W2},[ux]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw u.Wu("VectorValues must only contain numeric values.");return C1(u.serializer,d)})}}}}}}(n,i);throw i.Wu(`Unsupported field value: ${D1(n)}`)}(r,e)}function NA(r,e){const t={};return F2(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):od(r,(n,i)=>{const s=OA(i,e.qu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function kA(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof wr||r instanceof RA||r instanceof Kp||r instanceof bl||r instanceof IA||r instanceof DA)}function zA(r,e,t){if(!kA(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const n=D1(t);throw n==="an object"?e.Wu(r+" a custom object"):e.Wu(r+" "+n)}}function HB(r,e,t){if((e=ah(e))instanceof PA)return e._internalPath;if(typeof e=="string")return WB(r,e);throw V0("Field path arguments must be of type string or ",r,!1,void 0,t)}const GB=new RegExp("[~\\*/\\[\\]]");function WB(r,e,t){if(e.search(GB)>=0)throw V0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new PA(...e.split("."))._internalPath}catch{throw V0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function V0(r,e,t,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(s||a)&&(f+=" (found",s&&(f+=` in field ${n}`),a&&(f+=` in document ${i}`),f+=")"),new zt(qe.INVALID_ARGUMENT,u+r+f)}function jB(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qB(r,e,t){let n;return n=r?r.toFirestore(e):e,n}function XB(r,e){const t=CA(r.firestore,bA),n=LB(r),i=qB(r.converter,e);return $B(t,[VB(BB(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,Al.exists(!1))]).then(()=>n)}function $B(r,e){return function(n,i){const s=new th;return n.asyncQueue.enqueueAndForget(async()=>xB(await PB(n),i,s)),s.promise}(NB(r),e)}(function(e,t=!0){(function(i){sd=i})($z),Nu(new Dl("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),u=new bA(new uF(n.getProvider("auth-internal")),new fF(a,n.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new zt(qe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new L0(d.options.projectId,m)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Oa(jE,qE,e),Oa(jE,qE,"esm2017")})();const FA="@firebase/installations",N1="0.6.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UA=1e4,BA=`w:${N1}`,VA="FIS_v2",YB="https://firebaseinstallations.googleapis.com/v1",QB=60*60*1e3,KB="installations",ZB="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JB={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},fh=new h_(KB,ZB,JB);function HA(r){return r instanceof ju&&r.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA({projectId:r}){return`${YB}/projects/${r}/installations`}function WA(r){return{token:r.token,requestStatus:2,expiresIn:t6(r.expiresIn),creationTime:Date.now()}}async function jA(r,e){const n=(await e.json()).error;return fh.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function qA({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function e6(r,{refreshToken:e}){const t=qA(r);return t.append("Authorization",n6(e)),t}async function XA(r){const e=await r();return e.status>=500&&e.status<600?r():e}function t6(r){return Number(r.replace("s","000"))}function n6(r){return`${VA} ${r}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i6({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const n=GA(r),i=qA(r),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const a={fid:t,authVersion:VA,appId:r.appId,sdkVersion:BA},u={method:"POST",headers:i,body:JSON.stringify(a)},f=await XA(()=>fetch(n,u));if(f.ok){const d=await f.json();return{fid:d.fid||t,registrationStatus:2,refreshToken:d.refreshToken,authToken:WA(d.authToken)}}else throw await jA("Create Installation",f)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $A(r){return new Promise(e=>{setTimeout(e,r)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r6(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6=/^[cdef][\w-]{21}$/,yx="";function o6(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=a6(r);return s6.test(t)?t:yx}catch{return yx}}function a6(r){return r6(r).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w_(r){return`${r.appName}!${r.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA=new Map;function QA(r,e){const t=w_(r);KA(t,e),l6(t,e)}function KA(r,e){const t=YA.get(r);if(t)for(const n of t)n(e)}function l6(r,e){const t=u6();t&&t.postMessage({key:r,fid:e}),c6()}let Yc=null;function u6(){return!Yc&&"BroadcastChannel"in self&&(Yc=new BroadcastChannel("[Firebase] FID Change"),Yc.onmessage=r=>{KA(r.data.key,r.data.fid)}),Yc}function c6(){YA.size===0&&Yc&&(Yc.close(),Yc=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h6="firebase-installations-database",f6=1,dh="firebase-installations-store";let uy=null;function k1(){return uy||(uy=M2(h6,f6,{upgrade:(r,e)=>{switch(e){case 0:r.createObjectStore(dh)}}})),uy}async function H0(r,e){const t=w_(r),i=(await k1()).transaction(dh,"readwrite"),s=i.objectStore(dh),a=await s.get(t);return await s.put(e,t),await i.done,(!a||a.fid!==e.fid)&&QA(r,e.fid),e}async function ZA(r){const e=w_(r),n=(await k1()).transaction(dh,"readwrite");await n.objectStore(dh).delete(e),await n.done}async function S_(r,e){const t=w_(r),i=(await k1()).transaction(dh,"readwrite"),s=i.objectStore(dh),a=await s.get(t),u=e(a);return u===void 0?await s.delete(t):await s.put(u,t),await i.done,u&&(!a||a.fid!==u.fid)&&QA(r,u.fid),u}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z1(r){let e;const t=await S_(r.appConfig,n=>{const i=d6(n),s=p6(r,i);return e=s.registrationPromise,s.installationEntry});return t.fid===yx?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function d6(r){const e=r||{fid:o6(),registrationStatus:0};return JA(e)}function p6(r,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(fh.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=m6(r,t);return{installationEntry:t,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:g6(r)}:{installationEntry:e}}async function m6(r,e){try{const t=await i6(r,e);return H0(r.appConfig,t)}catch(t){throw HA(t)&&t.customData.serverCode===409?await ZA(r.appConfig):await H0(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function g6(r){let e=await DT(r.appConfig);for(;e.registrationStatus===1;)await $A(100),e=await DT(r.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:n}=await z1(r);return n||t}return e}function DT(r){return S_(r,e=>{if(!e)throw fh.create("installation-not-found");return JA(e)})}function JA(r){return _6(r)?{fid:r.fid,registrationStatus:0}:r}function _6(r){return r.registrationStatus===1&&r.registrationTime+UA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v6({appConfig:r,heartbeatServiceProvider:e},t){const n=y6(r,t),i=e6(r,t),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&i.append("x-firebase-client",d)}const a={installation:{sdkVersion:BA,appId:r.appId}},u={method:"POST",headers:i,body:JSON.stringify(a)},f=await XA(()=>fetch(n,u));if(f.ok){const d=await f.json();return WA(d)}else throw await jA("Generate Auth Token",f)}function y6(r,{fid:e}){return`${GA(r)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F1(r,e=!1){let t;const n=await S_(r.appConfig,s=>{if(!eb(s))throw fh.create("not-registered");const a=s.authToken;if(!e&&S6(a))return s;if(a.requestStatus===1)return t=x6(r,e),s;{if(!navigator.onLine)throw fh.create("app-offline");const u=T6(s);return t=w6(r,u),u}});return t?await t:n.authToken}async function x6(r,e){let t=await LT(r.appConfig);for(;t.authToken.requestStatus===1;)await $A(100),t=await LT(r.appConfig);const n=t.authToken;return n.requestStatus===0?F1(r,e):n}function LT(r){return S_(r,e=>{if(!eb(e))throw fh.create("not-registered");const t=e.authToken;return M6(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function w6(r,e){try{const t=await v6(r,e),n=Object.assign(Object.assign({},e),{authToken:t});return await H0(r.appConfig,n),t}catch(t){if(HA(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await ZA(r.appConfig);else{const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await H0(r.appConfig,n)}throw t}}function eb(r){return r!==void 0&&r.registrationStatus===2}function S6(r){return r.requestStatus===2&&!E6(r)}function E6(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+QB}function T6(r){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},r),{authToken:e})}function M6(r){return r.requestStatus===1&&r.requestTime+UA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C6(r){const e=r,{installationEntry:t,registrationPromise:n}=await z1(e);return n?n.catch(console.error):F1(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A6(r,e=!1){const t=r;return await b6(t),(await F1(t,e)).token}async function b6(r){const{registrationPromise:e}=await z1(r);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P6(r){if(!r||!r.options)throw cy("App Configuration");if(!r.name)throw cy("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw cy(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}function cy(r){return fh.create("missing-app-config-values",{valueName:r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb="installations",I6="installations-internal",R6=r=>{const e=r.getProvider("app").getImmediate(),t=P6(e),n=ym(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},D6=r=>{const e=r.getProvider("app").getImmediate(),t=ym(e,tb).getImmediate();return{getId:()=>C6(t),getToken:i=>A6(t,i)}};function L6(){Nu(new Dl(tb,R6,"PUBLIC")),Nu(new Dl(I6,D6,"PRIVATE"))}L6();Oa(FA,N1);Oa(FA,N1,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G0="analytics",O6="firebase_id",N6="origin",k6=60*1e3,z6="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",U1="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ks=new f1("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F6={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},io=new h_("analytics","Analytics",F6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U6(r){if(!r.startsWith(U1)){const e=io.create("invalid-gtag-resource",{gtagURL:r});return ks.warn(e.message),""}return r}function nb(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function B6(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}function V6(r,e){const t=B6("firebase-js-sdk-policy",{createScriptURL:U6}),n=document.createElement("script"),i=`${U1}?l=${r}&id=${e}`;n.src=t?t==null?void 0:t.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}function H6(r){let e=[];return Array.isArray(window[r])?e=window[r]:window[r]=e,e}async function G6(r,e,t,n,i,s){const a=n[i];try{if(a)await e[a];else{const f=(await nb(t)).find(d=>d.measurementId===i);f&&await e[f.appId]}}catch(u){ks.error(u)}r("config",i,s)}async function W6(r,e,t,n,i){try{let s=[];if(i&&i.send_to){let a=i.send_to;Array.isArray(a)||(a=[a]);const u=await nb(t);for(const f of a){const d=u.find(_=>_.measurementId===f),m=d&&e[d.appId];if(m)s.push(m);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),r("event",n,i||{})}catch(s){ks.error(s)}}function j6(r,e,t,n){async function i(s,...a){try{if(s==="event"){const[u,f]=a;await W6(r,e,t,u,f)}else if(s==="config"){const[u,f]=a;await G6(r,e,t,n,u,f)}else if(s==="consent"){const[u,f]=a;r("consent",u,f)}else if(s==="get"){const[u,f,d]=a;r("get",u,f,d)}else if(s==="set"){const[u]=a;r("set",u)}else r(s,...a)}catch(u){ks.error(u)}}return i}function q6(r,e,t,n,i){let s=function(...a){window[n].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=j6(s,r,e,t),{gtagCore:s,wrappedGtag:window[i]}}function X6(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(U1)&&t.src.includes(r))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $6=30,Y6=1e3;class Q6{constructor(e={},t=Y6){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const ib=new Q6;function K6(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}async function Z6(r){var e;const{appId:t,apiKey:n}=r,i={method:"GET",headers:K6(n)},s=z6.replace("{app-id}",t),a=await fetch(s,i);if(a.status!==200&&a.status!==304){let u="";try{const f=await a.json();!((e=f.error)===null||e===void 0)&&e.message&&(u=f.error.message)}catch{}throw io.create("config-fetch-failed",{httpStatus:a.status,responseMessage:u})}return a.json()}async function J6(r,e=ib,t){const{appId:n,apiKey:i,measurementId:s}=r.options;if(!n)throw io.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw io.create("no-api-key")}const a=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new nV;return setTimeout(async()=>{u.abort()},k6),rb({appId:n,apiKey:i,measurementId:s},a,u,e)}async function rb(r,{throttleEndTimeMillis:e,backoffCount:t},n,i=ib){var s;const{appId:a,measurementId:u}=r;try{await eV(n,e)}catch(f){if(u)return ks.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${f==null?void 0:f.message}]`),{appId:a,measurementId:u};throw f}try{const f=await Z6(r);return i.deleteThrottleMetadata(a),f}catch(f){const d=f;if(!tV(d)){if(i.deleteThrottleMetadata(a),u)return ks.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:a,measurementId:u};throw f}const m=Number((s=d==null?void 0:d.customData)===null||s===void 0?void 0:s.httpStatus)===503?NE(t,i.intervalMillis,$6):NE(t,i.intervalMillis),_={throttleEndTimeMillis:Date.now()+m,backoffCount:t+1};return i.setThrottleMetadata(a,_),ks.debug(`Calling attemptFetch again in ${m} millis`),rb(r,_,n,i)}}function eV(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(s),n(io.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function tV(r){if(!(r instanceof ju)||!r.customData)return!1;const e=Number(r.customData.httpStatus);return e===429||e===500||e===503||e===504}class nV{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function iV(r,e,t,n,i){if(i&&i.global){r("event",t,n);return}else{const s=await e,a=Object.assign(Object.assign({},n),{send_to:s});r("event",t,a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rV(){if(w2())try{await S2()}catch(r){return ks.warn(io.create("indexeddb-unavailable",{errorInfo:r==null?void 0:r.toString()}).message),!1}else return ks.warn(io.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function sV(r,e,t,n,i,s,a){var u;const f=J6(r);f.then(w=>{t[w.measurementId]=w.appId,r.options.measurementId&&w.measurementId!==r.options.measurementId&&ks.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${w.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(w=>ks.error(w)),e.push(f);const d=rV().then(w=>{if(w)return n.getId()}),[m,_]=await Promise.all([f,d]);X6(s)||V6(s,m.measurementId),i("js",new Date);const y=(u=a==null?void 0:a.config)!==null&&u!==void 0?u:{};return y[N6]="firebase",y.update=!0,_!=null&&(y[O6]=_),i("config",m.measurementId,y),m.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e){this.app=e}_delete(){return delete Ap[this.app.options.appId],Promise.resolve()}}let Ap={},OT=[];const NT={};let hy="dataLayer",aV="gtag",kT,sb,zT=!1;function lV(){const r=[];if(B5()&&r.push("This is a browser extension environment."),H5()||r.push("Cookies are not available."),r.length>0){const e=r.map((n,i)=>`(${i+1}) ${n}`).join(" "),t=io.create("invalid-analytics-context",{errorInfo:e});ks.warn(t.message)}}function uV(r,e,t){lV();const n=r.options.appId;if(!n)throw io.create("no-app-id");if(!r.options.apiKey)if(r.options.measurementId)ks.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw io.create("no-api-key");if(Ap[n]!=null)throw io.create("already-exists",{id:n});if(!zT){H6(hy);const{wrappedGtag:s,gtagCore:a}=q6(Ap,OT,NT,hy,aV);sb=s,kT=a,zT=!0}return Ap[n]=sV(r,OT,NT,e,kT,hy,t),new oV(r)}function cV(r=A2()){r=ah(r);const e=ym(r,G0);return e.isInitialized()?e.getImmediate():hV(r)}function hV(r,e={}){const t=ym(r,G0);if(t.isInitialized()){const i=t.getImmediate();if(jp(e,t.getOptions()))return i;throw io.create("already-initialized")}return t.initialize({options:e})}function fV(r,e,t,n){r=ah(r),iV(sb,Ap[r.app.options.appId],e,t,n).catch(i=>ks.error(i))}const FT="@firebase/analytics",UT="0.10.12";function dV(){Nu(new Dl(G0,(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return uV(n,i,t)},"PUBLIC")),Nu(new Dl("analytics-internal",r,"PRIVATE")),Oa(FT,UT),Oa(FT,UT,"esm2017");function r(e){try{const t=e.getProvider(G0).getImmediate();return{logEvent:(n,i,s)=>fV(t,n,i,s)}}catch(t){throw io.create("interop-component-reg-failed",{reason:t})}}}dV();const pV={apiKey:"AIzaSyBcTTg-DfBP2f9qTnEIEFC_tGplL5WFmYU",authDomain:"trg-studio-b1b2d.firebaseapp.com",projectId:"trg-studio-b1b2d",storageBucket:"trg-studio-b1b2d.firebasestorage.app",messagingSenderId:"417779597476",appId:"1:417779597476:web:760883e6dc13e72710a631",measurementId:"G-WFDHXH8D4J"},ob=C2(pV),mV=OB(ob);cV(ob);function gV(){const r=new Date("2025-12-31T00:00:00"),e=()=>{const m=r-new Date,_=Math.floor(m/(1e3*60*60*24)),y=Math.floor(m%(1e3*60*60*24)/(1e3*60*60)),w=Math.floor(m%(1e3*60*60)/(1e3*60)),T=Math.floor(m%(1e3*60)/1e3);return{days:_,hours:y,minutes:w,seconds:T}},[t,n]=at.useState(e()),[i,s]=at.useState(""),[a,u]=at.useState("");at.useEffect(()=>{const d=setInterval(()=>{n(e())},1e3);return()=>clearInterval(d)},[]);const f=async d=>{d.preventDefault();try{await XB(DB(mV,"emails"),{email:i,timestamp:new Date}),console.log("Correo guardado correctamente"),u("Correo completado"),s(""),setTimeout(()=>{u("")},3e3)}catch(m){console.error("Error al guardar el correo:",m),u("Hubo un error al registrar el correo")}};return rt.jsx(rt.Fragment,{children:rt.jsxs("div",{className:"relative w-screen h-screen overflow-hidden bg-black text-white font-sans",children:[rt.jsx(Yk,{style:{position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",zIndex:0},children:rt.jsx(m5,{grain:"on",control:"query",urlString:"https://www.shadergradient.co/customize?animate=on&axesHelper=off&bgColor1=%23000000&bgColor2=%23000000&brightness=1.2&cAzimuthAngle=180&cDistance=3.1&cPolarAngle=90&cameraZoom=1&color1=%23e40000&color2=%237b0000&color3=%23a00000&destination=onCanvas&embedMode=off&envPreset=lobby&format=gif&fov=40&frameRate=10&gizmoHelper=hide&grain=off&lightType=env&pixelDensity=1.2&positionX=-1.4&positionY=0&positionZ=0&range=enabled&rangeEnd=40&rangeStart=0&reflection=0.2&rotationX=0&rotationY=0&rotationZ=0&shader=defaults&toggleAxis=false&type=waterPlane&uAmplitude=0&uDensity=2.2&uFrequency=5.5&uSpeed=0.1&uStrength=5&uTime=0&wireframe=false&zoomOut=false"})}),rt.jsxs("div",{className:"relative z-11 flex justify-between items-center p-4 bg-black/30",children:[rt.jsx("img",{src:"/logo.png",alt:"Logo",className:"h-10"}),rt.jsx("a",{href:"mailto:trg.studio.dance@gmail.com",children:rt.jsx("button",{className:"bg-white text-black font-semibold py-2 px-4 rounded-full text-sm transition-transform transform hover:scale-105 hover:bg-gray-400 hover:text-white",children:"CONTACT US!"})})]}),rt.jsxs("div",{className:"relative z-10 flex flex-col justify-center items-center h-[90vh] ",children:[rt.jsxs("div",{className:"bg-black/15 backdrop-blur-md rounded-3xl px-10 py-8 border border-white/30 shadow-2xl text-center w-[300px] md:w-[1000px] sm:w-[600px]",children:[rt.jsxs("p",{className:"text-4xl font-light tracking-widest py-2.5  mx-5",children:[rt.jsx("span",{className:"text-white",children:t.days})," ",rt.jsx("span",{className:"text-red-400 font-light",children:"DAYS"})," ",rt.jsx("span",{className:"text-white",children:t.hours})," ",rt.jsx("span",{className:"text-red-400 font-light",children:"HOURS"})," ",rt.jsx("span",{className:"text-white",children:t.minutes})," ",rt.jsx("span",{className:"text-red-400 font-light",children:"MIN"})," ",rt.jsx("span",{className:"text-white",children:t.seconds})," ",rt.jsx("span",{className:"text-red-400 font-light",children:"SEC"})]}),rt.jsx("div",{className:"flex justify-center items-center py-5",children:rt.jsx("img",{src:"/today.png",className:"h-auto w-[550px]"})})]}),rt.jsx("div",{className:"relative z-10 flex justify-center items-center py-10",children:rt.jsxs("form",{className:"flex",onSubmit:f,children:[rt.jsx("input",{type:"email",value:i,onChange:d=>s(d.target.value),className:"w-[150px] sm:w-[300px] p-2 mb-4bg-transparent border-b-1 border-white text-white focus:outline-none",placeholder:a||"Enter your e-mail",required:!0,autoComplete:"off"}),rt.jsx("button",{type:"submit",className:"mx-3 w-[150px] py-2 px-4 bg-white text-black font-semibold rounded-full hover:bg-gray-400 hover:text-white transition-transform transform hover:scale-105",children:"NOTIFY ME!"})]})}),rt.jsxs("div",{className:"flex",children:[rt.jsx("a",{href:"https://www.instagram.com/triggers.studio/",target:"_blank",rel:"noopener noreferrer",className:"px-16",children:rt.jsx(E5,{className:"text-white text-4xl hover:text-gray-400 transition"})}),rt.jsx("a",{href:"https://www.tiktok.com/@trg.dance",target:"_blank",rel:"noopener noreferrer",className:"px-16",children:rt.jsx(T5,{className:"text-white text-4xl hover:text-gray-400 transition"})})]})]})]})})}Ub.createRoot(document.getElementById("root")).render(rt.jsx(at.StrictMode,{children:rt.jsx(gV,{})}));
